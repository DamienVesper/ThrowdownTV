/*! v3.2.0-dce59b04, 2020-12-11T12:14:07Z */
!(function r (i, a, o) { function s (t, e) { if (!a[t]) { if (!i[t]) { var n = typeof require === `function` && require; if (!e && n) return n(t, !0); if (u) return u(t, !0); throw (n = new Error(`Cannot find module '${t}'`)).code = `MODULE_NOT_FOUND`, n; }n = a[t] = { exports: {} }, i[t][0].call(n.exports, (e) => { return s(i[t][1][e] || e); }, n, n.exports, r, i, a, o); } return a[t].exports; } for (var u = typeof require === `function` && require, e = 0; e < o.length; e++)s(o[e]); return s; }({ 1: [function (e, t, n) { "use strict"; let o; let u; let r; const i = { encode: function (e) { for (var t = [], n = 0; n < e.length; ++n) { const r = e.charCodeAt(n); r < 128 ? t.push(r) : (r < 2048 ? t.push(192 | r >> 6) : (r < 65536 ? t.push(224 | r >> 12) : (t.push(240 | r >> 18), t.push(128 | 63 & r >> 12)), t.push(128 | 63 & r >> 6)), t.push(128 | 63 & r)); } return t; }, decode: function (e) { for (var t = [], n = 0; n < e.length;) { let r = e[n++]; r < 128 || (r < 224 ? r = (31 & r) << 6 : (r < 240 ? r = (15 & r) << 12 : (r = (7 & r) << 18, r |= (63 & e[n++]) << 12), r |= (63 & e[n++]) << 6), r |= 63 & e[n++]), t.push(String.fromCharCode(r)); } return t.join(``); } }; const l = {}; function d (e) { for (var t = 0, n = [], r = 0 | e.length / 3; r-- > 0;) { var i = (e[t] << 16) + (e[t + 1] << 8) + e[t + 2]; t += 3, n.push(o.charAt(63 & i >> 18)), n.push(o.charAt(63 & i >> 12)), n.push(o.charAt(63 & i >> 6)), n.push(o.charAt(63 & i)); } return e.length - t == 2 ? (i = (e[t] << 16) + (e[t + 1] << 8), n.push(o.charAt(63 & i >> 18)), n.push(o.charAt(63 & i >> 12)), n.push(o.charAt(63 & i >> 6)), n.push(`=`)) : e.length - t == 1 && (i = e[t] << 16, n.push(o.charAt(63 & i >> 18)), n.push(o.charAt(63 & i >> 12)), n.push(`==`)), n.join(``); } function f (e) { for (var t = 0, n = [], r = 0 | e.length / 4; r-- > 0;) { const i = (u[e.charCodeAt(t)] << 18) + (u[e.charCodeAt(t + 1)] << 12) + (u[e.charCodeAt(t + 2)] << 6) + u[e.charCodeAt(t + 3)]; n.push(255 & i >> 16), n.push(255 & i >> 8), n.push(255 & i), t += 4; } return n && (e.charAt(t - 2) == `=` ? (n.pop(), n.pop()) : e.charAt(t - 1) == `=` && n.pop()), n; }o = `ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`, u = (function () { for (var e = [], t = 0; t < o.length; ++t)e[o.charCodeAt(t)] = t; return e[`=`.charCodeAt(0)] = 0, e; }()), r = { encode: function (e) { for (var t = [], n = 0; n < e.length; ++n)t.push(e.charCodeAt(n)); return t; }, decode: function (e) { for (let t = 0; t < s.length; ++t)a[t] = String.fromCharCode(a[t]); return a.join(``); } }, l.decodeArray = function (e) { e = f(e); return new Uint8Array(e); }, l.encodeASCII = function (e) { e = r.encode(e); return d(e); }, l.decodeASCII = function (e) { e = f(e); return r.decode(e); }, l.encode = function (e) { e = i.encode(e); return d(e); }, l.decode = function (e) { e = f(e); return i.decode(e); }, void 0 !== n && (n.decode = l.decode, n.decodeArray = l.decodeArray, n.encode = l.encode, n.encodeASCII = l.encodeASCII); }, {}], 2: [function (e, t, n) { "use strict"; !(function (e) { function o (e) { let t = e; return n.hasOwnProperty(e) && (t = n[e]), String.fromCharCode(t); } function s (e) { for (var t = [], n = 0; n < e.length; n++)t.push(e[n].toString(16)); return t; } function u (e, t, n, r, i) { this.foreground = e || `white`, this.underline = t || !1, this.italics = n || !1, this.background = r || `black`, this.flash = i || !1; } var n = { 42: 225, 92: 233, 94: 237, 95: 243, 96: 250, 123: 231, 124: 247, 125: 209, 126: 241, 127: 9608, 128: 174, 129: 176, 130: 189, 131: 191, 132: 8482, 133: 162, 134: 163, 135: 9834, 136: 224, 137: 32, 138: 232, 139: 226, 140: 234, 141: 238, 142: 244, 143: 251, 144: 193, 145: 201, 146: 211, 147: 218, 148: 220, 149: 252, 150: 8216, 151: 161, 152: 42, 153: 8217, 154: 9473, 155: 169, 156: 8480, 157: 8226, 158: 8220, 159: 8221, 160: 192, 161: 194, 162: 199, 163: 200, 164: 202, 165: 203, 166: 235, 167: 206, 168: 207, 169: 239, 170: 212, 171: 217, 172: 249, 173: 219, 174: 171, 175: 187, 176: 195, 177: 227, 178: 205, 179: 204, 180: 236, 181: 210, 182: 242, 183: 213, 184: 245, 185: 123, 186: 125, 187: 92, 188: 94, 189: 95, 190: 124, 191: 8764, 192: 196, 193: 228, 194: 214, 195: 246, 196: 223, 197: 165, 198: 164, 199: 9475, 200: 197, 201: 229, 202: 216, 203: 248, 204: 9487, 205: 9491, 206: 9495, 207: 9499 }; const i = { 17: 1, 18: 3, 21: 5, 22: 7, 23: 9, 16: 11, 19: 12, 20: 14 }; const a = { 17: 2, 18: 4, 21: 6, 22: 8, 23: 10, 19: 13, 20: 15 }; const l = { 25: 1, 26: 3, 29: 5, 30: 7, 31: 9, 24: 11, 27: 12, 28: 14 }; const d = { 25: 2, 26: 4, 29: 6, 30: 8, 31: 10, 27: 13, 28: 15 }; const f = [`white`, `green`, `blue`, `cyan`, `red`, `yellow`, `magenta`, `black`, `transparent`]; const c = { verboseFilter: { DATA: 3, DEBUG: 3, INFO: 2, WARNING: 2, TEXT: 1, ERROR: 0 }, time: null, verboseLevel: 0, setTime: function (e) { this.time = e; }, log: function (e, t) { const n = this.verboseFilter[e]; this.verboseLevel >= n && console.log(`${this.time} [${e}] ${t}`); } }; u.prototype = { reset: function () { this.foreground = `white`, this.underline = !1, this.italics = !1, this.background = `black`, this.flash = !1; }, setStyles: function (e) { for (let t = [`foreground`, `underline`, `italics`, `background`, `flash`], n = 0; n < t.length; n++) { const r = t[n]; e.hasOwnProperty(r) && (this[r] = e[r]); } }, isDefault: function () { return this.foreground === `white` && !this.underline && !this.italics && this.background === `black` && !this.flash; }, equals: function (e) { return this.foreground === e.foreground && this.underline === e.underline && this.italics === e.italics && this.background === e.background && this.flash === e.flash; }, copy: function (e) { this.foreground = e.foreground, this.underline = e.underline, this.italics = e.italics, this.background = e.background, this.flash = e.flash; }, toString: function () { return `color=${this.foreground}, underline=${this.underline}, italics=${this.italics}, background=${this.background}, flash=${this.flash}`; } }; function t (e, t, n, r, i, a) { this.uchar = e || ` `, this.penState = new u(t, n, r, i, a); }t.prototype = { reset: function () { this.uchar = ` `, this.penState.reset(); }, setChar: function (e, t) { this.uchar = e, this.penState.copy(t); }, setPenState: function (e) { this.penState.copy(e); }, equals: function (e) { return this.uchar === e.uchar && this.penState.equals(e.penState); }, copy: function (e) { this.uchar = e.uchar, this.penState.copy(e.penState); }, isEmpty: function () { return this.uchar === ` ` && this.penState.isDefault(); } }; function r () { this.chars = []; for (let e = 0; e < 32; e++) this.chars.push(new t()); this.pos = 0, this.currPenState = new u(); }r.prototype = { equals: function (e) { for (var t = !0, n = 0; n < 32; n++) if (!this.chars[n].equals(e.chars[n])) { t = !1; break; } return t; }, copy: function (e) { for (let t = 0; t < 32; t++) this.chars[t].copy(e.chars[t]); }, isEmpty: function () { for (var e = !0, t = 0; t < 32; t++) if (!this.chars[t].isEmpty()) { e = !1; break; } return e; }, setCursor: function (e) { this.pos !== e && (this.pos = e), this.pos < 0 ? (c.log(`ERROR`, `Negative cursor position ${this.pos}`), this.pos = 0) : this.pos > 32 && (c.log(`ERROR`, `Too large cursor position ${this.pos}`), this.pos = 32); }, moveCursor: function (e) { const t = this.pos + e; if (e > 1) for (let n = this.pos + 1; n < t + 1; n++) this.chars[n].setPenState(this.currPenState); this.setCursor(t); }, backSpace: function () { this.moveCursor(-1), this.chars[this.pos].setChar(` `, this.currPenState); }, insertChar: function (e) { e >= 144 && this.backSpace(); const t = o(e); this.pos >= 32 ? c.log(`ERROR`, `Cannot insert ${e.toString(16)} (${t}) at position ${this.pos}. Skipping it!`) : (this.chars[this.pos].setChar(t, this.currPenState), this.moveCursor(1)); }, clearFromPos: function (e) { for (let t = e; t < 32; t++) this.chars[t].reset(); }, clear: function () { this.clearFromPos(0), this.pos = 0, this.currPenState.reset(); }, clearToEndOfRow: function () { this.clearFromPos(this.pos); }, getTextString: function () { for (var e = [], t = !0, n = 0; n < 32; n++) { const r = this.chars[n].uchar; r !== ` ` && (t = !1), e.push(r); } return t ? `` : e.join(``); }, setPenStyles: function (e) { this.currPenState.setStyles(e), this.chars[this.pos].setPenState(this.currPenState); } }; function h () { this.rows = []; for (let e = 0; e < 15; e++) this.rows.push(new r()); this.currRow = 14, this.nrRollUpRows = null, this.reset(); }h.prototype = { reset: function () { for (let e = 0; e < 15; e++) this.rows[e].clear(); this.currRow = 14; }, equals: function (e) { for (var t = !0, n = 0; n < 15; n++) if (!this.rows[n].equals(e.rows[n])) { t = !1; break; } return t; }, copy: function (e) { for (let t = 0; t < 15; t++) this.rows[t].copy(e.rows[t]); }, isEmpty: function () { for (var e = !0, t = 0; t < 15; t++) if (!this.rows[t].isEmpty()) { e = !1; break; } return e; }, backSpace: function () { this.rows[this.currRow].backSpace(); }, clearToEndOfRow: function () { this.rows[this.currRow].clearToEndOfRow(); }, insertChar: function (e) { this.rows[this.currRow].insertChar(e); }, setPen: function (e) { this.rows[this.currRow].setPenStyles(e); }, moveCursor: function (e) { this.rows[this.currRow].moveCursor(e); }, setCursor: function (e) { c.log(`INFO`, `setCursor: ${e}`), this.rows[this.currRow].setCursor(e); }, setPAC: function (e) { c.log(`INFO`, `pacData = ${JSON.stringify(e)}`); let t = e.row - 1; this.nrRollUpRows && t < this.nrRollUpRows - 1 && (t = this.nrRollUpRows - 1), this.currRow = t; const n = this.rows[this.currRow]; e.indent !== null && (t = e.indent, t = Math.max(t - 1, 0), n.setCursor(e.indent), e.color = n.chars[t].penState.foreground); e = { foreground: e.color, underline: e.underline, italics: e.italics, background: `black`, flash: !1 }; this.setPen(e); }, setBkgData: function (e) { c.log(`INFO`, `bkgData = ${JSON.stringify(e)}`), this.backSpace(), this.setPen(e), this.insertChar(32); }, setRollUpRows: function (e) { this.nrRollUpRows = e; }, rollUp: function () { let e; this.nrRollUpRows !== null ? (c.log(`TEXT`, this.getDisplayText()), e = this.currRow + 1 - this.nrRollUpRows, (e = this.rows.splice(e, 1)[0]).clear(), this.rows.splice(this.currRow, 0, e), c.log(`INFO`, `Rolling up`)) : c.log(`DEBUG`, `roll_up but nrRollUpRows not set yet`); }, getDisplayText: function (e) { e = e || !1; for (var t, n = [], r = ``, i = 0; i < 15; i++) { const a = this.rows[i].getTextString(); a && (t = i + 1, e ? n.push(`Row ${t}: "${a}"`) : n.push(a.trim())); } return n.length > 0 && (r = e ? `[${n.join(` | `)}]` : n.join(`\n`)), r; }, getTextAndFormat: function () { return this.rows; } }; function p (e, t) { this.chNr = e, this.outputFilter = t, this.mode = null, this.verbose = 0, this.displayedMemory = new h(), this.nonDisplayedMemory = new h(), this.lastOutputScreen = new h(), this.currRollUpRow = this.displayedMemory.rows[14], this.writeScreen = this.displayedMemory, this.mode = null, this.cueStartTime = null; }p.prototype = { modes: [`MODE_ROLL-UP`, `MODE_POP-ON`, `MODE_PAINT-ON`, `MODE_TEXT`], reset: function () { this.mode = null, this.displayedMemory.reset(), this.nonDisplayedMemory.reset(), this.lastOutputScreen.reset(), this.currRollUpRow = this.displayedMemory.rows[14], this.writeScreen = this.displayedMemory, this.mode = null, this.cueStartTime = null, this.lastCueEndTime = null; }, getHandler: function () { return this.outputFilter; }, setHandler: function (e) { this.outputFilter = e; }, setPAC: function (e) { this.writeScreen.setPAC(e); }, setBkgData: function (e) { this.writeScreen.setBkgData(e); }, setMode: function (e) { e !== this.mode && (this.mode = e, c.log(`INFO`, `MODE=${e}`), this.mode == `MODE_POP-ON` ? this.writeScreen = this.nonDisplayedMemory : (this.writeScreen = this.displayedMemory, this.writeScreen.reset()), this.mode !== `MODE_ROLL-UP` && (this.displayedMemory.nrRollUpRows = null, this.nonDisplayedMemory.nrRollUpRows = null), this.mode = e); }, insertChars: function (e) { for (let t = 0; t < e.length; t++) this.writeScreen.insertChar(e[t]); const n = this.writeScreen === this.displayedMemory ? `DISP` : `NON_DISP`; c.log(`INFO`, `${n}: ${this.writeScreen.getDisplayText(!0)}`), this.mode !== `MODE_PAINT-ON` && this.mode !== `MODE_ROLL-UP` || (c.log(`TEXT`, `DISPLAYED: ${this.displayedMemory.getDisplayText(!0)}`), this.outputDataUpdate()); }, cc_RCL: function () { c.log(`INFO`, `RCL - Resume Caption Loading`), this.setMode(`MODE_POP-ON`); }, cc_BS: function () { c.log(`INFO`, `BS - BackSpace`), this.mode !== `MODE_TEXT` && (this.writeScreen.backSpace(), this.writeScreen === this.displayedMemory && this.outputDataUpdate()); }, cc_AOF: function () {}, cc_AON: function () {}, cc_DER: function () { c.log(`INFO`, `DER- Delete to End of Row`), this.writeScreen.clearToEndOfRow(), this.outputDataUpdate(); }, cc_RU: function (e) { c.log(`INFO`, `RU(${e}) - Roll Up`), this.writeScreen = this.displayedMemory, this.setMode(`MODE_ROLL-UP`), this.writeScreen.setRollUpRows(e); }, cc_FON: function () { c.log(`INFO`, `FON - Flash On`), this.writeScreen.setPen({ flash: !0 }); }, cc_RDC: function () { c.log(`INFO`, `RDC - Resume Direct Captioning`), this.setMode(`MODE_PAINT-ON`); }, cc_TR: function () { c.log(`INFO`, `TR`), this.setMode(`MODE_TEXT`); }, cc_RTD: function () { c.log(`INFO`, `RTD`), this.setMode(`MODE_TEXT`); }, cc_EDM: function () { c.log(`INFO`, `EDM - Erase Displayed Memory`), this.displayedMemory.reset(), this.outputDataUpdate(); }, cc_CR: function () { c.log(`CR - Carriage Return`), this.writeScreen.rollUp(), this.outputDataUpdate(); }, cc_ENM: function () { c.log(`INFO`, `ENM - Erase Non-displayed Memory`), this.nonDisplayedMemory.reset(); }, cc_EOC: function () { let e; c.log(`INFO`, `EOC - End Of Caption`), this.mode === `MODE_POP-ON` && (e = this.displayedMemory, this.displayedMemory = this.nonDisplayedMemory, this.nonDisplayedMemory = e, this.writeScreen = this.nonDisplayedMemory, c.log(`TEXT`, `DISP: ${this.displayedMemory.getDisplayText()}`)), this.outputDataUpdate(); }, cc_TO: function (e) { c.log(`INFO`, `TO(${e}) - Tab Offset`), this.writeScreen.moveCursor(e); }, cc_MIDROW: function (e) { const t = { flash: !1 }; t.underline = e % 2 == 1, t.italics = e >= 46, t.italics ? t.foreground = `white` : (e = Math.floor(e / 2) - 16, t.foreground = [`white`, `green`, `blue`, `cyan`, `red`, `yellow`, `magenta`][e]), c.log(`INFO`, `MIDROW: ${JSON.stringify(t)}`), this.writeScreen.setPen(t); }, outputDataUpdate: function () { const e = c.time; e !== null && this.outputFilter && (this.outputFilter.updateData && this.outputFilter.updateData(e, this.displayedMemory), this.cueStartTime !== null || this.displayedMemory.isEmpty() ? this.displayedMemory.equals(this.lastOutputScreen) || (this.outputFilter.newCue && this.outputFilter.newCue(this.cueStartTime, e, this.lastOutputScreen), this.cueStartTime = this.displayedMemory.isEmpty() ? null : e) : this.cueStartTime = e, this.lastOutputScreen.copy(this.displayedMemory)); }, cueSplitAtTime: function (e) { this.outputFilter && (this.displayedMemory.isEmpty() || (this.outputFilter.newCue && this.outputFilter.newCue(this.cueStartTime, e, this.displayedMemory), this.cueStartTime = e)); } }; function g (e, t, n) { this.field = e || 1, this.outputs = [t, n], this.channels = [new p(1, t), new p(2, n)], this.currChNr = -1, this.lastCmdA = null, this.lastCmdB = null, this.bufferedData = [], this.startTime = null, this.lastTime = null, this.dataCounters = { padding: 0, char: 0, cmd: 0, other: 0 }; }g.prototype = { getHandler: function (e) { return this.channels[e].getHandler(); }, setHandler: function (e, t) { this.channels[e].setHandler(t); }, addData: function (e, t) { let n; let r = !1; this.lastTime = e, c.setTime(e); for (let i = 0; i < t.length; i += 2) { const a = 127 & t[i]; const o = 127 & t[i + 1]; a >= 16 && a <= 31 && a === this.lastCmdA && o === this.lastCmdB ? (this.lastCmdA = null, this.lastCmdB = null, c.log(`DEBUG`, `Repeated command (${s([a, o])}) is dropped`)) : a != 0 || o != 0 ? (c.log(`DATA`, `[${s([t[i], t[i + 1]])}] -> (${s([a, o])})`), (n = (n = (n = (n = this.parseCmd(a, o)) || this.parseMidrow(a, o)) || this.parsePAC(a, o)) || this.parseBackgroundAttributes(a, o)) || (r = this.parseChars(a, o)) && (this.currChNr && this.currChNr >= 0 ? this.channels[this.currChNr - 1].insertChars(r) : c.log(`WARNING`, `No channel found yet. TEXT-MODE?`)), n ? this.dataCounters.cmd += 2 : r ? this.dataCounters.char += 2 : (this.dataCounters.other += 2, c.log(`WARNING`, `Couldn't parse cleaned data ${s([a, o])} orig: ${s([t[i], t[i + 1]])}`))) : this.dataCounters.padding += 2; } }, parseCmd: function (e, t) { let n = null; if (!((e === 20 || e === 21 || e === 28 || e === 29) && t >= 32 && t <= 47) && !((e === 23 || e === 31) && t >= 33 && t <= 35)) return !1; n = e === 20 || e === 21 || e === 23 ? 1 : 2; const r = this.channels[n - 1]; return e === 20 || e === 21 || e === 28 || e === 29 ? t === 32 ? r.cc_RCL() : t === 33 ? r.cc_BS() : t === 34 ? r.cc_AOF() : t === 35 ? r.cc_AON() : t === 36 ? r.cc_DER() : t === 37 ? r.cc_RU(2) : t === 38 ? r.cc_RU(3) : t === 39 ? r.cc_RU(4) : t === 40 ? r.cc_FON() : t === 41 ? r.cc_RDC() : t === 42 ? r.cc_TR() : t === 43 ? r.cc_RTD() : t === 44 ? r.cc_EDM() : t === 45 ? r.cc_CR() : t === 46 ? r.cc_ENM() : t === 47 && r.cc_EOC() : r.cc_TO(t - 32), this.lastCmdA = e, this.lastCmdB = t, this.currChNr = n, !0; }, parseMidrow: function (e, t) { let n = null; if ((e === 17 || e === 25) && t >= 32 && t <= 47) { if ((n = e === 17 ? 1 : 2) !== this.currChNr) return c.log(`ERROR`, `Mismatch channel in midrow parsing`), !1; n = this.channels[n - 1]; return n.insertChars([32]), n.cc_MIDROW(t), c.log(`DEBUG`, `MIDROW (${s([e, t])})`), this.lastCmdA = e, this.lastCmdB = t, !0; } return !1; }, parsePAC: function (e, t) { let n; let r = null; if (!((e >= 17 && e <= 23 || e >= 25 && e <= 31) && t >= 64 && t <= 127) && !((e === 16 || e === 24) && t >= 64 && t <= 95)) return !1; n = e <= 23 ? 1 : 2, r = (t >= 64 && t <= 95 ? n == 1 ? i : l : n == 1 ? a : d)[e]; r = this.interpretPAC(r, t); return this.channels[n - 1].setPAC(r), this.lastCmdA = e, this.lastCmdB = t, this.currChNr = n, !0; }, interpretPAC: function (e, t) { var n = t; var e = { color: null, italics: !1, indent: null, underline: !1, row: e }; var n = t > 95 ? t - 96 : t - 64; return e.underline = (1 & n) == 1, n <= 13 ? e.color = [`white`, `green`, `blue`, `cyan`, `red`, `yellow`, `magenta`, `white`][Math.floor(n / 2)] : n <= 15 ? (e.italics = !0, e.color = `white`) : e.indent = 4 * Math.floor((n - 16) / 2), e; }, parseChars: function (e, t) { let n; let r = null; let i = null; let a = null; return (a = e >= 25 ? (r = 2, e - 8) : (r = 1, e)) >= 17 && a <= 19 ? (n = t, n = a === 17 ? t + 80 : a === 18 ? t + 112 : t + 144, c.log(`INFO`, `Special char '${o(n)}' in channel ${r}`), i = [n], this.lastCmdA = e, this.lastCmdB = t) : e >= 32 && e <= 127 && (i = t === 0 ? [e] : [e, t], this.lastCmdA = null, this.lastCmdB = null), i && (t = s(i), c.log(`DEBUG`, `Char codes =  ${t.join(`,`)}`)), i; }, parseBackgroundAttributes: function (e, t) { let n, r; return ((e === 16 || e === 24) && t >= 32 && t <= 47 || (e === 23 || e === 31) && t >= 45 && t <= 47) && (n = {}, e === 16 || e === 24 ? (r = Math.floor((t - 32) / 2), n.background = f[r], t % 2 == 1 && (n.background = `${n.background}_semi`)) : t === 45 ? n.background = `transparent` : (n.foreground = `black`, t === 47 && (n.underline = !0)), r = e < 24 ? 1 : 2, this.channels[r - 1].setBkgData(n), this.lastCmdA = e, this.lastCmdB = t, !0); }, reset: function () { for (let e = 0; e < this.channels.length; e++) this.channels[e] && this.channels[e].reset(); this.lastCmdA = null, this.lastCmdB = null; }, cueSplitAtTime: function (e) { for (let t = 0; t < this.channels.length; t++) this.channels[t] && this.channels[t].cueSplitAtTime(e); } }; e.logger = c, e.PenState = u, e.CaptionScreen = h, e.Cea608Parser = g, e.findCea608Nalus = function (e, t, n) { for (var r, i = t, a = []; i < t + n;) { if (r = e.getUint32(i), (31 & e.getUint8(i + 4)) == 6) for (let o = i + 5, s = -1; o < i + 4 + r - 1;) { s = 0; for (var u = 255; u === 255;)s += u = e.getUint8(o), o++; for (var l = 0, u = 255; u === 255;)l += u = e.getUint8(o), o++; !(function (e, t, n, r) { if (e !== 4 || t < 8) return null; const i = n.getUint8(r); var e = n.getUint16(r + 1); var t = n.getUint32(r + 3); var r = n.getUint8(r + 7); return i == 181 && e == 49 && t == 1195456820 && r == 3; }(s, l, e, o)) || a.push([o, l]), o += l; }i += r + 4; } return a; }, e.extractCea608DataFromRange = function (e, t) { let n = t[0]; const r = [[], []]; n += 8; const i = 31 & e.getUint8(n); n += 2; for (let a = 0; a < i; a++) { let o = e.getUint8(n); const s = 4 & o; const u = 3 & o; n++; const l = e.getUint8(n); n++; o = e.getUint8(n); n++, s && (127 & l) + (127 & o) != 0 && (u == 0 ? (r[0].push(l), r[0].push(o)) : u == 1 && (r[1].push(l), r[1].push(o))); } return r; }; }(void 0 === n ? (void 0).cea608parser = {} : n)); }, {}], 3: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }), n.default = function (A) { A = A || {}, (function () { void 0 === A.escapeMode && (A.escapeMode = !0); void 0 === A.attributePrefix && (A.attributePrefix = `_`); A.arrayAccessForm = A.arrayAccessForm || `none`, A.emptyNodeForm = A.emptyNodeForm || `text`, void 0 === A.enableToStringFunc && (A.enableToStringFunc = !0); A.arrayAccessFormPaths = A.arrayAccessFormPaths || [], void 0 === A.skipEmptyTextNodesForObj && (A.skipEmptyTextNodesForObj = !0); void 0 === A.stripWhitespaces && (A.stripWhitespaces = !0); A.datetimeAccessFormPaths = A.datetimeAccessFormPaths || [], void 0 === A.useDoubleQuotes && (A.useDoubleQuotes = !1); A.xmlElementsFilter = A.xmlElementsFilter || [], A.jsonPropertiesFilter = A.jsonPropertiesFilter || [], void 0 === A.keepCData && (A.keepCData = !1); void 0 === A.ignoreRoot && (A.ignoreRoot = !1); }()); const I = { ELEMENT_NODE: 1, TEXT_NODE: 3, CDATA_SECTION_NODE: 4, COMMENT_NODE: 8, DOCUMENT_NODE: 9 }; function R (e) { let t = e.localName; return t == null && (t = e.baseName), t != null && t != `` || (t = e.nodeName), t; } function u (e) { return typeof e === `string` ? e.replace(/&/g, `&amp;`).replace(/</g, `&lt;`).replace(/>/g, `&gt;`).replace(/"/g, `&quot;`).replace(/'/g, `&apos;`) : e; } function b (e, t, n, r) { for (var i = 0; i < e.length; i++) { const a = e[i]; if (typeof a === `string`) { if (a == r) break; } else if (a instanceof RegExp) { if (a.test(r)) break; } else if (typeof a === `function` && a(t, n, r)) break; } return i != e.length; } function D (e, t, n) { A.arrayAccessForm === `property` && (e[t] instanceof Array ? e[`${t}_asArray`] = e[t] : e[`${t}_asArray`] = [e[t]]), !(e[t] instanceof Array) && A.arrayAccessFormPaths.length > 0 && b(A.arrayAccessFormPaths, e, t, n) && (e[t] = [e[t]]); } function M (e) { let t = e.split(/[-T:+Z]/g); let n = new Date(t[0], t[1] - 1, t[2]); const r = t[5].split(`.`); return n.setHours(t[3], t[4], r[0]), r.length > 1 && n.setMilliseconds(r[1]), t[6] && t[7] ? (t = 60 * t[6] + Number(t[7]), t = 0 + ((/\d\d-\d\d:\d\d$/.test(e) ? `-` : `+`) == `-` ? -1 * t : t), n.setMinutes(n.getMinutes() - t - n.getTimezoneOffset())) : e.indexOf(`Z`, e.length - 1) !== -1 && (n = new Date(Date.UTC(n.getFullYear(), n.getMonth(), n.getDate(), n.getHours(), n.getMinutes(), n.getSeconds(), n.getMilliseconds()))), n; } function N (e, t) { if (e.nodeType == I.DOCUMENT_NODE) { for (var n = new Object(), r = e.childNodes, i = 0; i < r.length; i++) { (o = r[i]).nodeType == I.ELEMENT_NODE && (A.ignoreRoot ? n = N(o) : (n = {})[d = R(o)] = N(o)); } return n; } if (e.nodeType == I.ELEMENT_NODE) { (n = new Object()).__cnt = 0; for (var a = [], r = e.childNodes, i = 0; i < r.length; i++) { var o; var s; var u; var l; var d = R(o = r[i]); o.nodeType != I.COMMENT_NODE && (s = `${t}.${d}`, y = n, v = o.nodeType, T = d, S = s, v == I.ELEMENT_NODE && A.xmlElementsFilter.length > 0 && !b(A.xmlElementsFilter, y, T, S) || (n.__cnt++, n[d] == null ? (u = N(o, s), d == `#text` && !/[^\s]/.test(u) || ((l = {})[d] = u, a.push(l)), n[d] = u, D(n, d, s)) : (n[d] != null && (n[d] instanceof Array || (n[d] = [n[d]], D(n, d, s))), u = N(o, s), d == `#text` && !/[^\s]/.test(u) || ((l = {})[d] = u, a.push(l)), n[d][n[d].length] = u))); }n.__children = a; for (let f = R(e), c = 0; c < e.attributes.length; c++) { const h = e.attributes[c]; n.__cnt++; for (var p = h.value, g = 0, _ = A.matchers.length; g < _; g++) { const m = A.matchers[g]; m.test(h, f) && (p = m.converter(h.value)); }n[A.attributePrefix + h.name] = p; } const E = e.prefix; return E != null && E != `` && (n.__cnt++, n.__prefix = E), n[`#text`] != null && (n.__text = n[`#text`], n.__text instanceof Array && (n.__text = n.__text.join(`\n`)), A.stripWhitespaces && (n.__text = n.__text.trim()), delete n[`#text`], A.arrayAccessForm == `property` && delete n[`#text_asArray`], n.__text = (function (e, t, n) { if (A.datetimeAccessFormPaths.length > 0) { n = n.split(`.#`)[0]; return b(A.datetimeAccessFormPaths, e, t, n) ? M(e) : e; } return e; }(n.__text, d, `${t}.${d}`))), n[`#cdata-section`] != null && (n.__cdata = n[`#cdata-section`], delete n[`#cdata-section`], A.arrayAccessForm == `property` && delete n[`#cdata-section_asArray`]), n.__cnt == 0 && A.emptyNodeForm == `text` ? n = `` : n.__cnt == 1 && n.__text != null ? n = n.__text : n.__cnt != 1 || n.__cdata == null || A.keepCData ? n.__cnt > 1 && n.__text != null && A.skipEmptyTextNodesForObj && (A.stripWhitespaces && n.__text == `` || n.__text.trim() == ``) && delete n.__text : n = n.__cdata, delete n.__cnt, !A.enableToStringFunc || n.__text == null && n.__cdata == null || (n.toString = function () { return (this.__text != null ? this.__text : ``) + (this.__cdata != null ? this.__cdata : ``); }), n; } if (e.nodeType == I.TEXT_NODE || e.nodeType == I.CDATA_SECTION_NODE) return e.nodeValue; let y, v, T, S; } function s (e, t, n, r) { let i = `<${e != null && e.__prefix != null ? `${e.__prefix}:` : ``}${t}`; if (n != null) for (let a = 0; a < n.length; a++) { const o = n[a]; let s = e[o]; A.escapeMode && (s = u(s)), i += ` ${o.substr(A.attributePrefix.length)}=`, A.useDoubleQuotes ? i += `"${s}"` : i += `'${s}'`; } return i += r ? `/>` : `>`; } function l (e, t) { return `</${e.__prefix != null ? `${e.__prefix}:` : ``}${t}>`; } function d (e, t) { return A.arrayAccessForm == `property` && (n = t.toString(), r = `_asArray`, n.indexOf(r, n.length - r.length) !== -1) || t.toString().indexOf(A.attributePrefix) == 0 || t.toString().indexOf(`__`) == 0 || e[t] instanceof Function; let n, r; } function f (e) { let t = 0; if (e instanceof Object) for (const n in e)d(e, n) || t++; return t; } function c (e) { const t = []; if (e instanceof Object) for (const n in e)n.toString().indexOf(`__`) == -1 && n.toString().indexOf(A.attributePrefix) == 0 && t.push(n); return t; } function h (e) { let t; let n; let r = ``; return e instanceof Object ? r += (n = ``, (t = e).__cdata != null && (n += `<![CDATA[${t.__cdata}]]>`), t.__text != null && (A.escapeMode ? n += u(t.__text) : n += t.__text), n) : e != null && (A.escapeMode ? r += u(e) : r += e), r; } function p (e, t) { return e === `` ? t : `${e}.${t}`; } function g (e, t) { let n; let r; let i; let a = ``; if (f(e) > 0) for (const o in e) { d(e, o) || t != `` && (n = e, i = p(t, r = o), A.jsonPropertiesFilter.length != 0 && i != `` && !b(A.jsonPropertiesFilter, n, r, i)) || (i = c(r = e[o]), r == null || r == null ? a += s(r, o, i, !0) : r instanceof Object ? r instanceof Array ? a += (function (e, t, n, r) { let i = ``; if (e.length == 0)i += s(e, t, n, !0); else for (let a = 0; a < e.length; a++)i += s(e[a], t, c(e[a]), !1), i += g(e[a], p(r, t)), i += l(e[a], t); return i; }(r, o, i, t)) : r instanceof Date ? (a += s(r, o, i, !1), a += r.toISOString(), a += l(r, o)) : f(r) > 0 || r.__text != null || r.__cdata != null ? (a += s(r, o, i, !1), a += g(r, p(t, o)), a += l(r, o)) : a += s(r, o, i, !0) : (a += s(r, o, i, !1), a += h(r), a += l(r, o))); } return a += h(e); } this.parseXmlString = function (e) { let t; window.ActiveXObject || 0 in window; if (void 0 === e) return null; if (window.DOMParser) { const n = new window.DOMParser(); try { (t = n.parseFromString(e, `text/xml`)).getElementsByTagNameNS(`*`, `parsererror`).length > 0 && (t = null); } catch (e) { t = null; } } else e.indexOf(`<?`) == 0 && (e = e.substr(e.indexOf(`?>`) + 2)), (t = new ActiveXObject(`Microsoft.XMLDOM`)).async = `false`, t.loadXML(e); return t; }, this.asArray = function (e) { return void 0 === e || e == null ? [] : e instanceof Array ? e : [e]; }, this.toXmlDateTime = function (e) { return e instanceof Date ? e.toISOString() : typeof e === `number` ? new Date(e).toISOString() : null; }, this.asDateTime = function (e) { return typeof e === `string` ? M(e) : e; }, this.xml2json = function (e) { return N(e); }, this.xml_str2json = function (e) { e = this.parseXmlString(e); return e != null ? this.xml2json(e) : null; }, this.json2xml_str = function (e) { return g(e, ``); }, this.json2xml = function (e) { e = this.json2xml_str(e); return this.parseXmlString(e); }, this.getVersion = function () { return `1.2.0`; }; }, t.exports = n.default; }, {}], 4: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = e(5); const a = r(e(125)); const o = r(e(162)); const s = r(e(102)); var e = r(e(45)); dashjs.Protection = o.default, dashjs.MetricsReporting = a.default, dashjs.MediaPlayerFactory = s.default, dashjs.Debug = e.default, n.default = dashjs, n.MediaPlayer = i.MediaPlayer, n.Protection = o.default, n.MetricsReporting = a.default, n.MediaPlayerFactory = s.default, n.Debug = e.default; }, { 102: 102, 125: 125, 162: 162, 45: 45, 5: 5 }], 5: [function (s, e, u) { (function (e) { "use strict"; function t (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(u, `__esModule`, { value: !0 }); const n = t(s(100)); const r = t(s(47)); const i = t(s(45)); const a = s(50); const o = typeof window !== `undefined` && window || e; var e = o.dashjs; (e = e || (o.dashjs = {})).MediaPlayer = n.default, e.FactoryMaker = r.default, e.Debug = i.default, e.Version = (0, a.getVersionString)(), u.default = e, u.MediaPlayer = n.default, u.FactoryMaker = r.default, u.Debug = i.default; }).call(this, typeof global !== `undefined` ? global : typeof self !== `undefined` ? self : typeof window !== `undefined` ? window : {}); }, { 100: 100, 45: 45, 47: 47, 50: 50 }], 6: [function (e, t, n) { "use strict"; n.byteLength = function (e) { var t = d(e); var e = t[0]; var t = t[1]; return 3 * (e + t) / 4 - t; }, n.toByteArray = function (e) { for (var t, n = d(e), r = n[0], n = n[1], i = new l(function (e, t) { return 3 * (e + t) / 4 - t; }(r, n)), a = 0, o = n > 0 ? r - 4 : r, s = 0; s < o; s += 4)t = u[e.charCodeAt(s)] << 18 | u[e.charCodeAt(s + 1)] << 12 | u[e.charCodeAt(s + 2)] << 6 | u[e.charCodeAt(s + 3)], i[a++] = t >> 16 & 255, i[a++] = t >> 8 & 255, i[a++] = 255 & t; n === 2 && (t = u[e.charCodeAt(s)] << 2 | u[e.charCodeAt(s + 1)] >> 4, i[a++] = 255 & t); n === 1 && (t = u[e.charCodeAt(s)] << 10 | u[e.charCodeAt(s + 1)] << 4 | u[e.charCodeAt(s + 2)] >> 2, i[a++] = t >> 8 & 255, i[a++] = 255 & t); return i; }, n.fromByteArray = function (e) { for (var t, n = e.length, r = n % 3, i = [], a = 0, o = n - r; a < o; a += 16383)i.push(function (e, t, n) { for (var r, i = [], a = t; a < n; a += 3)r = (e[a] << 16 & 16711680) + (e[a + 1] << 8 & 65280) + (255 & e[a + 2]), i.push(function (e) { return s[e >> 18 & 63] + s[e >> 12 & 63] + s[e >> 6 & 63] + s[63 & e]; }(r)); return i.join(``); }(e, a, o < a + 16383 ? o : a + 16383)); r == 1 ? (t = e[n - 1], i.push(`${s[t >> 2] + s[t << 4 & 63]}==`)) : r == 2 && (t = (e[n - 2] << 8) + e[n - 1], i.push(`${s[t >> 10] + s[t >> 4 & 63] + s[t << 2 & 63]}=`)); return i.join(``); }; for (var s = [], u = [], l = typeof Uint8Array !== `undefined` ? Uint8Array : Array, r = `ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`, i = 0, a = r.length; i < a; ++i)s[i] = r[i], u[r.charCodeAt(i)] = i; function d (e) { const t = e.length; if (t % 4 > 0) throw new Error(`Invalid string. Length must be a multiple of 4`); e = e.indexOf(`=`); return e === -1 && (e = t), [e, e === t ? 0 : 4 - e % 4]; }u[`-`.charCodeAt(0)] = 62, u[`_`.charCodeAt(0)] = 63; }, {}], 7: [function (e, t, n) {}, {}], 8: [function (e, t, n) { "use strict"; const s = e(6); const a = e(13); n.Buffer = f, n.SlowBuffer = function (e) { +e != e && (e = 0); return f.alloc(+e); }, n.INSPECT_MAX_BYTES = 50; const r = 2147483647; function i (e) { if (r < e) throw new RangeError(`The value "${e}" is invalid for option "size"`); e = new Uint8Array(e); return e.__proto__ = f.prototype, e; } function f (e, t, n) { if (typeof e !== `number`) return o(e, t, n); if (typeof t === `string`) throw new TypeError(`The "string" argument must be of type string. Received type number`); return l(e); } function o (e, t, n) { if (typeof e === `string`) return (function (e, t) { typeof t === `string` && t !== `` || (t = `utf8`); if (!f.isEncoding(t)) throw new TypeError(`Unknown encoding: ${t}`); const n = 0 | h(e, t); let r = i(n); var t = r.write(e, t); t !== n && (r = r.slice(0, t)); return r; }(e, t)); if (ArrayBuffer.isView(e)) return d(e); if (e == null) throw TypeError(`The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type ${typeof e}`); if (w(e, ArrayBuffer) || e && w(e.buffer, ArrayBuffer)) return (function (e, t, n) { if (t < 0 || e.byteLength < t) throw new RangeError(`"offset" is outside of buffer bounds`); if (e.byteLength < t + (n || 0)) throw new RangeError(`"length" is outside of buffer bounds`); n = void 0 === t && void 0 === n ? new Uint8Array(e) : void 0 === n ? new Uint8Array(e, t) : new Uint8Array(e, t, n); return n.__proto__ = f.prototype, n; }(e, t, n)); if (typeof e === `number`) throw new TypeError(`The "value" argument must not be of type number. Received type number`); let r = e.valueOf && e.valueOf(); if (r != null && r !== e) return f.from(r, t, n); r = (function (e) { if (f.isBuffer(e)) { const t = 0 | c(e.length); const n = i(t); return n.length === 0 ? n : (e.copy(n, 0, 0, t), n); } if (void 0 !== e.length) return typeof e.length !== `number` || O(e.length) ? i(0) : d(e); if (e.type === `Buffer` && Array.isArray(e.data)) return d(e.data); }(e)); if (r) return r; if (typeof Symbol !== `undefined` && Symbol.toPrimitive != null && typeof e[Symbol.toPrimitive] === `function`) return f.from(e[Symbol.toPrimitive](`string`), t, n); throw new TypeError(`The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type ${typeof e}`); } function u (e) { if (typeof e !== `number`) throw new TypeError(`"size" argument must be of type number`); if (e < 0) throw new RangeError(`The value "${e}" is invalid for option "size"`); } function l (e) { return u(e), i(e < 0 ? 0 : 0 | c(e)); } function d (e) { for (var t = e.length < 0 ? 0 : 0 | c(e.length), n = i(t), r = 0; r < t; r += 1)n[r] = 255 & e[r]; return n; } function c (e) { if (r <= e) throw new RangeError(`Attempt to allocate Buffer larger than maximum size: 0x${r.toString(16)} bytes`); return 0 | e; } function h (e, t) { if (f.isBuffer(e)) return e.length; if (ArrayBuffer.isView(e) || w(e, ArrayBuffer)) return e.byteLength; if (typeof e !== `string`) throw new TypeError(`The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type ${typeof e}`); const n = e.length; const r = arguments.length > 2 && !0 === arguments[2]; if (!r && n === 0) return 0; for (let i = !1; ;) switch (t) { case `ascii`:case `latin1`:case `binary`:return n; case `utf8`:case `utf-8`:return M(e).length; case `ucs2`:case `ucs-2`:case `utf16le`:case `utf-16le`:return 2 * n; case `hex`:return n >>> 1; case `base64`:return N(e).length; default:if (i) return r ? -1 : M(e).length; t = (`${t}`).toLowerCase(), i = !0; } } function p (e, t, n) { let r; let i; let a; let o = !1; if ((void 0 === t || t < 0) && (t = 0), t > this.length) return ``; if ((void 0 === n || n > this.length) && (n = this.length), n <= 0) return ``; if ((n >>>= 0) <= (t >>>= 0)) return ``; for (e = e || `utf8`; ;) switch (e) { case `hex`:return (function (e, t, n) { const r = e.length; (!t || t < 0) && (t = 0); (!n || n < 0 || r < n) && (n = r); for (var i = ``, a = t; a < n; ++a)i += (function (e) { return e < 16 ? `0${e.toString(16)}` : e.toString(16); }(e[a])); return i; }(this, t, n)); case `utf8`:case `utf-8`:return v(this, t, n); case `ascii`:return (function (e, t, n) { let r = ``; n = Math.min(e.length, n); for (let i = t; i < n; ++i)r += String.fromCharCode(127 & e[i]); return r; }(this, t, n)); case `latin1`:case `binary`:return (function (e, t, n) { let r = ``; n = Math.min(e.length, n); for (let i = t; i < n; ++i)r += String.fromCharCode(e[i]); return r; }(this, t, n)); case `base64`:return r = this, a = n, (i = t) === 0 && a === r.length ? s.fromByteArray(r) : s.fromByteArray(r.slice(i, a)); case `ucs2`:case `ucs-2`:case `utf16le`:case `utf-16le`:return (function (e, t, n) { for (var r = e.slice(t, n), i = ``, a = 0; a < r.length; a += 2)i += String.fromCharCode(r[a] + 256 * r[a + 1]); return i; }(this, t, n)); default:if (o) throw new TypeError(`Unknown encoding: ${e}`); e = (`${e}`).toLowerCase(), o = !0; } } function g (e, t, n) { const r = e[t]; e[t] = e[n], e[n] = r; } function _ (e, t, n, r, i) { if (e.length === 0) return -1; if (typeof n === `string` ? (r = n, n = 0) : n > 2147483647 ? n = 2147483647 : n < -2147483648 && (n = -2147483648), O(n = +n) && (n = i ? 0 : e.length - 1), n < 0 && (n = e.length + n), n >= e.length) { if (i) return -1; n = e.length - 1; } else if (n < 0) { if (!i) return -1; n = 0; } if (typeof t === `string` && (t = f.from(t, r)), f.isBuffer(t)) return t.length === 0 ? -1 : m(e, t, n, r, i); if (typeof t === `number`) return t &= 255, typeof Uint8Array.prototype.indexOf === `function` ? (i ? Uint8Array.prototype.indexOf : Uint8Array.prototype.lastIndexOf).call(e, t, n) : m(e, [t], n, r, i); throw new TypeError(`val must be string, number or Buffer`); } function m (e, t, n, r, i) { let a = 1; let o = e.length; let s = t.length; if (void 0 !== r && ((r = String(r).toLowerCase()) === `ucs2` || r === `ucs-2` || r === `utf16le` || r === `utf-16le`)) { if (e.length < 2 || t.length < 2) return -1; o /= a = 2, s /= 2, n /= 2; } function u (e, t) { return a === 1 ? e[t] : e.readUInt16BE(t * a); } if (i) for (var l = -1, d = n; d < o; d++) if (u(e, d) === u(t, l === -1 ? 0 : d - l)) { if (l === -1 && (l = d), d - l + 1 === s) return l * a; } else l !== -1 && (d -= d - l), l = -1; else for (o < n + s && (n = o - s), d = n; d >= 0; d--) { for (var f = !0, c = 0; c < s; c++) if (u(e, d + c) !== u(t, c)) { f = !1; break; } if (f) return d; } return -1; } function E (e, t, n, r) { return C((function (e) { for (var t = [], n = 0; n < e.length; ++n)t.push(255 & e.charCodeAt(n)); return t; }(t)), e, n, r); } function y (e, t, n, r) { return C((function (e, t) { for (var n, r, i = [], a = 0; a < e.length && !((t -= 2) < 0); ++a)r = e.charCodeAt(a), n = r >> 8, r = r % 256, i.push(r), i.push(n); return i; }(t, e.length - n)), e, n, r); } function v (e, t, n) { n = Math.min(e.length, n); for (var r = [], i = t; i < n;) { var a; var o; var s; var u; const l = e[i]; let d = null; let f = l > 239 ? 4 : l > 223 ? 3 : l > 191 ? 2 : 1; if (i + f <= n) switch (f) { case 1:l < 128 && (d = l); break; case 2:(192 & (a = e[i + 1])) == 128 && (u = (31 & l) << 6 | 63 & a) > 127 && (d = u); break; case 3:a = e[i + 1], o = e[i + 2], (192 & a) == 128 && (192 & o) == 128 && (u = (15 & l) << 12 | (63 & a) << 6 | 63 & o) > 2047 && (u < 55296 || u > 57343) && (d = u); break; case 4:a = e[i + 1], o = e[i + 2], s = e[i + 3], (192 & a) == 128 && (192 & o) == 128 && (192 & s) == 128 && (u = (15 & l) << 18 | (63 & a) << 12 | (63 & o) << 6 | 63 & s) > 65535 && u < 1114112 && (d = u); }d === null ? (d = 65533, f = 1) : d > 65535 && (d -= 65536, r.push(d >>> 10 & 1023 | 55296), d = 56320 | 1023 & d), r.push(d), i += f; } return (function (e) { const t = e.length; if (t <= T) return String.fromCharCode.apply(String, e); let n = ``; let r = 0; for (;r < t;)n += String.fromCharCode.apply(String, e.slice(r, r += T)); return n; }(r)); }n.kMaxLength = r, (f.TYPED_ARRAY_SUPPORT = (function () { try { const e = new Uint8Array(1); return e.__proto__ = { __proto__: Uint8Array.prototype, foo: function () { return 42; } }, e.foo() === 42; } catch (e) { return !1; } }())) || typeof console === `undefined` || typeof console.error !== `function` || console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."), Object.defineProperty(f.prototype, `parent`, { enumerable: !0, get: function () { if (f.isBuffer(this)) return this.buffer; } }), Object.defineProperty(f.prototype, `offset`, { enumerable: !0, get: function () { if (f.isBuffer(this)) return this.byteOffset; } }), typeof Symbol !== `undefined` && Symbol.species != null && f[Symbol.species] === f && Object.defineProperty(f, Symbol.species, { value: null, configurable: !0, enumerable: !1, writable: !1 }), f.poolSize = 8192, f.from = o, f.prototype.__proto__ = Uint8Array.prototype, f.__proto__ = Uint8Array, f.alloc = function (e, t, n) { return t = t, n = n, u(e = e), !(e <= 0) && void 0 !== t ? typeof n === `string` ? i(e).fill(t, n) : i(e).fill(t) : i(e); }, f.allocUnsafe = l, f.allocUnsafeSlow = l, f.isBuffer = function (e) { return e != null && !0 === e._isBuffer && e !== f.prototype; }, f.compare = function (e, t) { if (w(e, Uint8Array) && (e = f.from(e, e.offset, e.byteLength)), w(t, Uint8Array) && (t = f.from(t, t.offset, t.byteLength)), !f.isBuffer(e) || !f.isBuffer(t)) throw new TypeError(`The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array`); if (e === t) return 0; for (var n = e.length, r = t.length, i = 0, a = Math.min(n, r); i < a; ++i) if (e[i] !== t[i]) { n = e[i], r = t[i]; break; } return n < r ? -1 : r < n ? 1 : 0; }, f.isEncoding = function (e) { switch (String(e).toLowerCase()) { case `hex`:case `utf8`:case `utf-8`:case `ascii`:case `latin1`:case `binary`:case `base64`:case `ucs2`:case `ucs-2`:case `utf16le`:case `utf-16le`:return !0; default:return !1; } }, f.concat = function (e, t) { if (!Array.isArray(e)) throw new TypeError(`"list" argument must be an Array of Buffers`); if (e.length === 0) return f.alloc(0); if (void 0 === t) for (i = t = 0; i < e.length; ++i)t += e[i].length; for (var n = f.allocUnsafe(t), r = 0, i = 0; i < e.length; ++i) { let a = e[i]; if (w(a, Uint8Array) && (a = f.from(a)), !f.isBuffer(a)) throw new TypeError(`"list" argument must be an Array of Buffers`); a.copy(n, r), r += a.length; } return n; }, f.byteLength = h, f.prototype._isBuffer = !0, f.prototype.swap16 = function () { const e = this.length; if (e % 2 != 0) throw new RangeError(`Buffer size must be a multiple of 16-bits`); for (let t = 0; t < e; t += 2)g(this, t, t + 1); return this; }, f.prototype.swap32 = function () { const e = this.length; if (e % 4 != 0) throw new RangeError(`Buffer size must be a multiple of 32-bits`); for (let t = 0; t < e; t += 4)g(this, t, t + 3), g(this, t + 1, t + 2); return this; }, f.prototype.swap64 = function () { const e = this.length; if (e % 8 != 0) throw new RangeError(`Buffer size must be a multiple of 64-bits`); for (let t = 0; t < e; t += 8)g(this, t, t + 7), g(this, t + 1, t + 6), g(this, t + 2, t + 5), g(this, t + 3, t + 4); return this; }, f.prototype.toLocaleString = f.prototype.toString = function () { const e = this.length; return e === 0 ? `` : arguments.length === 0 ? v(this, 0, e) : p.apply(this, arguments); }, f.prototype.equals = function (e) { if (!f.isBuffer(e)) throw new TypeError(`Argument must be a Buffer`); return this === e || f.compare(this, e) === 0; }, f.prototype.inspect = function () { var e = ``; const t = n.INSPECT_MAX_BYTES; var e = this.toString(`hex`, 0, t).replace(/(.{2})/g, `$1 `).trim(); return this.length > t && (e += ` ... `), `<Buffer ${e}>`; }, f.prototype.compare = function (e, t, n, r, i) { if (w(e, Uint8Array) && (e = f.from(e, e.offset, e.byteLength)), !f.isBuffer(e)) throw new TypeError(`The "target" argument must be one of type Buffer or Uint8Array. Received type ${typeof e}`); if (void 0 === t && (t = 0), void 0 === n && (n = e ? e.length : 0), void 0 === r && (r = 0), void 0 === i && (i = this.length), t < 0 || n > e.length || r < 0 || i > this.length) throw new RangeError(`out of range index`); if (i <= r && n <= t) return 0; if (i <= r) return -1; if (n <= t) return 1; if (this === e) return 0; for (var a = (i >>>= 0) - (r >>>= 0), o = (n >>>= 0) - (t >>>= 0), s = Math.min(a, o), u = this.slice(r, i), l = e.slice(t, n), d = 0; d < s; ++d) if (u[d] !== l[d]) { a = u[d], o = l[d]; break; } return a < o ? -1 : o < a ? 1 : 0; }, f.prototype.includes = function (e, t, n) { return this.indexOf(e, t, n) !== -1; }, f.prototype.indexOf = function (e, t, n) { return _(this, e, t, n, !0); }, f.prototype.lastIndexOf = function (e, t, n) { return _(this, e, t, n, !1); }, f.prototype.write = function (e, t, n, r) { if (void 0 === t)r = `utf8`, n = this.length, t = 0; else if (void 0 === n && typeof t === `string`)r = t, n = this.length, t = 0; else { if (!isFinite(t)) throw new Error(`Buffer.write(string, encoding, offset[, length]) is no longer supported`); t >>>= 0, isFinite(n) ? (n >>>= 0, void 0 === r && (r = `utf8`)) : (r = n, n = void 0); } const i = this.length - t; if ((void 0 === n || i < n) && (n = i), e.length > 0 && (n < 0 || t < 0) || t > this.length) throw new RangeError(`Attempt to write outside buffer bounds`); r = r || `utf8`; for (var a, o, s, u = !1; ;) switch (r) { case `hex`:return (function (e, t, n, r) { n = Number(n) || 0; let i = e.length - n; (!r || i < (r = Number(r))) && (r = i), (i = t.length) / 2 < r && (r = i / 2); for (var a = 0; a < r; ++a) { const o = parseInt(t.substr(2 * a, 2), 16); if (O(o)) return a; e[n + a] = o; } return a; }(this, e, t, n)); case `utf8`:case `utf-8`:return o = t, s = n, C(M(e, (a = this).length - o), a, o, s); case `ascii`:return E(this, e, t, n); case `latin1`:case `binary`:return E(this, e, t, n); case `base64`:return a = this, o = t, s = n, C(N(e), a, o, s); case `ucs2`:case `ucs-2`:case `utf16le`:case `utf-16le`:return y(this, e, t, n); default:if (u) throw new TypeError(`Unknown encoding: ${r}`); r = (`${r}`).toLowerCase(), u = !0; } }, f.prototype.toJSON = function () { return { type: `Buffer`, data: Array.prototype.slice.call(this._arr || this, 0) }; }; var T = 4096; function S (e, t, n) { if (e % 1 != 0 || e < 0) throw new RangeError(`offset is not uint`); if (n < e + t) throw new RangeError(`Trying to access beyond buffer length`); } function A (e, t, n, r, i, a) { if (!f.isBuffer(e)) throw new TypeError(`"buffer" argument must be a Buffer instance`); if (i < t || t < a) throw new RangeError(`"value" argument is out of bounds`); if (n + r > e.length) throw new RangeError(`Index out of range`); } function I (e, t, n, r) { if (n + r > e.length) throw new RangeError(`Index out of range`); if (n < 0) throw new RangeError(`Index out of range`); } function R (e, t, n, r, i) { return t = +t, n >>>= 0, i || I(e, 0, n, 4), a.write(e, t, n, r, 23, 4), n + 4; } function b (e, t, n, r, i) { return t = +t, n >>>= 0, i || I(e, 0, n, 8), a.write(e, t, n, r, 52, 8), n + 8; }f.prototype.slice = function (e, t) { const n = this.length; (e = ~~e) < 0 ? (e += n) < 0 && (e = 0) : n < e && (e = n), (t = void 0 === t ? n : ~~t) < 0 ? (t += n) < 0 && (t = 0) : n < t && (t = n), t < e && (t = e); t = this.subarray(e, t); return t.__proto__ = f.prototype, t; }, f.prototype.readUIntLE = function (e, t, n) { e >>>= 0, t >>>= 0, n || S(e, t, this.length); for (var r = this[e], i = 1, a = 0; ++a < t && (i *= 256);)r += this[e + a] * i; return r; }, f.prototype.readUIntBE = function (e, t, n) { e >>>= 0, t >>>= 0, n || S(e, t, this.length); for (var r = this[e + --t], i = 1; t > 0 && (i *= 256);)r += this[e + --t] * i; return r; }, f.prototype.readUInt8 = function (e, t) { return e >>>= 0, t || S(e, 1, this.length), this[e]; }, f.prototype.readUInt16LE = function (e, t) { return e >>>= 0, t || S(e, 2, this.length), this[e] | this[e + 1] << 8; }, f.prototype.readUInt16BE = function (e, t) { return e >>>= 0, t || S(e, 2, this.length), this[e] << 8 | this[e + 1]; }, f.prototype.readUInt32LE = function (e, t) { return e >>>= 0, t || S(e, 4, this.length), (this[e] | this[e + 1] << 8 | this[e + 2] << 16) + 16777216 * this[e + 3]; }, f.prototype.readUInt32BE = function (e, t) { return e >>>= 0, t || S(e, 4, this.length), 16777216 * this[e] + (this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]); }, f.prototype.readIntLE = function (e, t, n) { e >>>= 0, t >>>= 0, n || S(e, t, this.length); for (var r = this[e], i = 1, a = 0; ++a < t && (i *= 256);)r += this[e + a] * i; return (i *= 128) <= r && (r -= Math.pow(2, 8 * t)), r; }, f.prototype.readIntBE = function (e, t, n) { e >>>= 0, t >>>= 0, n || S(e, t, this.length); for (var r = t, i = 1, a = this[e + --r]; r > 0 && (i *= 256);)a += this[e + --r] * i; return (i *= 128) <= a && (a -= Math.pow(2, 8 * t)), a; }, f.prototype.readInt8 = function (e, t) { return e >>>= 0, t || S(e, 1, this.length), 128 & this[e] ? -1 * (255 - this[e] + 1) : this[e]; }, f.prototype.readInt16LE = function (e, t) { e >>>= 0, t || S(e, 2, this.length); e = this[e] | this[e + 1] << 8; return 32768 & e ? 4294901760 | e : e; }, f.prototype.readInt16BE = function (e, t) { e >>>= 0, t || S(e, 2, this.length); e = this[e + 1] | this[e] << 8; return 32768 & e ? 4294901760 | e : e; }, f.prototype.readInt32LE = function (e, t) { return e >>>= 0, t || S(e, 4, this.length), this[e] | this[e + 1] << 8 | this[e + 2] << 16 | this[e + 3] << 24; }, f.prototype.readInt32BE = function (e, t) { return e >>>= 0, t || S(e, 4, this.length), this[e] << 24 | this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]; }, f.prototype.readFloatLE = function (e, t) { return e >>>= 0, t || S(e, 4, this.length), a.read(this, e, !0, 23, 4); }, f.prototype.readFloatBE = function (e, t) { return e >>>= 0, t || S(e, 4, this.length), a.read(this, e, !1, 23, 4); }, f.prototype.readDoubleLE = function (e, t) { return e >>>= 0, t || S(e, 8, this.length), a.read(this, e, !0, 52, 8); }, f.prototype.readDoubleBE = function (e, t) { return e >>>= 0, t || S(e, 8, this.length), a.read(this, e, !1, 52, 8); }, f.prototype.writeUIntLE = function (e, t, n, r) { e = +e, t >>>= 0, n >>>= 0, r || A(this, e, t, n, Math.pow(2, 8 * n) - 1, 0); let i = 1; let a = 0; for (this[t] = 255 & e; ++a < n && (i *= 256);) this[t + a] = e / i & 255; return t + n; }, f.prototype.writeUIntBE = function (e, t, n, r) { e = +e, t >>>= 0, n >>>= 0, r || A(this, e, t, n, Math.pow(2, 8 * n) - 1, 0); let i = n - 1; let a = 1; for (this[t + i] = 255 & e; --i >= 0 && (a *= 256);) this[t + i] = e / a & 255; return t + n; }, f.prototype.writeUInt8 = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 1, 255, 0), this[t] = 255 & e, t + 1; }, f.prototype.writeUInt16LE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 2, 65535, 0), this[t] = 255 & e, this[t + 1] = e >>> 8, t + 2; }, f.prototype.writeUInt16BE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 2, 65535, 0), this[t] = e >>> 8, this[t + 1] = 255 & e, t + 2; }, f.prototype.writeUInt32LE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 4, 4294967295, 0), this[t + 3] = e >>> 24, this[t + 2] = e >>> 16, this[t + 1] = e >>> 8, this[t] = 255 & e, t + 4; }, f.prototype.writeUInt32BE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 4, 4294967295, 0), this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e, t + 4; }, f.prototype.writeIntLE = function (e, t, n, r) { e = +e, t >>>= 0, r || A(this, e, t, n, (r = Math.pow(2, 8 * n - 1)) - 1, -r); let i = 0; let a = 1; let o = 0; for (this[t] = 255 & e; ++i < n && (a *= 256);)e < 0 && o === 0 && this[t + i - 1] !== 0 && (o = 1), this[t + i] = (e / a >> 0) - o & 255; return t + n; }, f.prototype.writeIntBE = function (e, t, n, r) { e = +e, t >>>= 0, r || A(this, e, t, n, (r = Math.pow(2, 8 * n - 1)) - 1, -r); let i = n - 1; let a = 1; let o = 0; for (this[t + i] = 255 & e; --i >= 0 && (a *= 256);)e < 0 && o === 0 && this[t + i + 1] !== 0 && (o = 1), this[t + i] = (e / a >> 0) - o & 255; return t + n; }, f.prototype.writeInt8 = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 1, 127, -128), e < 0 && (e = 255 + e + 1), this[t] = 255 & e, t + 1; }, f.prototype.writeInt16LE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 2, 32767, -32768), this[t] = 255 & e, this[t + 1] = e >>> 8, t + 2; }, f.prototype.writeInt16BE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 2, 32767, -32768), this[t] = e >>> 8, this[t + 1] = 255 & e, t + 2; }, f.prototype.writeInt32LE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 4, 2147483647, -2147483648), this[t] = 255 & e, this[t + 1] = e >>> 8, this[t + 2] = e >>> 16, this[t + 3] = e >>> 24, t + 4; }, f.prototype.writeInt32BE = function (e, t, n) { return e = +e, t >>>= 0, n || A(this, e, t, 4, 2147483647, -2147483648), e < 0 && (e = 4294967295 + e + 1), this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e, t + 4; }, f.prototype.writeFloatLE = function (e, t, n) { return R(this, e, t, !0, n); }, f.prototype.writeFloatBE = function (e, t, n) { return R(this, e, t, !1, n); }, f.prototype.writeDoubleLE = function (e, t, n) { return b(this, e, t, !0, n); }, f.prototype.writeDoubleBE = function (e, t, n) { return b(this, e, t, !1, n); }, f.prototype.copy = function (e, t, n, r) { if (!f.isBuffer(e)) throw new TypeError(`argument should be a Buffer`); if (n = n || 0, r || r === 0 || (r = this.length), t >= e.length && (t = e.length), t = t || 0, r > 0 && r < n && (r = n), r === n) return 0; if (e.length === 0 || this.length === 0) return 0; if (t < 0) throw new RangeError(`targetStart out of bounds`); if (n < 0 || n >= this.length) throw new RangeError(`Index out of range`); if (r < 0) throw new RangeError(`sourceEnd out of bounds`); r > this.length && (r = this.length), e.length - t < r - n && (r = e.length - t + n); const i = r - n; if (this === e && typeof Uint8Array.prototype.copyWithin === `function`) this.copyWithin(t, n, r); else if (this === e && n < t && t < r) for (let a = i - 1; a >= 0; --a)e[a + t] = this[a + n]; else Uint8Array.prototype.set.call(e, this.subarray(n, r), t); return i; }, f.prototype.fill = function (e, t, n, r) { if (typeof e === `string`) { if (typeof t === `string` ? (r = t, t = 0, n = this.length) : typeof n === `string` && (r = n, n = this.length), void 0 !== r && typeof r !== `string`) throw new TypeError(`encoding must be a string`); if (typeof r === `string` && !f.isEncoding(r)) throw new TypeError(`Unknown encoding: ${r}`); let i; e.length === 1 && (i = e.charCodeAt(0), (r === `utf8` && i < 128 || r === `latin1`) && (e = i)); } else typeof e === `number` && (e &= 255); if (t < 0 || this.length < t || this.length < n) throw new RangeError(`Out of range index`); if (n <= t) return this; let a; if (t >>>= 0, n = void 0 === n ? this.length : n >>> 0, typeof (e = e || 0) === `number`) for (a = t; a < n; ++a) this[a] = e; else { const o = f.isBuffer(e) ? e : f.from(e, r); const s = o.length; if (s === 0) throw new TypeError(`The value "${e}" is invalid for argument "value"`); for (a = 0; a < n - t; ++a) this[a + t] = o[a % s]; } return this; }; const D = /[^+/0-9A-Za-z-_]/g; function M (e, t) { let n; t = t || 1 / 0; for (var r = e.length, i = null, a = [], o = 0; o < r; ++o) { if ((n = e.charCodeAt(o)) > 55295 && n < 57344) { if (!i) { if (n > 56319) { (t -= 3) > -1 && a.push(239, 191, 189); continue; } if (o + 1 === r) { (t -= 3) > -1 && a.push(239, 191, 189); continue; }i = n; continue; } if (n < 56320) { (t -= 3) > -1 && a.push(239, 191, 189), i = n; continue; }n = 65536 + (i - 55296 << 10 | n - 56320); } else i && (t -= 3) > -1 && a.push(239, 191, 189); if (i = null, n < 128) { if (--t < 0) break; a.push(n); } else if (n < 2048) { if ((t -= 2) < 0) break; a.push(n >> 6 | 192, 63 & n | 128); } else if (n < 65536) { if ((t -= 3) < 0) break; a.push(n >> 12 | 224, n >> 6 & 63 | 128, 63 & n | 128); } else { if (!(n < 1114112)) throw new Error(`Invalid code point`); if ((t -= 4) < 0) break; a.push(n >> 18 | 240, n >> 12 & 63 | 128, n >> 6 & 63 | 128, 63 & n | 128); } } return a; } function N (e) { return s.toByteArray(function (e) { if ((e = (e = e.split(`=`)[0]).trim().replace(D, ``)).length < 2) return ``; for (;e.length % 4 != 0;)e += `=`; return e; }(e)); } function C (e, t, n, r) { for (var i = 0; i < r && !(i + n >= t.length || i >= e.length); ++i)t[i + n] = e[i]; return i; } function w (e, t) { return e instanceof t || e != null && e.constructor != null && e.constructor.name != null && e.constructor.name === t.name; } function O (e) { return e != e; } }, { 13: 13, 6: 6 }], 9: [function (e, t, n) { var i = { parseBuffer: function (e) { return new a(e).parse(); }, addBoxProcessor: function (e, t) { typeof e === `string` && typeof t === `function` && (r.prototype._boxProcessors[e] = t); }, createFile: function () { return new a(); }, createBox: function (e, t, n) { e = r.create(e); return t && t.append(e, n), e; }, createFullBox: function (e, t, n) { n = i.createBox(e, t, n); return n.version = 0, n.flags = 0, n; }, Utils: {} }; i.Utils.dataViewToString = function (e, t) { t = t || `utf-8`; if (typeof TextDecoder !== `undefined`) return new TextDecoder(t).decode(e); const n = []; let r = 0; if (t === `utf-8`) for (;r < e.byteLength;) { let i = e.getUint8(r++); i < 128 || (i < 224 ? i = (31 & i) << 6 : (i < 240 ? i = (15 & i) << 12 : (i = (7 & i) << 18, i |= (63 & e.getUint8(r++)) << 12), i |= (63 & e.getUint8(r++)) << 6), i |= 63 & e.getUint8(r++)), n.push(String.fromCharCode(i)); } else for (;r < e.byteLength;)n.push(String.fromCharCode(e.getUint8(r++))); return n.join(``); }, i.Utils.utf8ToByteArray = function (e) { let t, n; if (typeof TextEncoder !== `undefined`)t = (new TextEncoder()).encode(e); else for (t = [], n = 0; n < e.length; ++n) { const r = e.charCodeAt(n); r < 128 ? t.push(r) : (r < 2048 ? t.push(192 | r >> 6) : (r < 65536 ? t.push(224 | r >> 12) : (t.push(240 | r >> 18), t.push(128 | 63 & r >> 12)), t.push(128 | 63 & r >> 6)), t.push(128 | 63 & r)); } return t; }, i.Utils.appendBox = function (e, t, n) { if (t._offset = e._cursor.offset, t._root = e._root ? e._root : e, t._raw = e._raw, t._parent = e, n !== -1) if (n != null) { let r; let i = -1; if (typeof n === `number`)i = n; else { if (typeof n === `string`)r = n; else { if (typeof n !== `object` || !n.type) return void e.boxes.push(t); r = n.type; } for (let a = 0; a < e.boxes.length; a++) if (r === e.boxes[a].type) { i = a + 1; break; } }e.boxes.splice(i, 0, t); } else e.boxes.push(t); }, void 0 !== n && (n.parseBuffer = i.parseBuffer, n.addBoxProcessor = i.addBoxProcessor, n.createFile = i.createFile, n.createBox = i.createBox, n.createFullBox = i.createFullBox, n.Utils = i.Utils), i.Cursor = function (e) { this.offset = void 0 === e ? 0 : e; }; var a = function (e) { this._cursor = new i.Cursor(), this.boxes = [], e && (this._raw = new DataView(e)); }; a.prototype.fetch = function (e) { e = this.fetchAll(e, !0); return e.length ? e[0] : null; }, a.prototype.fetchAll = function (e, t) { const n = []; return a._sweep.call(this, e, n, t), n; }, a.prototype.parse = function () { for (this._cursor.offset = 0, this.boxes = []; this._cursor.offset < this._raw.byteLength;) { const e = r.parse(this); if (void 0 === e.type) break; this.boxes.push(e); } return this; }, a._sweep = function (e, t, n) { for (const r in this.type && this.type == e && t.push(this), this.boxes) { if (t.length && n) return; a._sweep.call(this.boxes[r], e, t, n); } }, a.prototype.write = function () { for (var e = 0, t = 0; t < this.boxes.length; t++)e += this.boxes[t].getLength(!1); const n = new Uint8Array(e); for (this._rawo = new DataView(n.buffer), this.bytes = n, t = this._cursor.offset = 0; t < this.boxes.length; t++) this.boxes[t].write(); return n.buffer; }, a.prototype.append = function (e, t) { i.Utils.appendBox(this, e, t); }; var r = function () { this._cursor = new i.Cursor(); }; r.parse = function (e) { const t = new r(); return t._offset = e._cursor.offset, t._root = e._root ? e._root : e, t._raw = e._raw, t._parent = e, t._parseBox(), e._cursor.offset = t._raw.byteOffset + t._raw.byteLength, t; }, r.create = function (e) { const t = new r(); return t.type = e, t.boxes = [], t; }, r.prototype._boxContainers = [`dinf`, `edts`, `mdia`, `meco`, `mfra`, `minf`, `moof`, `moov`, `mvex`, `stbl`, `strk`, `traf`, `trak`, `tref`, `udta`, `vttc`, `sinf`, `schi`, `encv`, `enca`], r.prototype._boxProcessors = {}, r.prototype._procField = function (e, t, n) { this._parsing ? this[e] = this._readField(t, n) : this._writeField(t, n, this[e]); }, r.prototype._procFieldArray = function (e, t, n, r) { let i; if (this._parsing) for (this[e] = [], i = 0; i < t; i++) this[e][i] = this._readField(n, r); else for (i = 0; i < this[e].length; i++) this._writeField(n, r, this[e][i]); }, r.prototype._procFullBox = function () { this._procField(`version`, `uint`, 8), this._procField(`flags`, `uint`, 24); }, r.prototype._procEntries = function (e, t, n) { let r; if (this._parsing) for (this[e] = [], r = 0; r < t; r++) this[e].push({}), n.call(this, this[e][r]); else for (r = 0; r < t; r++)n.call(this, this[e][r]); }, r.prototype._procSubEntries = function (e, t, n, r) { let i; if (this._parsing) for (e[t] = [], i = 0; i < n; i++)e[t].push({}), r.call(this, e[t][i]); else for (i = 0; i < n; i++)r.call(this, e[t][i]); }, r.prototype._procEntryField = function (e, t, n, r) { this._parsing ? e[t] = this._readField(n, r) : this._writeField(n, r, e[t]); }, r.prototype._procSubBoxes = function (e, t) { let n; if (this._parsing) for (this[e] = [], n = 0; n < t; n++) this[e].push(r.parse(this)); else for (n = 0; n < t; n++) this._rawo ? this[e][n].write() : this.size += this[e][n].getLength(); }, r.prototype._readField = function (e, t) { switch (e) { case `uint`:return this._readUint(t); case `int`:return this._readInt(t); case `template`:return this._readTemplate(t); case `string`:return t === -1 ? this._readTerminatedString() : this._readString(t); case `data`:return this._readData(t); case `utf8`:return this._readUTF8String(); default:return -1; } }, r.prototype._readInt = function (e) { var t = null; var n = this._cursor.offset - this._raw.byteOffset; switch (e) { case 8:t = this._raw.getInt8(n); break; case 16:t = this._raw.getInt16(n); break; case 32:t = this._raw.getInt32(n); break; case 64:var r = this._raw.getInt32(n); var n = this._raw.getInt32(4 + n); var t = r * Math.pow(2, 32) + n; } return this._cursor.offset += e >> 3, t; }, r.prototype._readUint = function (e) { let t; let n; let r = null; const i = this._cursor.offset - this._raw.byteOffset; switch (e) { case 8:r = this._raw.getUint8(i); break; case 16:r = this._raw.getUint16(i); break; case 24:r = ((t = this._raw.getUint16(i)) << 8) + (n = this._raw.getUint8(2 + i)); break; case 32:r = this._raw.getUint32(i); break; case 64:t = this._raw.getUint32(i), n = this._raw.getUint32(4 + i), r = t * Math.pow(2, 32) + n; } return this._cursor.offset += e >> 3, r; }, r.prototype._readString = function (e) { for (var t = ``, n = 0; n < e; n++) { const r = this._readUint(8); t += String.fromCharCode(r); } return t; }, r.prototype._readTemplate = function (e) { return this._readUint(e / 2) + this._readUint(e / 2) / Math.pow(2, e / 2); }, r.prototype._readTerminatedString = function () { for (var e = ``; this._cursor.offset - this._offset < this._raw.byteLength;) { const t = this._readUint(8); if (t === 0) break; e += String.fromCharCode(t); } return e; }, r.prototype._readData = function (e) { const t = e > 0 ? e : this._raw.byteLength - (this._cursor.offset - this._offset); if (t > 0) { e = new Uint8Array(this._raw.buffer, this._cursor.offset, t); return this._cursor.offset += t, e; } return null; }, r.prototype._readUTF8String = function () { const e = this._raw.byteLength - (this._cursor.offset - this._offset); let t = null; return e > 0 && (t = new DataView(this._raw.buffer, this._cursor.offset, e), this._cursor.offset += e), t ? i.Utils.dataViewToString(t) : t; }, r.prototype._parseBox = function () { if (this._parsing = !0, this._cursor.offset = this._offset, this._offset + 8 > this._raw.buffer.byteLength) this._root._incomplete = !0; else { switch (this._procField(`size`, `uint`, 32), this._procField(`type`, `string`, 4), this.size === 1 && this._procField(`largesize`, `uint`, 64), this.type === `uuid` && this._procFieldArray(`usertype`, 16, `uint`, 8), this.size) { case 0:this._raw = new DataView(this._raw.buffer, this._offset, this._raw.byteLength - this._cursor.offset + 8); break; case 1:this._offset + this.size > this._raw.buffer.byteLength ? (this._incomplete = !0, this._root._incomplete = !0) : this._raw = new DataView(this._raw.buffer, this._offset, this.largesize); break; default:this._offset + this.size > this._raw.buffer.byteLength ? (this._incomplete = !0, this._root._incomplete = !0) : this._raw = new DataView(this._raw.buffer, this._offset, this.size); } this._incomplete || (this._boxProcessors[this.type] && this._boxProcessors[this.type].call(this), this._boxContainers.indexOf(this.type) !== -1 ? this._parseContainerBox() : this._data = this._readData()); } }, r.prototype._parseFullBox = function () { this.version = this._readUint(8), this.flags = this._readUint(24); }, r.prototype._parseContainerBox = function () { for (this.boxes = []; this._cursor.offset - this._raw.byteOffset < this._raw.byteLength;) this.boxes.push(r.parse(this)); }, r.prototype.append = function (e, t) { i.Utils.appendBox(this, e, t); }, r.prototype.getLength = function () { if (this._parsing = !1, this._rawo = null, this.size = 0, this._procField(`size`, `uint`, 32), this._procField(`type`, `string`, 4), this.size === 1 && this._procField(`largesize`, `uint`, 64), this.type === `uuid` && this._procFieldArray(`usertype`, 16, `uint`, 8), this._boxProcessors[this.type] && this._boxProcessors[this.type].call(this), this._boxContainers.indexOf(this.type) !== -1) for (let e = 0; e < this.boxes.length; e++) this.size += this.boxes[e].getLength(); return this._data && this._writeData(this._data), this.size; }, r.prototype.write = function () { switch (this._parsing = !1, this._cursor.offset = this._parent._cursor.offset, this.size) { case 0:this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.parent._rawo.byteLength - this._cursor.offset); break; case 1:this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.largesize); break; default:this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.size); } if (this._procField(`size`, `uint`, 32), this._procField(`type`, `string`, 4), this.size === 1 && this._procField(`largesize`, `uint`, 64), this.type === `uuid` && this._procFieldArray(`usertype`, 16, `uint`, 8), this._boxProcessors[this.type] && this._boxProcessors[this.type].call(this), this._boxContainers.indexOf(this.type) !== -1) for (let e = 0; e < this.boxes.length; e++) this.boxes[e].write(); return this._data && this._writeData(this._data), this._parent._cursor.offset += this.size, this.size; }, r.prototype._writeInt = function (e, t) { if (this._rawo) { const n = this._cursor.offset - this._rawo.byteOffset; switch (e) { case 8:this._rawo.setInt8(n, t); break; case 16:this._rawo.setInt16(n, t); break; case 32:this._rawo.setInt32(n, t); break; case 64:var r = Math.floor(t / Math.pow(2, 32)); var t = t - r * Math.pow(2, 32); this._rawo.setUint32(n, r), this._rawo.setUint32(4 + n, t); } this._cursor.offset += e >> 3; } else this.size += e >> 3; }, r.prototype._writeUint = function (e, t) { if (this._rawo) { let n; let r; const i = this._cursor.offset - this._rawo.byteOffset; switch (e) { case 8:this._rawo.setUint8(i, t); break; case 16:this._rawo.setUint16(i, t); break; case 24:n = (16776960 & t) >> 8, r = 255 & t, this._rawo.setUint16(i, n), this._rawo.setUint8(2 + i, r); break; case 32:this._rawo.setUint32(i, t); break; case 64:r = t - (n = Math.floor(t / Math.pow(2, 32))) * Math.pow(2, 32), this._rawo.setUint32(i, n), this._rawo.setUint32(4 + i, r); } this._cursor.offset += e >> 3; } else this.size += e >> 3; }, r.prototype._writeString = function (e, t) { for (let n = 0; n < e; n++) this._writeUint(8, t.charCodeAt(n)); }, r.prototype._writeTerminatedString = function (e) { if (e.length !== 0) { for (let t = 0; t < e.length; t++) this._writeUint(8, e.charCodeAt(t)); this._writeUint(8, 0); } }, r.prototype._writeTemplate = function (e, t) { const n = Math.floor(t); var t = (t - n) * Math.pow(2, e / 2); this._writeUint(e / 2, n), this._writeUint(e / 2, t); }, r.prototype._writeData = function (e) { if (e) if (this._rawo) { if (e instanceof Array) { for (let t = this._cursor.offset - this._rawo.byteOffset, n = 0; n < e.length; n++) this._rawo.setInt8(t + n, e[n]); this._cursor.offset += e.length; }e instanceof Uint8Array && (this._root.bytes.set(e, this._cursor.offset), this._cursor.offset += e.length); } else this.size += e.length; }, r.prototype._writeUTF8String = function (e) { const t = i.Utils.utf8ToByteArray(e); if (this._rawo) for (let n = new DataView(this._rawo.buffer, this._cursor.offset, t.length), r = 0; r < t.length; r++)n.setUint8(r, t[r]); else this.size += t.length; }, r.prototype._writeField = function (e, t, n) { switch (e) { case `uint`:this._writeUint(t, n); break; case `int`:this._writeInt(t, n); break; case `template`:this._writeTemplate(t, n); break; case `string`:t == -1 ? this._writeTerminatedString(n) : this._writeString(t, n); break; case `data`:this._writeData(n); break; case `utf8`:this._writeUTF8String(n); } }, r.prototype._boxProcessors.avc1 = r.prototype._boxProcessors.encv = function () { this._procFieldArray(`reserved1`, 6, `uint`, 8), this._procField(`data_reference_index`, `uint`, 16), this._procField(`pre_defined1`, `uint`, 16), this._procField(`reserved2`, `uint`, 16), this._procFieldArray(`pre_defined2`, 3, `uint`, 32), this._procField(`width`, `uint`, 16), this._procField(`height`, `uint`, 16), this._procField(`horizresolution`, `template`, 32), this._procField(`vertresolution`, `template`, 32), this._procField(`reserved3`, `uint`, 32), this._procField(`frame_count`, `uint`, 16), this._procFieldArray(`compressorname`, 32, `uint`, 8), this._procField(`depth`, `uint`, 16), this._procField(`pre_defined3`, `int`, 16), this._procField(`config`, `data`, -1); }, r.prototype._boxProcessors.dref = function () { this._procFullBox(), this._procField(`entry_count`, `uint`, 32), this._procSubBoxes(`entries`, this.entry_count); }, r.prototype._boxProcessors.elst = function () { this._procFullBox(), this._procField(`entry_count`, `uint`, 32), this._procEntries(`entries`, this.entry_count, function (e) { this._procEntryField(e, `segment_duration`, `uint`, this.version === 1 ? 64 : 32), this._procEntryField(e, `media_time`, `int`, this.version === 1 ? 64 : 32), this._procEntryField(e, `media_rate_integer`, `int`, 16), this._procEntryField(e, `media_rate_fraction`, `int`, 16); }); }, r.prototype._boxProcessors.emsg = function () { this._procFullBox(), this.version == 1 ? (this._procField(`timescale`, `uint`, 32), this._procField(`presentation_time`, `uint`, 64), this._procField(`event_duration`, `uint`, 32), this._procField(`id`, `uint`, 32), this._procField(`scheme_id_uri`, `string`, -1), this._procField(`value`, `string`, -1)) : (this._procField(`scheme_id_uri`, `string`, -1), this._procField(`value`, `string`, -1), this._procField(`timescale`, `uint`, 32), this._procField(`presentation_time_delta`, `uint`, 32), this._procField(`event_duration`, `uint`, 32), this._procField(`id`, `uint`, 32)), this._procField(`message_data`, `data`, -1); }, r.prototype._boxProcessors.free = r.prototype._boxProcessors.skip = function () { this._procField(`data`, `data`, -1); }, r.prototype._boxProcessors.frma = function () { this._procField(`data_format`, `uint`, 32); }, r.prototype._boxProcessors.ftyp = r.prototype._boxProcessors.styp = function () { this._procField(`major_brand`, `string`, 4), this._procField(`minor_version`, `uint`, 32); let e = -1; this._parsing && (e = (this._raw.byteLength - (this._cursor.offset - this._raw.byteOffset)) / 4), this._procFieldArray(`compatible_brands`, e, `string`, 4); }, r.prototype._boxProcessors.hdlr = function () { this._procFullBox(), this._procField(`pre_defined`, `uint`, 32), this._procField(`handler_type`, `string`, 4), this._procFieldArray(`reserved`, 3, `uint`, 32), this._procField(`name`, `string`, -1); }, r.prototype._boxProcessors.mdat = function () { this._procField(`data`, `data`, -1); }, r.prototype._boxProcessors.mdhd = function () { this._procFullBox(), this._procField(`creation_time`, `uint`, this.version == 1 ? 64 : 32), this._procField(`modification_time`, `uint`, this.version == 1 ? 64 : 32), this._procField(`timescale`, `uint`, 32), this._procField(`duration`, `uint`, this.version == 1 ? 64 : 32), this._parsing || typeof this.language !== `string` || (this.language = this.language.charCodeAt(0) - 96 << 10 | this.language.charCodeAt(1) - 96 << 5 | this.language.charCodeAt(2) - 96), this._procField(`language`, `uint`, 16), this._parsing && (this.language = String.fromCharCode(96 + (this.language >> 10 & 31), 96 + (this.language >> 5 & 31), 96 + (31 & this.language))), this._procField(`pre_defined`, `uint`, 16); }, r.prototype._boxProcessors.mehd = function () { this._procFullBox(), this._procField(`fragment_duration`, `uint`, this.version == 1 ? 64 : 32); }, r.prototype._boxProcessors.mfhd = function () { this._procFullBox(), this._procField(`sequence_number`, `uint`, 32); }, r.prototype._boxProcessors.mfro = function () { this._procFullBox(), this._procField(`mfra_size`, `uint`, 32); }, r.prototype._boxProcessors.mp4a = r.prototype._boxProcessors.enca = function () { this._procFieldArray(`reserved1`, 6, `uint`, 8), this._procField(`data_reference_index`, `uint`, 16), this._procFieldArray(`reserved2`, 2, `uint`, 32), this._procField(`channelcount`, `uint`, 16), this._procField(`samplesize`, `uint`, 16), this._procField(`pre_defined`, `uint`, 16), this._procField(`reserved3`, `uint`, 16), this._procField(`samplerate`, `template`, 32), this._procField(`esds`, `data`, -1); }, r.prototype._boxProcessors.mvhd = function () { this._procFullBox(), this._procField(`creation_time`, `uint`, this.version == 1 ? 64 : 32), this._procField(`modification_time`, `uint`, this.version == 1 ? 64 : 32), this._procField(`timescale`, `uint`, 32), this._procField(`duration`, `uint`, this.version == 1 ? 64 : 32), this._procField(`rate`, `template`, 32), this._procField(`volume`, `template`, 16), this._procField(`reserved1`, `uint`, 16), this._procFieldArray(`reserved2`, 2, `uint`, 32), this._procFieldArray(`matrix`, 9, `template`, 32), this._procFieldArray(`pre_defined`, 6, `uint`, 32), this._procField(`next_track_ID`, `uint`, 32); }, r.prototype._boxProcessors.payl = function () { this._procField(`cue_text`, `utf8`); }, r.prototype._boxProcessors.pssh = function () { this._procFullBox(), this._procFieldArray(`SystemID`, 16, `uint`, 8), this._procField(`DataSize`, `uint`, 32), this._procFieldArray(`Data`, this.DataSize, `uint`, 8); }, r.prototype._boxProcessors.schm = function () { this._procFullBox(), this._procField(`scheme_type`, `uint`, 32), this._procField(`scheme_version`, `uint`, 32), 1 & this.flags && this._procField(`scheme_uri`, `string`, -1); }, r.prototype._boxProcessors.sdtp = function () { this._procFullBox(); let e = -1; this._parsing && (e = this._raw.byteLength - (this._cursor.offset - this._raw.byteOffset)), this._procFieldArray(`sample_dependency_table`, e, `uint`, 8); }, r.prototype._boxProcessors.sidx = function () { this._procFullBox(), this._procField(`reference_ID`, `uint`, 32), this._procField(`timescale`, `uint`, 32), this._procField(`earliest_presentation_time`, `uint`, this.version == 1 ? 64 : 32), this._procField(`first_offset`, `uint`, this.version == 1 ? 64 : 32), this._procField(`reserved`, `uint`, 16), this._procField(`reference_count`, `uint`, 16), this._procEntries(`references`, this.reference_count, function (e) { this._parsing || (e.reference = (1 & e.reference_type) << 31, e.reference |= 2147483647 & e.referenced_size, e.sap = (1 & e.starts_with_SAP) << 31, e.sap |= (3 & e.SAP_type) << 28, e.sap |= 268435455 & e.SAP_delta_time), this._procEntryField(e, `reference`, `uint`, 32), this._procEntryField(e, `subsegment_duration`, `uint`, 32), this._procEntryField(e, `sap`, `uint`, 32), this._parsing && (e.reference_type = e.reference >> 31 & 1, e.referenced_size = 2147483647 & e.reference, e.starts_with_SAP = e.sap >> 31 & 1, e.SAP_type = e.sap >> 28 & 7, e.SAP_delta_time = 268435455 & e.sap); }); }, r.prototype._boxProcessors.smhd = function () { this._procFullBox(), this._procField(`balance`, `uint`, 16), this._procField(`reserved`, `uint`, 16); }, r.prototype._boxProcessors.ssix = function () { this._procFullBox(), this._procField(`subsegment_count`, `uint`, 32), this._procEntries(`subsegments`, this.subsegment_count, function (e) { this._procEntryField(e, `ranges_count`, `uint`, 32), this._procSubEntries(e, `ranges`, e.ranges_count, function (e) { this._procEntryField(e, `level`, `uint`, 8), this._procEntryField(e, `range_size`, `uint`, 24); }); }); }, r.prototype._boxProcessors.stsd = function () { this._procFullBox(), this._procField(`entry_count`, `uint`, 32), this._procSubBoxes(`entries`, this.entry_count); }, r.prototype._boxProcessors.subs = function () { this._procFullBox(), this._procField(`entry_count`, `uint`, 32), this._procEntries(`entries`, this.entry_count, function (e) { this._procEntryField(e, `sample_delta`, `uint`, 32), this._procEntryField(e, `subsample_count`, `uint`, 16), this._procSubEntries(e, `subsamples`, e.subsample_count, function (e) { this._procEntryField(e, `subsample_size`, `uint`, this.version === 1 ? 32 : 16), this._procEntryField(e, `subsample_priority`, `uint`, 8), this._procEntryField(e, `discardable`, `uint`, 8), this._procEntryField(e, `codec_specific_parameters`, `uint`, 32); }); }); }, r.prototype._boxProcessors.tenc = function () { this._procFullBox(), this._procField(`default_IsEncrypted`, `uint`, 24), this._procField(`default_IV_size`, `uint`, 8), this._procFieldArray(`default_KID`, 16, `uint`, 8); }, r.prototype._boxProcessors.tfdt = function () { this._procFullBox(), this._procField(`baseMediaDecodeTime`, `uint`, this.version == 1 ? 64 : 32); }, r.prototype._boxProcessors.tfhd = function () { this._procFullBox(), this._procField(`track_ID`, `uint`, 32), 1 & this.flags && this._procField(`base_data_offset`, `uint`, 64), 2 & this.flags && this._procField(`sample_description_offset`, `uint`, 32), 8 & this.flags && this._procField(`default_sample_duration`, `uint`, 32), 16 & this.flags && this._procField(`default_sample_size`, `uint`, 32), 32 & this.flags && this._procField(`default_sample_flags`, `uint`, 32); }, r.prototype._boxProcessors.tfra = function () { this._procFullBox(), this._procField(`track_ID`, `uint`, 32), this._parsing || (this.reserved = 0, this.reserved |= (48 & this.length_size_of_traf_num) << 4, this.reserved |= (12 & this.length_size_of_trun_num) << 2, this.reserved |= 3 & this.length_size_of_sample_num), this._procField(`reserved`, `uint`, 32), this._parsing && (this.length_size_of_traf_num = (48 & this.reserved) >> 4, this.length_size_of_trun_num = (12 & this.reserved) >> 2, this.length_size_of_sample_num = 3 & this.reserved), this._procField(`number_of_entry`, `uint`, 32), this._procEntries(`entries`, this.number_of_entry, function (e) { this._procEntryField(e, `time`, `uint`, this.version === 1 ? 64 : 32), this._procEntryField(e, `moof_offset`, `uint`, this.version === 1 ? 64 : 32), this._procEntryField(e, `traf_number`, `uint`, 8 * (this.length_size_of_traf_num + 1)), this._procEntryField(e, `trun_number`, `uint`, 8 * (this.length_size_of_trun_num + 1)), this._procEntryField(e, `sample_number`, `uint`, 8 * (this.length_size_of_sample_num + 1)); }); }, r.prototype._boxProcessors.tkhd = function () { this._procFullBox(), this._procField(`creation_time`, `uint`, this.version == 1 ? 64 : 32), this._procField(`modification_time`, `uint`, this.version == 1 ? 64 : 32), this._procField(`track_ID`, `uint`, 32), this._procField(`reserved1`, `uint`, 32), this._procField(`duration`, `uint`, this.version == 1 ? 64 : 32), this._procFieldArray(`reserved2`, 2, `uint`, 32), this._procField(`layer`, `uint`, 16), this._procField(`alternate_group`, `uint`, 16), this._procField(`volume`, `template`, 16), this._procField(`reserved3`, `uint`, 16), this._procFieldArray(`matrix`, 9, `template`, 32), this._procField(`width`, `template`, 32), this._procField(`height`, `template`, 32); }, r.prototype._boxProcessors.trex = function () { this._procFullBox(), this._procField(`track_ID`, `uint`, 32), this._procField(`default_sample_description_index`, `uint`, 32), this._procField(`default_sample_duration`, `uint`, 32), this._procField(`default_sample_size`, `uint`, 32), this._procField(`default_sample_flags`, `uint`, 32); }, r.prototype._boxProcessors.trun = function () { this._procFullBox(), this._procField(`sample_count`, `uint`, 32), 1 & this.flags && this._procField(`data_offset`, `int`, 32), 4 & this.flags && this._procField(`first_sample_flags`, `uint`, 32), this._procEntries(`samples`, this.sample_count, function (e) { 256 & this.flags && this._procEntryField(e, `sample_duration`, `uint`, 32), 512 & this.flags && this._procEntryField(e, `sample_size`, `uint`, 32), 1024 & this.flags && this._procEntryField(e, `sample_flags`, `uint`, 32), 2048 & this.flags && this._procEntryField(e, `sample_composition_time_offset`, this.version === 1 ? `int` : `uint`, 32); }); }, r.prototype._boxProcessors[`url `] = r.prototype._boxProcessors[`urn `] = function () { this._procFullBox(), this.type === `urn ` && this._procField(`name`, `string`, -1), this._procField(`location`, `string`, -1); }, r.prototype._boxProcessors.vlab = function () { this._procField(`source_label`, `utf8`); }, r.prototype._boxProcessors.vmhd = function () { this._procFullBox(), this._procField(`graphicsmode`, `uint`, 16), this._procFieldArray(`opcolor`, 3, `uint`, 16); }, r.prototype._boxProcessors.vttC = function () { this._procField(`config`, `utf8`); }, r.prototype._boxProcessors.vtte = function () {}; }, {}], 10: [function (e, t, n) { (function (e) { function t (e) { return Object.prototype.toString.call(e); }n.isArray = function (e) { return Array.isArray ? Array.isArray(e) : t(e) === `[object Array]`; }, n.isBoolean = function (e) { return typeof e === `boolean`; }, n.isNull = function (e) { return e === null; }, n.isNullOrUndefined = function (e) { return e == null; }, n.isNumber = function (e) { return typeof e === `number`; }, n.isString = function (e) { return typeof e === `string`; }, n.isSymbol = function (e) { return typeof e === `symbol`; }, n.isUndefined = function (e) { return void 0 === e; }, n.isRegExp = function (e) { return t(e) === `[object RegExp]`; }, n.isObject = function (e) { return typeof e === `object` && e !== null; }, n.isDate = function (e) { return t(e) === `[object Date]`; }, n.isError = function (e) { return t(e) === `[object Error]` || e instanceof Error; }, n.isFunction = function (e) { return typeof e === `function`; }, n.isPrimitive = function (e) { return e === null || typeof e === `boolean` || typeof e === `number` || typeof e === `string` || typeof e === `symbol` || void 0 === e; }, n.isBuffer = e.isBuffer; }).call(this, { isBuffer: e(22) }); }, { 22: 22 }], 11: [function (e, t, n) { const s = Object.create || function (e) { function t () {} return t.prototype = e, new t(); }; const o = Object.keys || function (e) { let t; const n = []; for (t in e)Object.prototype.hasOwnProperty.call(e, t) && n.push(t); return t; }; const r = Function.prototype.bind || function (e) { const t = this; return function () { return t.apply(e, arguments); }; }; function i () { this._events && Object.prototype.hasOwnProperty.call(this, `_events`) || (this._events = s(null), this._eventsCount = 0), this._maxListeners = this._maxListeners || void 0; }((t.exports = i).EventEmitter = i).prototype._events = void 0, i.prototype._maxListeners = void 0; let a; let u = 10; try { const l = {}; Object.defineProperty && Object.defineProperty(l, `x`, { value: 0 }), a = l.x === 0; } catch (e) { a = !1; } function d (e) { return void 0 === e._maxListeners ? i.defaultMaxListeners : e._maxListeners; } function f (e, t, n, r) { let i, a; if (typeof n !== `function`) throw new TypeError(`"listener" argument must be a function`); return (i = e._events) ? (i.newListener && (e.emit(`newListener`, t, n.listener ? n.listener : n), i = e._events), a = i[t]) : (i = e._events = s(null), e._eventsCount = 0), a ? (typeof a === `function` ? a = i[t] = r ? [n, a] : [a, n] : r ? a.unshift(n) : a.push(n), a.warned || (r = d(e)) && r > 0 && a.length > r && (a.warned = !0, (r = new Error(`Possible EventEmitter memory leak detected. ${a.length} "${String(t)}" listeners added. Use emitter.setMaxListeners() to increase limit.`)).name = `MaxListenersExceededWarning`, r.emitter = e, r.type = t, r.count = a.length, typeof console === `object` && console.warn && console.warn(`%s: %s`, r.name, r.message))) : (a = i[t] = n, ++e._eventsCount), e; } function c () { if (!this.fired) switch (this.target.removeListener(this.type, this.wrapFn), this.fired = !0, arguments.length) { case 0:return this.listener.call(this.target); case 1:return this.listener.call(this.target, arguments[0]); case 2:return this.listener.call(this.target, arguments[0], arguments[1]); case 3:return this.listener.call(this.target, arguments[0], arguments[1], arguments[2]); default:for (var e = new Array(arguments.length), t = 0; t < e.length; ++t)e[t] = arguments[t]; this.listener.apply(this.target, e); } } function h (e, t, n) { e = { fired: !1, wrapFn: void 0, target: e, type: t, listener: n }, t = r.call(c, e); return t.listener = n, e.wrapFn = t; } function p (e, t, n) { e = e._events; if (!e) return []; t = e[t]; return t ? typeof t === `function` ? n ? [t.listener || t] : [t] : n ? (function (e) { for (var t = new Array(e.length), n = 0; n < t.length; ++n)t[n] = e[n].listener || e[n]; return t; }(t)) : _(t, t.length) : []; } function g (e) { const t = this._events; if (t) { e = t[e]; if (typeof e === `function`) return 1; if (e) return e.length; } return 0; } function _ (e, t) { for (var n = new Array(t), r = 0; r < t; ++r)n[r] = e[r]; return n; }a ? Object.defineProperty(i, `defaultMaxListeners`, { enumerable: !0, get: function () { return u; }, set: function (e) { if (typeof e !== `number` || e < 0 || e != e) throw new TypeError(`"defaultMaxListeners" must be a positive number`); u = e; } }) : i.defaultMaxListeners = u, i.prototype.setMaxListeners = function (e) { if (typeof e !== `number` || e < 0 || isNaN(e)) throw new TypeError(`"n" argument must be a positive number`); return this._maxListeners = e, this; }, i.prototype.getMaxListeners = function () { return d(this); }, i.prototype.emit = function (e, t, n, r) { let i; let a; let o; let s = e === `error`; let u = this._events; if (u)s = s && u.error == null; else if (!s) return !1; if (s) { if (arguments.length > 1 && (i = t), i instanceof Error) throw i; s = new Error(`Unhandled "error" event. (${i})`); throw s.context = i, s; } if (!(u = u[e])) return !1; let l; var e = typeof u === `function`; switch (l = arguments.length) { case 1:!(function (e, t, n) { if (t)e.call(n); else for (let r = e.length, i = _(e, r), a = 0; a < r; ++a)i[a].call(n); }(u, e, this)); break; case 2:!(function (e, t, n, r) { if (t)e.call(n, r); else for (let i = e.length, a = _(e, i), o = 0; o < i; ++o)a[o].call(n, r); }(u, e, this, t)); break; case 3:!(function (e, t, n, r, i) { if (t)e.call(n, r, i); else for (let a = e.length, o = _(e, a), s = 0; s < a; ++s)o[s].call(n, r, i); }(u, e, this, t, n)); break; case 4:!(function (e, t, n, r, i, a) { if (t)e.call(n, r, i, a); else for (let o = e.length, s = _(e, o), u = 0; u < o; ++u)s[u].call(n, r, i, a); }(u, e, this, t, n, r)); break; default:for (a = new Array(l - 1), o = 1; o < l; o++)a[o - 1] = arguments[o]; !(function (e, t, n, r) { if (t)e.apply(n, r); else for (let i = e.length, a = _(e, i), o = 0; o < i; ++o)a[o].apply(n, r); }(u, e, this, a)); } return !0; }, i.prototype.on = i.prototype.addListener = function (e, t) { return f(this, e, t, !1); }, i.prototype.prependListener = function (e, t) { return f(this, e, t, !0); }, i.prototype.once = function (e, t) { if (typeof t !== `function`) throw new TypeError(`"listener" argument must be a function`); return this.on(e, h(this, e, t)), this; }, i.prototype.prependOnceListener = function (e, t) { if (typeof t !== `function`) throw new TypeError(`"listener" argument must be a function`); return this.prependListener(e, h(this, e, t)), this; }, i.prototype.removeListener = function (e, t) { let n, r, i, a, o; if (typeof t !== `function`) throw new TypeError(`"listener" argument must be a function`); if (!(r = this._events)) return this; if (!(n = r[e])) return this; if (n === t || n.listener === t)--this._eventsCount == 0 ? this._events = s(null) : (delete r[e], r.removeListener && this.emit(`removeListener`, e, n.listener || t)); else if (typeof n !== `function`) { for (i = -1, a = n.length - 1; a >= 0; a--) if (n[a] === t || n[a].listener === t) { o = n[a].listener, i = a; break; } if (i < 0) return this; i === 0 ? n.shift() : (function (e, t) { for (let n = t, r = n + 1, i = e.length; r < i; n += 1, r += 1)e[n] = e[r]; e.pop(); }(n, i)), n.length === 1 && (r[e] = n[0]), r.removeListener && this.emit(`removeListener`, e, o || t); } return this; }, i.prototype.removeAllListeners = function (e) { let t; const n = this._events; if (!n) return this; if (!n.removeListener) return arguments.length === 0 ? (this._events = s(null), this._eventsCount = 0) : n[e] && (--this._eventsCount == 0 ? this._events = s(null) : delete n[e]), this; if (arguments.length === 0) { for (var r, i = o(n), a = 0; a < i.length; ++a)(r = i[a]) !== `removeListener` && this.removeAllListeners(r); return this.removeAllListeners(`removeListener`), this._events = s(null), this._eventsCount = 0, this; } if (typeof (t = n[e]) === `function`) this.removeListener(e, t); else if (t) for (a = t.length - 1; a >= 0; a--) this.removeListener(e, t[a]); return this; }, i.prototype.listeners = function (e) { return p(this, e, !0); }, i.prototype.rawListeners = function (e) { return p(this, e, !1); }, i.listenerCount = function (e, t) { return typeof e.listenerCount === `function` ? e.listenerCount(t) : g.call(e, t); }, i.prototype.listenerCount = g, i.prototype.eventNames = function () { return this._eventsCount > 0 ? Reflect.ownKeys(this._events) : []; }; }, {}], 12: [function (e, t, n) { "use strict"; const l = Array.isArray; const d = Object.keys; const f = Object.prototype.hasOwnProperty; t.exports = function e (t, n) { if (t === n) return !0; if (t && n && typeof t === `object` && typeof n === `object`) { let r; let i; let a = l(t); let o = l(n); if (a && o) { if ((s = t.length) != n.length) return !1; for (r = s; r-- != 0;) if (!e(t[r], n[r])) return !1; return !0; } if (a != o) return !1; a = t instanceof Date, o = n instanceof Date; if (a != o) return !1; if (a && o) return t.getTime() == n.getTime(); a = t instanceof RegExp, o = n instanceof RegExp; if (a != o) return !1; if (a && o) return t.toString() == n.toString(); let s; const u = d(t); if ((s = u.length) !== d(n).length) return !1; for (r = s; r-- != 0;) if (!f.call(n, u[r])) return !1; for (r = s; r-- != 0;) if (!e(t[i = u[r]], n[i])) return !1; return !0; } return t != t && n != n; }; }, {}], 13: [function (e, t, n) { n.read = function (e, t, n, r, i) { let a; let o; const s = 8 * i - r - 1; const u = (1 << s) - 1; const l = u >> 1; let d = -7; let f = n ? i - 1 : 0; const c = n ? -1 : 1; var n = e[t + f]; for (f += c, a = n & (1 << -d) - 1, n >>= -d, d += s; d > 0; a = 256 * a + e[t + f], f += c, d -= 8);for (o = a & (1 << -d) - 1, a >>= -d, d += r; d > 0; o = 256 * o + e[t + f], f += c, d -= 8);if (a === 0)a = 1 - l; else { if (a === u) return o ? NaN : 1 / 0 * (n ? -1 : 1); o += Math.pow(2, r), a -= l; } return (n ? -1 : 1) * o * Math.pow(2, a - r); }, n.write = function (e, t, n, r, i, a) { let o; let s; let u = 8 * a - i - 1; const l = (1 << u) - 1; const d = l >> 1; const f = i === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0; let c = r ? 0 : a - 1; const h = r ? 1 : -1; var a = t < 0 || t === 0 && 1 / t < 0 ? 1 : 0; for (t = Math.abs(t), isNaN(t) || t === 1 / 0 ? (s = isNaN(t) ? 1 : 0, o = l) : (o = Math.floor(Math.log(t) / Math.LN2), t * (r = Math.pow(2, -o)) < 1 && (o--, r *= 2), (t += o + d >= 1 ? f / r : f * Math.pow(2, 1 - d)) * r >= 2 && (o++, r /= 2), l <= o + d ? (s = 0, o = l) : o + d >= 1 ? (s = (t * r - 1) * Math.pow(2, i), o += d) : (s = t * Math.pow(2, d - 1) * Math.pow(2, i), o = 0)); i >= 8; e[n + c] = 255 & s, c += h, s /= 256, i -= 8);for (o = o << i | s, u += i; u > 0; e[n + c] = 255 & o, c += h, o /= 256, u -= 8);e[n + c - h] |= 128 * a; }; }, {}], 14: [function (e, t, n) { function g (e, t, n, r) { const i = r && r.timeContainer === `seq`; let a = 0; r && (a = i && n ? n.end : r.begin), t.begin = t.explicit_begin ? t.explicit_begin + a : a; let o; let s = t.begin; let u = null; for (o in t.sets)g(e, t.sets[o], u, t), s = t.timeContainer === `seq` ? t.sets[o].end : Math.max(s, t.sets[o].end), u = t.sets[o]; if (`contents` in t) for (const l in t.contents)g(e, t.contents[l], u, t), s = t.timeContainer === `seq` ? t.contents[l].end : Math.max(s, t.contents[l].end), u = t.contents[l]; else s = i ? t.begin : Number.POSITIVE_INFINITY; t.explicit_end !== null && t.explicit_dur !== null ? t.end = Math.min(t.begin + t.explicit_dur, a + t.explicit_end) : t.explicit_end === null && t.explicit_dur !== null ? t.end = t.begin + t.explicit_dur : t.explicit_end !== null && t.explicit_dur === null ? t.end = a + t.explicit_end : t.end = s, delete t.explicit_begin, delete t.explicit_dur, delete t.explicit_end, e._registerEvent(t); } function _ (e) { this.node = e; } function m () { this.events = [], this.head = null, this.body = null; } function E () { this.styling = null, this.layout = null; } function y () { this.styles = {}; } function v () { this.id = null, this.styleAttrs = null, this.styleRefs = null; } function T () { this.regions = {}; } function r (e) { this.kind = e; } function i (e) { this.id = e; } function a (e) { this.regionID = e; } function o (e) { this.styleAttrs = e; } function s (e) { this.sets = e; } function u (e) { this.contents = e; } function l (e, t, n) { this.explicit_begin = e, this.explicit_end = t, this.explicit_dur = n; } function S () { r.call(this, `body`); } function A () { r.call(this, `div`); } function I () { r.call(this, `p`); } function R () { r.call(this, `span`); } function b () { r.call(this, `span`); } function D () { r.call(this, `br`); } function M () {} function N () {} function d (e) { return e && `xml:id` in e.attributes && e.attributes[`xml:id`].value || null; } function f (e) { return e && `style` in e.attributes ? e.attributes.style.value.split(` `) : []; } function c (e, t) { const n = {}; if (e !== null) for (const r in e.attributes) { var i; const a = `${e.attributes[r].uri} ${e.attributes[r].local}`; const o = B.byQName[a]; void 0 !== o && ((i = o.parse(e.attributes[r].value)) !== null ? (n[a] = i, o === B.byName.zIndex && O(t, `zIndex attribute present but not used by IMSC1 since regions do not overlap`)) : P(t, `Cannot parse styling attribute ${a} --\x3e ${e.attributes[r].value}`)); } return n; } function h (e, t, n) { for (const r in e.attributes) if (e.attributes[r].uri === t && e.attributes[r].local === n) return e.attributes[r].value; return null; } function p (e, t, n) { let r; let i = null; return (r = /^(\d+(?:\.\d+)?)f$/.exec(n)) !== null ? t !== null && (i = parseFloat(r[1]) / t) : (r = /^(\d+(?:\.\d+)?)t$/.exec(n)) !== null ? e !== null && (i = parseFloat(r[1]) / e) : (r = /^(\d+(?:\.\d+)?)ms$/.exec(n)) !== null ? i = parseFloat(r[1]) / 1e3 : (r = /^(\d+(?:\.\d+)?)s$/.exec(n)) !== null ? i = parseFloat(r[1]) : (r = /^(\d+(?:\.\d+)?)h$/.exec(n)) !== null ? i = 3600 * parseFloat(r[1]) : (r = /^(\d+(?:\.\d+)?)m$/.exec(n)) !== null ? i = 60 * parseFloat(r[1]) : (r = /^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n)) !== null ? i = 3600 * parseInt(r[1]) + 60 * parseInt(r[2]) + parseFloat(r[3]) : (r = /^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n)) !== null && t !== null && (i = 3600 * parseInt(r[1]) + 60 * parseInt(r[2]) + parseInt(r[3]) + (r[4] === null ? 0 : parseInt(r[4]) / t)), i; } function C (e, t, n, r) { for (let i = t.length - 1; i >= 0; i--) { const a = t[i]; a in e.styles ? w(e.styles[a].styleAttrs, n) : P(r, `Non-existant style id referenced`); } } function w (e, t) { for (const n in e)n in t || (t[n] = e[n]); } function O (e, t) { if (e && e.warn && e.warn(t)) throw t; } function P (e, t) { if (e && e.error && e.error(t)) throw t; } function L (e, t) { throw e && e.fatal && e.fatal(t), t; } function x (e, t) { for (var n, r = 0, i = e.length - 1; r <= i;) { const a = e[n = Math.floor((r + i) / 2)]; if (a < t)r = n + 1; else { if (!(t < a)) return { found: !0, index: n }; i = n - 1; } } return { found: !1, index: r }; } let F, U, B, k; n = void 0 === n ? this.imscDoc = {} : n, F = typeof sax === `undefined` ? e(40) : sax, U = typeof imscNames === `undefined` ? e(18) : imscNames, B = typeof imscStyles === `undefined` ? e(19) : imscStyles, k = typeof imscUtils === `undefined` ? e(20) : imscUtils, n.fromXML = function (e, u, l) { const t = F.parser(!0, { xmlns: !0 }); const d = []; const f = []; const c = []; let h = 0; let p = null; t.onclosetag = function (e) { if (d[0] instanceof y) for (const t in d[0].styles)!(function e (t, n, r) { for (;n.styleRefs.length > 0;) { const i = n.styleRefs.pop(); i in t.styles ? (e(t, t.styles[i], r), w(t.styles[i].styleAttrs, n.styleAttrs)) : P(r, `Non-existant style id referenced`); } }(d[0], d[0].styles[t], u)); else if (d[0] instanceof I || d[0] instanceof R) { if (d[0].contents.length > 1) { for (var n = [d[0].contents[0]], r = 1; r < d[0].contents.length; r++)d[0].contents[r] instanceof b && n[n.length - 1] instanceof b ? n[n.length - 1].text += d[0].contents[r].text : n.push(d[0].contents[r]); d[0].contents = n; }d[0] instanceof R && d[0].contents.length === 1 && d[0].contents[0] instanceof b && (d[0].text = d[0].contents[0].text, delete d[0].contents); } else d[0] instanceof _ && (d[0].node.uri === U.ns_tt && d[0].node.local === `metadata` ? h-- : h > 0 && l && `onCloseTag` in l && l.onCloseTag()); c.shift(), f.shift(), d.shift(); }, t.ontext = function (e) { let t; void 0 === d[0] || (d[0] instanceof R || d[0] instanceof I ? ((t = new b()).initFromText(p, d[0], e, c[0], u), d[0].contents.push(t)) : d[0] instanceof _ && h > 0 && l && `onText` in l && l.onText(e)); }, t.onopentag = function (e) { var t = e.attributes[`xml:space`]; t ? c.unshift(t.value) : c.length === 0 ? c.unshift(`default`) : c.unshift(c[0]); let n; let r; let i; let a; var t = e.attributes[`xml:lang`]; if (t ? f.unshift(t.value) : f.length === 0 ? f.unshift(``) : f.unshift(f[0]), e.uri === U.ns_tt ? e.local === `tt` ? (p !== null && L(u, `Two <tt> elements at (${this.line},${this.column})`), (p = new m()).initFromNode(e, u), d.unshift(p)) : e.local === `head` ? (d[0] instanceof m || L(u, `Parent of <head> element is not <tt> at (${this.line},${this.column})`), p.head !== null && L(`Second <head> element at (${this.line},${this.column})`), p.head = new E(), d.unshift(p.head)) : e.local === `styling` ? (d[0] instanceof E || L(u, `Parent of <styling> element is not <head> at (${this.line},${this.column})`), p.head.styling !== null && L(`Second <styling> element at (${this.line},${this.column})`), p.head.styling = new y(), d.unshift(p.head.styling)) : e.local === `style` ? d[0] instanceof y ? ((n = new v()).initFromNode(e, u), n.id ? p.head.styling.styles[n.id] = n : P(u, `<style> element missing @id attribute`), d.unshift(n)) : d[0] instanceof M ? ((n = new v()).initFromNode(e, u), w(n.styleAttrs, d[0].styleAttrs), d.unshift(n)) : L(u, `Parent of <style> element is not <styling> or <region> at (${this.line},${this.column})`) : e.local === `layout` ? (d[0] instanceof E || L(u, `Parent of <layout> element is not <head> at ${this.line},${this.column})`), p.head.layout !== null && L(u, `Second <layout> element at ${this.line},${this.column})`), p.head.layout = new T(), d.unshift(p.head.layout)) : e.local === `region` ? (d[0] instanceof T || L(u, `Parent of <region> element is not <layout> at ${this.line},${this.column})`), (n = new M()).initFromNode(p, e, u), !n.id || n.id in p.head.layout.regions ? P(u, `Ignoring <region> with duplicate or missing @id at ${this.line},${this.column})`) : p.head.layout.regions[n.id] = n, d.unshift(n)) : e.local === `body` ? (d[0] instanceof m || L(u, `Parent of <body> element is not <tt> at ${this.line},${this.column})`), p.body !== null && L(u, `Second <body> element at ${this.line},${this.column})`), (r = new S()).initFromNode(p, e, u), p.body = r, d.unshift(r)) : e.local === `div` ? (d[0] instanceof A || d[0] instanceof S || L(u, `Parent of <div> element is not <body> or <div> at ${this.line},${this.column})`), (r = new A()).initFromNode(p, d[0], e, u), d[0].contents.push(r), d.unshift(r)) : e.local === `p` ? (d[0] instanceof A || L(u, `Parent of <p> element is not <div> at ${this.line},${this.column})`), (i = new I()).initFromNode(p, d[0], e, u), d[0].contents.push(i), d.unshift(i)) : e.local === `span` ? (d[0] instanceof R || d[0] instanceof I || L(u, `Parent of <span> element is not <span> or <p> at ${this.line},${this.column})`), (i = new R()).initFromNode(p, d[0], e, c[0], u), d[0].contents.push(i), d.unshift(i)) : e.local === `br` ? (d[0] instanceof R || d[0] instanceof I || L(u, `Parent of <br> element is not <span> or <p> at ${this.line},${this.column})`), (a = new D()).initFromNode(p, d[0], e, u), d[0].contents.push(a), d.unshift(a)) : e.local === `set` ? (d[0] instanceof R || d[0] instanceof I || d[0] instanceof A || d[0] instanceof S || d[0] instanceof M || d[0] instanceof D || L(u, `Parent of <set> element is not a content element or a region at ${this.line},${this.column})`), (a = new N()).initFromNode(p, d[0], e, u), d[0].sets.push(a), d.unshift(a)) : d.unshift(new _(e)) : d.unshift(new _(e)), d[0] instanceof _) if (e.uri === U.ns_tt && e.local === `metadata`)h++; else if (h > 0 && l && `onOpenTag` in l) { let o; const s = []; for (o in e.attributes)s[`${e.attributes[o].uri} ${e.attributes[o].local}`] = { uri: e.attributes[o].uri, local: e.attributes[o].local, value: e.attributes[o].value }; l.onOpenTag(e.uri, e.local, s); } }, t.write(e).close(), p.head !== null ? delete p.head.styling : p.head = new E(), p.head.layout === null && (p.head.layout = new T()); let n; let r; let i = !1; for (n in p.head.layout.regions) { i = !0; break; } for (r in i || (e = M.prototype.createDefaultRegion(), p.head.layout.regions[e.id] = e), p.head.layout.regions)g(p, p.head.layout.regions[r], null, null); return p.body && g(p, p.body, null, null), p; }, m.prototype.initFromNode = function (e, t) { this.cellResolution = (function (e, t) { let n = h(e, U.ns_ttp, `cellResolution`); let r = 15; var e = 32; { n !== null && ((n = /(\d+) (\d+)/.exec(n)) !== null ? (e = parseInt(n[1]), r = parseInt(n[2])) : O(t, `Malformed cellResolution value (using initial value instead)`)); } return { w: e, h: r }; }(e, t)); let n = (function (e, t) { let n; const r = h(e, U.ns_ttp, `frameRate`); let i = 30; { r !== null && ((n = /(\d+)/.exec(r)) !== null ? i = parseInt(n[1]) : O(t, `Malformed frame rate attribute (using initial value instead)`)); } const a = h(e, U.ns_ttp, `frameRateMultiplier`); let o = 1; { a !== null && ((n = /(\d+) (\d+)/.exec(a)) !== null ? o = parseInt(n[1]) / parseInt(n[2]) : O(t, `Malformed frame rate multiplier attribute (using initial value instead)`)); }o *= i, i = 1, e = h(e, U.ns_ttp, `tickRate`); { e === null ? r !== null && (i = o) : (n = /(\d+)/.exec(e)) !== null ? i = parseInt(n[1]) : O(t, `Malformed tick rate attribute (using initial value instead)`); } return { effectiveFrameRate: o, tickRate: i }; }(e, t)); this.effectiveFrameRate = n.effectiveFrameRate, this.tickRate = n.tickRate, this.aspectRatio = (function (e, t) { let n = h(e, U.ns_ittp, `aspectRatio`); let r = null; { n !== null && ((e = /(\d+) (\d+)/.exec(n)) !== null ? (n = parseInt(e[1]), e = parseInt(e[2]), n !== 0 && e !== 0 ? r = n / e : P(t, `Illegal aspectRatio values (ignoring)`)) : P(t, `Malformed aspectRatio attribute (ignoring)`)); } return r; }(e, t)); n = h(e, U.ns_ttp, `timeBase`); n !== null && n !== `media` && L(t, `Unsupported time base`); e = (function (e, t) { let n = h(e, U.ns_tts, `extent`); if (n === null) return null; e = n.split(` `); if (e.length !== 2) return O(t, `Malformed extent (ignoring)`), null; n = k.parseLength(e[0]), e = k.parseLength(e[1]); return e && n ? { h: e, w: n } : (O(t, `Malformed extent values (ignoring)`), null); }(e, t)); e === null ? this.pxDimensions = { h: 480, w: 640 } : (e.h.unit === `px` && e.w.unit === `px` || L(t, `Extent on TT must be in px or absent`), this.pxDimensions = { h: e.h.value, w: e.w.value }); }, m.prototype._registerEvent = function (e) { let t; e.end <= e.begin || ((t = x(this.events, e.begin)).found || this.events.splice(t.index, 0, e.begin), e.end !== Number.POSITIVE_INFINITY && ((t = x(this.events, e.end)).found || this.events.splice(t.index, 0, e.end))); }, m.prototype.getMediaTimeRange = function () { return [this.events[0], this.events[this.events.length - 1]]; }, m.prototype.getMediaTimeEvents = function () { return this.events; }, v.prototype.initFromNode = function (e, t) { this.id = d(e), this.styleAttrs = c(e, t), this.styleRefs = f(e); }, i.prototype.initFromNode = function (e, t, n, r) { this.id = d(n); }, a.prototype.initFromNode = function (e, t, n, r) { this.regionID = (n = n) && `region` in n.attributes ? n.attributes.region.value : ``; }, o.prototype.initFromNode = function (e, t, n, r) { this.styleAttrs = c(n, r), e.head !== null && e.head.styling !== null && C(e.head.styling, f(n), this.styleAttrs, r); }, s.prototype.initFromNode = function (e, t, n, r) { this.sets = []; }, u.prototype.initFromNode = function (e, t, n, r) { this.contents = []; }, l.prototype.initFromNode = function (e, t, n, r) { e = (function (e, t, n) { let r = null; t && `begin` in t.attributes && (r = p(e.tickRate, e.effectiveFrameRate, t.attributes.begin.value)) === null && O(n, `Malformed begin value ${t.attributes.begin.value} (using 0)`); let i = null; t && `dur` in t.attributes && (i = p(e.tickRate, e.effectiveFrameRate, t.attributes.dur.value)) === null && O(n, `Malformed dur value ${t.attributes.dur.value} (ignoring)`); let a = null; t && `end` in t.attributes && (a = p(e.tickRate, e.effectiveFrameRate, t.attributes.end.value)) === null && O(n, `Malformed end value (ignoring)`); return { explicit_begin: r, explicit_end: a, explicit_dur: i }; }(e, n, r)); this.explicit_begin = e.explicit_begin, this.explicit_end = e.explicit_end, this.explicit_dur = e.explicit_dur, this.timeContainer = (function (e, t) { e = e && `timeContainer` in e.attributes ? e.attributes.timeContainer.value : null; return e && e !== `par` ? e === `seq` ? `seq` : (P(t, `Illegal value of timeContainer (assuming 'par')`), `par`) : `par`; }(n, r)); }, S.prototype.initFromNode = function (e, t, n) { o.prototype.initFromNode.call(this, e, null, t, n), l.prototype.initFromNode.call(this, e, null, t, n), s.prototype.initFromNode.call(this, e, null, t, n), a.prototype.initFromNode.call(this, e, null, t, n), u.prototype.initFromNode.call(this, e, null, t, n); }, A.prototype.initFromNode = function (e, t, n, r) { o.prototype.initFromNode.call(this, e, t, n, r), l.prototype.initFromNode.call(this, e, t, n, r), s.prototype.initFromNode.call(this, e, t, n, r), a.prototype.initFromNode.call(this, e, t, n, r), u.prototype.initFromNode.call(this, e, t, n, r); }, I.prototype.initFromNode = function (e, t, n, r) { o.prototype.initFromNode.call(this, e, t, n, r), l.prototype.initFromNode.call(this, e, t, n, r), s.prototype.initFromNode.call(this, e, t, n, r), a.prototype.initFromNode.call(this, e, t, n, r), u.prototype.initFromNode.call(this, e, t, n, r); }, R.prototype.initFromNode = function (e, t, n, r, i) { o.prototype.initFromNode.call(this, e, t, n, i), l.prototype.initFromNode.call(this, e, t, n, i), s.prototype.initFromNode.call(this, e, t, n, i), a.prototype.initFromNode.call(this, e, t, n, i), u.prototype.initFromNode.call(this, e, t, n, i), this.space = r; }, b.prototype.initFromText = function (e, t, n, r, i) { l.prototype.initFromNode.call(this, e, t, null, i), this.text = n, this.space = r; }, D.prototype.initFromNode = function (e, t, n, r) { a.prototype.initFromNode.call(this, e, t, n, r), l.prototype.initFromNode.call(this, e, t, n, r); }, M.prototype.createDefaultRegion = function () { const e = new M(); return i.call(e, ``), o.call(e, {}), s.call(e, []), l.call(e, 0, Number.POSITIVE_INFINITY, null), e; }, M.prototype.initFromNode = function (e, t, n) { i.prototype.initFromNode.call(this, e, null, t, n), o.prototype.initFromNode.call(this, e, null, t, n), l.prototype.initFromNode.call(this, e, null, t, n), s.prototype.initFromNode.call(this, e, null, t, n), e.head !== null && e.head.styling !== null && C(e.head.styling, f(t), this.styleAttrs, n); }, N.prototype.initFromNode = function (e, t, n, r) { l.prototype.initFromNode.call(this, e, t, n, r); let i; const a = c(n, r); for (i in this.qname = null, this.value = null, a) { if (this.qname) { P(r, `More than one style specified on set`); break; } this.qname = i, this.value = a[i]; } }; }, { 18: 18, 19: 19, 20: 20, 40: 40 }], 15: [function (e, t, n) { !(function (e, _) { function m (e, t, n) { for (const r in e) { const i = e[r].elements.length; const a = e[r].elements[e[r].start_elem]; const o = e[r].elements[e[r].end_elem]; const s = `${Math.ceil(t)}px`; const u = `-${Math.ceil(t)}px`; i !== 0 && (n.ipd === `lr` ? (a.node.style.borderLeftColor = a.bgcolor || `#00000000`, a.node.style.borderLeftStyle = `solid`, a.node.style.borderLeftWidth = s, a.node.style.marginLeft = u) : n.ipd === `rl` ? (a.node.style.borderRightColor = a.bgcolor || `#00000000`, a.node.style.borderRightStyle = `solid`, a.node.style.borderRightWidth = s, a.node.style.marginRight = u) : n.ipd === `tb` && (a.node.style.borderTopColor = a.bgcolor || `#00000000`, a.node.style.borderTopStyle = `solid`, a.node.style.borderTopWidth = s, a.node.style.marginTop = u), n.ipd === `lr` ? (o.node.style.borderRightColor = o.bgcolor || `#00000000`, o.node.style.borderRightStyle = `solid`, o.node.style.borderRightWidth = s, o.node.style.marginRight = u) : n.ipd === `rl` ? (o.node.style.borderLeftColor = o.bgcolor || `#00000000`, o.node.style.borderLeftStyle = `solid`, o.node.style.borderLeftWidth = s, o.node.style.marginLeft = u) : n.ipd === `tb` && (o.node.style.borderBottomColor = o.bgcolor || `#00000000`, o.node.style.borderBottomStyle = `solid`, o.node.style.borderBottomWidth = s, o.node.style.marginBottom = u)); } } function E (e) { for (let t = 0; t < e.length - 1; t++) { var n; let r = e[t].elements.length; r !== 0 && !1 === e[t].br && (n = document.createElement(`br`), (r = e[t].elements[r - 1].node).parentElement.insertBefore(n, r.nextSibling)); } } function y (e, t, n, r) { for (let i = Math.sign(n - t), a = 0; a <= e.length; a++) { var o; var s; const u = a === 0 ? t : a === e.length ? n : (e[a].before + e[a - 1].after) / 2; if (a > 0) for (let l = 0; l < e[a - 1].elements.length; l++)e[a - 1].elements[l].bgcolor !== null && i * ((s = e[a - 1].elements[l]).after - u) < 0 && (o = `${Math.ceil(Math.abs(u - s.after))}px`, s.node.style.backgroundColor = s.bgcolor, r.bpd === `lr` ? s.node.style.paddingRight = o : r.bpd === `rl` ? s.node.style.paddingLeft = o : r.bpd === `tb` && (s.node.style.paddingBottom = o)); if (a < e.length) for (let d = 0; d < e[a].elements.length; d++)(s = e[a].elements[d]).bgcolor !== null && i * (s.before - u) > 0 && (o = `${Math.ceil(Math.abs(s.before - u))}px`, s.node.style.backgroundColor = s.bgcolor, r.bpd === `lr` ? s.node.style.paddingLeft = o : r.bpd === `rl` ? s.node.style.paddingRight = o : r.bpd === `tb` && (s.node.style.paddingTop = o)); } } function v (e, t) { this.id = e, this.plist = t; } function T (e, t) { const n = { before: null, after: null, start: null, end: null }; return t.bpd === `tb` ? (n.before = e.top, n.after = e.bottom, t.ipd === `lr` ? (n.start = e.left, n.end = e.right) : (n.start = e.right, n.end = e.left)) : t.bpd === `lr` ? (n.before = e.left, n.after = e.right, n.start = e.top, n.end = e.bottom) : t.bpd === `rl` && (n.before = e.right, n.after = e.left, n.start = e.top, n.end = e.bottom), n; } function S (e, t, n, r) { const i = t.style.backgroundColor || r; if (t.childElementCount === 0) if (t.localName === `span`) { let a = t.getBoundingClientRect(); if (a.height === 0 || a.width === 0) return; let o; let s; const u = T(a, e); n.length !== 0 && (o = u.before, r = u.after, s = n[n.length - 1].before, a = n[n.length - 1].after, r < a && s < o || a <= r && o <= s) ? (o = Math.sign(u.after - u.before), s = Math.sign(u.end - u.start), o * (u.before - n[n.length - 1].before) < 0 && (n[n.length - 1].before = u.before), o * (u.after - n[n.length - 1].after) > 0 && (n[n.length - 1].after = u.after), s * (u.start - n[n.length - 1].start) < 0 && (n[n.length - 1].start = u.start, n[n.length - 1].start_elem = n[n.length - 1].elements.length), s * (u.end - n[n.length - 1].end) > 0 && (n[n.length - 1].end = u.end, n[n.length - 1].end_elem = n[n.length - 1].elements.length)) : n.push({ before: u.before, after: u.after, start: u.start, end: u.end, start_elem: 0, end_elem: 0, elements: [], text: ``, br: !1 }), n[n.length - 1].text += t.textContent, n[n.length - 1].elements.push({ node: t, bgcolor: i, before: u.before, after: u.after }); } else t.localName === `br` && n.length !== 0 && (n[n.length - 1].br = !0); else for (let l = t.firstChild; l;)l.nodeType === Node.ELEMENT_NODE && S(e, l, n, i), l = l.nextSibling; } function t (e, t) { this.qname = e, this.map = t; }e.render = function (e, t, n, r, i, a, o, s, u) { let l = r || t.clientHeight; var r = i || t.clientWidth; e.aspectRatio !== null && (r < (i = l * e.aspectRatio) ? l = Math.round(r / e.aspectRatio) : r = i); const d = document.createElement(`div`); d.style.position = `relative`, d.style.width = `${r}px`, d.style.height = `${l}px`, d.style.margin = `auto`, d.style.top = 0, d.style.bottom = 0, d.style.left = 0, d.style.right = 0, d.style.zIndex = 0; let f; const c = { h: l, w: r, regionH: null, regionW: null, imgResolver: n, displayForcedOnlyMode: a || !1, isd: e, errorHandler: o, previousISDState: s, enableRollUp: u || !1, currentISDState: {}, flg: null, lp: null, mra: null, ipd: null, bpd: null }; for (f in t.appendChild(d), e.contents)!(function e (t, n, r) { let i; r.kind === `region` ? (i = document.createElement(`div`)).style.position = `absolute` : r.kind === `body` || r.kind === `div` ? i = document.createElement(`div`) : r.kind === `p` ? i = document.createElement(`p`) : r.kind === `span` ? i = document.createElement(`span`) : r.kind === `br` && (i = document.createElement(`br`)); if (!i) return void I(t.errorHandler, `Error processing ISD element kind: ${r.kind}`); i.style.margin = `0`; for (const a in A) { const o = A[a]; const s = r.styleAttrs[o.qname]; void 0 !== s && o.map !== null && o.map(t, i, r, s); } let u = i; { r.kind === `region` && ((l = r.styleAttrs[_.byName.writingMode.qname]) === `lrtb` || l === `lr` ? (t.ipd = `lr`, t.bpd = `tb`) : l === `rltb` || l === `rl` ? (t.ipd = `rl`, t.bpd = `tb`) : l === `tblr` ? (t.ipd = `tb`, t.bpd = `lr`) : l !== `tbrl` && l !== `tb` || (t.ipd = `tb`, t.bpd = `rl`)); } var l = r.styleAttrs[_.byName.linePadding.qname]; { l && l > 0 && (d = `${Math.ceil(l * t.h)}px`, t.bpd === `tb` ? (u.style.paddingLeft = d, u.style.paddingRight = d) : (u.style.paddingTop = d, u.style.paddingBottom = d), t.lp = l); } var d = r.styleAttrs[_.byName.multiRowAlign.qname]; { d && d !== `auto` && ((l = document.createElement(`span`)).style.display = `inline-block`, l.style.textAlign = d, i.appendChild(l), u = l, t.mra = d); }r.styleAttrs[_.byName.fillLineGap.qname] && (t.flg = !0); if (r.kind === `span` && r.text) if (t.lp || t.mra || t.flg) for (let f = ``, c = 0; c < r.text.length; c++) { f += r.text.charAt(c); let h = r.text.charCodeAt(c); (h < 55296 || h > 56319 || c === r.text.length) && ((h = document.createElement(`span`)).textContent = f, i.appendChild(h), f = ``); } else i.textContent = r.text; n.appendChild(i); for (const p in r.contents)e(t, u, r.contents[p]); n = []; { (t.lp || t.mra || t.flg) && r.kind === `p` && (S(t, u, n, null), t.mra && (E(n), t.mra = null), t.lp && (m(n, t.lp * t.h, t), t.lp = null), t.flg && (g = T(u.getBoundingClientRect(), t), y(n, g.before, g.after, t), t.flg = null)); } { var g; r.kind === `region` && (S(t, u, n), t.bpd === `tb` && t.enableRollUp && r.contents.length > 0 && r.styleAttrs[_.byName.displayAlign.qname] === `after` && (g = r.id === `` ? `_` : r.id, g = new v(g, n), t.currentISDState[g.id] = g, t.previousISDState && g.id in t.previousISDState && t.previousISDState[g.id].plist.length > 0 && g.plist.length > 1 && g.plist[g.plist.length - 2].text === t.previousISDState[g.id].plist[t.previousISDState[g.id].plist.length - 1].text && (n = i.firstElementChild, g = g.plist[g.plist.length - 1].after - g.plist[g.plist.length - 1].before, n.style.bottom = `-${g}px`, n.style.transition = `transform 0.4s`, n.style.position = `relative`, n.style.transform = `translateY(-${g}px)`))); } }(c, d, e.contents[f])); return c.currentISDState; }; let n; var A = [new t(`http://www.w3.org/ns/ttml#styling backgroundColor`, (e, t, n, r) => { r[3] !== 0 && (t.style.backgroundColor = `rgba(${r[0].toString()},${r[1].toString()},${r[2].toString()},${(r[3] / 255).toString()})`); }), new t(`http://www.w3.org/ns/ttml#styling color`, (e, t, n, r) => { t.style.color = `rgba(${r[0].toString()},${r[1].toString()},${r[2].toString()},${(r[3] / 255).toString()})`; }), new t(`http://www.w3.org/ns/ttml#styling direction`, (e, t, n, r) => { t.style.direction = r; }), new t(`http://www.w3.org/ns/ttml#styling display`, (e, t, n, r) => {}), new t(`http://www.w3.org/ns/ttml#styling displayAlign`, (e, t, n, r) => { t.style.display = `flex`, t.style.flexDirection = `column`, r === `before` ? t.style.justifyContent = `flex-start` : r === `center` ? t.style.justifyContent = `center` : r === `after` && (t.style.justifyContent = `flex-end`); }), new t(`http://www.w3.org/ns/ttml#styling extent`, (e, t, n, r) => { e.regionH = r.h * e.h, e.regionW = r.w * e.w; let i = 0; var r = 0; var n = n.styleAttrs[`http://www.w3.org/ns/ttml#styling padding`]; n && (i = (n[0] + n[2]) * e.h, r = (n[1] + n[3]) * e.w), t.style.height = `${e.regionH - i}px`, t.style.width = `${e.regionW - r}px`; }), new t(`http://www.w3.org/ns/ttml#styling fontFamily`, (e, t, n, r) => { let i; const a = []; for (i in r)r[i] === `monospaceSerif` ? (a.push(`Courier New`), a.push(`"Liberation Mono"`), a.push(`Courier`), a.push(`monospace`)) : r[i] === `proportionalSansSerif` ? (a.push(`Arial`), a.push(`Helvetica`), a.push(`"Liberation Sans"`), a.push(`sans-serif`)) : r[i] === `monospace` ? a.push(`monospace`) : r[i] === `sansSerif` ? a.push(`sans-serif`) : r[i] === `serif` ? a.push(`serif`) : r[i] === `monospaceSansSerif` ? (a.push(`Consolas`), a.push(`monospace`)) : r[i] === `proportionalSerif` ? a.push(`serif`) : a.push(r[i]); t.style.fontFamily = a.join(`,`); }), new t(`http://www.w3.org/ns/ttml#styling fontSize`, (e, t, n, r) => { t.style.fontSize = `${r * e.h}px`; }), new t(`http://www.w3.org/ns/ttml#styling fontStyle`, (e, t, n, r) => { t.style.fontStyle = r; }), new t(`http://www.w3.org/ns/ttml#styling fontWeight`, (e, t, n, r) => { t.style.fontWeight = r; }), new t(`http://www.w3.org/ns/ttml#styling lineHeight`, (e, t, n, r) => { t.style.lineHeight = r === `normal` ? `normal` : `${r * e.h}px`; }), new t(`http://www.w3.org/ns/ttml#styling opacity`, (e, t, n, r) => { t.style.opacity = r; }), new t(`http://www.w3.org/ns/ttml#styling origin`, (e, t, n, r) => { t.style.top = `${r.h * e.h}px`, t.style.left = `${r.w * e.w}px`; }), new t(`http://www.w3.org/ns/ttml#styling overflow`, (e, t, n, r) => { t.style.overflow = r; }), new t(`http://www.w3.org/ns/ttml#styling padding`, (e, t, n, r) => { const i = []; i[0] = `${r[0] * e.h}px`, i[1] = `${r[3] * e.w}px`, i[2] = `${r[2] * e.h}px`, i[3] = `${r[1] * e.w}px`, t.style.padding = i.join(` `); }), new t(`http://www.w3.org/ns/ttml#styling showBackground`, null), new t(`http://www.w3.org/ns/ttml#styling textAlign`, (e, t, n, r) => { n = n.styleAttrs[_.byName.direction.qname], r = r === `start` ? n === `rtl` ? `right` : `left` : r === `end` ? n === `rtl` ? `left` : `right` : r; t.style.textAlign = r; }), new t(`http://www.w3.org/ns/ttml#styling textDecoration`, (e, t, n, r) => { t.style.textDecoration = r.join(` `).replace(`lineThrough`, `line-through`); }), new t(`http://www.w3.org/ns/ttml#styling textOutline`, (e, t, n, r) => { t.style.textShadow = r === `none` ? `` : `rgba(${r.color[0].toString()},${r.color[1].toString()},${r.color[2].toString()},${(r.color[3] / 255).toString()}) 0px 0px ${r.thickness * e.h}px`; }), new t(`http://www.w3.org/ns/ttml#styling unicodeBidi`, (e, t, n, r) => { r = r === `bidiOverride` ? `bidi-override` : r; t.style.unicodeBidi = r; }), new t(`http://www.w3.org/ns/ttml#styling visibility`, (e, t, n, r) => { t.style.visibility = r; }), new t(`http://www.w3.org/ns/ttml#styling wrapOption`, (e, t, n, r) => { r === `wrap` ? n.space === `preserve` ? t.style.whiteSpace = `pre-wrap` : t.style.whiteSpace = `normal` : n.space === `preserve` ? t.style.whiteSpace = `pre` : t.style.whiteSpace = `noWrap`; }), new t(`http://www.w3.org/ns/ttml#styling writingMode`, (e, t, n, r) => { r === `lrtb` || r === `lr` || r === `rltb` || r === `rl` ? t.style.writingMode = `horizontal-tb` : r === `tblr` ? t.style.writingMode = `vertical-lr` : r !== `tbrl` && r !== `tb` || (t.style.writingMode = `vertical-rl`); }), new t(`http://www.w3.org/ns/ttml#styling zIndex`, (e, t, n, r) => { t.style.zIndex = r; }), new t(`http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage`, (e, t, n, r) => { let i; e.imgResolver !== null && r !== null && (i = document.createElement(`img`), (r = e.imgResolver(r, i)) && (i.src = r), i.height = e.regionH, i.width = e.regionW, t.appendChild(i)); }), new t(`http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay`, (e, t, n, r) => { e.displayForcedOnlyMode && !1 === r && (t.style.visibility = `hidden`); })]; const r = {}; for (n in A)r[A[n].qname] = A[n]; function I (e, t) { if (e && e.error && e.error(t)) throw t; } }(void 0 === n ? this.imscHTML = {} : n, (typeof imscNames === `undefined` && e(18), typeof imscStyles === `undefined` ? e(19) : imscStyles))); }, { 18: 18, 19: 19 }], 16: [function (e, t, n) { function x (e, t) { if (`contents` in e) for (const n in e.contents)x(e.contents[n], t); else t.push(e); } function F (e) { if (e.kind !== `br`) { if (`text` in e) return e.text.length === 0; if (`contents` in e) { for (let t = e.contents.length; t--;)F(e.contents[t]) && e.contents.splice(t, 1); return e.contents.length === 0; } } } function s (e) { this.contents = [], this.aspectRatio = e.aspectRatio; } function U (e) { for (const t in this.kind = e.kind || `region`, e.id && (this.id = e.id), this.styleAttrs = {}, e.styleAttrs) this.styleAttrs[t] = e.styleAttrs[t]; `text` in e ? this.text = e.text : e.kind !== `br` && (this.contents = []), `space` in e && (this.space = e.space); } function B (e, t) { if (e && e.error && e.error(t)) throw t; } let k; n = void 0 === n ? this.imscISD = {} : n, typeof imscNames === `undefined` && e(18), k = typeof imscStyles === `undefined` ? e(19) : imscStyles, n.generateISD = function (e, t, n) { let r; const i = new s(e); const a = {}; for (r in e.head.layout.regions) { const o = (function e (t, n, r, i, a, o, s, u, l) { if (n < s.begin || n >= s.end) return null; const d = `regionID` in s && s.regionID !== `` ? s.regionID : o; if (a !== null && d !== r.id && (!(`contents` in s) || `contents` in s && s.contents.length === 0 || d !== ``)) return null; const f = new U(s); for (const c in s.sets)n < s.sets[c].begin || n >= s.sets[c].end || (f.styleAttrs[s.sets[c].qname] = s.sets[c].value); const h = {}; for (const p in f.styleAttrs) { var g; h[p] = !0, p !== k.byName.writingMode.qname || k.byName.direction.qname in f.styleAttrs || ((g = f.styleAttrs[p]) === `lrtb` || g === `lr` ? f.styleAttrs[k.byName.direction.qname] = `ltr` : g !== `rltb` && g !== `rl` || (f.styleAttrs[k.byName.direction.qname] = `rtl`)); } if (a !== null) for (const _ in k.all) { var m; var E; var y; const v = k.all[_]; v.qname === k.byName.textDecoration.qname ? (m = a.styleAttrs[v.qname], E = f.styleAttrs[v.qname], y = [], void 0 === E ? y = m : E.indexOf(`none`) === -1 ? ((E.indexOf(`noUnderline`) === -1 && m.indexOf(`underline`) !== -1 || E.indexOf(`underline`) !== -1) && y.push(`underline`), (E.indexOf(`noLineThrough`) === -1 && m.indexOf(`lineThrough`) !== -1 || E.indexOf(`lineThrough`) !== -1) && y.push(`lineThrough`), (E.indexOf(`noOverline`) === -1 && m.indexOf(`overline`) !== -1 || E.indexOf(`overline`) !== -1) && y.push(`overline`)) : y.push(`none`), f.styleAttrs[v.qname] = y) : v.inherit && v.qname in a.styleAttrs && !(v.qname in f.styleAttrs) && (f.styleAttrs[v.qname] = a.styleAttrs[v.qname]); } for (const T in k.all) { const S = k.all[T]; S.qname in f.styleAttrs || (f.kind === `region` || !1 === S.inherit && S.initial !== null) && (f.styleAttrs[S.qname] = S.parse(S.initial), h[S.qname] = !0); } for (const A in k.all) { var I; const R = k.all[A]; R.qname in h && R.compute !== null && ((I = R.compute(t, a, f, f.styleAttrs[R.qname], l)) !== null ? f.styleAttrs[R.qname] = I : B(u, `Style '${R.qname}' on element '${f.kind}' cannot be computed`)); } if (f.styleAttrs[k.byName.display.qname] === `none`) return null; let b; a === null ? b = i === null ? [] : [i] : `contents` in s && (b = s.contents); for (const D in b) { const M = e(t, n, r, i, f, d, b[D], u, l); M !== null && f.contents.push(M.element); } for (const N in f.styleAttrs) { const C = k.byQName[N]; C.applies.indexOf(f.kind) === -1 && delete f.styleAttrs[N]; } { f.kind === `span` && f.text && f.space === `default` && (o = f.text.replace(/\s+/g, ` `), f.text = o); } if (f.kind === `p`) { const w = []; x(f, w); for (let O = 0, P = `after_br`, L = 0; ;) if (P === `after_br`)O >= w.length || w[O].kind === `br` ? (P = `before_br`, L = O, O--) : (w[O].space !== `preserve` && (w[O].text = w[O].text.replace(/^\s+/g, ``)), w[O].text.length > 0 ? (P = `looking_br`, O++) : w.splice(O, 1)); else if (P === `before_br`) if (O < 0 || w[O].kind === `br`) { if (P = `after_br`, (O = L + 1) >= w.length) break; } else if (w[O].space !== `preserve` && (w[O].text = w[O].text.replace(/\s+$/g, ``)), w[O].text.length > 0) { if (P = `after_br`, (O = L + 1) >= w.length) break; } else w.splice(O, 1), O--; else O >= w.length || w[O].kind === `br` ? (P = `before_br`, L = O, O--) : O++; F(f); } if (f.kind === `div` && k.byName.backgroundImage.qname in f.styleAttrs || f.kind === `br` || `contents` in f && f.contents.length > 0 || f.kind === `span` && f.text !== null || f.kind === `region` && f.styleAttrs[k.byName.showBackground.qname] === `always`) return { region_id: d, element: f }; return null; }(e, t, e.head.layout.regions[r], e.body, null, ``, e.head.layout.regions[r], n, a)); o !== null && i.contents.push(o.element); } return i; }; }, { 18: 18, 19: 19 }], 17: [function (e, t, n) { n.generateISD = e(16).generateISD, n.fromXML = e(14).fromXML, n.renderHTML = e(15).render; }, { 14: 14, 15: 15, 16: 16 }], 18: [function (e, t, n) { (n = void 0 === n ? this.imscNames = {} : n).ns_tt = `http://www.w3.org/ns/ttml`, n.ns_tts = `http://www.w3.org/ns/ttml#styling`, n.ns_ttp = `http://www.w3.org/ns/ttml#parameter`, n.ns_xml = `http://www.w3.org/XML/1998/namespace`, n.ns_itts = `http://www.w3.org/ns/ttml/profile/imsc1#styling`, n.ns_ittp = `http://www.w3.org/ns/ttml/profile/imsc1#parameter`, n.ns_smpte = `http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt`, n.ns_ebutts = `urn:ebu:tt:style`; }, {}], 19: [function (e, t, n) { !(function (u, e, a) { function t (e, t, n, r, i, a, o, s) { this.name = t, this.ns = e, this.qname = `${e} ${t}`, this.inherit = i, this.animatable = a, this.initial = n, this.applies = r, this.parse = o, this.compute = s; } for (const n in u.all = [new t(e.ns_tts, `backgroundColor`, `transparent`, [`body`, `div`, `p`, `region`, `span`], !1, !0, a.parseColor, null), new t(e.ns_tts, `color`, `white`, [`span`], !0, !0, a.parseColor, null), new t(e.ns_tts, `direction`, `ltr`, [`p`, `span`], !0, !0, (e) => { return e; }, null), new t(e.ns_tts, `display`, `auto`, [`body`, `div`, `p`, `region`, `span`], !1, !0, (e) => { return e; }, null), new t(e.ns_tts, `displayAlign`, `before`, [`region`], !1, !0, (e) => { return e; }, null), new t(e.ns_tts, `extent`, `auto`, [`tt`, `region`], !1, !0, (e) => { if (e === `auto`) return e; let t = e.split(` `); if (t.length !== 2) return null; e = a.parseLength(t[0]), t = a.parseLength(t[1]); return t && e ? { h: t, w: e } : null; }, (e, t, n, r, i) => { let a, o; if (r === `auto`)a = 1; else if (r.h.unit === `%`)a = r.h.value / 100; else { if (r.h.unit !== `px`) return null; a = r.h.value / e.pxDimensions.h; } if (r === `auto`)o = 1; else if (r.w.unit === `%`)o = r.w.value / 100; else { if (r.w.unit !== `px`) return null; o = r.w.value / e.pxDimensions.w; } return { h: a, w: o }; }), new t(e.ns_tts, `fontFamily`, `default`, [`span`], !0, !0, (e) => { let t; const n = e.split(`,`); const r = []; for (t in n)n[t].charAt(0) !== `'` && n[t].charAt(0) !== `"` && n[t] === `default` ? r.push(`monospaceSerif`) : r.push(n[t]); return r; }, null), new t(e.ns_tts, `fontSize`, `1c`, [`span`], !0, !0, a.parseLength, (e, t, n, r, i) => { let a; if (r.unit === `%`)a = t !== null ? t.styleAttrs[u.byName.fontSize.qname] * r.value / 100 : r.value / 100 / e.cellResolution.h; else if (r.unit === `em`)a = t !== null ? t.styleAttrs[u.byName.fontSize.qname] * r.value : r.value / e.cellResolution.h; else if (r.unit === `c`)a = r.value / e.cellResolution.h; else { if (r.unit !== `px`) return null; a = r.value / e.pxDimensions.h; } return a; }), new t(e.ns_tts, `fontStyle`, `normal`, [`span`], !0, !0, (e) => { return e; }, null), new t(e.ns_tts, `fontWeight`, `normal`, [`span`], !0, !0, (e) => { return e; }, null), new t(e.ns_tts, `lineHeight`, `normal`, [`p`], !0, !0, (e) => { return e === `normal` ? e : a.parseLength(e); }, (e, t, n, r, i) => { let a; if (r === `normal`)a = r; else if (r.unit === `%`)a = n.styleAttrs[u.byName.fontSize.qname] * r.value / 100; else if (r.unit === `em`)a = n.styleAttrs[u.byName.fontSize.qname] * r.value; else if (r.unit === `c`)a = r.value / e.cellResolution.h; else { if (r.unit !== `px`) return null; a = r.value / e.pxDimensions.h; } return a; }), new t(e.ns_tts, `opacity`, 1, [`region`], !1, !0, parseFloat, null), new t(e.ns_tts, `origin`, `auto`, [`region`], !1, !0, (e) => { if (e === `auto`) return e; let t = e.split(` `); if (t.length !== 2) return null; e = a.parseLength(t[0]), t = a.parseLength(t[1]); return t && e ? { h: t, w: e } : null; }, (e, t, n, r, i) => { let a, o; if (r === `auto`)a = 0; else if (r.h.unit === `%`)a = r.h.value / 100; else { if (r.h.unit !== `px`) return null; a = r.h.value / e.pxDimensions.h; } if (r === `auto`)o = 0; else if (r.w.unit === `%`)o = r.w.value / 100; else { if (r.w.unit !== `px`) return null; o = r.w.value / e.pxDimensions.w; } return { h: a, w: o }; }), new t(e.ns_tts, `overflow`, `hidden`, [`region`], !1, !0, (e) => { return e; }, null), new t(e.ns_tts, `padding`, `0px`, [`region`], !1, !0, (e) => { const t = e.split(` `); if (t.length > 4) return null; let n; const r = []; for (n in t) { const i = a.parseLength(t[n]); if (!i) return null; r.push(i); } return r; }, (e, t, n, r, i) => { let a; if (r.length === 1)a = [r[0], r[0], r[0], r[0]]; else if (r.length === 2)a = [r[0], r[1], r[0], r[1]]; else if (r.length === 3)a = [r[0], r[1], r[2], r[1]]; else { if (r.length !== 4) return null; a = [r[0], r[1], r[2], r[3]]; }r = n.styleAttrs[u.byName.writingMode.qname]; if (r === `lrtb` || r === `lr`)a = [a[0], a[3], a[2], a[1]]; else if (r === `rltb` || r === `rl`)a = [a[0], a[1], a[2], a[3]]; else if (r === `tblr`)a = [a[3], a[0], a[1], a[2]]; else { if (r !== `tbrl` && r !== `tb`) return null; a = [a[3], a[2], a[1], a[0]]; } let o; const s = []; for (o in a) if (a[o].value === 0)s[o] = 0; else if (a[o].unit === `%`)s[o] = o === `0` || o === `2` ? n.styleAttrs[u.byName.extent.qname].h * a[o].value / 100 : n.styleAttrs[u.byName.extent.qname].w * a[o].value / 100; else if (a[o].unit === `em`)s[o] = n.styleAttrs[u.byName.fontSize.qname] * a[o].value; else if (a[o].unit === `c`)s[o] = a[o].value / e.cellResolution.h; else { if (a[o].unit !== `px`) return null; s[o] = o === `0` || o === `2` ? a[o].value / e.pxDimensions.h : a[o].value / e.pxDimensions.w; } return s; }), new t(e.ns_tts, `showBackground`, `always`, [`region`], !1, !0, (e) => { return e; }, null), new t(e.ns_tts, `textAlign`, `start`, [`p`], !0, !0, (e) => { return e; }, (e, t, n, r, i) => { return r === `left` ? `start` : r === `right` ? `end` : r; }), new t(e.ns_tts, `textDecoration`, `none`, [`span`], !0, !0, (e) => { return e.split(` `); }, null), new t(e.ns_tts, `textOutline`, `none`, [`span`], !0, !0, (e) => { if (e === `none`) return e; const t = {}; let n = e.split(` `); if (n.length === 0 || n.length > 2) return null; e = a.parseColor(n[0]); if ((t.color = e) !== null && n.shift(), n.length !== 1) return null; n = a.parseLength(n[0]); return n ? (t.thickness = n, t) : null; }, (e, t, n, r, i) => { if (r === `none`) return r; const a = {}; if (r.color === null ? a.color = n.styleAttrs[u.byName.color.qname] : a.color = r.color, r.thickness.unit === `%`)a.thickness = n.styleAttrs[u.byName.fontSize.qname] * r.thickness.value / 100; else if (r.thickness.unit === `em`)a.thickness = n.styleAttrs[u.byName.fontSize.qname] * r.thickness.value; else if (r.thickness.unit === `c`)a.thickness = r.thickness.value / e.cellResolution.h; else { if (r.thickness.unit !== `px`) return null; a.thickness = r.thickness.value / e.pxDimensions.h; } return a; }), new t(e.ns_tts, `unicodeBidi`, `normal`, [`span`, `p`], !1, !0, (e) => { return e; }, null), new t(e.ns_tts, `visibility`, `visible`, [`body`, `div`, `p`, `region`, `span`], !0, !0, (e) => { return e; }, null), new t(e.ns_tts, `wrapOption`, `wrap`, [`span`], !0, !0, (e) => { return e; }, null), new t(e.ns_tts, `writingMode`, `lrtb`, [`region`], !1, !0, (e) => { return e; }, null), new t(e.ns_tts, `zIndex`, `auto`, [`region`], !1, !0, (e) => { let t; return e === `auto` ? t = e : (t = parseInt(e), isNaN(t) && (t = null)), t; }, null), new t(e.ns_ebutts, `linePadding`, `0c`, [`p`], !0, !1, a.parseLength, (e, t, n, r, i) => { return r.unit === `c` ? r.value / e.cellResolution.h : null; }), new t(e.ns_ebutts, `multiRowAlign`, `auto`, [`p`], !0, !1, (e) => { return e; }, null), new t(e.ns_smpte, `backgroundImage`, null, [`div`], !1, !1, (e) => { return e; }, null), new t(e.ns_itts, `forcedDisplay`, `false`, [`body`, `div`, `p`, `region`, `span`], !0, !0, (e) => { return e === `true`; }, null), new t(e.ns_itts, `fillLineGap`, `false`, [`p`], !0, !0, (e) => { return e === `true`; }, null)], u.byQName = {}, u.all)u.byQName[u.all[n].qname] = u.all[n]; for (const r in u.byName = {}, u.all)u.byName[u.all[r].name] = u.all[r]; }(void 0 === n ? this.imscStyles = {} : n, typeof imscNames === `undefined` ? e(18) : imscNames, typeof imscUtils === `undefined` ? e(20) : imscUtils)); }, { 18: 18, 20: 20 }], 20: [function (e, t, n) { !(function (e) { const r = /#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/; const i = /rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/; const a = /rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/; const o = { transparent: [0, 0, 0, 0], black: [0, 0, 0, 255], silver: [192, 192, 192, 255], gray: [128, 128, 128, 255], white: [255, 255, 255, 255], maroon: [128, 0, 0, 255], red: [255, 0, 0, 255], purple: [128, 0, 128, 255], fuchsia: [255, 0, 255, 255], magenta: [255, 0, 255, 255], green: [0, 128, 0, 255], lime: [0, 255, 0, 255], olive: [128, 128, 0, 255], yellow: [255, 255, 0, 255], navy: [0, 0, 128, 255], blue: [0, 0, 255, 255], teal: [0, 128, 128, 255], aqua: [0, 255, 255, 255], cyan: [0, 255, 255, 255] }; e.parseColor = function (e) { let t = null; let n = o[e.toLowerCase()]; return void 0 !== n ? t = n : (n = r.exec(e)) !== null ? t = [parseInt(n[1], 16), parseInt(n[2], 16), parseInt(n[3], 16), void 0 !== n[4] ? parseInt(n[4], 16) : 255] : (n = i.exec(e)) !== null ? t = [parseInt(n[1]), parseInt(n[2]), parseInt(n[3]), 255] : (n = a.exec(e)) !== null && (t = [parseInt(n[1]), parseInt(n[2]), parseInt(n[3]), parseInt(n[4])]), t; }; const n = /^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/; e.parseLength = function (e) { let t = null; return (e = n.exec(e)) !== null && (t = { value: parseFloat(e[1]), unit: e[2] }), t; }; }(void 0 === n ? this.imscUtils = {} : n)); }, {}], 21: [function (e, t, n) { typeof Object.create === `function` ? t.exports = function (e, t) { e.super_ = t, e.prototype = Object.create(t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }); } : t.exports = function (e, t) { e.super_ = t; function n () {}n.prototype = t.prototype, e.prototype = new n(), e.prototype.constructor = e; }; }, {}], 22: [function (e, t, n) { function r (e) { return !!e.constructor && typeof e.constructor.isBuffer === `function` && e.constructor.isBuffer(e); }t.exports = function (e) { return e != null && (r(e) || typeof (t = e).readFloatLE === `function` && typeof t.slice === `function` && r(t.slice(0, 0)) || !!e._isBuffer); let t; }; }, {}], 23: [function (e, t, n) { const r = {}.toString; t.exports = Array.isArray || function (e) { return r.call(e) == `[object Array]`; }; }, {}], 24: [function (e, t, n) { (function (s) { "use strict"; !s.version || s.version.indexOf(`v0.`) === 0 || s.version.indexOf(`v1.`) === 0 && s.version.indexOf(`v1.8.`) !== 0 ? t.exports = { nextTick: function (e, t, n, r) { if (typeof e !== `function`) throw new TypeError(`"callback" argument must be a function`); let i; let a; const o = arguments.length; switch (o) { case 0:case 1:return s.nextTick(e); case 2:return s.nextTick(() => { e.call(null, t); }); case 3:return s.nextTick(() => { e.call(null, t, n); }); case 4:return s.nextTick(() => { e.call(null, t, n, r); }); default:for (i = new Array(o - 1), a = 0; a < i.length;)i[a++] = arguments[a]; return s.nextTick(() => { e.apply(null, i); }); } } } : t.exports = s; }).call(this, e(25)); }, { 25: 25 }], 25: [function (e, t, n) { let r; let i; var t = t.exports = {}; function a () { throw new Error(`setTimeout has not been defined`); } function o () { throw new Error(`clearTimeout has not been defined`); } function s (t) { if (r === setTimeout) return setTimeout(t, 0); if ((r === a || !r) && setTimeout) return r = setTimeout, setTimeout(t, 0); try { return r(t, 0); } catch (e) { try { return r.call(null, t, 0); } catch (e) { return r.call(this, t, 0); } } }!(function () { try { r = typeof setTimeout === `function` ? setTimeout : a; } catch (e) { r = a; } try { i = typeof clearTimeout === `function` ? clearTimeout : o; } catch (e) { i = o; } }()); let u; let l = []; let d = !1; let f = -1; function c () { d && u && (d = !1, u.length ? l = u.concat(l) : f = -1, l.length && h()); } function h () { if (!d) { const e = s(c); d = !0; for (let t = l.length; t;) { for (u = l, l = []; ++f < t;)u && u[f].run(); f = -1, t = l.length; }u = null, d = !1, (function (t) { if (i === clearTimeout) return clearTimeout(t); if ((i === o || !i) && clearTimeout) return i = clearTimeout, clearTimeout(t); try { i(t); } catch (e) { try { return i.call(null, t); } catch (e) { return i.call(this, t); } } }(e)); } } function p (e, t) { this.fun = e, this.array = t; } function g () {}t.nextTick = function (e) { const t = new Array(arguments.length - 1); if (arguments.length > 1) for (let n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; l.push(new p(e, t)), l.length !== 1 || d || s(h); }, p.prototype.run = function () { this.fun.apply(null, this.array); }, t.title = `browser`, t.browser = !0, t.env = {}, t.argv = [], t.version = ``, t.versions = {}, t.on = g, t.addListener = g, t.once = g, t.off = g, t.removeListener = g, t.removeAllListeners = g, t.emit = g, t.prependListener = g, t.prependOnceListener = g, t.listeners = function (e) { return []; }, t.binding = function (e) { throw new Error(`process.binding is not supported`); }, t.cwd = function () { return `/`; }, t.chdir = function (e) { throw new Error(`process.chdir is not supported`); }, t.umask = function () { return 0; }; }, {}], 26: [function (e, t, n) { t.exports = e(27); }, { 27: 27 }], 27: [function (e, t, n) { "use strict"; const r = e(24); const i = Object.keys || function (e) { let t; const n = []; for (t in e)n.push(t); return n; }; t.exports = d; t = e(10); t.inherits = e(21); const a = e(29); const o = e(31); t.inherits(d, a); for (let s = i(o.prototype), u = 0; u < s.length; u++) { const l = s[u]; d.prototype[l] || (d.prototype[l] = o.prototype[l]); } function d (e) { if (!(this instanceof d)) return new d(e); a.call(this, e), o.call(this, e), e && !1 === e.readable && (this.readable = !1), e && !1 === e.writable && (this.writable = !1), this.allowHalfOpen = !0, e && !1 === e.allowHalfOpen && (this.allowHalfOpen = !1), this.once(`end`, f); } function f () { this.allowHalfOpen || this._writableState.ended || r.nextTick(c, this); } function c (e) { e.end(); }Object.defineProperty(d.prototype, `writableHighWaterMark`, { enumerable: !1, get: function () { return this._writableState.highWaterMark; } }), Object.defineProperty(d.prototype, `destroyed`, { get: function () { return void 0 !== this._readableState && void 0 !== this._writableState && (this._readableState.destroyed && this._writableState.destroyed); }, set: function (e) { void 0 !== this._readableState && void 0 !== this._writableState && (this._readableState.destroyed = e, this._writableState.destroyed = e); } }), d.prototype._destroy = function (e, t) { this.push(null), this.end(), r.nextTick(t, e); }; }, { 10: 10, 21: 21, 24: 24, 29: 29, 31: 31 }], 28: [function (e, t, n) { "use strict"; t.exports = i; const r = e(30); var t = e(10); function i (e) { if (!(this instanceof i)) return new i(e); r.call(this, e); }t.inherits = e(21), t.inherits(i, r), i.prototype._transform = function (e, t, n) { n(null, e); }; }, { 10: 10, 21: 21, 30: 30 }], 29: [function (w, O, e) { (function (g, e) { "use strict"; const _ = w(24); O.exports = i; let a; const m = w(23); i.ReadableState = r; function E (e, t) { return e.listeners(t).length; }w(11).EventEmitter; const n = w(34); const s = w(39).Buffer; const u = e.Uint8Array || function () {}; const t = w(10); t.inherits = w(21); let o; var e = w(7); var y = void 0; var y = e && e.debuglog ? e.debuglog(`stream`) : function () {}; const l = w(32); var e = w(33); t.inherits(i, n); const d = [`error`, `close`, `destroy`, `pause`, `resume`]; function r (e, t) { e = e || {}; const n = t instanceof (a = a || w(27)); this.objectMode = !!e.objectMode, n && (this.objectMode = this.objectMode || !!e.readableObjectMode); const r = e.highWaterMark; const i = e.readableHighWaterMark; var t = this.objectMode ? 16 : 16384; this.highWaterMark = r || r === 0 ? r : n && (i || i === 0) ? i : t, this.highWaterMark = Math.floor(this.highWaterMark), this.buffer = new l(), this.length = 0, this.pipes = null, this.pipesCount = 0, this.flowing = null, this.ended = !1, this.endEmitted = !1, this.reading = !1, this.sync = !0, this.needReadable = !1, this.emittedReadable = !1, this.readableListening = !1, this.resumeScheduled = !1, this.destroyed = !1, this.defaultEncoding = e.defaultEncoding || `utf8`, this.awaitDrain = 0, this.readingMore = !1, this.decoder = null, this.encoding = null, e.encoding && (o = o || w(42).StringDecoder, this.decoder = new o(e.encoding), this.encoding = e.encoding); } function i (e) { if (a = a || w(27), !(this instanceof i)) return new i(e); this._readableState = new r(e, this), this.readable = !0, e && (typeof e.read === `function` && (this._read = e.read), typeof e.destroy === `function` && (this._destroy = e.destroy)), n.call(this); } function f (e, t, n, r, i) { let a; let o = e._readableState; return t === null ? (o.reading = !1, (function (e, t) { if (t.ended) return; { let n; !t.decoder || (n = t.decoder.end()) && n.length && (t.buffer.push(n), t.length += t.objectMode ? 1 : n.length); }t.ended = !0, v(e); }(e, o))) : (i || (a = (function (e, t) { let n; (function (e) { return s.isBuffer(e) || e instanceof u; })(t) || typeof t === `string` || void 0 === t || e.objectMode || (n = new TypeError(`Invalid non-string/buffer chunk`)); return n; }(o, t))), a ? e.emit(`error`, a) : o.objectMode || t && t.length > 0 ? (typeof t === `string` || o.objectMode || Object.getPrototypeOf(t) === s.prototype || (a = t, t = s.from(a)), r ? o.endEmitted ? e.emit(`error`, new Error(`stream.unshift() after end event`)) : c(e, o, t, !0) : o.ended ? e.emit(`error`, new Error(`stream.push() after EOF`)) : (o.reading = !1, o.decoder && !n ? (t = o.decoder.write(t), o.objectMode || t.length !== 0 ? c(e, o, t, !1) : S(e, o)) : c(e, o, t, !1))) : r || (o.reading = !1)), !(o = o).ended && (o.needReadable || o.length < o.highWaterMark || o.length === 0); } function c (e, t, n, r) { t.flowing && t.length === 0 && !t.sync ? (e.emit(`data`, n), e.read(0)) : (t.length += t.objectMode ? 1 : n.length, r ? t.buffer.unshift(n) : t.buffer.push(n), t.needReadable && v(e)), S(e, t); }Object.defineProperty(i.prototype, `destroyed`, { get: function () { return void 0 !== this._readableState && this._readableState.destroyed; }, set: function (e) { this._readableState && (this._readableState.destroyed = e); } }), i.prototype.destroy = e.destroy, i.prototype._undestroy = e.undestroy, i.prototype._destroy = function (e, t) { this.push(null), t(e); }, i.prototype.push = function (e, t) { let n; const r = this._readableState; return r.objectMode ? n = !0 : typeof e === `string` && ((t = t || r.defaultEncoding) !== r.encoding && (e = s.from(e, t), t = ``), n = !0), f(this, e, t, !1, n); }, i.prototype.unshift = function (e) { return f(this, e, null, !0, !1); }, i.prototype.isPaused = function () { return !1 === this._readableState.flowing; }, i.prototype.setEncoding = function (e) { return o = o || w(42).StringDecoder, this._readableState.decoder = new o(e), this._readableState.encoding = e, this; }; const h = 8388608; function p (e, t) { return e <= 0 || t.length === 0 && t.ended ? 0 : t.objectMode ? 1 : e != e ? (t.flowing && t.length ? t.buffer.head.data : t).length : (e > t.highWaterMark && (t.highWaterMark = (h <= (n = e) ? n = h : (n--, n |= n >>> 1, n |= n >>> 2, n |= n >>> 4, n |= n >>> 8, n |= n >>> 16, n++), n)), e <= t.length ? e : t.ended ? t.length : (t.needReadable = !0, 0)); let n; } function v (e) { const t = e._readableState; t.needReadable = !1, t.emittedReadable || (y(`emitReadable`, t.flowing), t.emittedReadable = !0, t.sync ? _.nextTick(T, e) : T(e)); } function T (e) { y(`emit readable`), e.emit(`readable`), b(e); } function S (e, t) { t.readingMore || (t.readingMore = !0, _.nextTick(A, e, t)); } function A (e, t) { for (let n = t.length; !t.reading && !t.flowing && !t.ended && t.length < t.highWaterMark && (y(`maybeReadMore read 0`), e.read(0), n !== t.length);)n = t.length; t.readingMore = !1; } function I (e) { y(`readable nexttick read 0`), e.read(0); } function R (e, t) { t.reading || (y(`resume read 0`), e.read(0)), t.resumeScheduled = !1, t.awaitDrain = 0, e.emit(`resume`), b(e), t.flowing && !t.reading && e.read(0); } function b (e) { const t = e._readableState; for (y(`flow`, t.flowing); t.flowing && e.read() !== null;); } function D (e, t) { return t.length === 0 ? null : (t.objectMode ? n = t.buffer.shift() : !e || e >= t.length ? (n = t.decoder ? t.buffer.join(``) : t.buffer.length === 1 ? t.buffer.head.data : t.buffer.concat(t.length), t.buffer.clear()) : n = (function (e, t, n) { let r; e < t.head.data.length ? (r = t.head.data.slice(0, e), t.head.data = t.head.data.slice(e)) : r = e === t.head.data.length ? t.shift() : (n ? function (e, t) { let n = t.head; let r = 1; let i = n.data; e -= i.length; for (;n = n.next;) { const a = n.data; const o = e > a.length ? a.length : e; if (o === a.length ? i += a : i += a.slice(0, e), (e -= o) === 0) { o === a.length ? (++r, n.next ? t.head = n.next : t.head = t.tail = null) : (t.head = n).data = a.slice(o); break; }++r; } return t.length -= r, i; } : function (e, t) { const n = s.allocUnsafe(e); let r = t.head; let i = 1; r.data.copy(n), e -= r.data.length; for (;r = r.next;) { const a = r.data; const o = e > a.length ? a.length : e; if (a.copy(n, n.length - e, 0, o), (e -= o) === 0) { o === a.length ? (++i, r.next ? t.head = r.next : t.head = t.tail = null) : (t.head = r).data = a.slice(o); break; }++i; } return t.length -= i, n; })(e, t); return r; }(e, t.buffer, t.decoder)), n); let n; } function M (e) { const t = e._readableState; if (t.length > 0) throw new Error(`"endReadable()" called on non-empty stream`); t.endEmitted || (t.ended = !0, _.nextTick(N, t, e)); } function N (e, t) { e.endEmitted || e.length !== 0 || (e.endEmitted = !0, t.readable = !1, t.emit(`end`)); } function C (e, t) { for (let n = 0, r = e.length; n < r; n++) if (e[n] === t) return n; return -1; }i.prototype.read = function (e) { y(`read`, e), e = parseInt(e, 10); const t = this._readableState; const n = e; if (e !== 0 && (t.emittedReadable = !1), e === 0 && t.needReadable && (t.length >= t.highWaterMark || t.ended)) return y(`read: emitReadable`, t.length, t.ended), (t.length === 0 && t.ended ? M : v)(this), null; if ((e = p(e, t)) === 0 && t.ended) return t.length === 0 && M(this), null; let r = t.needReadable; return y(`need readable`, r), (t.length === 0 || t.length - e < t.highWaterMark) && y(`length less than watermark`, r = !0), t.ended || t.reading ? y(`reading or ended`, r = !1) : r && (y(`do read`), t.reading = !0, t.sync = !0, t.length === 0 && (t.needReadable = !0), this._read(t.highWaterMark), t.sync = !1, t.reading || (e = p(n, t))), (r = e > 0 ? D(e, t) : null) === null ? (t.needReadable = !0, e = 0) : t.length -= e, t.length === 0 && (t.ended || (t.needReadable = !0), n !== e && t.ended && M(this)), r !== null && this.emit(`data`, r), r; }, i.prototype._read = function (e) { this.emit(`error`, new Error(`_read() is not implemented`)); }, i.prototype.pipe = function (n, e) { const r = this; const i = this._readableState; switch (i.pipesCount) { case 0:i.pipes = n; break; case 1:i.pipes = [i.pipes, n]; break; default:i.pipes.push(n); }i.pipesCount += 1, y(`pipe count=%d opts=%j`, i.pipesCount, e); e = (!e || !1 !== e.end) && n !== g.stdout && n !== g.stderr ? o : p; function a (e, t) { y(`onunpipe`), e === r && t && !1 === t.hasUnpiped && (t.hasUnpiped = !0, y(`cleanup`), n.removeListener(`close`, c), n.removeListener(`finish`, h), n.removeListener(`drain`, s), n.removeListener(`error`, f), n.removeListener(`unpipe`, a), r.removeListener(`end`, o), r.removeListener(`end`, p), r.removeListener(`data`, d), u = !0, !i.awaitDrain || n._writableState && !n._writableState.needDrain || s()); } function o () { y(`onend`), n.end(); }i.endEmitted ? _.nextTick(e) : r.once(`end`, e), n.on(`unpipe`, a); let t; var s = (t = r, function () { const e = t._readableState; y(`pipeOnDrain`, e.awaitDrain), e.awaitDrain && e.awaitDrain--, e.awaitDrain === 0 && E(t, `data`) && (e.flowing = !0, b(t)); }); n.on(`drain`, s); var u = !1; let l = !1; function d (e) { y(`ondata`), (l = !1) !== n.write(e) || l || ((i.pipesCount === 1 && i.pipes === n || i.pipesCount > 1 && C(i.pipes, n) !== -1) && !u && (y(`false write response, pause`, r._readableState.awaitDrain), r._readableState.awaitDrain++, l = !0), r.pause()); } function f (e) { y(`onerror`, e), p(), n.removeListener(`error`, f), E(n, `error`) === 0 && n.emit(`error`, e); } function c () { n.removeListener(`finish`, h), p(); } function h () { y(`onfinish`), n.removeListener(`close`, c), p(); } function p () { y(`unpipe`), r.unpipe(n); } return r.on(`data`, d), (function (e, t, n) { if (typeof e.prependListener === `function`) return e.prependListener(t, n); e._events && e._events[t] ? m(e._events[t]) ? e._events[t].unshift(n) : e._events[t] = [n, e._events[t]] : e.on(t, n); }(n, `error`, f)), n.once(`close`, c), n.once(`finish`, h), n.emit(`pipe`, r), i.flowing || (y(`pipe resume`), r.resume()), n; }, i.prototype.unpipe = function (e) { const t = this._readableState; const n = { hasUnpiped: !1 }; if (t.pipesCount === 0) return this; if (t.pipesCount === 1) return e && e !== t.pipes || (e = e || t.pipes, t.pipes = null, t.pipesCount = 0, t.flowing = !1, e && e.emit(`unpipe`, this, n)), this; if (!e) { const r = t.pipes; const i = t.pipesCount; t.pipes = null, t.pipesCount = 0, t.flowing = !1; for (let a = 0; a < i; a++)r[a].emit(`unpipe`, this, n); return this; } const o = C(t.pipes, e); return o === -1 || (t.pipes.splice(o, 1), --t.pipesCount, t.pipesCount === 1 && (t.pipes = t.pipes[0]), e.emit(`unpipe`, this, n)), this; }, i.prototype.addListener = i.prototype.on = function (e, t) { t = n.prototype.on.call(this, e, t); return e === `data` ? !1 !== this._readableState.flowing && this.resume() : e === `readable` && ((e = this._readableState).endEmitted || e.readableListening || (e.readableListening = e.needReadable = !0, e.emittedReadable = !1, e.reading ? e.length && v(this) : _.nextTick(I, this))), t; }, i.prototype.resume = function () { let e; let t = this._readableState; return t.flowing || (y(`resume`), t.flowing = !0, e = this, (t = t).resumeScheduled || (t.resumeScheduled = !0, _.nextTick(R, e, t))), this; }, i.prototype.pause = function () { return y(`call pause flowing=%j`, this._readableState.flowing), !1 !== this._readableState.flowing && (y(`pause`), this._readableState.flowing = !1, this.emit(`pause`)), this; }, i.prototype.wrap = function (t) { let e; const n = this; const r = this._readableState; let i = !1; for (e in t.on(`end`, () => { let e; y(`wrapped end`), !r.decoder || r.ended || (e = r.decoder.end()) && e.length && n.push(e), n.push(null); }), t.on(`data`, (e) => { y(`wrapped data`), r.decoder && (e = r.decoder.write(e)), r.objectMode && e == null || (r.objectMode || e && e.length) && (n.push(e) || (i = !0, t.pause())); }), t) void 0 === this[e] && typeof t[e] === `function` && (this[e] = (function (e) { return function () { return t[e].apply(t, arguments); }; }(e))); for (let a = 0; a < d.length; a++)t.on(d[a], this.emit.bind(this, d[a])); return this._read = function (e) { y(`wrapped _read`, e), i && (i = !1, t.resume()); }, this; }, Object.defineProperty(i.prototype, `readableHighWaterMark`, { enumerable: !1, get: function () { return this._readableState.highWaterMark; } }), i._fromList = D; }).call(this, w(25), typeof global !== `undefined` ? global : typeof self !== `undefined` ? self : typeof window !== `undefined` ? window : {}); }, { 10: 10, 11: 11, 21: 21, 23: 23, 24: 24, 25: 25, 27: 27, 32: 32, 33: 33, 34: 34, 39: 39, 42: 42, 7: 7 }], 30: [function (e, t, n) { "use strict"; t.exports = i; const r = e(27); var t = e(10); function i (e) { if (!(this instanceof i)) return new i(e); r.call(this, e), this._transformState = { afterTransform: function (e, t) { const n = this._transformState; n.transforming = !1; const r = n.writecb; if (!r) return this.emit(`error`, new Error(`write callback called multiple times`)); n.writechunk = null, (n.writecb = null) != t && this.push(t), r(e), (e = this._readableState).reading = !1, (e.needReadable || e.length < e.highWaterMark) && this._read(e.highWaterMark); }.bind(this), needTransform: !1, transforming: !1, writecb: null, writechunk: null, writeencoding: null }, this._readableState.needReadable = !0, this._readableState.sync = !1, e && (typeof e.transform === `function` && (this._transform = e.transform), typeof e.flush === `function` && (this._flush = e.flush)), this.on(`prefinish`, a); } function a () { const n = this; typeof this._flush === `function` ? this._flush((e, t) => { o(n, e, t); }) : o(this, null, null); } function o (e, t, n) { if (t) return e.emit(`error`, t); if (n != null && e.push(n), e._writableState.length) throw new Error(`Calling transform done when ws.length != 0`); if (e._transformState.transforming) throw new Error(`Calling transform done when still transforming`); return e.push(null); }t.inherits = e(21), t.inherits(i, r), i.prototype.push = function (e, t) { return this._transformState.needTransform = !1, r.prototype.push.call(this, e, t); }, i.prototype._transform = function (e, t, n) { throw new Error(`_transform() is not implemented`); }, i.prototype._write = function (e, t, n) { const r = this._transformState; r.writecb = n, r.writechunk = e, r.writeencoding = t, r.transforming || (t = this._readableState, (r.needTransform || t.needReadable || t.length < t.highWaterMark) && this._read(t.highWaterMark)); }, i.prototype._read = function (e) { const t = this._transformState; t.writechunk !== null && t.writecb && !t.transforming ? (t.transforming = !0, this._transform(t.writechunk, t.writeencoding, t.afterTransform)) : t.needTransform = !0; }, i.prototype._destroy = function (e, t) { const n = this; r.prototype._destroy.call(this, e, (e) => { t(e), n.emit(`close`); }); }; }, { 10: 10, 21: 21, 27: 27 }], 31: [function (T, S, e) { (function (e, t, n) { "use strict"; const c = T(24); function d (e) { const t = this; this.next = null, this.entry = null, this.finish = function () { !(function (e, t, n) { let r = e.entry; e.entry = null; for (;r;) { const i = r.callback; t.pendingcb--, i(n), r = r.next; }t.corkedRequestsFree ? t.corkedRequestsFree.next = e : t.corkedRequestsFree = e; }(t, e)); }; }S.exports = l; let o; const s = !e.browser && [`v0.10`, `v0.9.`].indexOf(e.version.slice(0, 5)) > -1 ? n : c.nextTick; l.WritableState = u; n = T(10); n.inherits = T(21); const r = { deprecate: T(44) }; const i = T(34); const h = T(39).Buffer; const p = t.Uint8Array || function () {}; let a; var t = T(33); function g () {} function u (e, t) { o = o || T(27), e = e || {}; const n = t instanceof o; this.objectMode = !!e.objectMode, n && (this.objectMode = this.objectMode || !!e.writableObjectMode); const r = e.highWaterMark; const i = e.writableHighWaterMark; let a = this.objectMode ? 16 : 16384; this.highWaterMark = r || r === 0 ? r : n && (i || i === 0) ? i : a, this.highWaterMark = Math.floor(this.highWaterMark), this.finalCalled = !1, this.needDrain = !1, this.ending = !1, this.ended = !1, this.finished = !1; a = (this.destroyed = !1) === e.decodeStrings; this.decodeStrings = !a, this.defaultEncoding = e.defaultEncoding || `utf8`, this.length = 0, this.writing = !1, this.corked = 0, this.sync = !0, this.bufferProcessing = !1, this.onwrite = function (e) { !(function (e, t) { const n = e._writableState; const r = n.sync; const i = n.writecb; { (function (e) { e.writing = !1, e.writecb = null, e.length -= e.writelen, e.writelen = 0; })(n), t ? (function (e, t, n, r, i) { --t.pendingcb, n ? (c.nextTick(i, r), c.nextTick(v, e, t), e._writableState.errorEmitted = !0, e.emit(`error`, r)) : (i(r), e._writableState.errorEmitted = !0, e.emit(`error`, r), v(e, t)); }(e, n, r, t, i)) : ((t = E(n)) || n.corked || n.bufferProcessing || !n.bufferedRequest || m(e, n), r ? s(f, e, n, t, i) : f(e, n, t, i)); } }(t, e)); }, this.writecb = null, this.writelen = 0, this.bufferedRequest = null, this.lastBufferedRequest = null, this.pendingcb = 0, this.prefinished = !1, this.errorEmitted = !1, this.bufferedRequestCount = 0, this.corkedRequestsFree = new d(this); } function l (e) { if (o = o || T(27), !(a.call(l, this) || this instanceof o)) return new l(e); this._writableState = new u(e, this), this.writable = !0, e && (typeof e.write === `function` && (this._write = e.write), typeof e.writev === `function` && (this._writev = e.writev), typeof e.destroy === `function` && (this._destroy = e.destroy), typeof e.final === `function` && (this._final = e.final)), i.call(this); } function _ (e, t, n, r, i, a, o) { t.writelen = r, t.writecb = o, t.writing = !0, t.sync = !0, n ? e._writev(i, t.onwrite) : e._write(i, a, t.onwrite), t.sync = !1; } function f (e, t, n, r) { let i; n || (i = e, (n = t).length === 0 && n.needDrain && (n.needDrain = !1, i.emit(`drain`))), t.pendingcb--, r(), v(e, t); } function m (e, t) { t.bufferProcessing = !0; let n = t.bufferedRequest; if (e._writev && n && n.next) { var r = t.bufferedRequestCount; const i = new Array(r); var r = t.corkedRequestsFree; r.entry = n; for (var a = 0, o = !0; n;)(i[a] = n).isBuf || (o = !1), n = n.next, a += 1; i.allBuffers = o, _(e, t, !0, t.length, i, ``, r.finish), t.pendingcb++, t.lastBufferedRequest = null, r.next ? (t.corkedRequestsFree = r.next, r.next = null) : t.corkedRequestsFree = new d(t), t.bufferedRequestCount = 0; } else { for (;n;) { const s = n.chunk; const u = n.encoding; const l = n.callback; if (_(e, t, !1, t.objectMode ? 1 : s.length, s, u, l), n = n.next, t.bufferedRequestCount--, t.writing) break; }n === null && (t.lastBufferedRequest = null); }t.bufferedRequest = n, t.bufferProcessing = !1; } function E (e) { return e.ending && e.length === 0 && e.bufferedRequest === null && !e.finished && !e.writing; } function y (t, n) { t._final((e) => { n.pendingcb--, e && t.emit(`error`, e), n.prefinished = !0, t.emit(`prefinish`), v(t, n); }); } function v (e, t) { let n; let r; const i = E(t); return i && (n = e, (r = t).prefinished || r.finalCalled || (typeof n._final === `function` ? (r.pendingcb++, r.finalCalled = !0, c.nextTick(y, n, r)) : (r.prefinished = !0, n.emit(`prefinish`))), t.pendingcb === 0 && (t.finished = !0, e.emit(`finish`))), i; }n.inherits(l, i), u.prototype.getBuffer = function () { for (var e = this.bufferedRequest, t = []; e;)t.push(e), e = e.next; return t; }, (function () { try { Object.defineProperty(u.prototype, `buffer`, { get: r.deprecate(function () { return this.getBuffer(); }, `_writableState.buffer is deprecated. Use _writableState.getBuffer instead.`, `DEP0003`) }); } catch (e) {} }()), typeof Symbol === `function` && Symbol.hasInstance && typeof Function.prototype[Symbol.hasInstance] === `function` ? (a = Function.prototype[Symbol.hasInstance], Object.defineProperty(l, Symbol.hasInstance, { value: function (e) { return !!a.call(this, e) || this === l && (e && e._writableState instanceof u); } })) : a = function (e) { return e instanceof this; }, l.prototype.pipe = function () { this.emit(`error`, new Error(`Cannot pipe, not readable`)); }, l.prototype.write = function (e, t, n) { let r; let i; let a; let o; let s; let u; const l = this._writableState; let d = !1; const f = !l.objectMode && (i = e, h.isBuffer(i) || i instanceof p); return f && !h.isBuffer(e) && (a = e, e = h.from(a)), typeof t === `function` && (n = t, t = null), t = f ? `buffer` : t || l.defaultEncoding, typeof n !== `function` && (n = g), l.ended ? (o = this, s = n, u = new Error(`write after end`), o.emit(`error`, u), c.nextTick(s, u)) : (f || (r = this, i = l, a = n, s = !(o = !0), (u = e) === null ? s = new TypeError(`May not write null values to stream`) : typeof u === `string` || void 0 === u || i.objectMode || (s = new TypeError(`Invalid non-string/buffer chunk`)), s && (r.emit(`error`, s), c.nextTick(a, s), o = !1), o)) && (l.pendingcb++, d = (function (e, t, n, r, i, a) { { n || (u = (function (e, t, n) { e.objectMode || !1 === e.decodeStrings || typeof t !== `string` || (t = h.from(t, n)); return t; }(t, r, i)), r !== u && (n = !0, i = `buffer`, r = u)); } const o = t.objectMode ? 1 : r.length; t.length += o; const s = t.length < t.highWaterMark; s || (t.needDrain = !0); { var u; t.writing || t.corked ? (u = t.lastBufferedRequest, t.lastBufferedRequest = { chunk: r, encoding: i, isBuf: n, callback: a, next: null }, u ? u.next = t.lastBufferedRequest : t.bufferedRequest = t.lastBufferedRequest, t.bufferedRequestCount += 1) : _(e, t, !1, o, r, i, a); } return s; }(this, l, f, e, t, n))), d; }, l.prototype.cork = function () { this._writableState.corked++; }, l.prototype.uncork = function () { const e = this._writableState; e.corked && (e.corked--, e.writing || e.corked || e.finished || e.bufferProcessing || !e.bufferedRequest || m(this, e)); }, l.prototype.setDefaultEncoding = function (e) { if (typeof e === `string` && (e = e.toLowerCase()), !([`hex`, `utf8`, `utf-8`, `ascii`, `binary`, `base64`, `ucs2`, `ucs-2`, `utf16le`, `utf-16le`, `raw`].indexOf((`${e}`).toLowerCase()) > -1)) throw new TypeError(`Unknown encoding: ${e}`); return this._writableState.defaultEncoding = e, this; }, Object.defineProperty(l.prototype, `writableHighWaterMark`, { enumerable: !1, get: function () { return this._writableState.highWaterMark; } }), l.prototype._write = function (e, t, n) { n(new Error(`_write() is not implemented`)); }, l.prototype._writev = null, l.prototype.end = function (e, t, n) { const r = this._writableState; typeof e === `function` ? (n = e, t = e = null) : typeof t === `function` && (n = t, t = null), e != null && this.write(e, t), r.corked && (r.corked = 1, this.uncork()), r.ending || r.finished || (function (e, t, n) { t.ending = !0, v(e, t), n && (t.finished ? c.nextTick(n) : e.once(`finish`, n)); t.ended = !0, e.writable = !1; }(this, r, n)); }, Object.defineProperty(l.prototype, `destroyed`, { get: function () { return void 0 !== this._writableState && this._writableState.destroyed; }, set: function (e) { this._writableState && (this._writableState.destroyed = e); } }), l.prototype.destroy = t.destroy, l.prototype._undestroy = t.undestroy, l.prototype._destroy = function (e, t) { this.end(), t(e); }; }).call(this, T(25), typeof global !== `undefined` ? global : typeof self !== `undefined` ? self : typeof window !== `undefined` ? window : {}, T(43).setImmediate); }, { 10: 10, 21: 21, 24: 24, 25: 25, 27: 27, 33: 33, 34: 34, 39: 39, 43: 43, 44: 44 }], 32: [function (e, t, n) { "use strict"; const s = e(39).Buffer; const r = e(7); function i () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, i)), this.head = null, this.tail = null, this.length = 0; }t.exports = (i.prototype.push = function (e) { e = { data: e, next: null }; this.length > 0 ? this.tail.next = e : this.head = e, this.tail = e, ++this.length; }, i.prototype.unshift = function (e) { e = { data: e, next: this.head }; this.length === 0 && (this.tail = e), this.head = e, ++this.length; }, i.prototype.shift = function () { if (this.length !== 0) { const e = this.head.data; return this.length === 1 ? this.head = this.tail = null : this.head = this.head.next, --this.length, e; } }, i.prototype.clear = function () { this.head = this.tail = null, this.length = 0; }, i.prototype.join = function (e) { if (this.length === 0) return ``; for (var t = this.head, n = `${t.data}`; t = t.next;)n += e + t.data; return n; }, i.prototype.concat = function (e) { if (this.length === 0) return s.alloc(0); if (this.length === 1) return this.head.data; for (var t, n, r, i = s.allocUnsafe(e >>> 0), a = this.head, o = 0; a;)t = a.data, n = i, r = o, t.copy(n, r), o += a.data.length, a = a.next; return i; }, i), r && r.inspect && r.inspect.custom && (t.exports.prototype[r.inspect.custom] = function () { const e = r.inspect({ length: this.length }); return `${this.constructor.name} ${e}`; }); }, { 39: 39, 7: 7 }], 33: [function (e, t, n) { "use strict"; const a = e(24); function o (e, t) { e.emit(`error`, t); }t.exports = { destroy: function (e, t) { const n = this; const r = this._readableState && this._readableState.destroyed; const i = this._writableState && this._writableState.destroyed; return r || i ? t ? t(e) : !e || this._writableState && this._writableState.errorEmitted || a.nextTick(o, this, e) : (this._readableState && (this._readableState.destroyed = !0), this._writableState && (this._writableState.destroyed = !0), this._destroy(e || null, (e) => { !t && e ? (a.nextTick(o, n, e), n._writableState && (n._writableState.errorEmitted = !0)) : t && t(e); })), this; }, undestroy: function () { this._readableState && (this._readableState.destroyed = !1, this._readableState.reading = !1, this._readableState.ended = !1, this._readableState.endEmitted = !1), this._writableState && (this._writableState.destroyed = !1, this._writableState.ended = !1, this._writableState.ending = !1, this._writableState.finished = !1, this._writableState.errorEmitted = !1); } }; }, { 24: 24 }], 34: [function (e, t, n) { t.exports = e(11).EventEmitter; }, { 11: 11 }], 35: [function (e, t, n) { t.exports = e(36).PassThrough; }, { 36: 36 }], 36: [function (e, t, n) { (((n = t.exports = e(29)).Stream = n).Readable = n).Writable = e(31), n.Duplex = e(27), n.Transform = e(30), n.PassThrough = e(28); }, { 27: 27, 28: 28, 29: 29, 30: 30, 31: 31 }], 37: [function (e, t, n) { t.exports = e(36).Transform; }, { 36: 36 }], 38: [function (e, t, n) { t.exports = e(31); }, { 31: 31 }], 39: [function (e, t, n) { const r = e(8); const i = r.Buffer; function a (e, t) { for (const n in e)t[n] = e[n]; } function o (e, t, n) { return i(e, t, n); }i.from && i.alloc && i.allocUnsafe && i.allocUnsafeSlow ? t.exports = r : (a(r, n), n.Buffer = o), a(i, o), o.from = function (e, t, n) { if (typeof e === `number`) throw new TypeError(`Argument must not be a number`); return i(e, t, n); }, o.alloc = function (e, t, n) { if (typeof e !== `number`) throw new TypeError(`Argument must be a number`); e = i(e); return void 0 !== t ? typeof n === `string` ? e.fill(t, n) : e.fill(t) : e.fill(0), e; }, o.allocUnsafe = function (e) { if (typeof e !== `number`) throw new TypeError(`Argument must be a number`); return i(e); }, o.allocUnsafeSlow = function (e) { if (typeof e !== `number`) throw new TypeError(`Argument must be a number`); return r.SlowBuffer(e); }; }, { 8: 8 }], 40: [function (G, e, t) { (function (k) { !(function (s) { s.parser = function (e, t) { return new i(e, t); }, s.SAXParser = i, s.SAXStream = o, s.createStream = function (e, t) { return new o(e, t); }, s.MAX_BUFFER_LENGTH = 65536; let r; const u = [`comment`, `sgmlDecl`, `textNode`, `tagName`, `doctype`, `procInstName`, `procInstBody`, `entity`, `attribName`, `attribValue`, `cdata`, `script`]; function i (e, t) { if (!(this instanceof i)) return new i(e, t); const n = this; !(function (e) { for (let t = 0, n = u.length; t < n; t++)e[u[t]] = ``; }(n)), n.q = n.c = ``, n.bufferCheckPosition = s.MAX_BUFFER_LENGTH, n.opt = t || {}, n.opt.lowercase = n.opt.lowercase || n.opt.lowercasetags, n.looseCase = n.opt.lowercase ? `toLowerCase` : `toUpperCase`, n.tags = [], n.closed = n.closedRoot = n.sawRoot = !1, n.tag = n.error = null, n.strict = !!e, n.noscript = !(!e && !n.opt.noscript), n.state = R.BEGIN, n.strictEntities = n.opt.strictEntities, n.ENTITIES = n.strictEntities ? Object.create(s.XML_ENTITIES) : Object.create(s.ENTITIES), n.attribList = [], n.opt.xmlns && (n.ns = Object.create(g)), n.trackPosition = !1 !== n.opt.position, n.trackPosition && (n.position = n.line = n.column = 0), b(n, `onready`); }s.EVENTS = [`text`, `processinginstruction`, `sgmldeclaration`, `doctype`, `comment`, `opentagstart`, `attribute`, `opentag`, `closetag`, `opencdata`, `cdata`, `closecdata`, `error`, `end`, `ready`, `script`, `opennamespace`, `closenamespace`], Object.create || (Object.create = function (e) { function t () {} return t.prototype = e, new t(); }), Object.keys || (Object.keys = function (e) { let t; const n = []; for (t in e)e.hasOwnProperty(t) && n.push(t); return n; }), i.prototype = { end: function () { w(this); }, write: function (e) { const t = this; if (this.error) throw this.error; if (t.closed) return C(t, `Cannot write after close. Assign an onready handler.`); if (e === null) return w(t); typeof e === `object` && (e = e.toString()); let n; let r; let i = 0; let a = ``; for (;a = B(e, i++), t.c = a;) switch (t.trackPosition && (t.position++, a === `\n` ? (t.line++, t.column = 0) : t.column++), t.state) { case R.BEGIN:if (t.state = R.BEGIN_WHITESPACE, a === `\ufeff`) continue; U(t, a); continue; case R.BEGIN_WHITESPACE:U(t, a); continue; case R.TEXT:if (t.sawRoot && !t.closedRoot) { for (var o = i - 1; a && a !== `<` && a !== `&`;)(a = B(e, i++)) && t.trackPosition && (t.position++, a === `\n` ? (t.line++, t.column = 0) : t.column++); t.textNode += e.substring(o, i - 1); }a !== `<` || t.sawRoot && t.closedRoot && !t.strict ? (!S(_, a) || t.sawRoot && !t.closedRoot || O(t, `Text data outside of root node.`), a === `&` ? t.state = R.TEXT_ENTITY : t.textNode += a) : (t.state = R.OPEN_WAKA, t.startTagPosition = t.position); continue; case R.SCRIPT:a === `<` ? t.state = R.SCRIPT_ENDING : t.script += a; continue; case R.SCRIPT_ENDING:a === `/` ? t.state = R.CLOSE_TAG : (t.script += `<${a}`, t.state = R.SCRIPT); continue; case R.OPEN_WAKA:a === `!` ? (t.state = R.SGML_DECL, t.sgmlDecl = ``) : T(_, a) || (T(m, a) ? (t.state = R.OPEN_TAG, t.tagName = a) : a === `/` ? (t.state = R.CLOSE_TAG, t.tagName = ``) : a === `?` ? (t.state = R.PROC_INST, t.procInstName = t.procInstBody = ``) : (O(t, `Unencoded <`), t.startTagPosition + 1 < t.position && (o = t.position - t.startTagPosition, a = new Array(o).join(` `) + a), t.textNode += `<${a}`, t.state = R.TEXT)); continue; case R.SGML_DECL:(t.sgmlDecl + a).toUpperCase() === f ? (D(t, `onopencdata`), t.state = R.CDATA, t.sgmlDecl = ``, t.cdata = ``) : t.sgmlDecl + a === `--` ? (t.state = R.COMMENT, t.comment = ``, t.sgmlDecl = ``) : (t.sgmlDecl + a).toUpperCase() === c ? (t.state = R.DOCTYPE, (t.doctype || t.sawRoot) && O(t, `Inappropriately located doctype declaration`), t.doctype = ``, t.sgmlDecl = ``) : a === `>` ? (D(t, `onsgmldeclaration`, t.sgmlDecl), t.sgmlDecl = ``, t.state = R.TEXT) : (T(l, a) && (t.state = R.SGML_DECL_QUOTED), t.sgmlDecl += a); continue; case R.SGML_DECL_QUOTED:a === t.q && (t.state = R.SGML_DECL, t.q = ``), t.sgmlDecl += a; continue; case R.DOCTYPE:a === `>` ? (t.state = R.TEXT, D(t, `ondoctype`, t.doctype), t.doctype = !0) : (t.doctype += a, a === `[` ? t.state = R.DOCTYPE_DTD : T(l, a) && (t.state = R.DOCTYPE_QUOTED, t.q = a)); continue; case R.DOCTYPE_QUOTED:t.doctype += a, a === t.q && (t.q = ``, t.state = R.DOCTYPE); continue; case R.DOCTYPE_DTD:t.doctype += a, a === `]` ? t.state = R.DOCTYPE : T(l, a) && (t.state = R.DOCTYPE_DTD_QUOTED, t.q = a); continue; case R.DOCTYPE_DTD_QUOTED:t.doctype += a, a === t.q && (t.state = R.DOCTYPE_DTD, t.q = ``); continue; case R.COMMENT:a === `-` ? t.state = R.COMMENT_ENDING : t.comment += a; continue; case R.COMMENT_ENDING:a === `-` ? (t.state = R.COMMENT_ENDED, t.comment = N(t.opt, t.comment), t.comment && D(t, `oncomment`, t.comment), t.comment = ``) : (t.comment += `-${a}`, t.state = R.COMMENT); continue; case R.COMMENT_ENDED:a !== `>` ? (O(t, `Malformed comment`), t.comment += `--${a}`, t.state = R.COMMENT) : t.state = R.TEXT; continue; case R.CDATA:a === `]` ? t.state = R.CDATA_ENDING : t.cdata += a; continue; case R.CDATA_ENDING:a === `]` ? t.state = R.CDATA_ENDING_2 : (t.cdata += `]${a}`, t.state = R.CDATA); continue; case R.CDATA_ENDING_2:a === `>` ? (t.cdata && D(t, `oncdata`, t.cdata), D(t, `onclosecdata`), t.cdata = ``, t.state = R.TEXT) : a === `]` ? t.cdata += `]` : (t.cdata += `]]${a}`, t.state = R.CDATA); continue; case R.PROC_INST:a === `?` ? t.state = R.PROC_INST_ENDING : T(_, a) ? t.state = R.PROC_INST_BODY : t.procInstName += a; continue; case R.PROC_INST_BODY:if (!t.procInstBody && T(_, a)) continue; a === `?` ? t.state = R.PROC_INST_ENDING : t.procInstBody += a; continue; case R.PROC_INST_ENDING:a === `>` ? (D(t, `onprocessinginstruction`, { name: t.procInstName, body: t.procInstBody }), t.procInstName = t.procInstBody = ``, t.state = R.TEXT) : (t.procInstBody += `?${a}`, t.state = R.PROC_INST_BODY); continue; case R.OPEN_TAG:T(E, a) ? t.tagName += a : ((function (e) { e.strict || (e.tagName = e.tagName[e.looseCase]()); const t = e.tags[e.tags.length - 1] || e; const n = e.tag = { name: e.tagName, attributes: {} }; e.opt.xmlns && (n.ns = t.ns); e.attribList.length = 0, D(e, `onopentagstart`, n); }(t)), a === `>` ? x(t) : a === `/` ? t.state = R.OPEN_TAG_SLASH : (S(_, a) && O(t, `Invalid character in tag name`), t.state = R.ATTRIB)); continue; case R.OPEN_TAG_SLASH:a === `>` ? (x(t, !0), F(t)) : (O(t, `Forward-slash in opening tag not followed by >`), t.state = R.ATTRIB); continue; case R.ATTRIB:if (T(_, a)) continue; a === `>` ? x(t) : a === `/` ? t.state = R.OPEN_TAG_SLASH : T(m, a) ? (t.attribName = a, t.attribValue = ``, t.state = R.ATTRIB_NAME) : O(t, `Invalid attribute name`); continue; case R.ATTRIB_NAME:a === `=` ? t.state = R.ATTRIB_VALUE : a === `>` ? (O(t, `Attribute without value`), t.attribValue = t.attribName, L(t), x(t)) : T(_, a) ? t.state = R.ATTRIB_NAME_SAW_WHITE : T(E, a) ? t.attribName += a : O(t, `Invalid attribute name`); continue; case R.ATTRIB_NAME_SAW_WHITE:if (a === `=`)t.state = R.ATTRIB_VALUE; else { if (T(_, a)) continue; O(t, `Attribute without value`), t.tag.attributes[t.attribName] = ``, t.attribValue = ``, D(t, `onattribute`, { name: t.attribName, value: `` }), t.attribName = ``, a === `>` ? x(t) : T(m, a) ? (t.attribName = a, t.state = R.ATTRIB_NAME) : (O(t, `Invalid attribute name`), t.state = R.ATTRIB); } continue; case R.ATTRIB_VALUE:if (T(_, a)) continue; T(l, a) ? (t.q = a, t.state = R.ATTRIB_VALUE_QUOTED) : (O(t, `Unquoted attribute value`), t.state = R.ATTRIB_VALUE_UNQUOTED, t.attribValue = a); continue; case R.ATTRIB_VALUE_QUOTED:if (a !== t.q) { a === `&` ? t.state = R.ATTRIB_VALUE_ENTITY_Q : t.attribValue += a; continue; }L(t), t.q = ``, t.state = R.ATTRIB_VALUE_CLOSED; continue; case R.ATTRIB_VALUE_CLOSED:T(_, a) ? t.state = R.ATTRIB : a === `>` ? x(t) : a === `/` ? t.state = R.OPEN_TAG_SLASH : T(m, a) ? (O(t, `No whitespace between attributes`), t.attribName = a, t.attribValue = ``, t.state = R.ATTRIB_NAME) : O(t, `Invalid attribute name`); continue; case R.ATTRIB_VALUE_UNQUOTED:if (S(d, a)) { a === `&` ? t.state = R.ATTRIB_VALUE_ENTITY_U : t.attribValue += a; continue; }L(t), a === `>` ? x(t) : t.state = R.ATTRIB; continue; case R.CLOSE_TAG:if (t.tagName)a === `>` ? F(t) : T(E, a) ? t.tagName += a : t.script ? (t.script += `</${t.tagName}`, t.tagName = ``, t.state = R.SCRIPT) : (S(_, a) && O(t, `Invalid tagname in closing tag`), t.state = R.CLOSE_TAG_SAW_WHITE); else { if (T(_, a)) continue; S(m, a) ? t.script ? (t.script += `</${a}`, t.state = R.SCRIPT) : O(t, `Invalid tagname in closing tag.`) : t.tagName = a; } continue; case R.CLOSE_TAG_SAW_WHITE:if (T(_, a)) continue; a === `>` ? F(t) : O(t, `Invalid characters in closing tag`); continue; case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:switch (t.state) { case R.TEXT_ENTITY:n = R.TEXT, r = `textNode`; break; case R.ATTRIB_VALUE_ENTITY_Q:n = R.ATTRIB_VALUE_QUOTED, r = `attribValue`; break; case R.ATTRIB_VALUE_ENTITY_U:n = R.ATTRIB_VALUE_UNQUOTED, r = `attribValue`; }a === `;` ? (t[r] += (function (e) { let t; let n = e.entity; const r = n.toLowerCase(); let i = ``; if (e.ENTITIES[n]) return e.ENTITIES[n]; if (e.ENTITIES[r]) return e.ENTITIES[r]; (n = r).charAt(0) === `#` && (i = n.charAt(1) === `x` ? (n = n.slice(2), (t = parseInt(n, 16)).toString(16)) : (n = n.slice(1), (t = parseInt(n, 10)).toString(10))); return n = n.replace(/^0+/, ``), i.toLowerCase() === n ? String.fromCodePoint(t) : (O(e, `Invalid character entity`), `&${e.entity};`); }(t)), t.entity = ``, t.state = n) : T(t.entity.length ? v : y, a) ? t.entity += a : (O(t, `Invalid character in entity name`), t[r] += `&${t.entity}${a}`, t.entity = ``, t.state = n); continue; default:throw new Error(t, `Unknown state: ${t.state}`); }t.position >= t.bufferCheckPosition && (function (e) { for (var t = Math.max(s.MAX_BUFFER_LENGTH, 10), n = 0, r = 0, i = u.length; r < i; r++) { const a = e[u[r]].length; if (t < a) switch (u[r]) { case `textNode`:M(e); break; case `cdata`:D(e, `oncdata`, e.cdata), e.cdata = ``; break; case `script`:D(e, `onscript`, e.script), e.script = ``; break; default:C(e, `Max buffer length exceeded: ${u[r]}`); }n = Math.max(n, a); } const o = s.MAX_BUFFER_LENGTH - n; e.bufferCheckPosition = o + e.position; }(t)); return t; }, resume: function () { return this.error = null, this; }, close: function () { return this.write(null); }, flush: function () { let e; M(e = this), e.cdata !== `` && (D(e, `oncdata`, e.cdata), e.cdata = ``), e.script !== `` && (D(e, `onscript`, e.script), e.script = ``); } }; try { r = G(41).Stream; } catch (e) { r = function () {}; } const a = s.EVENTS.filter((e) => { return e !== `error` && e !== `end`; }); function o (e, t) { if (!(this instanceof o)) return new o(e, t); r.apply(this), this._parser = new i(e, t), this.writable = !0, this.readable = !0; const n = this; this._parser.onend = function () { n.emit(`end`); }, this._parser.onerror = function (e) { n.emit(`error`, e), n._parser.error = null; }, this._decoder = null, a.forEach((t) => { Object.defineProperty(n, `on${t}`, { get: function () { return n._parser[`on${t}`]; }, set: function (e) { if (!e) return n.removeAllListeners(t), n._parser[`on${t}`] = e; n.on(t, e); }, enumerable: !0, configurable: !1 }); }); }(o.prototype = Object.create(r.prototype, { constructor: { value: o } })).write = function (e) { let t; return typeof k === `function` && typeof k.isBuffer === `function` && k.isBuffer(e) && (this._decoder || (t = G(42).StringDecoder, this._decoder = new t(`utf8`)), e = this._decoder.write(e)), this._parser.write(e.toString()), this.emit(`data`, e), !0; }, o.prototype.end = function (e) { return e && e.length && this.write(e), this._parser.end(), !0; }, o.prototype.on = function (t, e) { const n = this; return n._parser[`on${t}`] || a.indexOf(t) === -1 || (n._parser[`on${t}`] = function () { const e = arguments.length === 1 ? [arguments[0]] : Array.apply(null, arguments); e.splice(0, 0, t), n.emit.apply(n, e); }), r.prototype.on.call(n, t, e); }; var l = `'"`; var d = `${_ = `\r\n\t `}>`; var f = `[CDATA[`; var c = `DOCTYPE`; const h = `http://www.w3.org/XML/1998/namespace`; const p = `http://www.w3.org/2000/xmlns/`; var g = { xml: h, xmlns: p }; var _ = e(_); var m = (e(`0124356789`), e(`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`), /[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/); var E = /[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/; var y = /[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/; var v = /[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/; function e (e) { return e.split(``).reduce((e, t) => { return e[t] = !0, e; }, {}); } function T (e, t) { return n = e, Object.prototype.toString.call(n) === `[object RegExp]` ? t.match(e) : e[t]; let n; } function S (e, t) { return !T(e, t); }l = e(l), d = e(d); let t; let A; let I; var R = 0; for (t in s.STATE = { BEGIN: R++, BEGIN_WHITESPACE: R++, TEXT: R++, TEXT_ENTITY: R++, OPEN_WAKA: R++, SGML_DECL: R++, SGML_DECL_QUOTED: R++, DOCTYPE: R++, DOCTYPE_QUOTED: R++, DOCTYPE_DTD: R++, DOCTYPE_DTD_QUOTED: R++, COMMENT_STARTING: R++, COMMENT: R++, COMMENT_ENDING: R++, COMMENT_ENDED: R++, CDATA: R++, CDATA_ENDING: R++, CDATA_ENDING_2: R++, PROC_INST: R++, PROC_INST_BODY: R++, PROC_INST_ENDING: R++, OPEN_TAG: R++, OPEN_TAG_SLASH: R++, ATTRIB: R++, ATTRIB_NAME: R++, ATTRIB_NAME_SAW_WHITE: R++, ATTRIB_VALUE: R++, ATTRIB_VALUE_QUOTED: R++, ATTRIB_VALUE_CLOSED: R++, ATTRIB_VALUE_UNQUOTED: R++, ATTRIB_VALUE_ENTITY_Q: R++, ATTRIB_VALUE_ENTITY_U: R++, CLOSE_TAG: R++, CLOSE_TAG_SAW_WHITE: R++, SCRIPT: R++, SCRIPT_ENDING: R++ }, s.XML_ENTITIES = { amp: `&`, gt: `>`, lt: `<`, quot: `"`, apos: `'` }, s.ENTITIES = { amp: `&`, gt: `>`, lt: `<`, quot: `"`, apos: `'`, AElig: 198, Aacute: 193, Acirc: 194, Agrave: 192, Aring: 197, Atilde: 195, Auml: 196, Ccedil: 199, ETH: 208, Eacute: 201, Ecirc: 202, Egrave: 200, Euml: 203, Iacute: 205, Icirc: 206, Igrave: 204, Iuml: 207, Ntilde: 209, Oacute: 211, Ocirc: 212, Ograve: 210, Oslash: 216, Otilde: 213, Ouml: 214, THORN: 222, Uacute: 218, Ucirc: 219, Ugrave: 217, Uuml: 220, Yacute: 221, aacute: 225, acirc: 226, aelig: 230, agrave: 224, aring: 229, atilde: 227, auml: 228, ccedil: 231, eacute: 233, ecirc: 234, egrave: 232, eth: 240, euml: 235, iacute: 237, icirc: 238, igrave: 236, iuml: 239, ntilde: 241, oacute: 243, ocirc: 244, ograve: 242, oslash: 248, otilde: 245, ouml: 246, szlig: 223, thorn: 254, uacute: 250, ucirc: 251, ugrave: 249, uuml: 252, yacute: 253, yuml: 255, copy: 169, reg: 174, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, ordf: 170, laquo: 171, not: 172, shy: 173, macr: 175, deg: 176, plusmn: 177, sup1: 185, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, times: 215, divide: 247, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, int: 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830 }, Object.keys(s.ENTITIES).forEach((e) => { var t = s.ENTITIES[e]; var t = typeof t === `number` ? String.fromCharCode(t) : t; s.ENTITIES[e] = t; }), s.STATE)s.STATE[s.STATE[t]] = t; function b (e, t, n) { e[t] && e[t](n); } function D (e, t, n) { e.textNode && M(e), b(e, t, n); } function M (e) { e.textNode = N(e.opt, e.textNode), e.textNode && b(e, `ontext`, e.textNode), e.textNode = ``; } function N (e, t) { return e.trim && (t = t.trim()), e.normalize && (t = t.replace(/\s+/g, ` `)), t; } function C (e, t) { return M(e), e.trackPosition && (t += `\nLine: ${e.line}\nColumn: ${e.column}\nChar: ${e.c}`), t = new Error(t), e.error = t, b(e, `onerror`, t), e; } function w (e) { return e.sawRoot && !e.closedRoot && O(e, `Unclosed root tag`), e.state !== R.BEGIN && e.state !== R.BEGIN_WHITESPACE && e.state !== R.TEXT && C(e, `Unexpected end`), M(e), e.c = ``, e.closed = !0, b(e, `onend`), i.call(e, e.strict, e.opt), e; } function O (e, t) { if (typeof e !== `object` || !(e instanceof i)) throw new Error(`bad call to strictFail`); e.strict && C(e, t); } function P (e, t) { var n = e.indexOf(`:`) < 0 ? [``, e] : e.split(`:`); let r = n[0]; var n = n[1]; return t && e === `xmlns` && (r = `xmlns`, n = ``), { prefix: r, local: n }; } function L (e) { let t, n, r; e.strict || (e.attribName = e.attribName[e.looseCase]()), e.attribList.indexOf(e.attribName) !== -1 || e.tag.attributes.hasOwnProperty(e.attribName) || (e.opt.xmlns ? (r = (n = P(e.attribName, !0)).prefix, t = n.local, r === `xmlns` && (t === `xml` && e.attribValue !== h ? O(e, `xml: prefix must be bound to ${h}\nActual: ${e.attribValue}`) : t === `xmlns` && e.attribValue !== p ? O(e, `xmlns: prefix must be bound to ${p}\nActual: ${e.attribValue}`) : (n = e.tag, r = e.tags[e.tags.length - 1] || e, n.ns === r.ns && (n.ns = Object.create(r.ns)), n.ns[t] = e.attribValue)), e.attribList.push([e.attribName, e.attribValue])) : (e.tag.attributes[e.attribName] = e.attribValue, D(e, `onattribute`, { name: e.attribName, value: e.attribValue }))), e.attribName = e.attribValue = ``; } function x (t, e) { if (t.opt.xmlns) { const n = t.tag; let r = P(t.tagName); n.prefix = r.prefix, n.local = r.local, n.uri = n.ns[r.prefix] || ``, n.prefix && !n.uri && (O(t, `Unbound namespace prefix: ${JSON.stringify(t.tagName)}`), n.uri = r.prefix); r = t.tags[t.tags.length - 1] || t; n.ns && r.ns !== n.ns && Object.keys(n.ns).forEach((e) => { D(t, `onopennamespace`, { prefix: e, uri: n.ns[e] }); }); for (let i = 0, a = t.attribList.length; i < a; i++) { var o = t.attribList[i]; const s = o[0]; const u = o[1]; var l = P(s, !0); const d = l.prefix; var o = l.local; var l = d !== `` && n.ns[d] || ``; var o = { name: s, value: u, prefix: d, local: o, uri: l }; d && d !== `xmlns` && !l && (O(t, `Unbound namespace prefix: ${JSON.stringify(d)}`), o.uri = d), t.tag.attributes[s] = o, D(t, `onattribute`, o); }t.attribList.length = 0; }t.tag.isSelfClosing = !!e, t.sawRoot = !0, t.tags.push(t.tag), D(t, `onopentag`, t.tag), e || (t.noscript || t.tagName.toLowerCase() !== `script` ? t.state = R.TEXT : t.state = R.SCRIPT, t.tag = null, t.tagName = ``), t.attribName = t.attribValue = ``, t.attribList.length = 0; } function F (n) { if (!n.tagName) return O(n, `Weird empty close tag.`), n.textNode += `</>`, void (n.state = R.TEXT); if (n.script) { if (n.tagName !== `script`) return n.script += `</${n.tagName}>`, n.tagName = ``, void (n.state = R.SCRIPT); D(n, `onscript`, n.script), n.script = ``; } let e = n.tags.length; let t = n.tagName; n.strict || (t = t[n.looseCase]()); for (let r = t; e--;) { if (n.tags[e].name === r) break; O(n, `Unexpected close tag`); } if (e < 0) return O(n, `Unmatched closing tag: ${n.tagName}`), n.textNode += `</${n.tagName}>`, void (n.state = R.TEXT); n.tagName = t; for (let i = n.tags.length; i-- > e;) { var a = n.tag = n.tags.pop(); n.tagName = n.tag.name, D(n, `onclosetag`, n.tagName); var o; const s = {}; for (o in a.ns)s[o] = a.ns[o]; const u = n.tags[n.tags.length - 1] || n; n.opt.xmlns && a.ns !== u.ns && Object.keys(a.ns).forEach((e) => { const t = a.ns[e]; D(n, `onclosenamespace`, { prefix: e, uri: t }); }); }e === 0 && (n.closedRoot = !0), n.tagName = n.attribValue = n.attribName = ``, n.attribList.length = 0, n.state = R.TEXT; } function U (e, t) { t === `<` ? (e.state = R.OPEN_WAKA, e.startTagPosition = e.position) : S(_, t) && (O(e, `Non-whitespace before first tag.`), e.textNode = t, e.state = R.TEXT); } function B (e, t) { let n = ``; return t < e.length && (n = e.charAt(t)), n; } function n () { let e; const t = []; let n = -1; const r = arguments.length; if (!r) return ``; for (var i = ``; ++n < r;) { let a = Number(arguments[n]); if (!isFinite(a) || a < 0 || a > 1114111 || I(a) !== a) throw RangeError(`Invalid code point: ${a}`); a <= 65535 ? t.push(a) : (e = 55296 + ((a -= 65536) >> 10), a = a % 1024 + 56320, t.push(e, a)), (n + 1 === r || t.length > 16384) && (i += A.apply(null, t), t.length = 0); } return i; }R = s.STATE, String.fromCodePoint || (A = String.fromCharCode, I = Math.floor, Object.defineProperty ? Object.defineProperty(String, `fromCodePoint`, { value: n, configurable: !0, writable: !0 }) : String.fromCodePoint = n); }(void 0 === t ? this.sax = {} : t)); }).call(this, G(8).Buffer); }, { 41: 41, 42: 42, 8: 8 }], 41: [function (e, t, n) { t.exports = r; const d = e(11).EventEmitter; function r () { d.call(this); }e(21)(r, d), r.Readable = e(36), r.Writable = e(38), r.Duplex = e(26), r.Transform = e(37), r.PassThrough = e(35), (r.Stream = r).prototype.pipe = function (t, e) { const n = this; function r (e) { t.writable && !1 === t.write(e) && n.pause && n.pause(); } function i () { n.readable && n.resume && n.resume(); }n.on(`data`, r), t.on(`drain`, i), t._isStdio || e && !1 === e.end || (n.on(`end`, o), n.on(`close`, s)); let a = !1; function o () { a || (a = !0, t.end()); } function s () { a || (a = !0, typeof t.destroy === `function` && t.destroy()); } function u (e) { if (l(), d.listenerCount(this, `error`) === 0) throw e; } function l () { n.removeListener(`data`, r), t.removeListener(`drain`, i), n.removeListener(`end`, o), n.removeListener(`close`, s), n.removeListener(`error`, u), t.removeListener(`error`, u), n.removeListener(`end`, l), n.removeListener(`close`, l), t.removeListener(`close`, l); } return n.on(`error`, u), t.on(`error`, u), n.on(`end`, l), n.on(`close`, l), t.on(`close`, l), t.emit(`pipe`, n), t; }; }, { 11: 11, 21: 21, 26: 26, 35: 35, 36: 36, 37: 37, 38: 38 }], 42: [function (e, t, n) { "use strict"; const r = e(39).Buffer; const i = r.isEncoding || function (e) { switch ((e = `${e}`) && e.toLowerCase()) { case `hex`:case `utf8`:case `utf-8`:case `ascii`:case `binary`:case `base64`:case `ucs2`:case `ucs-2`:case `utf16le`:case `utf-16le`:case `raw`:return !0; default:return !1; } }; function a (e) { const t = (function (e) { if (!e) return `utf8`; for (var t; ;) switch (e) { case `utf8`:case `utf-8`:return `utf8`; case `ucs2`:case `ucs-2`:case `utf16le`:case `utf-16le`:return `utf16le`; case `latin1`:case `binary`:return `latin1`; case `base64`:case `ascii`:case `hex`:return e; default:if (t) return; e = (`${e}`).toLowerCase(), t = !0; } }(e)); if (typeof t !== `string` && (r.isEncoding === i || !i(e))) throw new Error(`Unknown encoding: ${e}`); return t || e; } function o (e) { let t; switch (this.encoding = a(e), this.encoding) { case `utf16le`:this.text = l, this.end = d, t = 4; break; case `utf8`:this.fillLast = u, t = 4; break; case `base64`:this.text = f, this.end = c, t = 3; break; default:return this.write = h, void (this.end = p); } this.lastNeed = 0, this.lastTotal = 0, this.lastChar = r.allocUnsafe(t); } function s (e) { return e <= 127 ? 0 : e >> 5 == 6 ? 2 : e >> 4 == 14 ? 3 : e >> 3 == 30 ? 4 : e >> 6 == 2 ? -1 : -2; } function u (e) { const t = this.lastTotal - this.lastNeed; const n = (function (e, t) { if ((192 & t[0]) != 128) return e.lastNeed = 0, `�`; if (e.lastNeed > 1 && t.length > 1) { if ((192 & t[1]) != 128) return e.lastNeed = 1, `�`; if (e.lastNeed > 2 && t.length > 2 && (192 & t[2]) != 128) return e.lastNeed = 2, `�`; } }(this, e)); return void 0 !== n ? n : this.lastNeed <= e.length ? (e.copy(this.lastChar, t, 0, this.lastNeed), this.lastChar.toString(this.encoding, 0, this.lastTotal)) : (e.copy(this.lastChar, t, 0, e.length), void (this.lastNeed -= e.length)); } function l (e, t) { if ((e.length - t) % 2 != 0) return this.lastNeed = 1, this.lastTotal = 2, this.lastChar[0] = e[e.length - 1], e.toString(`utf16le`, t, e.length - 1); const n = e.toString(`utf16le`, t); if (n) { t = n.charCodeAt(n.length - 1); if (t >= 55296 && t <= 56319) return this.lastNeed = 2, this.lastTotal = 4, this.lastChar[0] = e[e.length - 2], this.lastChar[1] = e[e.length - 1], n.slice(0, -1); } return n; } function d (e) { const t = e && e.length ? this.write(e) : ``; if (this.lastNeed) { e = this.lastTotal - this.lastNeed; return t + this.lastChar.toString(`utf16le`, 0, e); } return t; } function f (e, t) { const n = (e.length - t) % 3; return n == 0 ? e.toString(`base64`, t) : (this.lastNeed = 3 - n, this.lastTotal = 3, n == 1 ? this.lastChar[0] = e[e.length - 1] : (this.lastChar[0] = e[e.length - 2], this.lastChar[1] = e[e.length - 1]), e.toString(`base64`, t, e.length - n)); } function c (e) { e = e && e.length ? this.write(e) : ``; return this.lastNeed ? e + this.lastChar.toString(`base64`, 0, 3 - this.lastNeed) : e; } function h (e) { return e.toString(this.encoding); } function p (e) { return e && e.length ? this.write(e) : ``; }(n.StringDecoder = o).prototype.write = function (e) { if (e.length === 0) return ``; let t, n; if (this.lastNeed) { if (void 0 === (t = this.fillLast(e))) return ``; n = this.lastNeed, this.lastNeed = 0; } else n = 0; return n < e.length ? t ? t + this.text(e, n) : this.text(e, n) : t || ``; }, o.prototype.end = function (e) { e = e && e.length ? this.write(e) : ``; return this.lastNeed ? `${e}�` : e; }, o.prototype.text = function (e, t) { let n = (function (e, t, n) { let r = t.length - 1; if (r < n) return 0; let i = s(t[r]); if (i >= 0) return i > 0 && (e.lastNeed = i - 1), i; if (--r < n || i === -2) return 0; if ((i = s(t[r])) >= 0) return i > 0 && (e.lastNeed = i - 2), i; if (--r < n || i === -2) return 0; if ((i = s(t[r])) >= 0) return i > 0 && (i === 2 ? i = 0 : e.lastNeed = i - 3), i; return 0; }(this, e, t)); if (!this.lastNeed) return e.toString(`utf8`, t); this.lastTotal = n; n = e.length - (n - this.lastNeed); return e.copy(this.lastChar, 0, n), e.toString(`utf8`, t, n); }, o.prototype.fillLast = function (e) { if (this.lastNeed <= e.length) return e.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, this.lastNeed), this.lastChar.toString(this.encoding, 0, this.lastTotal); e.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, e.length), this.lastNeed -= e.length; }; }, { 39: 39 }], 43: [function (u, e, l) { (function (e, t) { const r = u(25).nextTick; const n = Function.prototype.apply; const i = Array.prototype.slice; const a = {}; let o = 0; function s (e, t) { this._id = e, this._clearFn = t; }l.setTimeout = function () { return new s(n.call(setTimeout, window, arguments), clearTimeout); }, l.setInterval = function () { return new s(n.call(setInterval, window, arguments), clearInterval); }, l.clearTimeout = l.clearInterval = function (e) { e.close(); }, s.prototype.unref = s.prototype.ref = function () {}, s.prototype.close = function () { this._clearFn.call(window, this._id); }, l.enroll = function (e, t) { clearTimeout(e._idleTimeoutId), e._idleTimeout = t; }, l.unenroll = function (e) { clearTimeout(e._idleTimeoutId), e._idleTimeout = -1; }, l._unrefActive = l.active = function (e) { clearTimeout(e._idleTimeoutId); const t = e._idleTimeout; t >= 0 && (e._idleTimeoutId = setTimeout(() => { e._onTimeout && e._onTimeout(); }, t)); }, l.setImmediate = typeof e === `function` ? e : function (e) { const t = o++; const n = !(arguments.length < 2) && i.call(arguments, 1); return a[t] = !0, r(() => { a[t] && (n ? e.apply(null, n) : e.call(null), l.clearImmediate(t)); }), t; }, l.clearImmediate = typeof t === `function` ? t : function (e) { delete a[e]; }; }).call(this, u(43).setImmediate, u(43).clearImmediate); }, { 25: 25, 43: 43 }], 44: [function (e, n, t) { (function (t) { function r (e) { try { if (!t.localStorage) return; } catch (e) { return; }e = t.localStorage[e]; return e != null && String(e).toLowerCase() === `true`; }n.exports = function (e, t) { if (r(`noDeprecation`)) return e; let n = !1; return function () { if (!n) { if (r(`throwDeprecation`)) throw new Error(t); r(`traceDeprecation`) ? console.trace(t) : console.warn(t), n = !0; } return e.apply(this, arguments); }; }; }).call(this, typeof global !== `undefined` ? global : typeof self !== `undefined` ? self : typeof window !== `undefined` ? window : {}); }, {}], 45: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(46)); const h = r(e(54)); const a = r(e(47)); const o = 1; const p = 2; const g = 3; const _ = 4; const m = 5; function s (e) { e = e || {}; const t = this.context; const s = (0, i.default)(t).getInstance(); const u = e.settings; const l = []; var e = void 0; let d = void 0; let f = void 0; let c = void 0; function n (e) { return (e && e.bind ? e : window.console.log).bind(window.console); } function r (e, t) { let n; let r = ``; d && (n = (new Date()).getTime(), r += `[${n - c}]`), f && t && t.getClassName && (r += `[${t.getClassName()}]`, t.getType && (r += `[${t.getType()}]`)), r.length > 0 && (r += ` `); for (var i = arguments.length, a = Array(i > 2 ? i - 2 : 0), o = 2; o < i; o++)a[o - 2] = arguments[o]; Array.apply(null, a).forEach((e) => { r += `${e} `; }), l[e] && u.get().debug.logLevel >= e && l[e](r), u && u.get().debug.dispatchEvent && s.trigger(h.default.LOG, { message: r, level: e }); } return e = { getLogger: function (e) { return { fatal: function () { for (var e = arguments.length, t = Array(e), n = 0; n < e; n++)t[n] = arguments[n]; r.apply(void 0, [o, this].concat(t)); }.bind(e), error: function () { for (var e = arguments.length, t = Array(e), n = 0; n < e; n++)t[n] = arguments[n]; r.apply(void 0, [p, this].concat(t)); }.bind(e), warn: function () { for (var e = arguments.length, t = Array(e), n = 0; n < e; n++)t[n] = arguments[n]; r.apply(void 0, [g, this].concat(t)); }.bind(e), info: function () { for (var e = arguments.length, t = Array(e), n = 0; n < e; n++)t[n] = arguments[n]; r.apply(void 0, [_, this].concat(t)); }.bind(e), debug: function () { for (var e = arguments.length, t = Array(e), n = 0; n < e; n++)t[n] = arguments[n]; r.apply(void 0, [m, this].concat(t)); }.bind(e) }; }, setLogTimestampVisible: function (e) { d = e; }, setCalleeNameVisible: function (e) { f = e; } }, f = d = !0, c = (new Date()).getTime(), typeof window !== `undefined` && window.console && (l[o] = n(window.console.error), l[p] = n(window.console.error), l[g] = n(window.console.warn), l[_] = n(window.console.info), l[m] = n(window.console.debug)), e; }s.__dashjs_factory_name = `Debug`; e = a.default.getSingletonFactory(s); e.LOG_LEVEL_NONE = 0, e.LOG_LEVEL_FATAL = o, e.LOG_LEVEL_ERROR = p, e.LOG_LEVEL_WARNING = g, e.LOG_LEVEL_INFO = _, e.LOG_LEVEL_DEBUG = m, a.default.updateSingletonFactory(s.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 46: 46, 47: 47, 54: 54 }], 46: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); const a = (r = i) && r.__esModule ? r : { default: r }; const u = e(101); function o () { let o = {}; function s (e, n, r) { let i = -1; return o[e] && o[e].some((e, t) => { if (e && e.callback === n && (!r || r === e.scope)) return i = t, !0; }), i; } return { on: function (n, e, t) { const r = arguments.length <= 3 || void 0 === arguments[3] ? {} : arguments[3]; if (!n) throw new Error(`event type cannot be null or undefined`); if (!e || typeof e !== `function`) throw new Error(`listener must be a function: ${e}`); let i; const a = r.priority || 0; s(n, e, t) >= 0 || (o[n] = o[n] || [], i = { callback: e, scope: t, priority: a }, t && t.getStreamId && (i.streamId = t.getStreamId()), t && t.getType && (i.mediaType = t.getType()), r && r.mode && (i.mode = r.mode), o[n].some((e, t) => { if (e && a > e.priority) return o[n].splice(t, 0, i), !0; }) || o[n].push(i)); }, off: function (e, t, n) { e && t && o[e] && ((n = s(e, t, n)) < 0 || (o[e][n] = null)); }, trigger: function (e) { let t = arguments.length <= 1 || void 0 === arguments[1] ? {} : arguments[1]; const n = arguments.length <= 2 || void 0 === arguments[2] ? {} : arguments[2]; if (e && o[e]) { if ((t = t || {}).hasOwnProperty(`type`)) throw new Error(`'type' is a reserved word for event dispatching`); t.type = e, n.streamId && (t.streamId = n.streamId), n.mediaType && (t.mediaType = n.mediaType), o[e].filter((e) => { return !!e && ((!n.streamId || !e.streamId || e.streamId === n.streamId) && ((!n.mediaType || !e.mediaType || e.mediaType === n.mediaType) && !(n.mode && e.mode && e.mode !== n.mode || !e.mode && n.mode && n.mode === u.EVENT_MODE_ON_RECEIVE))); }).forEach((e) => { return e && e.callback.call(e.scope, t); }); } }, reset: function () { o = {}; } }; }o.__dashjs_factory_name = `EventBus`; e = a.default.getSingletonFactory(o); e.EVENT_PRIORITY_LOW = 0, e.EVENT_PRIORITY_HIGH = 5e3, a.default.updateSingletonFactory(o.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 101: 101, 47: 47 }], 47: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let u; let a; let r; let i; const o = (u = void 0, a = [], r = {}, i = {}, u = { extend: function (e, t, n, r) { !r[e] && t && (r[e] = { instance: t, override: n }); }, getSingletonInstance: s, setSingletonInstance: function (e, t, n) { for (const r in a) { const i = a[r]; if (i.context === e && i.name === t) return void (a[r].instance = n); }a.push({ name: t, context: e, instance: n }); }, deleteSingletonInstances: function (t) { a = a.filter((e) => { return e.context !== t; }); }, getSingletonFactory: function (n) { let e = l(n.__dashjs_factory_name, r); return e || (e = function (e) { let t = void 0; return void 0 === e && (e = {}), { getInstance: function () { return (t = t || s(e, n.__dashjs_factory_name)) || (t = f(n, e, arguments), a.push({ name: n.__dashjs_factory_name, context: e, instance: t })), t; } }; }, r[n.__dashjs_factory_name] = e), e; }, getSingletonFactoryByName: function (e) { return r[e]; }, updateSingletonFactory: function (e, t) { d(e, t, r); }, getClassFactory: function (t) { let e = l(t.__dashjs_factory_name, i); return e || (e = function (e) { return void 0 === e && (e = {}), { create: function () { return f(t, e, arguments); } }; }, i[t.__dashjs_factory_name] = e), e; }, getClassFactoryByName: function (e) { return i[e]; }, updateClassFactory: function (e, t) { d(e, t, i); } }); function s (e, t) { for (const n in a) { const r = a[n]; if (r.context === e && r.name === t) return r.instance; } return null; } function l (e, t) { return t[e]; } function d (e, t, n) { e in n && (n[e] = t); } function f (e, t, n) { let r = void 0; const i = e.__dashjs_factory_name; const a = t[i]; if (a) { let o; let s = a.instance; if (!a.override) return s.apply({ context: t, factory: u }, n); for (o in r = e.apply({ context: t }, n), s = s.apply({ context: t, factory: u, parent: r }, n))r.hasOwnProperty(o) && (r[o] = s[o]); } else r = e.apply({ context: t }, n); return r.getClassName = function () { return i; }, r; }n.default = o, t.exports = n.default; }, {}], 48: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; } function i (e, t, n) { return t in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e; }Object.defineProperty(n, `__esModule`, { value: !0 }); let a = r(e(47)); const o = r(e(49)); const s = r(e(45)); const u = r(e(108)); const l = e(248); function d () { let e; const t = { debug: { logLevel: s.default.LOG_LEVEL_WARNING, dispatchEvent: !1 }, streaming: { metricsMaxListDepth: 1e3, abandonLoadTimeout: 1e4, liveDelayFragmentCount: NaN, liveDelay: null, scheduleWhilePaused: !0, fastSwitchEnabled: !1, flushBufferAtTrackSwitch: !1, calcSegmentAvailabilityRangeFromTimeline: !1, reuseExistingSourceBuffers: !0, bufferPruningInterval: 10, bufferToKeep: 20, jumpGaps: !0, jumpLargeGaps: !0, smallGapLimit: 1.5, stableBufferTime: 12, bufferTimeAtTopQuality: 30, bufferTimeAtTopQualityLongForm: 60, longFormContentDurationThreshold: 600, wallclockTimeUpdateInterval: 50, lowLatencyEnabled: !1, keepProtectionMediaKeys: !1, useManifestDateHeaderTimeSource: !0, useSuggestedPresentationDelay: !0, useAppendWindow: !0, manifestUpdateRetryInterval: 100, stallThreshold: 0.5, liveCatchup: { minDrift: 0.02, maxDrift: 0, playbackRate: 0.5, latencyThreshold: 60, playbackBufferMin: 0.5, enabled: !1, mode: u.default.LIVE_CATCHUP_MODE_DEFAULT }, lastBitrateCachingInfo: { enabled: !0, ttl: 36e4 }, lastMediaSettingsCachingInfo: { enabled: !0, ttl: 36e4 }, cacheLoadThresholds: { video: 50, audio: 5 }, trackSwitchMode: { audio: u.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE, video: u.default.TRACK_SWITCH_MODE_NEVER_REPLACE }, selectionModeForInitialTrack: u.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE, fragmentRequestTimeout: 0, retryIntervals: (i(e = {}, l.HTTPRequest.MPD_TYPE, 500), i(e, l.HTTPRequest.XLINK_EXPANSION_TYPE, 500), i(e, l.HTTPRequest.MEDIA_SEGMENT_TYPE, 1e3), i(e, l.HTTPRequest.INIT_SEGMENT_TYPE, 1e3), i(e, l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE, 1e3), i(e, l.HTTPRequest.INDEX_SEGMENT_TYPE, 1e3), i(e, l.HTTPRequest.OTHER_TYPE, 1e3), i(e, `lowLatencyReductionFactor`, 10), e), retryAttempts: (i(e = {}, l.HTTPRequest.MPD_TYPE, 3), i(e, l.HTTPRequest.XLINK_EXPANSION_TYPE, 1), i(e, l.HTTPRequest.MEDIA_SEGMENT_TYPE, 3), i(e, l.HTTPRequest.INIT_SEGMENT_TYPE, 3), i(e, l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE, 3), i(e, l.HTTPRequest.INDEX_SEGMENT_TYPE, 3), i(e, l.HTTPRequest.OTHER_TYPE, 3), i(e, `lowLatencyMultiplyFactor`, 5), e), abr: { movingAverageMethod: u.default.MOVING_AVERAGE_SLIDING_WINDOW, ABRStrategy: u.default.ABR_STRATEGY_DYNAMIC, bandwidthSafetyFactor: 0.9, useDefaultABRRules: !0, useDeadTimeLatency: !0, limitBitrateByPortal: !1, usePixelRatioInLimitBitrateByPortal: !1, maxBitrate: { audio: -1, video: -1 }, minBitrate: { audio: -1, video: -1 }, maxRepresentationRatio: { audio: 1, video: 1 }, initialBitrate: { audio: -1, video: -1 }, initialRepresentationRatio: { audio: -1, video: -1 }, autoSwitchBitrate: { audio: !0, video: !0 }, fetchThroughputCalculationMode: u.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA }, cmcd: { enabled: !1, sid: null, cid: null } } }; let n = o.default.clone(t); return { get: function () { return n; }, update: function (e) { typeof e === `object` && !(function e (t, n, r) { for (const i in t)t.hasOwnProperty(i) && n.hasOwnProperty(i) && (typeof t[i] === `object` && t[i] !== null ? e(t[i], n[i], `${r.slice() + i}.`) : n[i] = o.default.clone(t[i])); }(e, n, ``)); }, reset: function () { n = o.default.clone(t); } }; }d.__dashjs_factory_name = `Settings`; a = a.default.getSingletonFactory(d); n.default = a, t.exports = n.default; }, { 108: 108, 248: 248, 45: 45, 47: 47, 49: 49 }], 49: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(o, null, [{ key: `mixin`, value: function (e, t, n) { let r; const i = {}; if (e) for (const a in t)t.hasOwnProperty(a) && (r = t[a], a in e && (e[a] === r || a in i && i[a] === r) || (typeof e[a] === `object` && e[a] !== null ? e[a] = o.mixin(e[a], r, n) : e[a] = n(r))); return e; } }, { key: `clone`, value: function (e) { if (!e || typeof e !== `object`) return e; let t = void 0; if (e instanceof Array) { t = []; for (let n = 0, r = e.length; n < r; ++n)n in e && t.push(o.clone(e[n])); } else t = {}; return o.mixin(t, e, o.clone); } }, { key: `addAditionalQueryParameterToUrl`, value: function (n, e) { try { const t = (function () { if (!e || e.length === 0) return { v: n }; const t = new URL(n); return e.forEach((e) => { e.key && e.value && t.searchParams.set(e.key, e.value); }), { v: t.href }; }()); if (typeof t === `object`) return t.v; } catch (e) { return n; } } }, { key: `generateUuid`, value: function () { let n = (new Date()).getTime(); return `xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx`.replace(/[xy]/g, (e) => { const t = (n + 16 * Math.random()) % 16 | 0; return n = Math.floor(n / 16), (e == `x` ? t : 3 & t | 8).toString(16); }); } }, { key: `generateHashCode`, value: function (e) { let t = 0; if (e.length === 0) return t; for (let n = 0; n < e.length; n++) { t = (t << 5) - t + e.charCodeAt(n); t |= 0; } return t; } }])), o); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)); }n.default = i, t.exports = n.default; }, {}], 50: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }), n.getVersionString = function () { return r; }; var r = `3.2.0`; }, {}], 51: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(52); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this), this.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE = 10, this.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE = 11, this.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE = 12, this.SEGMENTS_UPDATE_FAILED_ERROR_CODE = 13, this.SEGMENTS_UNAVAILABLE_ERROR_CODE = 14, this.SEGMENT_BASE_LOADER_ERROR_CODE = 15, this.TIME_SYNC_FAILED_ERROR_CODE = 16, this.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE = 17, this.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE = 18, this.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE = 19, this.APPEND_ERROR_CODE = 20, this.REMOVE_ERROR_CODE = 21, this.DATA_UPDATE_FAILED_ERROR_CODE = 22, this.CAPABILITY_MEDIASOURCE_ERROR_CODE = 23, this.CAPABILITY_MEDIAKEYS_ERROR_CODE = 24, this.DOWNLOAD_ERROR_ID_MANIFEST_CODE = 25, this.DOWNLOAD_ERROR_ID_SIDX_CODE = 26, this.DOWNLOAD_ERROR_ID_CONTENT_CODE = 27, this.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE = 28, this.DOWNLOAD_ERROR_ID_XLINK_CODE = 29, this.MANIFEST_ERROR_ID_CODEC_CODE = 30, this.MANIFEST_ERROR_ID_PARSE_CODE = 31, this.MANIFEST_ERROR_ID_NOSTREAMS_CODE = 32, this.TIMED_TEXT_ERROR_ID_PARSE_CODE = 33, this.MANIFEST_ERROR_ID_MULTIPLEXED_CODE = 34, this.MEDIASOURCE_TYPE_UNSUPPORTED_CODE = 35, this.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE = `parsing failed for `, this.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE = `Failed loading manifest: `, this.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE = `Failed loading Xlink element: `, this.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE = `Segments update failed`, this.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE = `no segments are available yet`, this.SEGMENT_BASE_LOADER_ERROR_MESSAGE = `error loading segments`, this.TIME_SYNC_FAILED_ERROR_MESSAGE = `Failed to synchronize time`, this.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE = `request is null`, this.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE = `Failed to resolve a valid URL`, this.APPEND_ERROR_MESSAGE = `chunk is not defined`, this.REMOVE_ERROR_MESSAGE = `buffer is not defined`, this.DATA_UPDATE_FAILED_ERROR_MESSAGE = `Data update failed`, this.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE = `mediasource is not supported`, this.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE = `mediakeys is not supported`, this.TIMED_TEXT_ERROR_MESSAGE_PARSE = `parsing error :`, this.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE = `Error creating source buffer of type : `; }e = new ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o)(); n.default = e, t.exports = n.default; }, { 52: 52 }], 52: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, [{ key: `extend`, value: function (e, t) { if (e) { let n; const r = !!t && t.override; const i = !!t && t.publicOnly; for (n in e)!e.hasOwnProperty(n) || this[n] && !r || i && e[n].indexOf(`public_`) === -1 || (this[n] = e[n]); } } }])), a); function a () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)); }n.default = i, t.exports = n.default; }, {}], 53: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(55); var e = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this), this.BUFFERING_COMPLETED = `bufferingCompleted`, this.BUFFER_CLEARED = `bufferCleared`, this.BUFFER_LEVEL_UPDATED = `bufferLevelUpdated`, this.BYTES_APPENDED = `bytesAppended`, this.BYTES_APPENDED_END_FRAGMENT = `bytesAppendedEndFragment`, this.CHECK_FOR_EXISTENCE_COMPLETED = `checkForExistenceCompleted`, this.CURRENT_TRACK_CHANGED = `currentTrackChanged`, this.DATA_UPDATE_COMPLETED = `dataUpdateCompleted`, this.DATA_UPDATE_STARTED = `dataUpdateStarted`, this.INBAND_EVENTS = `inbandEvents`, this.INITIALIZATION_LOADED = `initializationLoaded`, this.INIT_FRAGMENT_LOADED = `initFragmentLoaded`, this.INIT_FRAGMENT_NEEDED = `initFragmentNeeded`, this.INTERNAL_MANIFEST_LOADED = `internalManifestLoaded`, this.ORIGINAL_MANIFEST_LOADED = `originalManifestLoaded`, this.LIVE_EDGE_SEARCH_COMPLETED = `liveEdgeSearchCompleted`, this.LOADING_COMPLETED = `loadingCompleted`, this.LOADING_PROGRESS = `loadingProgress`, this.LOADING_DATA_PROGRESS = `loadingDataProgress`, this.LOADING_ABANDONED = `loadingAborted`, this.MANIFEST_UPDATED = `manifestUpdated`, this.MEDIA_FRAGMENT_LOADED = `mediaFragmentLoaded`, this.MEDIA_FRAGMENT_NEEDED = `mediaFragmentNeeded`, this.QUOTA_EXCEEDED = `quotaExceeded`, this.REPRESENTATION_UPDATE_STARTED = `representationUpdateStarted`, this.REPRESENTATION_UPDATE_COMPLETED = `representationUpdateCompleted`, this.SEGMENTS_LOADED = `segmentsLoaded`, this.SERVICE_LOCATION_BLACKLIST_ADD = `serviceLocationBlacklistAdd`, this.SERVICE_LOCATION_BLACKLIST_CHANGED = `serviceLocationBlacklistChanged`, this.SOURCEBUFFER_REMOVE_COMPLETED = `sourceBufferRemoveCompleted`, this.STREAMS_COMPOSED = `streamsComposed`, this.STREAM_BUFFERING_COMPLETED = `streamBufferingCompleted`, this.STREAM_COMPLETED = `streamCompleted`, this.TEXT_TRACKS_QUEUE_INITIALIZED = `textTracksQueueInitialized`, this.TIME_SYNCHRONIZATION_COMPLETED = `timeSynchronizationComplete`, this.URL_RESOLUTION_FAILED = `urlResolutionFailed`, this.VIDEO_CHUNK_RECEIVED = `videoChunkReceived`, this.WALLCLOCK_TIME_UPDATED = `wallclockTimeUpdated`, this.XLINK_ELEMENT_LOADED = `xlinkElementLoaded`, this.XLINK_READY = `xlinkReady`, this.SEGMENTBASE_INIT_REQUEST_NEEDED = `segmentBaseInitRequestNeeded`, this.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED = `segmentBaseSegmentsListRequestNeeded`, this.SEEK_TARGET = `seekTarget`; }n.default = e, t.exports = n.default; }, { 55: 55 }], 54: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(53); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).apply(this, arguments); }e = new ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o)(); n.default = e, t.exports = n.default; }, { 53: 53 }], 55: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, [{ key: `extend`, value: function (e, t) { if (e) { let n; const r = !!t && t.override; const i = !!t && t.publicOnly; for (n in e)!e.hasOwnProperty(n) || this[n] && !r || i && e[n].indexOf(`public_`) === -1 || (this[n] = e[n]); } } }])), a); function a () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)); }n.default = i, t.exports = n.default; }, {}], 56: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const h = r(e(61)); const p = r(e(93)); const g = r(e(89)); const _ = r(e(95)); const b = r(e(88)); const D = r(e(86)); const i = r(e(47)); const M = r(e(65)); function a () { let e; let m = void 0; let E = void 0; let y = void 0; let u = void 0; let v = void 0; let i = void 0; const t = this.context; function a (e, t, n) { let r; const i = m.getAdaptationsForType(E[0].mpd.manifest, e, t); if (!i || i.length === 0) return null; if (i.length > 1 && n) { const a = l(n, t); if (u[n.id] && u[n.id][t]) for (var o = 0, s = i.length; o < s; o++) if (function (e, t) { if (!e || !t) return !1; const n = e.id === t.id; const r = e.viewpoint === t.viewpoint; const i = e.lang === t.lang; const a = e.roles.toString() === t.roles.toString(); const o = e.accessibility.toString() === t.accessibility.toString(); var t = e.audioChannelConfiguration.toString() === t.audioChannelConfiguration.toString(); return n && r && i && a && o && t; }(u[n.id][t], a[o])) return i[o]; for (o = 0, s = i.length; o < s; o++) if (r = i[o], m.getRolesForAdaptation(r).filter((e) => { return e.value === h.default.MAIN; })[0]) return i[o]; } return i[0]; } function l (e, t, n) { let r; let i; let a; let o = E; let s = n; const u = []; let l = void 0; let d = void 0; var f = void 0; let c = void 0; if (s)R(), o = T(s); else { if (!(E.length > 0)) return u; s = E[0].mpd.manifest; }o = S(e, o); o && (c = o.id); const h = m.getAdaptationsForType(s, e ? e.index : null, t !== v.EMBEDDED_TEXT ? t : v.VIDEO); if (!h || h.length === 0) return u; for (y[c] = y[c] || m.getAdaptationsForPeriod(o), d = 0, a = h.length; d < a; d++) if (r = h[d], i = m.getIndexForAdaptation(r, s, e.index), l = A(y[c][i]), t === v.EMBEDDED_TEXT) { for (var p = l.accessibility.length, f = 0; f < p; f++) if (l) { const g = l.accessibility[f]; if (g.indexOf(`cea-608:`) === 0) { const _ = g.substring(8).split(`;`); if (_[0].substring(0, 2) === `CC`) for (f = 0; f < _.length; f++)I(l = l || A.call(this, y[c][i]), _[f].substring(0, 3), _[f].substring(4)), u.push(l), l = null; else for (f = 0; f < _.length; f++)I(l = l || A.call(this, y[c][i]), `CC${f + 1}`, _[f]), u.push(l), l = null; } else g.indexOf(`cea-608`) === 0 && (I(l, v.CC1, `eng`), u.push(l), l = null); } } else t === v.IMAGE ? (l.type = v.IMAGE, u.push(l), l = null) : l && u.push(l); return u; } function T (e) { e = n(e); return m.getRegularPeriods(e); } function n (e) { e = o(e); return m.getMpd(e); } function r () { E = [], y = {}, u = {}; } function o (e) { return e || (E.length > 0 ? E[0].mpd.manifest : null); } function s (e) { return e && e.streamInfo && void 0 !== e.streamInfo.id && y[e.streamInfo.id] ? y[e.streamInfo.id][e.index] : null; } function S (e, t) { for (let n = t.length, r = 0; r < n; r++) { const i = t[r]; if (e && e.id === i.id) return i; } return null; } function A (e) { if (!e) return null; let t; const r = new g.default(); const n = e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index]; return r.id = e.id, r.index = e.index, r.type = e.type, r.streamInfo = d(e.period), r.representationCount = m.getRepresentationCount(n), r.labels = m.getLabelsForAdaptation(n), r.lang = m.getLanguageForAdaptation(n), t = m.getViewpointForAdaptation(n), r.viewpoint = t ? t.value : void 0, r.accessibility = m.getAccessibilityForAdaptation(n).map((e) => { const t = e.value; let n = t; return e.schemeIdUri && e.schemeIdUri.search(`cea-608`) >= 0 && void 0 !== i && (n = t ? `cea-608:${t}` : `cea-608`, r.embeddedCaptions = !0), n; }), r.audioChannelConfiguration = m.getAudioChannelConfigurationForAdaptation(n).map((e) => { return e.value; }), r.audioChannelConfiguration.length === 0 && Array.isArray(n.Representation_asArray) && n.Representation_asArray.length > 0 && (r.audioChannelConfiguration = m.getAudioChannelConfigurationForRepresentation(n.Representation_asArray[0]).map((e) => { return e.value; })), r.roles = m.getRolesForAdaptation(n).map((e) => { return e.value; }), r.codec = m.getCodec(n), r.mimeType = m.getMimeType(n), r.contentProtection = m.getContentProtectionData(n), r.bitrateList = m.getBitrateListForAdaptation(n), r.contentProtection && r.contentProtection.forEach((e) => { e.KID = m.getKID(e); }), r.isText = m.getIsTextTrack(r.mimeType), r.supplementalProperties = m.getSupplementalPropperties(n), r; } function I (e, t, n) { e.id = t, e.index = 100 + parseInt(t.substring(2, 3)), e.type = v.EMBEDDED_TEXT, e.codec = `cea-608-in-SEI`, e.isText = !0, e.isEmbedded = !0, e.lang = n, e.roles = [`caption`]; } function d (e) { let t; let n; const r = new _.default(); return r.id = e.id, r.index = e.index, r.start = e.start, r.duration = e.duration, r.manifestInfo = (t = e.mpd, (n = new b.default()).DVRWindowSize = t.timeShiftBufferDepth, n.loadedTime = t.manifest.loadedTime, n.availableFrom = t.availabilityStartTime, n.minBufferTime = t.manifest.minBufferTime, n.maxFragmentDuration = t.maxSegmentDuration, n.duration = m.getDuration(t.manifest), n.isDynamic = m.getIsDynamic(t.manifest), n.serviceDescriptions = m.getServiceDescriptions(t.manifest), n.protocol = t.manifest.protocol, n), r.isLast = e.mpd.manifest.Period_asArray.length === 1 || Math.abs(r.start + r.duration - r.manifestInfo.duration) < 1, r; } function R () { if (!v) throw new Error(`setConfig function has to be called previously`); } function f (e) { return E.length > 0 ? E[0].mpd.manifest.Period_asArray[e] : null; } function c (e, t, n) { let r; let i; let a; let o = void 0; let s = void 0; if (e) for (r = e.AdaptationSet_asArray, o = 0; o < r.length; o += 1) for (a = r[o].Representation_asArray, s = 0; s < a.length; s += 1) if (t === (i = a[s]).id) return n ? s : i; return null; } return e = { getBandwidthForRepresentation: function (e, t) { let n = void 0; return (n = c(f(t), e)) ? n.bandwidth : null; }, getIndexForRepresentation: function (e, t) { return (function (e, t) { t = c(e, t, !0); return t !== null ? t : -1; }(f(t), e)); }, getMaxIndexForBufferType: function (e, t) { return (function (e, t) { let n = void 0; let r = void 0; let i = void 0; let a = void 0; if (!e || !t) return -1; for (r = e.AdaptationSet_asArray, a = 0; a < r.length; a += 1) if (n = r[a], i = n.Representation_asArray, m.getIsTypeOf(n, t)) return i.length; return -1; }(f(t), e)); }, convertDataToRepresentationInfo: function (e) { if (e) { const t = new p.default(); var n = e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index]; var n = m.getRepresentationFor(e.index, n); return t.id = e.id, t.quality = e.index, t.bandwidth = m.getBandwidth(n), t.DVRWindow = e.segmentAvailabilityRange, t.fragmentDuration = e.segmentDuration || (e.segments && e.segments.length > 0 ? e.segments[0].duration : NaN), t.MSETimeOffset = e.MSETimeOffset, t.mediaInfo = A(e.adaptation), t; } return null; }, getDataForMedia: s, getStreamsInfo: function (e, t) { const n = []; let r = E; if (e && (R(), r = T(e)), r.length > 0) { (!t || t > r.length) && (t = r.length); for (let i = 0; i < t; i++)n.push(d(r[i])); } return n; }, getMediaInfoForType: function (e, t) { if (E.length === 0 || !e) return null; const n = S(e, E); if (!n) return null; const r = n.id; return y[r] = y[r] || m.getAdaptationsForPeriod(n), (t = a(e.index, t, e)) ? (e = m.getIndexForAdaptation(t, E[0].mpd.manifest, e.index), A(y[r][e])) : null; }, getAllMediaInfoForType: l, getAdaptationForType: a, getRealAdaptation: function (e, t) { let n = void 0; var e = S(e, E); const r = t ? t.id : null; return E.length > 0 && e && (n = r ? m.getAdaptationForId(r, E[0].mpd.manifest, e.index) : m.getAdaptationForIndex(t ? t.index : null, E[0].mpd.manifest, e.index)), n; }, getVoRepresentations: function (e) { return e = s(e), m.getRepresentationsForAdaptation(e); }, getEventsFor: function (e, t) { let n; let r = []; return E.length > 0 && (n = E[0].mpd.manifest, e instanceof _.default ? r = m.getEventsForPeriod(S(e, E)) : e instanceof g.default ? r = m.getEventStreamForAdaptationSet(n, s(e)) : e instanceof p.default && (r = m.getEventStreamForRepresentation(n, t))), r; }, getEvent: function (e, t, n, r) { try { if (!e || !t || isNaN(n) || !r) return null; const i = new D.default(); const a = e.scheme_id_uri; const o = e.value; const s = e.timescale || 1; var u = r.presentationTimeOffset || 0; var l = r.adaptation.period.start; const d = e.presentation_time_delta / s; var f = void 0; var f = e.version === 0 ? l + n - u + d : l - u + d; const c = e.event_duration; var l = e.id; var u = e.message_data; return t[`${a}/${o}`] ? (i.eventStream = t[`${a}/${o}`], i.eventStream.value = o, i.eventStream.timescale = s, i.duration = c, i.id = l, i.calculatedPresentationTime = f, i.messageData = u, i.presentationTimeDelta = d, i) : null; } catch (e) { return null; } }, getMpd: n, setConfig: function (e) { e && (e.constants && (v = e.constants), e.cea608parser && (i = e.cea608parser), e.errHandler && m.setConfig({ errHandler: e.errHandler }), e.BASE64 && m.setConfig({ BASE64: e.BASE64 })); }, updatePeriods: function (e) { if (!e) return null; R(), E = T(e), y = {}; }, getIsTextTrack: function (e) { return m.getIsTextTrack(e); }, getUTCTimingSources: function () { const e = o(); return m.getUTCTimingSources(e); }, getSuggestedPresentationDelay: function () { const e = E.length > 0 ? E[0].mpd : null; return m.getSuggestedPresentationDelay(e); }, getAvailabilityStartTime: function (e) { return e = n(e), m.getAvailabilityStartTime(e); }, getIsDynamic: function (e) { return e = o(e), m.getIsDynamic(e); }, getDuration: function (e) { return e = o(e), m.getDuration(e); }, getRegularPeriods: T, getLocation: function (e) { return m.getLocation(e); }, getManifestUpdatePeriod: function (e) { const t = arguments.length <= 1 || void 0 === arguments[1] ? 0 : arguments[1]; return m.getManifestUpdatePeriod(e, t); }, getIsDVB: function (e) { return m.hasProfile(e, `urn:dvb:dash:profile:dvb-dash:2014`); }, getBaseURLsFromElement: function (e) { return m.getBaseURLsFromElement(e); }, getRepresentationSortFunction: function () { return m.getRepresentationSortFunction(); }, getCodec: function (e, t, n) { return m.getCodec(e, t, n); }, getVoAdaptations: function () { return y; }, getVoPeriods: function () { return E; }, getPeriodById: function (t) { if (!t || E.length === 0) return null; const e = E.filter((e) => { return e.id === t; }); return e && e.length > 0 ? e[0] : null; }, setCurrentMediaInfo: function (e, t, n) { u[e] = u[e] || {}, u[e][t] = u[e][t] || {}, u[e][t] = n; }, reset: r }, m = (0, M.default)(t).getInstance(), r(), e; }a.__dashjs_factory_name = `DashAdapter`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 47: 47, 61: 61, 65: 65, 86: 86, 88: 88, 89: 89, 93: 93, 95: 95 }], 57: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const w = r(e(234)); const O = e(248); const i = r(e(47)); const P = e(80); const L = r(e(64)); function a (e) { e = e || {}; const t = this.context; const l = e.eventBus; const d = e.events; const n = e.debug; const u = e.dashConstants; const a = e.urlUtils; const f = e.type; const c = e.streamInfo; const h = e.timelineConverter; const p = e.dashMetrics; const o = e.baseURLController; let r = void 0; let g = void 0; let _ = void 0; let m = void 0; let E = void 0; let y = void 0; let s = void 0; let i = void 0; let v = void 0; function T () { return f; } function S () { _ = -1, m = null; } function A () { S(), i = v = E = null; } function I (e, t, n) { const r = o.resolve(n.path); let i = void 0; var n = void 0; return r && t !== r.url && a.isRelative(t) ? (i = r.url, n = r.serviceLocation, t && (i = a.resolve(t, i))) : i = t, !a.isRelative(i) && (e.url = i, e.serviceLocation = n, 1); } function R (e) { let t, n; t = e.representation, n = t.hasInitialization(), e = t.hasSegments(), n && e ? l.trigger(d.REPRESENTATION_UPDATE_COMPLETED, { representation: t }, { streamId: c.id, mediaType: f }) : v.update(t, i, n, e); } function b (e, t) { if (t == null) return null; const n = new w.default(); const r = t.representation; const i = r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth; var a = t.media; var a = (0, P.replaceTokenForTemplate)(a, `Number`, t.replacementNumber); return a = (0, P.replaceTokenForTemplate)(a, `Time`, t.replacementTime), a = (0, P.replaceTokenForTemplate)(a, `Bandwidth`, i), a = (0, P.replaceIDForTemplate)(a, r.id), a = (0, P.unescapeDollarsInTemplate)(a), n.mediaType = f, n.type = O.HTTPRequest.MEDIA_SEGMENT_TYPE, n.range = t.mediaRange, n.startTime = t.presentationStartTime, n.mediaStartTime = t.mediaStartTime, n.duration = t.duration, n.timescale = r.timescale, n.availabilityStartTime = t.availabilityStartTime, n.availabilityEndTime = t.availabilityEndTime, n.wallStartTime = t.wallStartTime, n.quality = r.index, n.index = t.availabilityIdx, n.mediaInfo = e, n.adaptationIndex = r.adaptation.index, n.representationId = r.id, I(n, a, r) ? n : void 0; } function D (e) { let t; let n = !1; return e && (y ? s ? n = !0 : m && (t = parseFloat((m.presentationStartTime - e.adaptation.period.start).toFixed(5)), t = m.duration > 0 ? t + 1.5 * m.duration : t, n = e.adaptation.period.duration <= t) : _ >= e.availableSegmentsNumber && (n = !0)), n; } function M (e) { e = e.representation; e.segments && l.trigger(d.REPRESENTATION_UPDATE_COMPLETED, { representation: e }, { streamId: c.id, mediaType: f }); } function N (e) { if (!e.error) { for (var t, n, r = e.segments, i = e.representation, a = [], o = 0, s = void 0, s = 0, u = r ? r.length : 0; s < u; s++)t = r[s], (n = (0, P.getTimeBasedSegment)(h, y, i, t.startTime, t.duration, t.timescale, t.media, t.mediaRange, o)) && (a.push(n), o++); a.length > 0 && (i.segmentAvailabilityRange = { start: a[0].presentationStartTime, end: a[a.length - 1].presentationStartTime }, i.availableSegmentsNumber = a.length, i.segments = a, y && (e = a[a.length - 1].presentationStartTime - 8, e = e, h.setExpectedLiveEdge(e), p.updateManifestUpdateInfo({ presentationStartTime: e }))), i.hasInitialization() && l.trigger(d.REPRESENTATION_UPDATE_COMPLETED, { representation: i }, { streamId: c.id, mediaType: f }); } } function C () { g.debug(`Dynamic stream complete`), s = !0; } return r = { initialize: function (e) { y = e, s = !1, v.initialize(e); }, getStreamId: function () { return c.id; }, getType: T, getStreamInfo: function () { return c; }, getInitRequest: function (e, t) { return t ? (function (e, t, n) { const r = new w.default(); const i = t.adaptation.period; const a = i.start; if (r.mediaType = n, r.type = O.HTTPRequest.INIT_SEGMENT_TYPE, r.range = t.range, r.availabilityStartTime = h.calcAvailabilityStartTimeFromPresentationTime(a, i.mpd, y), r.availabilityEndTime = h.calcAvailabilityEndTimeFromPresentationTime(a + i.duration, i.mpd, y), r.quality = t.index, r.mediaInfo = e, r.representationId = t.id, I(r, t.initialization, t)) return r.url = (0, P.replaceTokenForTemplate)(r.url, `Bandwidth`, t.bandwidth), r; }(e, t, f)) : null; }, getRequestForSegment: b, getSegmentRequestForTime: function (e, t, n, r) { let i = null; if (!t || !t.segmentInfoType) return i; const a = _; const o = !!r && r.keepIdx; const s = !(!r || !r.ignoreIsFinished); return E !== n && (E = n, g.debug(`Getting the request for time : ${n}`)), (r = v.getSegmentByTime(t, n)) ? (_ = r.availabilityIdx, m = r, g.debug(`Index for time ${n} is ${_}`), i = b(e, r)) : !s && D(t) && ((i = new w.default()).action = w.default.ACTION_COMPLETE, i.index = _ - 1, i.mediaType = f, i.mediaInfo = e, g.debug(`Signal complete in getSegmentRequestForTime`)), o && a >= 0 && (_ = t.segmentInfoType === u.SEGMENT_TIMELINE && y ? _ : a), i; }, getNextSegmentRequest: function (e, t) { let n = null; if (!t || !t.segmentInfoType) return null; E = null; const r = _ + 1; g.debug(`Getting the next request at index: ${r}`); const i = v.getSegmentByIndex(t, r, m ? m.mediaStartTime : -1); return i || isFinite(t.adaptation.period.duration) || s ? (_ = i ? (n = b(e, i), i.availabilityIdx) : y ? r - 1 : r, i ? m = i : D(t) && ((n = new w.default()).action = w.default.ACTION_COMPLETE, n.index = _ - 1, n.mediaType = f, n.mediaInfo = e, g.debug(`Signal complete`)), n) : (g.debug(`${f} No segment found at index: ${r}. Wait for next loop`), null); }, setCurrentIndex: function (e) { _ = e; }, getCurrentIndex: function () { return _; }, isMediaFinished: D, reset: function () { A(), l.off(d.INITIALIZATION_LOADED, M, r), l.off(d.SEGMENTS_LOADED, N, r), l.off(d.REPRESENTATION_UPDATE_STARTED, R, r), l.off(d.DYNAMIC_TO_STATIC, C, r); }, resetIndex: S, setMimeType: function (e) { i = e; } }, g = n.getLogger(r), A(), v = (0, L.default)(t).create(e), l.on(d.INITIALIZATION_LOADED, M, r), l.on(d.SEGMENTS_LOADED, N, r), l.on(d.REPRESENTATION_UPDATE_STARTED, R, r), l.on(d.DYNAMIC_TO_STATIC, C, r), r; }a.__dashjs_factory_name = `DashHandler`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 234: 234, 248: 248, 47: 47, 64: 64, 80: 80 }], 58: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const f = r(e(108)); const c = e(248); const i = r(e(47)); const h = r(e(109)); const p = r(e(78)); const g = r(e(153)); const _ = e(250); function a (e) { e = e || {}; let t; const n = this.context; let r = void 0; let i = void 0; let a = void 0; let o = e.metricsModel; function s (e) { e = o.getMetricsFor(e, !0); if (!e) return null; const t = e.HttpList; let n = null; let r = void 0; if (!t || t.length <= 0) return null; for (r = t.length - 1; r >= 0;) { if (t[r].responsecode) { n = t[r]; break; }r--; } return n; } function u (e) { e = o.getMetricsFor(e, !0); return e && e.HttpList ? e.HttpList : []; } function l (e, t) { if (!e) return null; t = e[t]; return t && t.length !== 0 ? t[t.length - 1] : null; } function d (e) { const t = {}; if (!e) return t; for (let n = e.trim().split(`\r\n`), r = 0, i = n.length; r < i; r++) { const a = n[r]; const o = a.indexOf(`: `); o > 0 && (t[a.substring(0, o)] = a.substring(o + 2)); } return t; } return t = { getCurrentRepresentationSwitch: function (e) { return l(o.getMetricsFor(e, !0), h.default.TRACK_SWITCH); }, getCurrentBufferState: function (e) { return l(o.getMetricsFor(e, !0), h.default.BUFFER_STATE); }, getCurrentBufferLevel: function (e) { return (e = l(o.getMetricsFor(e, !0), h.default.BUFFER_LEVEL)) ? p.default.round10(e.level / 1e3, -3) : 0; }, getCurrentHttpRequest: s, getHttpRequests: u, getCurrentDroppedFrames: function () { return l(o.getMetricsFor(f.default.VIDEO, !0), h.default.DROPPED_FRAMES); }, getCurrentSchedulingInfo: function (e) { return l(o.getMetricsFor(e, !0), h.default.SCHEDULING_INFO); }, getCurrentDVRInfo: function (e) { return l(e ? o.getMetricsFor(e, !0) : o.getMetricsFor(f.default.VIDEO, !0) || o.getMetricsFor(f.default.AUDIO, !0), h.default.DVR_INFO); }, getCurrentManifestUpdate: function () { return l(o.getMetricsFor(f.default.STREAM), h.default.MANIFEST_UPDATE); }, getLatestFragmentRequestHeaderValueByID: function (e, t) { let n = {}; return (e = s(e)) && (n = d(e._responseHeaders)), void 0 === n[t] ? null : n[t]; }, getLatestMPDRequestHeaderValueByID: function (e) { for (var t, n = {}, r = void 0, i = void 0, i = (r = u(f.default.STREAM)).length - 1; i >= 0; i--) if ((t = r[i]).type === c.HTTPRequest.MPD_TYPE) { n = d(t._responseHeaders); break; } return void 0 === n[e] ? null : n[e]; }, addRepresentationSwitch: function (e, t, n, r, i) { o.addRepresentationSwitch(e, t, n, r, i); }, addDVRInfo: function (e, t, n, r) { o.addDVRInfo(e, t, n, r); }, updateManifestUpdateInfo: function (e) { const t = this.getCurrentManifestUpdate(); o.updateManifestUpdateInfo(t, e); }, addManifestUpdateStreamInfo: function (e) { let t; e && (t = this.getCurrentManifestUpdate(), o.addManifestUpdateStreamInfo(t, e.id, e.index, e.start, e.duration)); }, addManifestUpdateRepresentationInfo: function (e, t) { let n; e && (n = this.getCurrentManifestUpdate(), o.addManifestUpdateRepresentationInfo(n, e.id, e.index, e.streamIndex, t, e.presentationTimeOffset, e.startNumber, e.fragmentInfoType)); }, addManifestUpdate: function (e) { o.addManifestUpdate(f.default.STREAM, e.type, e.requestStartDate, e.requestEndDate); }, addHttpRequest: function (e, t, n, r, i) { o.addHttpRequest(e.mediaType, null, e.type, e.url, e.quality, t, e.serviceLocation || null, e.range || null, e.requestStartDate, e.firstByteDate, e.requestEndDate, n, e.duration, r, i); }, addSchedulingInfo: function (e, t) { o.addSchedulingInfo(e.mediaType, new Date(), e.type, e.startTime, e.availabilityStartTime, e.duration, e.quality, e.range, t); }, addRequestsQueue: function (e, t, n) { o.addRequestsQueue(e, t, n); }, addBufferLevel: function (e, t, n) { o.addBufferLevel(e, t, n); }, addBufferState: function (e, t, n) { o.addBufferState(e, t, n); }, addDroppedFrames: function (e) { o.addDroppedFrames(f.default.VIDEO, e); }, addPlayList: function () { a && (o.addPlayList(a), a = null); }, addDVBErrors: function (e) { o.addDVBErrors(e); }, createPlaylistMetrics: function (e, t) { (a = new _.PlayList()).start = new Date(), a.mstart = e, a.starttype = t; }, createPlaylistTraceMetrics: function (e, t, n) { !0 === r && (r = !1, (i = new _.PlayListTrace()).representationid = e, i.start = new Date(), i.mstart = t, i.playbackspeed = n !== null ? n.toString() : null); }, updatePlayListTraceMetrics: function (e) { if (i) for (const t in i)i[t] = e[t]; }, pushPlayListTraceMetrics: function (e, t) { let n; !1 === r && a && i && i.start && (n = i.start, n = e.getTime() - n.getTime(), i.duration = n, i.stopreason = t, a.trace.push(i), r = !0); }, clearAllCurrentMetrics: function () { o.clearAllCurrentMetrics(); } }, o = o || (0, g.default)(n).getInstance({ settings: e.settings }), r = !0, a = i = null, t; }a.__dashjs_factory_name = `DashMetrics`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 108: 108, 109: 109, 153: 153, 248: 248, 250: 250, 47: 47, 78: 78 }], 59: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const S = r(e(94)); const p = r(e(232)); const i = r(e(47)); const g = r(e(234)); const A = r(e(159)); function a () { const e = this.context; let t = void 0; let _ = void 0; let n = void 0; let m = void 0; let r = void 0; let i = void 0; let a = void 0; let o = void 0; let u = void 0; let l = void 0; let d = void 0; let s = void 0; let f = void 0; let c = void 0; let h = void 0; let E = void 0; function y () { if (!E || !E.hasOwnProperty(`resolve`)) throw new Error(`setConfig function has to be called previously`); } function v (e) { if (e.url) { const t = new g.default(); return t.setInfo(e), t; } } function T (e, t, n, r) { d.trigger(l.SEGMENTS_LOADED, { segments: n, representation: r, error: n ? void 0 : new p.default(s.SEGMENT_BASE_LOADER_ERROR_CODE, s.SEGMENT_BASE_LOADER_ERROR_MESSAGE) }, { streamId: e, mediaType: t }); } return t = { setConfig: function (e) { e.baseURLController && (E = e.baseURLController), e.dashMetrics && (i = e.dashMetrics), e.mediaPlayerModel && (o = e.mediaPlayerModel), e.errHandler && (n = e.errHandler), e.settings && (a = e.settings), e.boxParser && (m = e.boxParser), e.events && (l = e.events), e.eventBus && (d = e.eventBus), e.debug && (_ = e.debug.getLogger(t)), e.requestModifier && (r = e.requestModifier), e.errors && (s = e.errors), e.urlUtils && (h = e.urlUtils), e.constants && (f = e.constants), e.dashConstants && (c = e.dashConstants); }, initialize: function () { u = (0, A.default)(e).create({ errHandler: n, dashMetrics: i, mediaPlayerModel: o, requestModifier: r, useFetch: a ? a.get().streaming.lowLatencyEnabled : null, boxParser: m, errors: s, urlUtils: h, constants: f, dashConstants: c }); }, loadInitialization: function t (n, r, i, e) { y(); let a; let o = i ? E.resolve(i.path) : null; const s = e || { init: !0, url: o ? o.url : void 0, range: { start: 0, end: 1500 }, searching: !1, bytesLoaded: 0, bytesToLoad: 1500, mediaType: r }; _.debug(`Start searching for initialization.`); o = v(s); u.load({ request: o, success: function (e) { s.bytesLoaded = s.range.end, (a = m.findInitRange(e)) ? (i.range = a, d.trigger(l.INITIALIZATION_LOADED, { representation: i }, { streamId: n, mediaType: r })) : (s.range.end = s.bytesLoaded + s.bytesToLoad, t(n, r, i, s)); }, error: function () { d.trigger(l.INITIALIZATION_LOADED, { representation: i }, { streamId: n, mediaType: r }); } }), _.debug(`Perform init search: ${s.url}`); }, loadSegments: function l (d, f, c, e, h, t) { y(), !e || void 0 !== e.start && void 0 !== e.end || (e = (r = e ? e.toString().split(`-`) : null) ? { start: parseFloat(r[0]), end: parseFloat(r[1]) } : null), h = h || T; let p; let i = null; const n = !!e; var r = c ? E.resolve(c.path) : null; const g = { init: !1, url: r ? r.url : void 0, range: n ? e : { start: 0, end: 1500 }, searching: !n, bytesLoaded: t ? t.bytesLoaded : 0, bytesToLoad: 1500, mediaType: f }; var t = v(g); u.load({ request: t, success: function (e) { const t = g.bytesToLoad; let n = e.byteLength; if (g.bytesLoaded = g.range.end - g.range.start, i = m.parse(e), (p = i.getBox(`sidx`)) && p.isComplete) { const u = p.references; let r = void 0; var e = void 0; u != null && u.length > 0 && (r = u[0].reference_type === 1), r ? (function () { _.debug(`Initiate multiple SIDX load.`), g.range.end = g.range.start + p.size; for (var e, t, n = void 0, r = void 0, i = [], a = 0, o = (p.offset || g.range.start) + p.size, s = function (e, t, n) { n ? (i = i.concat(n), r <= ++a && (i.sort((e, t) => { return e.startTime - t.startTime < 0 ? -1 : 0; }), h(e, t, i, c))) : h(e, t, null, c); }, n = 0, r = u.length; n < r; n++)t = (e = o) + u[n].referenced_size - 1, o += u[n].referenced_size, l(d, f, c, { start: e, end: t }, s, g); }()) : (_.debug(`Parsing segments from SIDX. representation ${f} - id: ${c.id} for range : ${g.range.start} - ${g.range.end}`), e = (function (e, t) { for (var n = e.references, r = n.length, i = e.timescale, a = e.earliest_presentation_time, o = t.range.start + e.offset + e.first_offset + e.size, s = [], u = void 0, l = void 0, d = void 0, f = void 0, c = 0; c < r; c++)d = n[c].subsegment_duration, f = n[c].referenced_size, (u = new S.default()).duration = d, u.startTime = a, u.timescale = i, l = o + f - 1, u.mediaRange = `${o}-${l}`, s.push(u), a += d, o += f; return s; }(p, g)), h(d, f, e, c)); } else { if (p)g.range.start = p.offset || g.range.start, g.range.end = g.range.start + (p.size || t); else { if (n < g.bytesLoaded) return void h(d, f, null, c); (n = i.getLastBox()) && n.size ? (g.range.start = n.offset + n.size, g.range.end = g.range.start + t) : g.range.end += t; }l(d, f, c, g.range, h, g); } }, error: function () { h(d, f, null, c); } }), _.debug(`Perform SIDX load: ${g.url} with range : ${g.range.start} - ${g.range.end}`); }, reset: function () { u.abort(), r = m = n = u = null; } }; }a.__dashjs_factory_name = `SegmentBaseLoader`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 159: 159, 232: 232, 234: 234, 47: 47, 94: 94 }], 60: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const y = r(e(218)); const v = r(e(108)); const i = r(e(47)); const T = r(e(94)); const S = r(e(234)); const A = r(e(159)); const I = r(e(232)); function a () { const c = this.context; let t = void 0; let h = void 0; let p = void 0; let n = void 0; let r = void 0; let i = void 0; let a = void 0; let g = void 0; let o = void 0; let s = void 0; let u = void 0; let l = void 0; let d = void 0; function _ (e, t, n, r) { for (var i, a = void 0, o = void 0, s = void 0, u = void 0, l = void 0, d = void 0, s = [], l = 0, f = (o = (function (e) { const t = []; const n = (0, y.default)(c).create({ data: e }); let r = void 0; let i = void 0; for (n.consumeTagAndSize(p.Segment.Cues); n.moreData() && n.consumeTagAndSize(p.Segment.Cues.CuePoint, !0);) { for ((r = {}).CueTime = n.parseTag(p.Segment.Cues.CuePoint.CueTime), r.CueTracks = []; n.moreData() && n.consumeTag(p.Segment.Cues.CuePoint.CueTrackPositions, !0);) { const a = n.getMatroskaCodedNum(); const o = n.getPos(); if ((i = {}).Track = n.parseTag(p.Segment.Cues.CuePoint.CueTrackPositions.CueTrack), i.Track === 0) throw new Error(`Cue track cannot be 0`); i.ClusterPosition = n.parseTag(p.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition), r.CueTracks.push(i), n.setPos(o + a); } if (r.CueTracks.length === 0) throw new Error(`Mandatory cuetrack not found`); t.push(r); } if (t.length === 0) throw new Error(`mandatory cuepoint not found`); return t; }(e))).length; l < f; l += 1)u = new T.default(), a = 0, a = l < o.length - 1 ? o[l + 1].CueTime - o[l].CueTime : r - o[l].CueTime, u.duration = a, u.startTime = o[l].CueTime, u.timescale = 1e3, i = o[l].CueTracks[0].ClusterPosition + t, d = l < o.length - 1 ? o[l + 1].CueTracks[0].ClusterPosition + t - 1 : n - 1, u.mediaRange = `${i}-${d}`, s.push(u); return h.debug(`Parsed cues: ${s.length} cues.`), s; } function f () { if (!d || !d.hasOwnProperty(`resolve`)) throw new Error(`setConfig function has to be called previously`); } function m (e, t, n, r) { s.trigger(u.SEGMENTS_LOADED, { segments: n, representation: r, error: n ? void 0 : new I.default(l.SEGMENT_BASE_LOADER_ERROR_CODE, l.SEGMENT_BASE_LOADER_ERROR_MESSAGE) }, { streamId: e, mediaType: t }); } function E (e) { const t = new S.default(); return t.setInfo(e), t; } return t = { setConfig: function (e) { if (!(e.baseURLController && e.dashMetrics && e.mediaPlayerModel && e.errHandler)) throw new Error(v.default.MISSING_CONFIG_ERROR); d = e.baseURLController, i = e.dashMetrics, a = e.mediaPlayerModel, n = e.errHandler, o = e.settings, u = e.events, s = e.eventBus, l = e.errors, h = e.debug.getLogger(t), r = e.requestModifier; }, initialize: function () { g = (0, A.default)(c).create({ errHandler: n, dashMetrics: i, mediaPlayerModel: a, requestModifier: r, useFetch: o ? o.get().streaming.lowLatencyEnabled : null, errors: l }); }, loadInitialization: function (e, t, n, r) { f(); let i = null; var a = n ? d.resolve(n.path) : null; const o = n ? n.range.split(`-`) : null; var a = r || { range: { start: o ? parseFloat(o[0]) : null, end: o ? parseFloat(o[1]) : null }, request: i, url: a ? a.url : void 0, init: !0, mediaType: t }; h.info(`Start loading initialization.`), i = E(a), g.load({ request: i, success: function () { s.trigger(u.INITIALIZATION_LOADED, { representation: n }, { streamId: e, mediaType: t }); }, error: function () { s.trigger(u.INITIALIZATION_LOADED, { representation: n }, { streamId: e, mediaType: t }); } }), h.debug(`Perform init load: ${a.url}`); }, loadSegments: function (t, n, r, i, a) { f(); let e = null; const o = r ? d.resolve(r.path) : null; const s = o ? o.url : void 0; a = a || m, e = E({ bytesLoaded: 0, bytesToLoad: 8192, range: { start: 0, end: 8192 }, request: e, url: s, init: !1, mediaType: n }), h.debug(`Parsing ebml header`), g.load({ request: e, success: function (e) { !(function (e, t, n, r) { if (e && e.byteLength !== 0) { let i; let a; let o; const s = (0, y.default)(c).create({ data: e }); let u = void 0; var e = n ? n.split(`-`) : null; var n = null; const l = { url: t, range: { start: e ? parseFloat(e[0]) : null, end: e ? parseFloat(e[1]) : null }, request: n }; for (h.debug(`Parse EBML header: ${l.url}`), s.skipOverElement(p.EBML), s.consumeTag(p.Segment), a = s.getMatroskaCodedNum(), a += s.getPos(), o = s.getPos(); s.moreData() && !s.consumeTagAndSize(p.Segment.Info, !0);) if (!(s.skipOverElement(p.Segment.SeekHead, !0) || s.skipOverElement(p.Segment.Tracks, !0) || s.skipOverElement(p.Segment.Cues, !0) || s.skipOverElement(p.Void, !0))) throw new Error(`no valid top level element found`); for (;void 0 === u;) { const d = s.getMatroskaCodedNum(!0); const f = s.getMatroskaCodedNum(); d === p.Segment.Info.Duration.tag ? u = s[p.Segment.Info.Duration.parse](f) : s.setPos(s.getPos() + f); }n = E(l); g.load({ request: n, success: function (e) { i = _(e, o, a, u), r(i); }, error: function () { h.error(`Download Error: Cues ${l.url}`), r(null); } }), h.debug(`Perform cues load: ${l.url} bytes=${l.range.start}-${l.range.end}`); } else r(null); }(e, s, i, (e) => { a(t, n, e, r); })); }, error: function () { a(t, n, null, r); } }); }, reset: function () { r = n = null; } }, p = { EBML: { tag: 440786851, required: !0 }, Segment: { tag: 408125543, required: !0, SeekHead: { tag: 290298740, required: !0 }, Info: { tag: 357149030, required: !0, TimecodeScale: { tag: 2807729, required: !0, parse: `getMatroskaUint` }, Duration: { tag: 17545, required: !0, parse: `getMatroskaFloat` } }, Tracks: { tag: 374648427, required: !0 }, Cues: { tag: 475249515, required: !0, CuePoint: { tag: 187, required: !0, CueTime: { tag: 179, required: !0, parse: `getMatroskaUint` }, CueTrackPositions: { tag: 183, required: !0, CueTrack: { tag: 247, required: !0, parse: `getMatroskaUint` }, CueClusterPosition: { tag: 241, required: !0, parse: `getMatroskaUint` } } } } }, Void: { tag: 236, required: !0 } }, t; }a.__dashjs_factory_name = `WebmSegmentBaseLoader`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 108: 108, 159: 159, 218: 218, 232: 232, 234: 234, 47: 47, 94: 94 }], 61: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } } function i () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, i)), this.init(); }Object.defineProperty(n, `__esModule`, { value: !0 }); const a = new ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(i, [{ key: `init`, value: function () { this.BASE_URL = `BaseURL`, this.SEGMENT_BASE = `SegmentBase`, this.SEGMENT_TEMPLATE = `SegmentTemplate`, this.SEGMENT_LIST = `SegmentList`, this.SEGMENT_URL = `SegmentURL`, this.SEGMENT_TIMELINE = `SegmentTimeline`, this.SEGMENT_PROFILES = `segmentProfiles`, this.ADAPTATION_SET = `AdaptationSet`, this.REPRESENTATION = `Representation`, this.REPRESENTATION_INDEX = `RepresentationIndex`, this.SUB_REPRESENTATION = `SubRepresentation`, this.INITIALIZATION = `Initialization`, this.INITIALIZATION_MINUS = `initialization`, this.MPD = `MPD`, this.PERIOD = `Period`, this.ASSET_IDENTIFIER = `AssetIdentifier`, this.EVENT_STREAM = `EventStream`, this.ID = `id`, this.PROFILES = `profiles`, this.SERVICE_LOCATION = `serviceLocation`, this.RANGE = `range`, this.INDEX = `index`, this.MEDIA = `media`, this.BYTE_RANGE = `byteRange`, this.INDEX_RANGE = `indexRange`, this.MEDIA_RANGE = `mediaRange`, this.VALUE = `value`, this.CONTENT_TYPE = `contentType`, this.MIME_TYPE = `mimeType`, this.BITSTREAM_SWITCHING = `BitstreamSwitching`, this.BITSTREAM_SWITCHING_MINUS = `bitstreamSwitching`, this.CODECS = `codecs`, this.DEPENDENCY_ID = `dependencyId`, this.MEDIA_STREAM_STRUCTURE_ID = `mediaStreamStructureId`, this.METRICS = `Metrics`, this.METRICS_MINUS = `metrics`, this.REPORTING = `Reporting`, this.WIDTH = `width`, this.HEIGHT = `height`, this.SAR = `sar`, this.FRAMERATE = `frameRate`, this.AUDIO_SAMPLING_RATE = `audioSamplingRate`, this.MAXIMUM_SAP_PERIOD = `maximumSAPPeriod`, this.START_WITH_SAP = `startWithSAP`, this.MAX_PLAYOUT_RATE = `maxPlayoutRate`, this.CODING_DEPENDENCY = `codingDependency`, this.SCAN_TYPE = `scanType`, this.FRAME_PACKING = `FramePacking`, this.AUDIO_CHANNEL_CONFIGURATION = `AudioChannelConfiguration`, this.CONTENT_PROTECTION = `ContentProtection`, this.ESSENTIAL_PROPERTY = `EssentialProperty`, this.SUPPLEMENTAL_PROPERTY = `SupplementalProperty`, this.INBAND_EVENT_STREAM = `InbandEventStream`, this.ACCESSIBILITY = `Accessibility`, this.ROLE = `Role`, this.RATING = `Rating`, this.CONTENT_COMPONENT = `ContentComponent`, this.SUBSET = `Subset`, this.LANG = `lang`, this.VIEWPOINT = `Viewpoint`, this.ROLE_ASARRAY = `Role_asArray`, this.ACCESSIBILITY_ASARRAY = `Accessibility_asArray`, this.AUDIOCHANNELCONFIGURATION_ASARRAY = `AudioChannelConfiguration_asArray`, this.CONTENTPROTECTION_ASARRAY = `ContentProtection_asArray`, this.MAIN = `main`, this.DYNAMIC = `dynamic`, this.STATIC = `static`, this.MEDIA_PRESENTATION_DURATION = `mediaPresentationDuration`, this.MINIMUM_UPDATE_PERIOD = `minimumUpdatePeriod`, this.CODEC_PRIVATE_DATA = `codecPrivateData`, this.BANDWITH = `bandwidth`, this.SOURCE_URL = `sourceURL`, this.TIMESCALE = `timescale`, this.DURATION = `duration`, this.START_NUMBER = `startNumber`, this.PRESENTATION_TIME_OFFSET = `presentationTimeOffset`, this.AVAILABILITY_START_TIME = `availabilityStartTime`, this.AVAILABILITY_END_TIME = `availabilityEndTime`, this.TIMESHIFT_BUFFER_DEPTH = `timeShiftBufferDepth`, this.MAX_SEGMENT_DURATION = `maxSegmentDuration`, this.PRESENTATION_TIME = `presentationTime`, this.MIN_BUFFER_TIME = `minBufferTime`, this.MAX_SUBSEGMENT_DURATION = `maxSubsegmentDuration`, this.START = `start`, this.AVAILABILITY_TIME_OFFSET = `availabilityTimeOffset`, this.AVAILABILITY_TIME_COMPLETE = `availabilityTimeComplete`, this.CENC_DEFAULT_KID = `cenc:default_KID`, this.DVB_PRIORITY = `dvb:priority`, this.DVB_WEIGHT = `dvb:weight`, this.SUGGESTED_PRESENTATION_DELAY = `suggestedPresentationDelay`, this.SERVICE_DESCRIPTION = `ServiceDescription`, this.SERVICE_DESCRIPTION_SCOPE = `Scope`, this.SERVICE_DESCRIPTION_LATENCY = `Latency`, this.SERVICE_DESCRIPTION_PLAYBACK_RATE = `PlaybackRate`; } }])), i)(); n.default = a, t.exports = n.default; }, {}], 62: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const O = r(e(108)); const P = r(e(232)); var e = r(e(47)); function i (e) { const i = (e = e || {}).eventBus; const a = e.events; const o = e.errors; const s = e.abrController; const u = e.dashMetrics; const l = e.playbackController; const n = e.timelineConverter; const d = e.type; const f = e.streamInfo; const c = e.dashConstants; let t = void 0; let h = void 0; let p = void 0; let g = void 0; let _ = void 0; function r () { return d; } function m () { if (!(s && u && l && n)) throw new Error(O.default.MISSING_CONFIG_ERROR); } function E () { return p; } function y () { return _; } function v () { p = !(h = null), g = []; } function T () { m(); const e = new Date(); const t = _; const n = 1e3 * l.getTime(); t && u.addRepresentationSwitch(t.adaptation.type, e, n, t.id); } function S (e) { return e == null || e >= g.length ? null : g[e]; } function A (e, t) { e.segmentAvailabilityRange = n.calcSegmentAvailabilityRange(e, t), e.segmentAvailabilityRange.end < e.segmentAvailabilityRange.start ? b(new P.default(o.SEGMENTS_UNAVAILABLE_ERROR_CODE, o.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE, { availabilityDelay: e.segmentAvailabilityRange.start - e.segmentAvailabilityRange.end })) : t && (e = e.segmentAvailabilityRange.end, n.setExpectedLiveEdge(e), u.updateManifestUpdateInfo({ presentationStartTime: e })); } function I (e, t) { m(); for (let n = 0, r = g.length; n < r; n++)A(g[n], e), t && i.trigger(a.REPRESENTATION_UPDATE_STARTED, { representation: g[n] }, { streamId: f.id, mediaType: d }); } function R () { p = !0, i.trigger(a.DATA_UPDATE_STARTED, {}, { streamId: f.id, mediaType: d }); } function b (e) { p = !1, i.trigger(a.DATA_UPDATE_COMPLETED, { data: h, currentRepresentation: _, error: e }, { streamId: f.id, mediaType: d }); } function D (e) { i.trigger(a.AST_IN_FUTURE, { delay: e }), setTimeout(() => { p || (R(), g.forEach((e) => { e.segmentAvailabilityRange = null; }), I(l.getIsDynamic(), !0)); }, e); } function M (e) { if (p) if (e.error)b(e.error); else { let t; const n = e.representation; const r = u.getCurrentManifestUpdate(); let i = !1; var e = 0; if (n.adaptation.period.mpd.manifest.type === c.DYNAMIC && !n.adaptation.period.mpd.manifest.ignorePostponeTimePeriod && l.getStreamController().getStreams().length <= 1 && (e = (function (e) { try { const t = l.getStreamController().getActiveStreamInfo(); let n = e.segmentAvailabilityRange.start; t && t.id && t.id !== f.id && (n = Math.min(l.getTime(), n)); n = e.segmentAvailabilityRange.end - n; return 1e3 * (l.getLiveDelay() - n); } catch (e) { return 0; } }(n))), e > 0) return D(e), void b(new P.default(o.SEGMENTS_UPDATE_FAILED_ERROR_CODE, o.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE)); if (r) { for (let a = 0; a < r.representationInfo.length; a++) if ((t = r.representationInfo[a]).index === n.index && t.mediaType === d) { i = !0; break; }i || u.addManifestUpdateRepresentationInfo(n, d); }!(function () { for (let e = 0, t = g.length; e < t; e++) { const n = g[e].segmentInfoType; if (g[e].segmentAvailabilityRange === null || !g[e].hasInitialization() || (n === c.SEGMENT_BASE || n === c.BASE_URL) && !g[e].segments) return; } return 1; }()) || (s.setPlaybackQuality(d, f, (e = _, g.indexOf(e))), u.updateManifestUpdateInfo({ latency: _.segmentAvailabilityRange.end - l.getTime() }), u.getCurrentRepresentationSwitch(_.adaptation.type) || T(), b()); } } function N (e) { e.isDynamic && I(e.isDynamic); } function C (e) { _ = S(e.newQuality), T(); } function w (e) { e.newDuration && _ && _.adaptation.period && (_.adaptation.period.duration = e.newDuration); } return t = { getStreamId: function () { return f.id; }, getType: r, getData: function () { return h; }, isUpdating: E, updateData: function (e, t, n, r) { m(), R(), g = t, _ = S(r), h = e, n === O.default.VIDEO || n === O.default.AUDIO || n === O.default.FRAGMENTED_TEXT ? I(l.getIsDynamic(), !0) : b(); }, updateRepresentation: A, getCurrentRepresentation: y, getRepresentationForQuality: S, reset: function () { i.off(a.QUALITY_CHANGE_REQUESTED, C, t), i.off(a.REPRESENTATION_UPDATE_COMPLETED, M, t), i.off(a.WALLCLOCK_TIME_UPDATED, N, t), i.off(a.MANIFEST_VALIDITY_CHANGED, w, t), v(); } }, v(), i.on(a.QUALITY_CHANGE_REQUESTED, C, t), i.on(a.REPRESENTATION_UPDATE_COMPLETED, M, t), i.on(a.WALLCLOCK_TIME_UPDATED, N, t), i.on(a.MANIFEST_VALIDITY_CHANGED, w, t), t; }i.__dashjs_factory_name = `RepresentationController`, n.default = e.default.getClassFactory(i), t.exports = n.default; }, { 108: 108, 232: 232, 47: 47 }], 63: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const E = r(e(59)); const y = r(e(60)); function a (e) { e = e || {}; const t = this.context; const n = e.eventBus; const r = e.events; const i = e.dashMetrics; const a = e.mediaPlayerModel; const o = e.errHandler; const s = e.baseURLController; const u = e.debug; const l = e.boxParser; const d = e.requestModifier; const f = e.errors; let c = void 0; let h = void 0; let p = void 0; function g (e) { return (e ? e.split(`/`)[1] : ``).toLowerCase() === `webm`; } function _ (e) { (g(e.mimeType) ? p : h).loadInitialization(e.streamId, e.mediaType, e.representation); } function m (e) { (g(e.mimeType) ? p : h).loadSegments(e.streamId, e.mediaType, e.representation, e.representation ? e.representation.indexRange : null, e.callback); } return c = { initialize: function () { n.on(r.SEGMENTBASE_INIT_REQUEST_NEEDED, _, c), n.on(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED, m, c), h.initialize(), p.initialize(); }, reset: function () { n.off(r.SEGMENTBASE_INIT_REQUEST_NEEDED, _, c), n.off(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED, m, c); } }, h = (0, E.default)(t).getInstance(), p = (0, y.default)(t).getInstance(), h.setConfig({ baseURLController: s, dashMetrics: i, mediaPlayerModel: a, errHandler: o, eventBus: n, events: r, errors: f, debug: u, boxParser: l, requestModifier: d }), p.setConfig({ baseURLController: s, dashMetrics: i, mediaPlayerModel: a, errHandler: o, eventBus: n, events: r, errors: f, debug: u, requestModifier: d }), c; }a.__dashjs_factory_name = `SegmentBaseController`; i = i.default.getSingletonFactory(a); n.default = i, t.exports = n.default; }, { 47: 47, 59: 59, 60: 60 }], 64: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const d = r(e(83)); const f = r(e(81)); const c = r(e(77)); const h = r(e(79)); function a (t) { t = t || {}; let e; const n = this.context; const i = t.events; const a = t.eventBus; const r = t.dashConstants; const o = t.streamInfo; const s = t.type; let u = void 0; function l (e) { return e ? e.segments ? u[r.SEGMENT_BASE] : u[e.segmentInfoType] : null; } return e = { initialize: function (e) { u[r.SEGMENT_TIMELINE] = (0, d.default)(n).create(t, e), u[r.SEGMENT_TEMPLATE] = (0, f.default)(n).create(t, e), u[r.SEGMENT_LIST] = (0, c.default)(n).create(t, e), u[r.SEGMENT_BASE] = (0, h.default)(n).create(t, e); }, update: function (e, t, n, r) { n || a.trigger(i.SEGMENTBASE_INIT_REQUEST_NEEDED, { streamId: o.id, mediaType: s, mimeType: t, representation: e }), r || a.trigger(i.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED, { streamId: o.id, mediaType: s, mimeType: t, representation: e }); }, getSegmentByIndex: function (e, t, n) { const r = l(e); return r ? r.getSegmentByIndex(e, t, n) : null; }, getSegmentByTime: function (e, t) { const n = l(e); return n ? n.getSegmentByTime(e, t) : null; } }, u = {}, e; }a.__dashjs_factory_name = `SegmentsController`; i = i.default.getClassFactory(a); n.default = i, t.exports = n.default; }, { 47: 47, 77: 77, 79: 79, 81: 81, 83: 83 }], 65: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const y = r(e(108)); const v = r(e(61)); const T = r(e(92)); const S = r(e(84)); const A = r(e(91)); const i = r(e(90)); const I = r(e(96)); const R = r(e(86)); const b = r(e(85)); const D = r(e(87)); const M = r(e(223)); const N = r(e(227)); const a = r(e(47)); const C = r(e(45)); const w = r(e(232)); const O = r(e(51)); const P = e(211); function o () { let e = void 0; let l = void 0; let d = void 0; let f = void 0; const a = this.context; const o = (0, N.default)(a).getInstance(); const h = Number.isInteger || function (e) { return typeof e === `number` && isFinite(e) && Math.floor(e) === e; }; function s (e, t) { let n; let r = void 0; let i = void 0; let a = void 0; let o = void 0; let s = void 0; let u = !1; let l = !1; if (!e) throw new Error(`adaptation is not defined`); if (!t) throw new Error(`type is not defined`); if (e.hasOwnProperty(`ContentComponent_asArray`) && (a = e.ContentComponent_asArray), o = t !== y.default.TEXT ? new RegExp(t) : new RegExp(`(vtt|ttml)`), e.Representation_asArray && e.Representation_asArray.length && e.Representation_asArray.length > 0) { const d = _(e.Representation_asArray[0]); if (d && d.length > 0 && P.THUMBNAILS_SCHEME_ID_URIS.indexOf(d[0].schemeIdUri) >= 0) return t === y.default.IMAGE; if (e.Representation_asArray[0].hasOwnProperty(v.default.CODECS) && ((s = e.Representation_asArray[0].codecs).search(y.default.STPP) === 0 || s.search(y.default.WVTT) === 0)) return t === y.default.FRAGMENTED_TEXT; } if (a) { if (a.length > 1) return t === y.default.MUXED; a[0] && a[0].contentType === t && (l = u = !0); } if (e.hasOwnProperty(v.default.MIME_TYPE) && (u = o.test(e.mimeType), l = !0), !l) for (r = 0, n = e.Representation_asArray && e.Representation_asArray.length ? e.Representation_asArray.length : 0; !l && r < n;)(i = e.Representation_asArray[r]).hasOwnProperty(v.default.MIME_TYPE) && (u = o.test(i.mimeType), l = !0), r++; return u; } function p (e) { return e === `text/vtt` || e === `application/ttml+xml`; } function t () { return function (e, t) { return e.bandwidth - t.bandwidth; }; } function g (e) { return e && Array.isArray(e.Representation_asArray) && e.Representation_asArray.sort(t()), e; } function u (e, t) { return e && e.Period_asArray && h(t) && e.Period_asArray[t] ? e.Period_asArray[t].AdaptationSet_asArray : []; } function c (e) { let t = !1; return e && e.hasOwnProperty(`type`) && (t = e.type === v.default.DYNAMIC), t; } function _ (e) { return e && e.EssentialProperty_asArray && e.EssentialProperty_asArray.length ? e.EssentialProperty_asArray.map((e) => { return { schemeIdUri: e.schemeIdUri, value: e.value }; }) : null; } function m (e, t) { const n = []; let r = void 0; if (!e) return n; for (r = 0; r < e.length; r++) { const i = new D.default(); if (i.timescale = 1, i.representation = t, !e[r].hasOwnProperty(y.default.SCHEME_ID_URI)) throw new Error(`Invalid EventStream. SchemeIdUri has to be set`); i.schemeIdUri = e[r].schemeIdUri, e[r].hasOwnProperty(v.default.TIMESCALE) && (i.timescale = e[r].timescale), e[r].hasOwnProperty(v.default.VALUE) && (i.value = e[r].value), n.push(i); } return n; } function E (r) { const i = []; const e = r.BaseURL_asArray || [r.baseUri]; let a = !1; return e.some((e) => { if (e) { const t = new b.default(); let n = e.__text || e; return o.isRelative(n) && (a = !0, r.baseUri && (n = o.resolve(n, r.baseUri))), t.url = n, e.hasOwnProperty(v.default.SERVICE_LOCATION) && e.serviceLocation.length ? t.serviceLocation = e.serviceLocation : t.serviceLocation = n, e.hasOwnProperty(v.default.DVB_PRIORITY) && (t.dvb_priority = e[v.default.DVB_PRIORITY]), e.hasOwnProperty(v.default.DVB_WEIGHT) && (t.dvb_weight = e[v.default.DVB_WEIGHT]), e.hasOwnProperty(v.default.AVAILABILITY_TIME_OFFSET) && (t.availabilityTimeOffset = e[v.default.AVAILABILITY_TIME_OFFSET]), e.hasOwnProperty(v.default.AVAILABILITY_TIME_COMPLETE) && (t.availabilityTimeComplete = e[v.default.AVAILABILITY_TIME_COMPLETE] !== `false`), i.push(t), a; } }), i; } return e = { getIsTypeOf: s, getIsTextTrack: p, getLanguageForAdaptation: function (e) { let t = ``; return e && e.hasOwnProperty(v.default.LANG) && (t = e.lang.replace(/[^A-Za-z0-9-]/g, ``)), t; }, getViewpointForAdaptation: function (e) { return e && e.hasOwnProperty(v.default.VIEWPOINT) ? e.Viewpoint : null; }, getRolesForAdaptation: function (e) { return e && e.hasOwnProperty(v.default.ROLE_ASARRAY) ? e.Role_asArray : []; }, getAccessibilityForAdaptation: function (e) { return e && e.hasOwnProperty(v.default.ACCESSIBILITY_ASARRAY) ? e.Accessibility_asArray : []; }, getAudioChannelConfigurationForAdaptation: function (e) { return e && e.hasOwnProperty(v.default.AUDIOCHANNELCONFIGURATION_ASARRAY) ? e.AudioChannelConfiguration_asArray : []; }, getAudioChannelConfigurationForRepresentation: function (e) { return e && e.hasOwnProperty(v.default.AUDIOCHANNELCONFIGURATION_ASARRAY) ? e.AudioChannelConfiguration_asArray : []; }, getAdaptationForIndex: function (e, t, n) { return (n = u(t, n)).length > 0 && h(e) ? n[e] : null; }, getIndexForAdaptation: function (e, t, n) { if (!e) return -1; for (let r = u(t, n), i = 0; i < r.length; i++) { if ((0, M.default)(a).getInstance().areEqual(r[i], e)) return i; } return -1; }, getAdaptationForId: function (e, t, n) { for (var r = u(t, n), i = void 0, i = 0, a = r.length; i < a; i++) if (r[i].hasOwnProperty(v.default.ID) && r[i].id === e) return r[i]; return null; }, getAdaptationsForType: function (e, t, n) { for (var r = u(e, t), i = void 0, a = [], i = 0, o = r.length; i < o; i++)s(r[i], n) && a.push(g(r[i])); return a; }, getCodec: function (e, t, n) { let r = null; return e && e.Representation_asArray && e.Representation_asArray.length > 0 && ((e = h(t) && t >= 0 && t < e.Representation_asArray.length ? e.Representation_asArray[t] : e.Representation_asArray[0]) && (r = `${e.mimeType};codecs="${e.codecs}"`, n && void 0 !== e.width && (r += `;width="${e.width}";height="${e.height}"`))), r = r && r.replace(/\sprofiles=[^;]*/g, ``); }, getMimeType: function (e) { return e && e.Representation_asArray && e.Representation_asArray.length > 0 ? e.Representation_asArray[0].mimeType : null; }, getKID: function (e) { return e && e.hasOwnProperty(v.default.CENC_DEFAULT_KID) ? e[v.default.CENC_DEFAULT_KID] : null; }, getLabelsForAdaptation: function (e) { if (!e || !Array.isArray(e.Label_asArray)) return []; for (var t = [], n = 0; n < e.Label_asArray.length; n++)t.push({ lang: e.Label_asArray[n].lang, text: e.Label_asArray[n].__text || e.Label_asArray[n] }); return t; }, getContentProtectionData: function (e) { return e && e.hasOwnProperty(v.default.CONTENTPROTECTION_ASARRAY) && e.ContentProtection_asArray.length !== 0 ? e.ContentProtection_asArray : null; }, getIsDynamic: c, hasProfile: function (e, t) { let n = !1; return e && e.profiles && e.profiles.length > 0 && (n = e.profiles.indexOf(t) !== -1), n; }, getDuration: function (e) { return e && e.hasOwnProperty(v.default.MEDIA_PRESENTATION_DURATION) ? e.mediaPresentationDuration : e && e.type == `dynamic` ? Number.POSITIVE_INFINITY : Number.MAX_SAFE_INTEGER || Number.MAX_VALUE; }, getBandwidth: function (e) { return e && e.bandwidth ? e.bandwidth : NaN; }, getManifestUpdatePeriod: function (e) { const t = arguments.length <= 1 || void 0 === arguments[1] ? 0 : arguments[1]; let n = NaN; return e && e.hasOwnProperty(v.default.MINIMUM_UPDATE_PERIOD) && (n = e.minimumUpdatePeriod), isNaN(n) ? n : Math.max(n - t, 1); }, getRepresentationCount: function (e) { return e && Array.isArray(e.Representation_asArray) ? e.Representation_asArray.length : 0; }, getBitrateListForAdaptation: function (e) { return ((e = g(e)) && Array.isArray(e.Representation_asArray) ? e.Representation_asArray : []).map((e) => { return { bandwidth: e.bandwidth, width: e.width || 0, height: e.height || 0, scanType: e.scanType || null, id: e.id || null }; }); }, getRepresentationFor: function (e, t) { return t && t.Representation_asArray && t.Representation_asArray.length > 0 && h(e) ? t.Representation_asArray[e] : null; }, getRepresentationsForAdaptation: function (e) { let t; let n; let r; const i = []; const a = (function (e) { if (e && e.period && h(e.period.index)) { const t = e.period.mpd.manifest.Period_asArray[e.period.index]; if (t && t.AdaptationSet_asArray && h(e.index)) return g(t.AdaptationSet_asArray[e.index]); } }(e)); let o = void 0; let s = void 0; if (a && a.Representation_asArray) { e && e.period && h(e.period.index) && ((t = E(e.period.mpd.manifest)) && (s = t[0])); for (let u = 0, l = a.Representation_asArray.length; u < l; ++u) { var d; const f = a.Representation_asArray[u]; const c = new T.default(); c.index = u, c.adaptation = e, f.hasOwnProperty(v.default.ID) && (c.id = f.id), f.hasOwnProperty(v.default.CODECS) && (c.codecs = f.codecs), f.hasOwnProperty(v.default.CODEC_PRIVATE_DATA) && (c.codecPrivateData = f.codecPrivateData), f.hasOwnProperty(v.default.BANDWITH) && (c.bandwidth = f.bandwidth), f.hasOwnProperty(v.default.WIDTH) && (c.width = f.width), f.hasOwnProperty(v.default.HEIGHT) && (c.height = f.height), f.hasOwnProperty(v.default.SCAN_TYPE) && (c.scanType = f.scanType), f.hasOwnProperty(v.default.MAX_PLAYOUT_RATE) && (c.maxPlayoutRate = f.maxPlayoutRate), f.hasOwnProperty(v.default.SEGMENT_BASE) ? (o = f.SegmentBase, c.segmentInfoType = v.default.SEGMENT_BASE) : f.hasOwnProperty(v.default.SEGMENT_LIST) ? (o = f.SegmentList).hasOwnProperty(v.default.SEGMENT_TIMELINE) ? c.segmentInfoType = v.default.SEGMENT_TIMELINE : c.segmentInfoType = v.default.SEGMENT_LIST : f.hasOwnProperty(v.default.SEGMENT_TEMPLATE) ? ((o = f.SegmentTemplate).hasOwnProperty(v.default.SEGMENT_TIMELINE) ? c.segmentInfoType = v.default.SEGMENT_TIMELINE : c.segmentInfoType = v.default.SEGMENT_TEMPLATE, o.hasOwnProperty(v.default.INITIALIZATION_MINUS) && (c.initialization = o.initialization.split(`$Bandwidth$`).join(f.bandwidth).split(`$RepresentationID$`).join(f.id))) : c.segmentInfoType = v.default.BASE_URL, c.essentialProperties = _(f), o && (o.hasOwnProperty(v.default.INITIALIZATION) ? ((d = o.Initialization).hasOwnProperty(v.default.SOURCE_URL) && (c.initialization = d.sourceURL), d.hasOwnProperty(v.default.RANGE) && (c.range = d.range)) : f.hasOwnProperty(v.default.MIME_TYPE) && p(f.mimeType) && (c.range = 0), o.hasOwnProperty(v.default.TIMESCALE) && (c.timescale = o.timescale), o.hasOwnProperty(v.default.DURATION) ? c.segmentDuration = o.duration / c.timescale : f.hasOwnProperty(v.default.SEGMENT_TEMPLATE) && (o = f.SegmentTemplate).hasOwnProperty(v.default.SEGMENT_TIMELINE) && (c.segmentDuration = (n = o.SegmentTimeline, r = void 0, r = n.S_asArray[0], n = n.S_asArray[1], (r.hasOwnProperty(`d`) ? r.d : n.t - r.t) / c.timescale)), o.hasOwnProperty(v.default.MEDIA) && (c.media = o.media), o.hasOwnProperty(v.default.START_NUMBER) && (c.startNumber = o.startNumber), o.hasOwnProperty(v.default.INDEX_RANGE) && (c.indexRange = o.indexRange), o.hasOwnProperty(v.default.PRESENTATION_TIME_OFFSET) && (c.presentationTimeOffset = o.presentationTimeOffset / c.timescale), o.hasOwnProperty(v.default.AVAILABILITY_TIME_OFFSET) ? c.availabilityTimeOffset = o.availabilityTimeOffset : s && void 0 !== s.availabilityTimeOffset && (c.availabilityTimeOffset = s.availabilityTimeOffset), o.hasOwnProperty(v.default.AVAILABILITY_TIME_COMPLETE) ? c.availabilityTimeComplete = o.availabilityTimeComplete !== `false` : s && void 0 !== s.availabilityTimeComplete && (c.availabilityTimeComplete = s.availabilityTimeComplete)), c.MSETimeOffset = (n = void 0, n = (r = c).presentationTimeOffset, r.adaptation.period.start - n), c.path = [e.period.index, e.index, u], i.push(c); } } return i; }, getAdaptationsForPeriod: function (e) { const t = e && h(e.index) ? e.mpd.manifest.Period_asArray[e.index] : null; const n = []; let r = void 0; let i = void 0; let a = void 0; if (t && t.AdaptationSet_asArray) for (a = 0; a < t.AdaptationSet_asArray.length; a++)i = t.AdaptationSet_asArray[a], r = new S.default(), i.hasOwnProperty(v.default.ID) && (r.id = i.id), r.index = a, r.period = e, s(i, y.default.MUXED) ? r.type = y.default.MUXED : s(i, y.default.AUDIO) ? r.type = y.default.AUDIO : s(i, y.default.VIDEO) ? r.type = y.default.VIDEO : s(i, y.default.FRAGMENTED_TEXT) ? r.type = y.default.FRAGMENTED_TEXT : s(i, y.default.IMAGE) ? r.type = y.default.IMAGE : r.type = y.default.TEXT, n.push(r); return n; }, getRegularPeriods: function (e) { for (var t = !!e && c(e.manifest), n = [], r = null, i = null, a = null, o = null, s = void 0, s = 0, u = e && e.manifest && e.manifest.Period_asArray ? e.manifest.Period_asArray.length : 0; s < u; s++)(i = e.manifest.Period_asArray[s]).hasOwnProperty(v.default.START) ? (o = new A.default()).start = i.start : r !== null && r.hasOwnProperty(v.default.DURATION) && a !== null ? (o = new A.default()).start = parseFloat((a.start + a.duration).toFixed(5)) : s !== 0 || t || ((o = new A.default()).start = 0), a !== null && isNaN(a.duration) && (o !== null ? a.duration = parseFloat((o.start - a.start).toFixed(5)) : l.warn(`First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback`)), o !== null && (o.id = (function (e, t) { if (!e) throw new Error(`Period cannot be null or undefined`); t = `${A.default.DEFAULT_ID}_${t}`; e.hasOwnProperty(v.default.ID) && e.id.length > 0 && e.id !== `__proto__` && (t = e.id); return t; }(i, s)), o.index = s, o.mpd = e, i.hasOwnProperty(v.default.DURATION) && (o.duration = i.duration), n.push(o), r = i, a = o), o = i = null; return n.length === 0 || a !== null && isNaN(a.duration) && (a.duration = parseFloat(((function (e) { !(function () { if (!d || !d.hasOwnProperty(`error`)) throw new Error(y.default.MISSING_CONFIG_ERROR); }()); const t = c(e.mpd.manifest); let n = void 0; e.mpd.manifest.mediaPresentationDuration ? n = e.mpd.manifest.mediaPresentationDuration : e.duration ? n = e.duration : t ? n = Number.POSITIVE_INFINITY : d.error(new w.default(O.default.MANIFEST_ERROR_ID_PARSE_CODE, `Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.`, e)); return n; }(a)) - a.start).toFixed(5))), n; }, getMpd: function (e) { const t = new i.default(); return e && ((t.manifest = e).hasOwnProperty(v.default.AVAILABILITY_START_TIME) ? t.availabilityStartTime = new Date(e.availabilityStartTime.getTime()) : e.loadedTime && (t.availabilityStartTime = new Date(e.loadedTime.getTime())), e.hasOwnProperty(v.default.AVAILABILITY_END_TIME) && (t.availabilityEndTime = new Date(e.availabilityEndTime.getTime())), e.hasOwnProperty(v.default.MINIMUM_UPDATE_PERIOD) && (t.minimumUpdatePeriod = e.minimumUpdatePeriod), e.hasOwnProperty(v.default.MEDIA_PRESENTATION_DURATION) && (t.mediaPresentationDuration = e.mediaPresentationDuration), e.hasOwnProperty(v.default.SUGGESTED_PRESENTATION_DELAY) && (t.suggestedPresentationDelay = e.suggestedPresentationDelay), e.hasOwnProperty(v.default.TIMESHIFT_BUFFER_DEPTH) && (t.timeShiftBufferDepth = e.timeShiftBufferDepth), e.hasOwnProperty(v.default.MAX_SEGMENT_DURATION) && (t.maxSegmentDuration = e.maxSegmentDuration)), t; }, getEventsForPeriod: function (e) { let t = e && e.mpd && e.mpd.manifest ? e.mpd.manifest : null; const n = (t = t ? t.Period_asArray : null) && e && h(e.index) ? t[e.index].EventStream_asArray : null; const r = []; let i = void 0; let a = void 0; if (n) for (i = 0; i < n.length; i++) { const o = new D.default(); if (o.period = e, o.timescale = 1, !n[i].hasOwnProperty(y.default.SCHEME_ID_URI)) throw new Error(`Invalid EventStream. SchemeIdUri has to be set`); for (o.schemeIdUri = n[i][y.default.SCHEME_ID_URI], n[i].hasOwnProperty(v.default.TIMESCALE) && (o.timescale = n[i][v.default.TIMESCALE]), n[i].hasOwnProperty(v.default.VALUE) && (o.value = n[i][v.default.VALUE]), n[i].hasOwnProperty(v.default.PRESENTATION_TIME_OFFSET) && (o.presentationTimeOffset = n[i][v.default.PRESENTATION_TIME_OFFSET]), a = 0; n[i].Event_asArray && a < n[i].Event_asArray.length; a++) { var s; const u = n[i].Event_asArray[a]; const l = new R.default(); l.presentationTime = 0, l.eventStream = o, u.hasOwnProperty(v.default.PRESENTATION_TIME) && (l.presentationTime = u.presentationTime, s = o.presentationTimeOffset ? o.presentationTimeOffset / o.timescale : 0, l.calculatedPresentationTime = l.presentationTime / o.timescale + e.start - s), u.hasOwnProperty(v.default.DURATION) && (l.duration = u.duration / o.timescale), u.hasOwnProperty(v.default.ID) && (l.id = u.id), u.Signal && u.Signal.Binary ? l.messageData = f.decodeArray(u.Signal.Binary.toString()) : l.messageData = u.messageData || u.__text, r.push(l); } } return r; }, getEventStreamForAdaptationSet: function (e, t) { let n; let r; let i = void 0; return e && e.Period_asArray && t && t.period && h(t.period.index) && (n = e.Period_asArray[t.period.index]) && n.AdaptationSet_asArray && h(t.index) && (r = n.AdaptationSet_asArray[t.index]) && (i = r.InbandEventStream_asArray), m(i, null); }, getEventStreamForRepresentation: function (e, t) { let n; let r; let i; let a = void 0; return e && e.Period_asArray && t && t.adaptation && t.adaptation.period && h(t.adaptation.period.index) && (n = e.Period_asArray[t.adaptation.period.index]) && n.AdaptationSet_asArray && h(t.adaptation.index) && (r = n.AdaptationSet_asArray[t.adaptation.index]) && r.Representation_asArray && h(t.index) && (i = r.Representation_asArray[t.index]) && (a = i.InbandEventStream_asArray), m(a, t); }, getUTCTimingSources: function (e) { const t = c(e); const n = !!e && e.hasOwnProperty(v.default.AVAILABILITY_START_TIME); var e = e ? e.UTCTiming_asArray : null; const r = []; return (t || n) && e && e.forEach((e) => { const t = new I.default(); e.hasOwnProperty(y.default.SCHEME_ID_URI) && (t.schemeIdUri = e.schemeIdUri, e.hasOwnProperty(v.default.VALUE) && (t.value = e.value.toString(), r.push(t))); }), r; }, getBaseURLsFromElement: E, getRepresentationSortFunction: t, getLocation: function (e) { if (e && e.hasOwnProperty(y.default.LOCATION)) return e.Location = e.Location_asArray[0], e.Location; }, getSuggestedPresentationDelay: function (e) { return e && e.hasOwnProperty(v.default.SUGGESTED_PRESENTATION_DELAY) ? e.suggestedPresentationDelay : null; }, getAvailabilityStartTime: function (e) { return e && e.hasOwnProperty(v.default.AVAILABILITY_START_TIME) && e.availabilityStartTime !== null ? e.availabilityStartTime.getTime() : null; }, getServiceDescriptions: function (e) { const t = []; if (e && e.hasOwnProperty(v.default.SERVICE_DESCRIPTION)) { let n = !0; let r = !1; let i = void 0; try { for (var a, o = e.ServiceDescription_asArray[Symbol.iterator](); !(n = (a = o.next()).done); n = !0) { var s; const u = a.value; let l = void 0; let d = void 0; let f = void 0; let c = void 0; for (s in u)u.hasOwnProperty(s) && (s === v.default.ID ? l = u[s] : s === v.default.SERVICE_DESCRIPTION_SCOPE ? d = u[s].schemeIdUri : s === v.default.SERVICE_DESCRIPTION_LATENCY ? f = { target: u[s].target, max: u[s].max, min: u[s].min } : s === v.default.SERVICE_DESCRIPTION_PLAYBACK_RATE && (c = { max: u[s].max, min: u[s].min })); d === y.default.SERVICE_DESCRIPTION_LL_SCHEME && (f || c) && t.push({ id: l, schemeIdUri: d, latency: f, playbackRate: c }); } } catch (e) { r = !0, i = e; } finally { try { !n && o.return && o.return(); } finally { if (r) throw i; } } } return t; }, getSupplementalPropperties: function (e) { const t = {}; if (e && e.hasOwnProperty(v.default.SUPPLEMENTAL_PROPERTY)) { let n = !0; let r = !1; let i = void 0; try { for (var a = e.SupplementalProperty_asArray[Symbol.iterator](); !(n = (o = a.next()).done); n = !0) { var o = o.value; o.hasOwnProperty(y.default.SCHEME_ID_URI) && o.hasOwnProperty(v.default.VALUE) && (t[o[y.default.SCHEME_ID_URI]] = o[v.default.VALUE]); } } catch (e) { r = !0, i = e; } finally { try { !n && a.return && a.return(); } finally { if (r) throw i; } } } return t; }, setConfig: function (e) { e && (e.errHandler && (d = e.errHandler), e.BASE64 && (f = e.BASE64)); } }, l = (0, C.default)(a).getInstance().getLogger(e), e; }o.__dashjs_factory_name = `DashManifestModel`, n.default = a.default.getSingletonFactory(o), t.exports = n.default; }, { 108: 108, 211: 211, 223: 223, 227: 227, 232: 232, 45: 45, 47: 47, 51: 51, 61: 61, 84: 84, 85: 85, 86: 86, 87: 87, 90: 90, 91: 91, 92: 92, 96: 96 }], 66: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const u = r(e(76)); const l = r(e(3)); const d = r(e(75)); const f = r(e(73)); const c = r(e(72)); const h = r(e(74)); const p = r(e(69)); const g = r(e(70)); function a (e) { e = e || {}; const t = this.context; const n = e.debug; let r = void 0; let i = void 0; let a = void 0; let o = void 0; let s = void 0; return r = { parse: function (e) { let t = void 0; const n = window.performance.now(); if (!(t = o.xml_str2json(e))) throw new Error(`parsing the manifest failed`); const r = window.performance.now(); return s.run(t), e = window.performance.now(), i.info(`Parsing complete: ( xml2json: ${(r - n).toPrecision(3)}ms, objectiron: ${(e - r).toPrecision(3)}ms, total: ${((e - n) / 1e3).toPrecision(3)}s)`), t.protocol = `DASH`, t; }, getMatchers: function () { return a; }, getIron: function () { return s; } }, i = n.getLogger(r), a = [new f.default(), new c.default(), new h.default(), new d.default()], o = new l.default({ escapeMode: !1, attributePrefix: ``, arrayAccessForm: `property`, emptyNodeForm: `object`, stripWhitespaces: !1, enableToStringFunc: !0, ignoreRoot: !0, matchers: a }), s = (0, u.default)(t).create({ adaptationset: new p.default(), period: new g.default() }), r; }a.__dashjs_factory_name = `DashParser`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 3: 3, 47: 47, 69: 69, 70: 70, 72: 72, 73: 73, 74: 74, 75: 75, 76: 76 }], 67: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, [{ key: `name`, get: function () { return this._name; } }, { key: `merge`, get: function () { return this._merge; } }])), a); function a (e) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)); let t; this._name = e, this._merge = (t = e) && t.length && t.charAt(0) === t.charAt(0).toUpperCase(); }n.default = i, t.exports = n.default; }, {}], 68: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); var r = function (e, t, n) { return t && i(e.prototype, t), n && i(e, n), e; }; function i (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } } let a; const o = e(67); const s = (a = o) && a.__esModule ? a : { default: a }; var r = (r(u, [{ key: `name`, get: function () { return this._name; } }, { key: `children`, get: function () { return this._children; } }, { key: `properties`, get: function () { return this._properties; } }]), u); function u (e, t, n) { const r = this; !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, u)), this._name = e || ``, this._properties = [], this._children = n || [], Array.isArray(t) && t.forEach((e) => { r._properties.push(new s.default(e)); }); }n.default = r, t.exports = n.default; }, { 67: 67 }], 69: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; function i (e) { return e && e.__esModule ? e : { default: e }; } const a = i(e(68)); const o = i(e(61)); var e = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(s, a.default)), s); function s () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, s)); const e = [o.default.PROFILES, o.default.WIDTH, o.default.HEIGHT, o.default.SAR, o.default.FRAMERATE, o.default.AUDIO_SAMPLING_RATE, o.default.MIME_TYPE, o.default.SEGMENT_PROFILES, o.default.CODECS, o.default.MAXIMUM_SAP_PERIOD, o.default.START_WITH_SAP, o.default.MAX_PLAYOUT_RATE, o.default.CODING_DEPENDENCY, o.default.SCAN_TYPE, o.default.FRAME_PACKING, o.default.AUDIO_CHANNEL_CONFIGURATION, o.default.CONTENT_PROTECTION, o.default.ESSENTIAL_PROPERTY, o.default.SUPPLEMENTAL_PROPERTY, o.default.INBAND_EVENT_STREAM]; r(Object.getPrototypeOf(s.prototype), `constructor`, this).call(this, o.default.ADAPTATION_SET, e, [new a.default(o.default.REPRESENTATION, e, [new a.default(o.default.SUB_REPRESENTATION, e)])]); }n.default = e, t.exports = n.default; }, { 61: 61, 68: 68 }], 70: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; function i (e) { return e && e.__esModule ? e : { default: e }; } const a = i(e(68)); const o = i(e(61)); var e = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(s, a.default)), s); function s () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, s)); const e = [o.default.SEGMENT_BASE, o.default.SEGMENT_TEMPLATE, o.default.SEGMENT_LIST]; r(Object.getPrototypeOf(s.prototype), `constructor`, this).call(this, o.default.PERIOD, e, [new a.default(o.default.ADAPTATION_SET, e, [new a.default(o.default.REPRESENTATION, e)])]); }n.default = e, t.exports = n.default; }, { 61: 61, 68: 68 }], 71: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, [{ key: `test`, get: function () { return this._test; } }, { key: `converter`, get: function () { return this._converter; } }])), a); function a (e, t) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)), this._test = e, this._converter = t; }n.default = i, t.exports = n.default; }, {}], 72: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(71); var e = (i = a) && i.__esModule ? i : { default: i }; const o = 60; const s = 60; const u = 1e3; const l = /^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/; var e = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(d, e.default)), d); function d () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, d)), r(Object.getPrototypeOf(d.prototype), `constructor`, this).call(this, (e) => { return l.test(e.value); }, (e) => { const t = l.exec(e); var n = void 0; var n = Date.UTC(parseInt(t[1], 10), parseInt(t[2], 10) - 1, parseInt(t[3], 10), parseInt(t[4], 10), parseInt(t[5], 10), t[6] && parseInt(t[6], 10) || 0, t[7] && parseFloat(t[7]) * u || 0); return t[9] && t[10] && (e = parseInt(t[9], 10) * s + parseInt(t[10], 10), n += (t[8] === `+` ? -1 : 1) * e * o * u), new Date(n); }); }n.default = e, t.exports = n.default; }, { 71: 71 }], 73: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; function i (e) { return e && e.__esModule ? e : { default: e }; } var a = i(e(71)); const o = i(e(108)); const s = i(e(61)); const u = /^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/; const l = 31536e3; const d = 2592e3; const f = 86400; const c = 3600; const h = 60; var a = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(p, a.default)), p); function p () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, p)), r(Object.getPrototypeOf(p.prototype), `constructor`, this).call(this, (e) => { for (let t = [s.default.MIN_BUFFER_TIME, s.default.MEDIA_PRESENTATION_DURATION, s.default.MINIMUM_UPDATE_PERIOD, s.default.TIMESHIFT_BUFFER_DEPTH, s.default.MAX_SEGMENT_DURATION, s.default.MAX_SUBSEGMENT_DURATION, s.default.SUGGESTED_PRESENTATION_DELAY, s.default.START, o.default.START_TIME, s.default.DURATION], n = t.length, r = 0; r < n; r++) if (e.nodeName === t[r]) return u.test(e.value); return !1; }, (e) => { const t = u.exec(e); var e = parseFloat(t[3] || 0) * l + parseFloat(t[5] || 0) * d + parseFloat(t[7] || 0) * f + parseFloat(t[9] || 0) * c + parseFloat(t[11] || 0) * h + parseFloat(t[13] || 0); return void 0 !== t[1] && (e = -e), e; }); }n.default = a, t.exports = n.default; }, { 108: 108, 61: 61, 71: 71 }], 74: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(71); var e = (i = a) && i.__esModule ? i : { default: i }; const o = /^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/; var e = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(s, e.default)), s); function s () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, s)), r(Object.getPrototypeOf(s.prototype), `constructor`, this).call(this, (e) => { return o.test(e.value); }, (e) => { return parseFloat(e); }); }n.default = e, t.exports = n.default; }, { 71: 71 }], 75: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; function i (e) { return e && e.__esModule ? e : { default: e }; } function a (e, t, n) { return t in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e; } var o = i(e(71)); const s = i(e(61)); var o = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(u, o.default)), u); function u () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, u)), r(Object.getPrototypeOf(u.prototype), `constructor`, this).call(this, (e, t) => { var n = (a(n = {}, s.default.MPD, [s.default.ID, s.default.PROFILES]), a(n, s.default.PERIOD, [s.default.ID]), a(n, s.default.BASE_URL, [s.default.SERVICE_LOCATION, s.default.BYTE_RANGE]), a(n, s.default.SEGMENT_BASE, [s.default.INDEX_RANGE]), a(n, s.default.INITIALIZATION, [s.default.RANGE]), a(n, s.default.REPRESENTATION_INDEX, [s.default.RANGE]), a(n, s.default.SEGMENT_LIST, [s.default.INDEX_RANGE]), a(n, s.default.BITSTREAM_SWITCHING, [s.default.RANGE]), a(n, s.default.SEGMENT_URL, [s.default.MEDIA_RANGE, s.default.INDEX_RANGE]), a(n, s.default.SEGMENT_TEMPLATE, [s.default.INDEX_RANGE, s.default.MEDIA, s.default.INDEX, s.default.INITIALIZATION_MINUS, s.default.BITSTREAM_SWITCHING_MINUS]), a(n, s.default.ASSET_IDENTIFIER, [s.default.VALUE, s.default.ID]), a(n, s.default.EVENT_STREAM, [s.default.VALUE]), a(n, s.default.ADAPTATION_SET, [s.default.PROFILES, s.default.MIME_TYPE, s.default.SEGMENT_PROFILES, s.default.CODECS, s.default.CONTENT_TYPE]), a(n, s.default.FRAME_PACKING, [s.default.VALUE, s.default.ID]), a(n, s.default.AUDIO_CHANNEL_CONFIGURATION, [s.default.VALUE, s.default.ID]), a(n, s.default.CONTENT_PROTECTION, [s.default.VALUE, s.default.ID]), a(n, s.default.ESSENTIAL_PROPERTY, [s.default.VALUE, s.default.ID]), a(n, s.default.SUPPLEMENTAL_PROPERTY, [s.default.VALUE, s.default.ID]), a(n, s.default.INBAND_EVENT_STREAM, [s.default.VALUE, s.default.ID]), a(n, s.default.ACCESSIBILITY, [s.default.VALUE, s.default.ID]), a(n, s.default.ROLE, [s.default.VALUE, s.default.ID]), a(n, s.default.RATING, [s.default.VALUE, s.default.ID]), a(n, s.default.VIEWPOINT, [s.default.VALUE, s.default.ID]), a(n, s.default.CONTENT_COMPONENT, [s.default.CONTENT_TYPE]), a(n, s.default.REPRESENTATION, [s.default.ID, s.default.DEPENDENCY_ID, s.default.MEDIA_STREAM_STRUCTURE_ID]), a(n, s.default.SUBSET, [s.default.ID]), a(n, s.default.METRICS, [s.default.METRICS_MINUS]), a(n, s.default.REPORTING, [s.default.VALUE, s.default.ID]), n); if (n.hasOwnProperty(t)) { t = n[t]; return void 0 !== t && t.indexOf(e.name) >= 0; } return !1; }, (e) => { return String(e); }); }n.default = o, t.exports = n.default; }, { 61: 61, 71: 71 }], 76: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a (d) { function l (e, t, n) { for (let r = 0, i = e.length; r < i; ++r) { var a; var o; const s = e[r]; t[s.name] && (n[s.name] ? s.merge && (a = t[s.name], o = n[s.name], typeof a === `object` && typeof o === `object` ? (function (e, t) { for (const n in e)t.hasOwnProperty(n) || (t[n] = e[n]); }(a, o)) : n[s.name] = a + o) : n[s.name] = t[s.name]); } } function f (e, t) { for (let n = 0, r = e.children.length; n < r; ++n) { const i = e.children[n]; const a = t[`${i.name}_asArray`]; if (a) for (let o = 0, s = a.length; o < s; ++o) { const u = a[o]; l(e.properties, t, u), f(i, u); } } } return { run: function (e) { if (e === null || typeof e !== `object`) return e; if (`period` in d) for (let t = d.period, n = e.Period_asArray, r = 0, i = n.length; r < i; ++r) { const a = n[r]; if (f(t, a), `adaptationset` in d) { const o = a.AdaptationSet_asArray; if (o) for (let s = d.adaptationset, u = 0, l = o.length; u < l; ++u)f(s, o[u]); } } return e; } }; }a.__dashjs_factory_name = `ObjectIron`; e = e.default.getClassFactory(a); n.default = e, t.exports = n.default; }, { 47: 47 }], 77: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const a = r(e(108)); const d = e(80); function o (e, s) { const u = (e = e || {}).timelineConverter; function l () { if (!u || !u.hasOwnProperty(`calcPeriodRelativeTimeFromMpdRelativeTime`)) throw new Error(a.default.MISSING_CONFIG_ERROR); } function r (e, t) { if (l(), !e) return null; const n = e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList; const r = n.SegmentURL_asArray.length; var i = e && !isNaN(e.startNumber) ? e.startNumber : 1; let a = Math.max(i - 1, 0); const o = e.startNumber; var i = null; return t - a < r && (a = n.SegmentURL_asArray[t - a], (i = (0, d.getIndexBasedSegment)(u, s, e, t)) && (i.replacementTime = (o + t - 1) * e.segmentDuration, i.media = a.media ? a.media : ``, i.mediaRange = a.mediaRange, i.index = t, i.indexRange = a.indexRange)), e.availableSegmentsNumber = r, i; } return { getSegmentByIndex: r, getSegmentByTime: function (e, t) { if (l(), !e) return null; const n = e.segmentDuration; return isNaN(n) ? null : (t = u.calcPeriodRelativeTimeFromMpdRelativeTime(e, t), r(e, Math.floor(t / n))); } }; }o.__dashjs_factory_name = `ListSegmentsGetter`; i = i.default.getClassFactory(o); n.default = i, t.exports = n.default; }, { 108: 108, 47: 47, 80: 80 }], 78: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, null, [{ key: `round10`, value: function (e, t) { return n = `round`, e = e, void 0 !== (t = t) && +t != 0 ? (t = +t, (e = +e) === null || isNaN(e) || typeof t !== `number` || t % 1 != 0 ? NaN : (e = e.toString().split(`e`), +(`${(e = (e = Math[n](+(`${e[0]}e${e[1] ? +e[1] - t : -t}`))).toString().split(`e`))[0]}e${e[1] ? +e[1] + t : t}`))) : Math[n](e); let n; } }])), a); function a () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)); }n.default = i, t.exports = n.default; }, {}], 79: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const o = r(e(108)); function a (e) { const t = (e = e || {}).timelineConverter; function a () { if (!t || !t.hasOwnProperty(`calcPeriodRelativeTimeFromMpdRelativeTime`)) throw new Error(o.default.MISSING_CONFIG_ERROR); } function n (e, t) { if (a(), !e) return null; const n = e.segments ? e.segments.length : -1; let r = void 0; if (t < n && (r = e.segments[t]) && r.availabilityIdx === t) return r; for (let i = 0; i < n; i++) if ((r = e.segments[i]) && r.availabilityIdx === t) return r; return null; } return { getSegmentByIndex: n, getSegmentByTime: function (e, t) { return a(), n(e, (function (e, t) { if (!e) return -1; const n = e.segments; const r = n ? n.length : null; let i = -1; let a = void 0; let o = void 0; let s = void 0; let u = void 0; let l = void 0; if (n && r > 0) for (l = 0; l < r; l++) if (o = n[l], s = o.presentationStartTime, u = o.duration, s <= t + (a = u / 2) && t - a < s + u) { i = o.availabilityIdx; break; } return i; }(e, t))); } }; }a.__dashjs_factory_name = `SegmentBaseGetter`; i = i.default.getClassFactory(a); n.default = i, t.exports = n.default; }, { 108: 108, 47: 47 }], 80: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }), n.unescapeDollarsInTemplate = function (e) { return e ? e.split(`$$`).join(`$`) : e; }, n.replaceIDForTemplate = function (e, t) { if (!t || !e || e.indexOf(`$RepresentationID$`) === -1) return e; t = t.toString(); return e.split(`$RepresentationID$`).join(t); }, n.replaceTokenForTemplate = h, n.getIndexBasedSegment = function (e, t, n, r) { let i = void 0; let a = void 0; let o = void 0; i = n.segmentDuration, isNaN(i) && (i = n.adaptation.period.duration); a = parseFloat((n.adaptation.period.start + r * i).toFixed(5)), o = parseFloat((a + i).toFixed(5)); r = p(n, i, a, e.calcMediaTimeFromPresentationTime(a, n), e.calcAvailabilityStartTimeFromPresentationTime(a, n.adaptation.period.mpd, t), e, o, t, r); return g(e, n, r, t) ? r : null; }, n.getTimeBasedSegment = function (e, t, n, r, i, a, o, s, u, l) { const d = r / a; const f = Math.min(i / a, n.adaptation.period.mpd.maxSegmentDuration); let c = void 0; var i = void 0; var a = void 0; return c = e.calcPresentationTimeFromMediaTime(d, n), i = c + f, a = p(n, f, c, d, n.adaptation.period.mpd.manifest.loadedTime, e, i, t, u), g(e, n, a, t) ? (a.replacementTime = l || r, o = h(o, `Number`, a.replacementNumber), o = h(o, `Time`, a.replacementTime), a.media = o, a.mediaRange = s, a) : null; }; let r; const i = e(94); const d = (r = i) && r.__esModule ? r : { default: r }; function f (e, t) { for (;e.length < t;)e = `0${e}`; return e; } function h (e, t, n) { let r; let i; let a; let o; let s; let u = void 0; const l = t.length; const d = `%0`.length; if (!e) return e; for (;;) { if ((r = e.indexOf(`$${t}`)) < 0) return e; if ((i = e.indexOf(`$`, r + l)) < 0) return e; if (r < (a = e.indexOf(`%0`, r + l)) && a < i) switch (o = e.charAt(i - 1), s = parseInt(e.substring(a + d, i - 1), 10), o) { case `d`:case `i`:case `u`:u = f(n.toString(), s); break; case `x`:u = f(n.toString(16), s); break; case `X`:u = f(n.toString(16), s).toUpperCase(); break; case `o`:u = f(n.toString(8), s); break; default:return e; } else u = n; e = e.substring(0, r) + u + e.substring(i + 1); } } function p (e, t, n, r, i, a, o, s, u) { const l = new d.default(); return l.representation = e, l.duration = t, l.presentationStartTime = n, l.mediaStartTime = r, l.availabilityStartTime = i, l.availabilityEndTime = a.calcAvailabilityEndTimeFromPresentationTime(o, e.adaptation.period.mpd, s), l.wallStartTime = a.calcWallTimeForSegment(l, s), l.replacementNumber = (s = u, l.representation.startNumber + s), l.availabilityIdx = u, l; } function g (e, t, n, r) { const i = e.getPeriodEnd(t, r); if (e.calcPeriodRelativeTimeFromMpdRelativeTime(t, i) <= e.calcPeriodRelativeTimeFromMpdRelativeTime(t, n.presentationStartTime)) { if (!r) return; if (t.segmentAvailabilityRange && n.presentationStartTime >= t.segmentAvailabilityRange.end) return; } return 1; } }, { 94: 94 }], 81: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const u = r(e(108)); const l = e(80); function a (e, a) { const o = (e = e || {}).timelineConverter; function s () { if (!o || !o.hasOwnProperty(`calcPeriodRelativeTimeFromMpdRelativeTime`)) throw new Error(u.default.MISSING_CONFIG_ERROR); } function r (e, t) { if (s(), !e) return null; var n = e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate; t = Math.max(t, 0); const r = (0, l.getIndexBasedSegment)(o, a, e, t); r && (r.replacementTime = Math.round((t - 1) * e.segmentDuration * e.timescale, 10), i = n.media, i = (0, l.replaceTokenForTemplate)(i, `Number`, r.replacementNumber), i = (0, l.replaceTokenForTemplate)(i, `Time`, r.replacementTime), r.media = i); var n = e.segmentDuration; var i = e.segmentAvailabilityRange; return isNaN(n) ? e.availableSegmentsNumber = 1 : e.availableSegmentsNumber = Math.ceil((i.end - i.start) / n), r; } return { getSegmentByIndex: r, getSegmentByTime: function (e, t) { if (s(), !e) return null; const n = e.segmentDuration; return isNaN(n) ? null : (t = o.calcPeriodRelativeTimeFromMpdRelativeTime(e, t), r(e, Math.floor(t / n))); } }; }a.__dashjs_factory_name = `TemplateSegmentsGetter`; i = i.default.getClassFactory(a); n.default = i, t.exports = n.default; }, { 108: 108, 47: 47, 80: 80 }], 82: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const g = r(e(46)); const _ = r(e(54)); const i = r(e(47)); const m = r(e(61)); const E = r(e(65)); const y = r(e(48)); function a () { let e; const t = this.context; const n = (0, g.default)(t).getInstance(); const o = (0, y.default)(t).getInstance(); let d = void 0; let i = void 0; let s = void 0; let r = void 0; function a (e) { i = e; } function u (e, t, n, r) { return r ? n && t.timeShiftBufferDepth != Number.POSITIVE_INFINITY ? new Date(t.availabilityStartTime.getTime() + 1e3 * (e + t.timeShiftBufferDepth)) : t.availabilityEndTime : n ? new Date(t.availabilityStartTime.getTime() + 1e3 * (e - i)) : t.availabilityStartTime; } function l (e, t) { return (e.getTime() - t.mpd.availabilityStartTime.getTime() + 1e3 * i) / 1e3; } function f (e, t) { return e + (t.adaptation.period.start - t.presentationTimeOffset); } function c (e) { s || void 0 !== e.offset && (a(e.offset / 1e3), s = !0); } function h () { i = 0, s = !1, r = NaN; } function p () { n.off(_.default.TIME_SYNCHRONIZATION_COMPLETED, c, this), h(); } return e = { initialize: function () { h(), n.on(_.default.TIME_SYNCHRONIZATION_COMPLETED, c, this); }, isTimeSyncCompleted: function () { return s; }, setTimeSyncCompleted: function (e) { s = e; }, getClientTimeOffset: function () { return i; }, setClientTimeOffset: a, getExpectedLiveEdge: function () { return r; }, setExpectedLiveEdge: function (e) { r = e; }, calcAvailabilityStartTimeFromPresentationTime: function (e, t, n) { return u.call(this, e, t, n); }, calcAvailabilityEndTimeFromPresentationTime: function (e, t, n) { return u.call(this, e, t, n, !0); }, calcPresentationTimeFromWallTime: l, calcPresentationTimeFromMediaTime: f, calcPeriodRelativeTimeFromMpdRelativeTime: function (e, t) { return t - e.adaptation.period.start; }, calcMediaTimeFromPresentationTime: function (e, t) { return e - t.adaptation.period.start + t.presentationTimeOffset; }, calcSegmentAvailabilityRange: function (e, t) { const n = e.adaptation.period; const r = { start: n.start, end: n.start + n.duration }; if (!t) return r; if (!s && e.segmentAvailabilityRange) return e.segmentAvailabilityRange; let i = e.segmentDuration || (e.segments && e.segments.length ? e.segments[e.segments.length - 1].duration : 0); if (e.segmentInfoType === m.default.SEGMENT_TIMELINE && o.get().streaming.calcSegmentAvailabilityRangeFromTimeline) return (function (e) { var t = e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index]; const n = d.getRepresentationFor(e.index, t); var t = n.SegmentTemplate.SegmentTimeline; const r = n.SegmentTemplate.timescale; const i = t.S_asArray; var t = { start: 0, end: 0 }; let a = 0; let o = void 0; let s = void 0; let u = void 0; let l = void 0; for (t.start = f(i[0].t / r, e), u = 0, l = i.length; u < l; u++)o = i[u], s = 0, o.hasOwnProperty(`r`) && (s = o.r), a += o.d / r * (1 + s); return t.end = t.start + a, t; }(e)); const a = l(new Date(), n); var t = n.start + n.duration; return r.start = Math.max(a - n.mpd.timeShiftBufferDepth, n.start), i = void 0 !== e.availabilityTimeOffset && e.availabilityTimeOffset < i ? i - e.availabilityTimeOffset : i, r.end = t <= a && a - i < t ? t : a - i, r; }, getPeriodEnd: function (e, t) { var n = e.adaptation.period; if (!t) return n.start + n.duration; if (!s && e.segmentAvailabilityRange) return e.segmentAvailabilityRange; var r = e.segmentDuration || (e.segments && e.segments.length ? e.segments[e.segments.length - 1].duration : 0); var t = l(new Date(), n); var n = n.start + n.duration; var r = void 0 !== e.availabilityTimeOffset && e.availabilityTimeOffset < r ? r - e.availabilityTimeOffset : r; return Math.min(t - r, n); }, calcWallTimeForSegment: function (e, t) { let n = void 0; return t && (t = e.representation.adaptation.period.mpd.suggestedPresentationDelay, t = e.presentationStartTime + t, n = new Date(e.availabilityStartTime.getTime() + 1e3 * t)), n; }, reset: p }, d = (0, E.default)(t).getInstance(), p(), e; }a.__dashjs_factory_name = `TimelineConverter`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 46: 46, 47: 47, 48: 48, 54: 54, 61: 61, 65: 65 }], 83: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const a = r(e(108)); const h = e(80); function o (e, y) { const v = (e = e || {}).timelineConverter; function t () { if (!v || !v.hasOwnProperty(`calcMediaTimeFromPresentationTime`) || !v.hasOwnProperty(`calcSegmentAvailabilityRange`)) throw new Error(a.default.MISSING_CONFIG_ERROR); } function n (e, t) { for (var n = e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate || e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList, r = n.SegmentTimeline, i = n.SegmentURL_asArray, a = 0, o = 0, s = -1, u = void 0, l = void 0, d = void 0, f = void 0, c = void 0, h = void 0, p = void 0, g = e.timescale, _ = !1, d = 0, m = (u = r.S_asArray).length; d < m && !_; d++) { var E; var c = 0; for ((l = u[d]).hasOwnProperty(`r`) && (c = l.r), l.hasOwnProperty(`t`) && (o = (a = l.t) / g), c < 0 && ((p = u[d + 1]) && p.hasOwnProperty(`t`) ? h = p.t / g : (E = (e.segmentAvailabilityRange ? e.segmentAvailabilityRange : v.calcSegmentAvailabilityRange(e, y)).end, h = v.calcMediaTimeFromPresentationTime(E, e), e.segmentDuration = l.d / g), c = Math.ceil((h - o) / (l.d / g)) - 1), f = 0; f <= c && !_; f++)(_ = t(a, o, n, i, l, g, ++s, d)) && (e.segmentDuration = l.d / g, (f < c - 1 || d < m - 1) && s++), o = (a += l.d) / g; }e.availableSegmentsNumber = s; } return { getSegmentByIndex: function (l, e, d) { if (t(), !l) return null; let f = null; let c = !1; return n(l, (e, t, n, r, i, a, o, s) => { if (c || d < 0) { let u = n.media; var n = i.mediaRange; return r && (u = r[s].media || ``, n = r[s].mediaRange), f = (0, h.getTimeBasedSegment)(v, y, l, e, i.d, a, u, n, o, i.tManifest), !0; } return t >= d - 0.5 * i.d / a && (c = !0), !1; }), f; }, getSegmentByTime: function (u, e) { if (t(), !u) return null; void 0 === e && (e = null); let l = null; const d = v.calcMediaTimeFromPresentationTime(e, u); return n(u, (e, t, n, r, i, a, o, s) => { if (d < t + i.d / a) { t = n.media, n = i.mediaRange; return r && (t = r[s].media || ``, n = r[s].mediaRange), l = (0, h.getTimeBasedSegment)(v, y, u, e, i.d, a, t, n, o, i.tManifest), !0; } return !1; }), l; } }; }o.__dashjs_factory_name = `TimelineSegmentsGetter`; i = i.default.getClassFactory(o); n.default = i, t.exports = n.default; }, { 108: 108, 47: 47, 80: 80 }], 84: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.period = null, this.index = -1, this.type = null; }n.default = r, t.exports = n.default; }, {}], 85: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function i (e, t, n, r) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, i)), this.url = e || ``, this.serviceLocation = t || e || ``, this.dvb_priority = n || 1, this.dvb_weight = r || 1, this.availabilityTimeOffset = 0, this.availabilityTimeComplete = !0; }i.DEFAULT_DVB_PRIORITY = 1, i.DEFAULT_DVB_WEIGHT = 1, n.default = i, t.exports = n.default; }, {}], 86: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.duration = NaN, this.presentationTime = NaN, this.id = NaN, this.messageData = ``, this.eventStream = null, this.presentationTimeDelta = NaN; }n.default = r, t.exports = n.default; }, {}], 87: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.adaptionSet = null, this.representation = null, this.period = null, this.timescale = 1, this.value = ``, this.schemeIdUri = ``, this.presentationTimeOffset = 0; }n.default = r, t.exports = n.default; }, {}], 88: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.DVRWindowSize = NaN, this.loadedTime = null, this.availableFrom = null, this.minBufferTime = NaN, this.duration = NaN, this.isDynamic = !1, this.maxFragmentDuration = null; }n.default = r, t.exports = n.default; }, {}], 89: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.id = null, this.index = null, this.type = null, this.streamInfo = null, this.representationCount = 0, this.lang = null, this.viewpoint = null, this.accessibility = null, this.audioChannelConfiguration = null, this.roles = null, this.codec = null, this.mimeType = null, this.contentProtection = null, this.isText = !1, this.KID = null, this.bitrateList = null; }n.default = r, t.exports = n.default; }, {}], 90: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.manifest = null, this.suggestedPresentationDelay = 0, this.availabilityStartTime = null, this.availabilityEndTime = Number.POSITIVE_INFINITY, this.timeShiftBufferDepth = Number.POSITIVE_INFINITY, this.maxSegmentDuration = Number.POSITIVE_INFINITY, this.minimumUpdatePeriod = NaN, this.mediaPresentationDuration = NaN; }n.default = r, t.exports = n.default; }, {}], 91: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.id = null, this.index = -1, this.duration = NaN, this.start = NaN, this.mpd = null; }r.DEFAULT_ID = `defaultId`, n.default = r, t.exports = n.default; }, {}], 92: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); var r = function (e, t, n) { return t && i(e.prototype, t), n && i(e, n), e; }; function i (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } } let a; const o = e(61); const s = (a = o) && a.__esModule ? a : { default: a }; var r = (r(u, [{ key: `hasInitialization`, value: function () { return this.initialization !== null || this.range !== null; } }, { key: `hasSegments`, value: function () { return this.segmentInfoType !== s.default.BASE_URL && this.segmentInfoType !== s.default.SEGMENT_BASE && !this.indexRange; } }]), u); function u () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, u)), this.id = null, this.index = -1, this.adaptation = null, this.segmentInfoType = null, this.initialization = null, this.codecs = null, this.codecPrivateData = null, this.segmentDuration = NaN, this.timescale = 1, this.startNumber = 1, this.indexRange = null, this.range = null, this.presentationTimeOffset = 0, this.MSETimeOffset = NaN, this.segmentAvailabilityRange = null, this.availableSegmentsNumber = 0, this.bandwidth = NaN, this.width = NaN, this.height = NaN, this.scanType = null, this.maxPlayoutRate = NaN, this.availabilityTimeOffset = 0, this.availabilityTimeComplete = !0; }n.default = r, t.exports = n.default; }, { 61: 61 }], 93: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.id = null, this.quality = null, this.DVRWindow = null, this.fragmentDuration = null, this.mediaInfo = null, this.MSETimeOffset = null; }n.default = r, t.exports = n.default; }, {}], 94: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.indexRange = null, this.index = null, this.mediaRange = null, this.media = null, this.duration = NaN, this.replacementTime = null, this.replacementNumber = NaN, this.mediaStartTime = NaN, this.presentationStartTime = NaN, this.availabilityStartTime = NaN, this.availabilityEndTime = NaN, this.availabilityIdx = NaN, this.wallStartTime = NaN, this.representation = null; }n.default = r, t.exports = n.default; }, {}], 95: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.id = null, this.index = null, this.start = NaN, this.duration = NaN, this.manifestInfo = null, this.isLast = !0; }n.default = r, t.exports = n.default; }, {}], 96: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.schemeIdUri = ``, this.value = ``; }n.default = r, t.exports = n.default; }, {}], 97: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const l = r(e(108)); const d = r(e(159)); const f = r(e(235)); const c = r(e(232)); var e = r(e(47)); function i (e) { e = e || {}; const t = this.context; const i = e.eventBus; const a = e.events; const n = e.urlUtils; const o = e.errors; let s = void 0; let u = void 0; return s = { checkForExistence: function (t) { function e (e) { i.trigger(a.CHECK_FOR_EXISTENCE_COMPLETED, { request: t, exists: e }); } let n; t ? (n = new f.default(t.url), u.load({ request: n, success: function () { e(!0); }, error: function () { e(!1); } })) : e(!1); }, load: function (n) { function r (e, t) { i.trigger(a.LOADING_COMPLETED, { request: n, response: e || null, error: t || null, sender: s }); }n ? u.load({ request: n, progress: function (e) { i.trigger(a.LOADING_PROGRESS, { request: n, stream: e.stream }), e.data && i.trigger(a.LOADING_DATA_PROGRESS, { request: n, response: e.data || null, error: null, sender: s }); }, success: function (e) { r(e); }, error: function (e, t, n) { r(void 0, new c.default(o.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE, n, t)); }, abort: function (e) { e && i.trigger(a.LOADING_ABANDONED, { mediaType: e.mediaType, request: e, sender: s }); } }) : r(void 0, new c.default(o.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE, o.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE)); }, abort: function () { u && u.abort(); }, reset: function () { u && (u.abort(), u = null); } }, u = (0, d.default)(t).create({ errHandler: e.errHandler, errors: o, dashMetrics: e.dashMetrics, mediaPlayerModel: e.mediaPlayerModel, requestModifier: e.requestModifier, useFetch: e.settings.get().streaming.lowLatencyEnabled, urlUtils: n, constants: l.default, boxParser: e.boxParser, dashConstants: e.dashConstants, requestTimeout: e.settings.get().streaming.fragmentRequestTimeout }), s; }i.__dashjs_factory_name = `FragmentLoader`, n.default = e.default.getClassFactory(i), t.exports = n.default; }, { 108: 108, 159: 159, 232: 232, 235: 235, 47: 47 }], 98: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const _ = r(e(108)); const a = r(e(61)); const o = r(e(124)); const s = r(e(159)); const m = r(e(227)); const E = r(e(239)); const y = r(e(232)); const v = e(248); const T = r(e(46)); const S = r(e(54)); const A = r(e(51)); let i = r(e(47)); const I = r(e(66)); function u (e) { e = e || {}; const u = this.context; const l = e.debug; const d = (0, T.default)(u).getInstance(); const f = (0, m.default)(u).getInstance(); let t = void 0; let c = void 0; let n = void 0; let h = void 0; let p = void 0; const g = e.mssHandler; const r = e.errHandler; function i (e) { d.trigger(S.default.INTERNAL_MANIFEST_LOADED, { manifest: e.manifest }); } return t = { load: function (s) { const e = new E.default(s, v.HTTPRequest.MPD_TYPE); n.load({ request: e, success: function (e, t, n) { if (h) { let r; let i = void 0; let a = void 0; let o = void 0; if (n && n !== s ? (a = f.parseBaseUrl(n), i = n) : (f.isRelative(s) && (s = f.resolve(s, window.location.href)), a = f.parseBaseUrl(s)), p === null && (r = null, p = (n = e).indexOf(`SmoothStreamingMedia`) > -1 ? (g && (r = g.createMssParser(), g.registerEvents()), r) : n.indexOf(`MPD`) > -1 ? (0, I.default)(u).create({ debug: l }) : r), p !== null) { h.setMatchers(p.getMatchers()), h.setIron(p.getIron()); try { o = p.parse(e); } catch (e) { return void d.trigger(S.default.INTERNAL_MANIFEST_LOADED, { manifest: null, error: new y.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE, `${A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE}${s}`) }); }o ? (o.url = i || s, o.originalUrl || (o.originalUrl = o.url), o.hasOwnProperty(_.default.LOCATION) && (a = f.parseBaseUrl(o.Location_asArray[0]), c.debug(`BaseURI set by Location to: ${a}`)), o.baseUri = a, o.loadedTime = new Date(), h.resolveManifestOnLoad(o), d.trigger(S.default.ORIGINAL_MANIFEST_LOADED, { originalManifest: e })) : d.trigger(S.default.INTERNAL_MANIFEST_LOADED, { manifest: null, error: new y.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE, `${A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE}${s}`) }); } else d.trigger(S.default.INTERNAL_MANIFEST_LOADED, { manifest: null, error: new y.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE, `${A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE}${s}`) }); } }, error: function (e, t, n) { d.trigger(S.default.INTERNAL_MANIFEST_LOADED, { manifest: null, error: new y.default(A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE, `${A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE}${s}, ${n}`) }); } }); }, reset: function () { d.off(S.default.XLINK_READY, i, t), h && (h.reset(), h = null), n && (n.abort(), n = null), g && g.reset(); } }, c = l.getLogger(t), d.on(S.default.XLINK_READY, i, t), n = (0, s.default)(u).create({ errHandler: e.errHandler, dashMetrics: e.dashMetrics, mediaPlayerModel: e.mediaPlayerModel, requestModifier: e.requestModifier, useFetch: e.settings.get().streaming.lowLatencyEnabled, urlUtils: f, constants: _.default, dashConstants: a.default, errors: A.default }), h = (0, o.default)(u).create({ errHandler: r, dashMetrics: e.dashMetrics, mediaPlayerModel: e.mediaPlayerModel, requestModifier: e.requestModifier, settings: e.settings }), p = null, t; }u.__dashjs_factory_name = `ManifestLoader`; i = i.default.getClassFactory(u); n.default = i, t.exports = n.default; }, { 108: 108, 124: 124, 159: 159, 227: 227, 232: 232, 239: 239, 248: 248, 46: 46, 47: 47, 51: 51, 54: 54, 61: 61, 66: 66 }], 99: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const I = r(e(46)); const R = r(e(54)); const i = r(e(47)); const b = r(e(45)); const D = r(e(51)); const M = r(e(61)); function a () { const e = this.context; const r = (0, I.default)(e).getInstance(); let t = void 0; let i = void 0; let a = void 0; let n = void 0; let o = void 0; let s = void 0; let u = void 0; let l = void 0; let d = void 0; let f = void 0; let c = void 0; let h = void 0; function p () { a = NaN, s = !(o = !(u = !1)), g(); } function g () { n !== null && (clearTimeout(n), n = null); } function _ (e) { g(), s || (isNaN(e) && !isNaN(a) && (e = 1e3 * a), isNaN(e) || (i.debug(`Refresh manifest in ${e} milliseconds.`), n = setTimeout(y, e))); } function m () { u = !0; var e = d.getValue(); let t = e.url; var e = f.getLocation(e); e && (t = e), l.load(t); } function E (e) { if (d.getValue() && d.getValue().type === M.default.DYNAMIC && e.type === M.default.STATIC) return r.trigger(R.default.DYNAMIC_TO_STATIC), void (s = !(u = !1)); d.setValue(e); const t = new Date(); const n = (t.getTime() - e.loadedTime.getTime()) / 1e3; 1e3 * (a = f.getManifestUpdatePeriod(e, n)) > 2147483647 && (a = 2147483.647), r.trigger(R.default.MANIFEST_UPDATED, { manifest: e }), i.info(`Manifest has been refreshed at ${t}[${t.getTime() / 1e3}] `), o || _(); } function y () { o || (u ? _(h.get().streaming.manifestUpdateRetryInterval) : m()); } function v (e) { e.error ? e.error.code === D.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE && c.error(e.error) : E(e.manifest); } function T () { o = !1, _(); } function S () { (o = !h.get().streaming.scheduleWhilePaused) && g(); } function A () { u = !1; } return t = { initialize: function () { p(), r.on(R.default.STREAMS_COMPOSED, A, this), r.on(R.default.PLAYBACK_STARTED, T, this), r.on(R.default.PLAYBACK_PAUSED, S, this), r.on(R.default.INTERNAL_MANIFEST_LOADED, v, this); }, setManifest: function (e) { E(e); }, refreshManifest: m, setConfig: function (e) { e && (e.manifestModel && (d = e.manifestModel), e.adapter && (f = e.adapter), e.manifestLoader && (l = e.manifestLoader), e.errHandler && (c = e.errHandler), e.settings && (h = e.settings)); }, reset: function () { r.off(R.default.PLAYBACK_STARTED, T, this), r.off(R.default.PLAYBACK_PAUSED, S, this), r.off(R.default.STREAMS_COMPOSED, A, this), r.off(R.default.INTERNAL_MANIFEST_LOADED, v, this), p(); } }, i = (0, b.default)(e).getInstance().getLogger(t), t; }a.__dashjs_factory_name = `ManifestUpdater`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 45: 45, 46: 46, 47: 47, 51: 51, 54: 54, 61: 61 }], 100: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const ue = r(e(2)); const le = r(e(108)); const de = r(e(61)); const fe = r(e(109)); const ce = r(e(120)); const he = r(e(122)); const pe = r(e(117)); const ge = r(e(118)); const _e = r(e(112)); const me = r(e(98)); const Ee = r(e(219)); const ye = r(e(214)); const ve = r(e(209)); const Te = r(e(224)); const Se = r(e(207)); const Ae = r(e(154)); const Ie = r(e(151)); const Re = r(e(152)); const be = r(e(111)); const De = r(e(158)); const Me = r(e(155)); const Ne = r(e(149)); const Ce = r(e(216)); const we = r(e(45)); const Oe = r(e(51)); const Pe = r(e(46)); const Le = r(e(54)); const xe = r(e(101)); const Fe = r(e(47)); const Ue = r(e(48)); const Be = e(50); const ke = r(e(63)); const Ge = r(e(56)); const je = r(e(58)); const Ye = r(e(82)); const He = e(248); const Ke = r(e(1)); const qe = r(e(9)); const Ve = r(e(232)); const We = e(225); const ze = r(e(99)); const Xe = r(e(227)); const Qe = r(e(213)); function i () { const r = `You must first call initialize() and set a source before calling this method`; const i = `You must first call initialize() and set a valid source and view before calling this method`; const t = `You must first call attachView() to set the video element before calling this method`; const e = `You must first call attachSource() with a valid source before calling this method`; const a = `MediaPlayer not initialized!`; const o = this.context; const s = (0, Pe.default)(o).getInstance(); let u = (0, Ue.default)(o).getInstance(); const l = (0, we.default)(o).getInstance({ settings: u }); let n = void 0; let d = void 0; let f = void 0; let c = void 0; let h = void 0; let p = void 0; let g = void 0; let _ = void 0; let m = void 0; let E = void 0; let y = void 0; let v = void 0; let T = void 0; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; let C = void 0; let w = void 0; let O = void 0; let P = void 0; let L = void 0; let x = void 0; let F = void 0; let U = void 0; let B = void 0; let k = void 0; let G = void 0; function j () { ee(null), $(null), c = null, T && (T.reset(), T = null), S && (S.reset(), S = null), G.reset(), u.reset(), I && (I.reset(), I = null); } function Y () { return !!f && !!F.getElement(); } function H () { return (0, Be.getVersionString)(); } function K () { if (!g) throw i; return O.isPaused(); } function q (e) { const t = P.getCurrentDVRInfo(); if (!t) return 0; const n = O.getLiveDelay(); var e = t.range.start + e; return e > t.range.end - n && (e = t.range.end - n), e; } function V (e) { if (!g) throw i; let t = Z().currentTime; return void 0 !== e ? t = C.getTimeRelativeToStreamId(t, e) : O.getIsDynamic() && (t = (e = P.getCurrentDVRInfo()) === null ? 0 : W() - (e.range.end - e.time)), t; } function W () { if (!g) throw i; let e = Z().duration; if (O.getIsDynamic()) { let t; const n = P.getCurrentDVRInfo(); if (!n) return 0; e = (t = n.range.end - n.range.start) < n.manifestInfo.DVRWindowSize ? t : n.manifestInfo.DVRWindowSize; } return e; } function z (e) { (0, We.checkParameterType)(e, `boolean`), _ = e; } function X () { b.restoreDefaultUTCTimingSources(); } function Q () { return P; } function Z () { if (!F.getElement()) throw t; return F.getElement(); } function $ (e) { if (!h) throw a; F.setElement(e), e && (ie(), (function () { if (S) return; let e = dashjs.MetricsReporting; { typeof e === `function` && (e = e(o).create(), S = e.createMetricsReporting({ debug: l, eventBus: s, mediaElement: Z(), adapter: R, dashMetrics: P, events: Le.default, constants: le.default, metricsConstants: fe.default })); } }()), (function () { if (A) return; const e = dashjs.MssHandler; typeof e === `function` && (Oe.default.extend(e.errors), A = e(o).create({ eventBus: s, mediaPlayerModel: b, dashMetrics: P, manifestModel: L, playbackController: O, streamController: C, protectionController: T, baseURLController: M, errHandler: D, events: Le.default, constants: le.default, debug: l, initSegmentType: He.HTTPRequest.INIT_SEGMENT_TYPE, BASE64: Ke.default, ISOBoxer: qe.default, settings: u })); }()), C && C.switchToVideoElement()), g && ne(), se(); } function J (e) { if (!p) throw r; const t = C.getActiveStreamInfo(); return v.getTracksFor(e, t); } function ee (e) { if (!h) throw a; typeof e === `string` && B.initialize(e), f = e, (p || g) && ne(), Y() && se(); } function te () { if (!p) throw r; const e = C.getActiveStreamInfo(); return e ? C.getStreamById(e.id) : null; } function ne () { p = g = !1, R.reset(), C.reset(), w.reset(), O.reset(), m.reset(), v.reset(), U.reset(), T && (u.get().streaming.keepProtectionMediaKeys ? T.stop() : (T.reset(), T = null, ie())), x.reset(); } function re () { return (0, me.default)(o).create({ debug: l, errHandler: D, dashMetrics: P, mediaPlayerModel: b, requestModifier: (0, Te.default)(o).getInstance(), mssHandler: A, settings: u }); } function ie () { if (T) return T; const e = dashjs.Protection; if (typeof e !== `function`) return null; const t = e(o).create(); return Le.default.extend(e.events), xe.default.extend(e.events, { publicOnly: !0 }), Oe.default.extend(e.errors), N = N || (0, ye.default)(o).getInstance(), T = t.createProtectionSystem({ debug: l, errHandler: D, videoModel: F, capabilities: N, eventBus: s, events: Le.default, BASE64: Ke.default, constants: le.default }); } function ae () { if (!h) throw a; if (I) return I; const e = dashjs.OfflineController; if (typeof e !== `function`) return null; Le.default.extend(e.events), xe.default.extend(e.events, { publicOnly: !0 }), Oe.default.extend(e.errors); const t = re(); const n = (0, ze.default)(o).create(); return n.setConfig({ manifestModel: L, adapter: R, manifestLoader: t, errHandler: D }), I = e(o).create({ debug: l, manifestUpdater: n, baseURLController: M, manifestLoader: t, manifestModel: L, mediaPlayerModel: b, abrController: m, playbackController: O, adapter: R, errHandler: D, dashMetrics: P, timelineConverter: y, schemeLoaderFactory: E, eventBus: s, events: Le.default, errors: Oe.default, constants: le.default, settings: u, dashConstants: de.default, urlUtils: (0, Xe.default)(o).getInstance() }); } function oe (e) { const t = P.getCurrentDVRInfo(); return t ? e + (t.manifestInfo.availableFrom.getTime() / 1e3 + t.range.start) : 0; } function se () { let e; I && I.resetRecords(), !p && f && (p = !0, d.info(`Streaming Initialized`), e = re(), (C = C || (0, he.default)(o).getInstance()).setConfig({ capabilities: N, manifestLoader: e, manifestModel: L, mediaPlayerModel: b, protectionController: T, adapter: R, dashMetrics: P, errHandler: D, timelineConverter: y, videoModel: F, playbackController: O, abrController: m, mediaController: v, textController: U, settings: u, baseURLController: M }), w.setConfig({ settings: u, playbackController: O, streamController: C, videoModel: F, timelineConverter: y, adapter: R }), O.setConfig({ streamController: C, dashMetrics: P, mediaPlayerModel: b, adapter: R, videoModel: F, timelineConverter: y, uriFragmentModel: B, settings: u }), m.setConfig({ streamController: C, domStorage: k, mediaPlayerModel: b, dashMetrics: P, adapter: R, videoModel: F, settings: u }), U.setConfig({ errHandler: D, manifestModel: L, adapter: R, mediaController: v, streamController: C, videoModel: F }), x.setConfig({ abrController: m, dashMetrics: P, playbackController: O }), C.initialize(_, c), w.initialize(), x.initialize(), typeof f === `string` ? C.load(f) : C.loadWithManifest(f)), !g && Y() && (g = !0, d.info(`Playback Initialized`)); } return n = { initialize: function (e, t, n) { N = N || (0, ye.default)(o).getInstance(), D = (0, Ee.default)(o).getInstance(), N.supportsMediaSource() ? h || (h = !0, y = (0, Ye.default)(o).getInstance(), m || (m = (0, be.default)(o).getInstance()).setConfig({ settings: u }), E = E || (0, De.default)(o).getInstance(), O = O || (0, ce.default)(o).getInstance(), v = v || (0, ge.default)(o).getInstance(), C = C || (0, he.default)(o).getInstance(), w = w || (0, pe.default)(o).getInstance(), R = (0, Ge.default)(o).getInstance(), L = (0, Ie.default)(o).getInstance(), x = (0, Ne.default)(o).getInstance(), P = (0, je.default)(o).getInstance({ settings: u }), U = (0, Se.default)(o).getInstance(), k = (0, Ce.default)(o).getInstance({ settings: u }), R.setConfig({ constants: le.default, cea608parser: ue.default, errHandler: D, BASE64: Ke.default }), (M = M || (0, _e.default)(o).create()).setConfig({ adapter: R }), (G = (0, ke.default)(o).getInstance({ dashMetrics: P, mediaPlayerModel: b, errHandler: D, baseURLController: M, events: Le.default, eventBus: s, debug: l, boxParser: (0, Qe.default)(o).getInstance(), requestModifier: (0, Te.default)(o).getInstance(), errors: Oe.default })).initialize(), v.setConfig({ domStorage: k, settings: u }), X(), z(void 0 === n || n), ae(), e && $(e), t && ee(t), d.info(`[dash.js ${H()}] MediaPlayer has been initialized`)) : D.error(new Ve.default(Oe.default.CAPABILITY_MEDIASOURCE_ERROR_CODE, Oe.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE)); }, setConfig: function (e) { e && (e.capabilities && (N = e.capabilities), e.streamController && (C = e.streamController), e.gapController && (w = e.gapController), e.playbackController && (O = e.playbackController), e.mediaPlayerModel && (b = e.mediaPlayerModel), e.abrController && (m = e.abrController), e.schemeLoaderFactory && (E = e.schemeLoaderFactory), e.mediaController && (v = e.mediaController), e.settings && (u = e.settings)); }, on: function (e, t, n, r) { s.on(e, t, n, r); }, off: function (e, t, n) { s.off(e, t, n); }, extend: function (e, t, n) { Fe.default.extend(e, t, n, o); }, attachView: $, attachSource: ee, isReady: Y, preload: function () { if (F.getElement() || p) return !1; if (!f) throw e; se(); }, play: function () { if (!g) throw i; (!_ || K() && g) && O.play(); }, isPaused: K, pause: function () { if (!g) throw i; O.pause(); }, isSeeking: function () { if (!g) throw i; return O.isSeeking(); }, isDynamic: function () { if (!g) throw i; return O.getIsDynamic(); }, seek: function (e) { if (!g) throw i; if ((0, We.checkParameterType)(e, `number`), isNaN(e)) throw le.default.BAD_ARGUMENT_ERROR; e = O.getIsDynamic() ? q(e) : e, O.seek(e); }, setPlaybackRate: function (e) { Z().playbackRate = e; }, getPlaybackRate: function () { return Z().playbackRate; }, setMute: function (e) { (0, We.checkParameterType)(e, `boolean`), Z().muted = e; }, isMuted: function () { return Z().muted; }, setVolume: function (e) { if (typeof e !== `number` || isNaN(e) || e < 0 || e > 1) throw le.default.BAD_ARGUMENT_ERROR; Z().volume = e; }, getVolume: function () { return Z().volume; }, time: V, duration: W, timeAsUTC: function () { if (!g) throw i; return V() < 0 ? NaN : oe(V()); }, durationAsUTC: function () { if (!g) throw i; return oe(W()); }, getActiveStream: te, getDVRWindowSize: function () { const e = P.getCurrentDVRInfo(); return e ? e.manifestInfo.DVRWindowSize : 0; }, getDVRSeekOffset: q, convertToTimeCode: function (e) { e = Math.max(e, 0); const t = Math.floor(e / 3600); const n = Math.floor(e % 3600 / 60); var e = Math.floor(e % 3600 % 60); return `${(t === 0 ? `` : t < 10 ? `0${t.toString()}:` : `${t.toString()}:`) + (n < 10 ? `0${n.toString()}` : n.toString())}:${e < 10 ? `0${e.toString()}` : e.toString()}`; }, formatUTC: function (e, t, n) { const r = !(arguments.length <= 3 || void 0 === arguments[3]) && arguments[3]; const i = new Date(1e3 * e); var e = i.toLocaleDateString(t); var n = i.toLocaleTimeString(t, { hour12: n }); return r ? `${n} ${e}` : n; }, getVersion: H, getDebug: function () { return l; }, getBufferLength: function (e) { let t; const n = [le.default.VIDEO, le.default.AUDIO, le.default.FRAGMENTED_TEXT]; return e ? n.indexOf(e) === -1 ? (d.warn(`getBufferLength requested for invalid type`), NaN) : (t = P.getCurrentBufferLevel(e)) || NaN : (t = n.map((e) => { return J(e).length > 0 ? P.getCurrentBufferLevel(e) : Number.MAX_VALUE; }).reduce((e, t) => { return Math.min(e, t); })) === Number.MAX_VALUE ? NaN : t; }, getTTMLRenderingDiv: function () { return F ? F.getTTMLRenderingDiv() : null; }, getVideoElement: Z, getSource: function () { if (!f) throw e; return f; }, getCurrentLiveLatency: function () { if (!h) throw a; return g ? O.getCurrentLiveLatency() : NaN; }, getTopBitrateInfoFor: function (e) { if (!p) throw r; return m.getTopBitrateInfoFor(e); }, setAutoPlay: z, getAutoPlay: function () { return _; }, getDashMetrics: Q, getQualityFor: function (e) { if (!p) throw r; return e !== le.default.IMAGE ? m.getQualityFor(e) : (e = te()) && (e = e.getThumbnailController()) ? e.getCurrentTrackIndex() : -1; }, setQualityFor: function (e, t) { if (!p) throw r; if (e === le.default.IMAGE) { let n = te(); if (!n) return; n = n.getThumbnailController(); n && n.setTrackByIndex(t); }m.setPlaybackQuality(e, C.getActiveStreamInfo(), t); }, updatePortalSize: function () { m.setElementSize(), m.setWindowResizeEventCalled(!0); }, setTextDefaultLanguage: function (e) { d.warn(`setTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use setInitialMediaSettingsFor("fragmentedText", { lang: lang }) instead`), void 0 === U && (U = (0, Se.default)(o).getInstance()), U.setTextDefaultLanguage(e); }, getTextDefaultLanguage: function () { return d.warn(`getTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use getInitialMediaSettingsFor("fragmentedText").lang instead`), void 0 === U && (U = (0, Se.default)(o).getInstance()), U.getTextDefaultLanguage(); }, setTextDefaultEnabled: function (e) { void 0 === U && (U = (0, Se.default)(o).getInstance()), U.setTextDefaultEnabled(e); }, getTextDefaultEnabled: function () { return void 0 === U && (U = (0, Se.default)(o).getInstance()), U.getTextDefaultEnabled(); }, enableText: function (e) { void 0 === U && (U = (0, Se.default)(o).getInstance()), U.enableText(e); }, enableForcedTextStreaming: function (e) { void 0 === U && (U = (0, Se.default)(o).getInstance()), U.enableForcedTextStreaming(e); }, isTextEnabled: function () { return void 0 === U && (U = (0, Se.default)(o).getInstance()), U.isTextEnabled(); }, setTextTrack: function (e) { if (!g) throw i; void 0 === U && (U = (0, Se.default)(o).getInstance()), U.setTextTrack(e); }, getBitrateInfoListFor: function (e) { if (!p) throw r; const t = te(); return t ? t.getBitrateListFor(e) : []; }, getStreamsFromManifest: function (e) { if (!p) throw r; return R.getStreamsInfo(e); }, getTracksFor: J, getTracksForTypeFromManifest: function (e, t, n) { if (!p) throw r; return (n = n || R.getStreamsInfo(t, 1)[0]) ? R.getAllMediaInfoForType(n, e, t) : []; }, getCurrentTrackFor: function (e) { if (!p) throw r; const t = C.getActiveStreamInfo(); return v.getCurrentTrackFor(e, t); }, setInitialMediaSettingsFor: function (e, t) { if (!h) throw a; v.setInitialSettings(e, t), e === le.default.FRAGMENTED_TEXT && U.setInitialSettings(t); }, getInitialMediaSettingsFor: function (e) { if (!h) throw a; return v.getInitialSettings(e); }, setCurrentTrack: function (e) { if (!p) throw r; v.setTrack(e); }, getTrackSwitchModeFor: function (e) { if (!h) throw a; return v.getSwitchMode(e); }, setTrackSwitchModeFor: function (e, t) { if (!h) throw a; v.setSwitchMode(e, t); }, setSelectionModeForInitialTrack: function (e) { if (!h) throw a; v.setSelectionModeForInitialTrack(e); }, getSelectionModeForInitialTrack: function () { if (!h) throw a; return v.getSelectionModeForInitialTrack(); }, addABRCustomRule: function (e, t, n) { b.addABRCustomRule(e, t, n); }, removeABRCustomRule: function (e) { b.removeABRCustomRule(e); }, removeAllABRCustomRule: function () { b.removeABRCustomRule(); }, getAverageThroughput: function (e) { const t = m.getThroughputHistory(); return t ? t.getAverageThroughput(e) : 0; }, retrieveManifest: function (e, t) { function n (e) { e.error ? t(null, e.error) : t(e.manifest), s.off(Le.default.INTERNAL_MANIFEST_LOADED, n, i), r.reset(); } var r = re(); var i = this; s.on(Le.default.INTERNAL_MANIFEST_LOADED, n, i), B.initialize(e), r.load(e); }, addUTCTimingSource: function (e, t) { b.addUTCTimingSource(e, t); }, removeUTCTimingSource: function (e, t) { b.removeUTCTimingSource(e, t); }, clearDefaultUTCTimingSources: function () { b.clearDefaultUTCTimingSources(); }, restoreDefaultUTCTimingSources: X, setXHRWithCredentialsForType: function (e, t) { b.setXHRWithCredentialsForType(e, t); }, getXHRWithCredentialsForType: function (e) { return b.getXHRWithCredentialsForType(e); }, getProtectionController: ie, attachProtectionController: function (e) { T = e; }, setProtectionData: function (e) { c = e, C && C.setProtectionData(c); }, displayCaptionsOnTop: function (e) { const t = (0, ve.default)(o).getInstance(); t.setConfig({ videoModel: F }), t.initialize(), t.setDisplayCConTop(e); }, attachTTMLRenderingDiv: function (e) { if (!F.getElement()) throw t; F.setTTMLRenderingDiv(e); }, getCurrentTextTrackIndex: function () { let e = NaN; return U && (e = U.getCurrentTrackIdx()), e; }, provideThumbnail: function (e, t) { if (typeof t === `function`) if (e < 0)t(null); else { const n = O.getIsDynamic() ? q(e) : e; let r = C.getStreamForTime(n); if (r !== null) { e = r.getThumbnailController(); if (e) { r = C.getTimeRelativeToStreamId(n, r.getId()); return e.provide(r, t); }t(null); } else t(null); } }, getDashAdapter: function () { return R; }, getOfflineController: ae, getSettings: function () { return u.get(); }, updateSettings: function (e) { u.update(e); }, resetSettings: function () { u.reset(); }, reset: j, destroy: function () { j(), Fe.default.deleteSingletonInstances(o); } }, d = l.getLogger(n), _ = !(p = g = h = !1), G = R = c = I = T = null, Le.default.extend(xe.default), b = (0, Re.default)(o).getInstance(), F = (0, Me.default)(o).getInstance(), B = (0, Ae.default)(o).getInstance(), n; }i.__dashjs_factory_name = `MediaPlayer`; e = Fe.default.getClassFactory(i); e.events = xe.default, e.errors = Oe.default, Fe.default.updateClassFactory(i.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 1: 1, 101: 101, 108: 108, 109: 109, 111: 111, 112: 112, 117: 117, 118: 118, 120: 120, 122: 122, 149: 149, 151: 151, 152: 152, 154: 154, 155: 155, 158: 158, 2: 2, 207: 207, 209: 209, 213: 213, 214: 214, 216: 216, 219: 219, 224: 224, 225: 225, 227: 227, 232: 232, 248: 248, 45: 45, 46: 46, 47: 47, 48: 48, 50: 50, 51: 51, 54: 54, 56: 56, 58: 58, 61: 61, 63: 63, 82: 82, 9: 9, 98: 98, 99: 99 }], 101: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(55); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this), this.AST_IN_FUTURE = `astInFuture`, this.BUFFER_EMPTY = `bufferStalled`, this.BUFFER_LOADED = `bufferLoaded`, this.BUFFER_LEVEL_STATE_CHANGED = `bufferStateChanged`, this.DYNAMIC_TO_STATIC = `dynamicToStatic`, this.ERROR = `error`, this.FRAGMENT_LOADING_COMPLETED = `fragmentLoadingCompleted`, this.FRAGMENT_LOADING_PROGRESS = `fragmentLoadingProgress`, this.FRAGMENT_LOADING_STARTED = `fragmentLoadingStarted`, this.FRAGMENT_LOADING_ABANDONED = `fragmentLoadingAbandoned`, this.LOG = `log`, this.MANIFEST_LOADED = `manifestLoaded`, this.METRICS_CHANGED = `metricsChanged`, this.METRIC_CHANGED = `metricChanged`, this.METRIC_ADDED = `metricAdded`, this.METRIC_UPDATED = `metricUpdated`, this.PERIOD_SWITCH_COMPLETED = `periodSwitchCompleted`, this.PERIOD_SWITCH_STARTED = `periodSwitchStarted`, this.QUALITY_CHANGE_REQUESTED = `qualityChangeRequested`, this.QUALITY_CHANGE_RENDERED = `qualityChangeRendered`, this.TRACK_CHANGE_RENDERED = `trackChangeRendered`, this.SOURCE_INITIALIZED = `sourceInitialized`, this.STREAM_INITIALIZING = `streamInitializing`, this.STREAM_UPDATED = `streamUpdated`, this.STREAM_INITIALIZED = `streamInitialized`, this.STREAM_TEARDOWN_COMPLETE = `streamTeardownComplete`, this.TEXT_TRACKS_ADDED = `allTextTracksAdded`, this.TEXT_TRACK_ADDED = `textTrackAdded`, this.TTML_PARSED = `ttmlParsed`, this.TTML_TO_PARSE = `ttmlToParse`, this.CAPTION_RENDERED = `captionRendered`, this.CAPTION_CONTAINER_RESIZE = `captionContainerResize`, this.CAN_PLAY = `canPlay`, this.PLAYBACK_ENDED = `playbackEnded`, this.PLAYBACK_ERROR = `playbackError`, this.PLAYBACK_NOT_ALLOWED = `playbackNotAllowed`, this.PLAYBACK_METADATA_LOADED = `playbackMetaDataLoaded`, this.PLAYBACK_PAUSED = `playbackPaused`, this.PLAYBACK_PLAYING = `playbackPlaying`, this.PLAYBACK_PROGRESS = `playbackProgress`, this.PLAYBACK_RATE_CHANGED = `playbackRateChanged`, this.PLAYBACK_SEEKED = `playbackSeeked`, this.PLAYBACK_SEEKING = `playbackSeeking`, this.PLAYBACK_SEEK_ASKED = `playbackSeekAsked`, this.PLAYBACK_STALLED = `playbackStalled`, this.PLAYBACK_STARTED = `playbackStarted`, this.PLAYBACK_TIME_UPDATED = `playbackTimeUpdated`, this.PLAYBACK_WAITING = `playbackWaiting`, this.MANIFEST_VALIDITY_CHANGED = `manifestValidityChanged`, this.GAP_CAUSED_SEEK_TO_PERIOD_END = `gapCausedSeekToPeriodEnd`, this.GAP_CAUSED_INTERNAL_SEEK = `gapCausedInternalSeek`, this.EVENT_MODE_ON_START = `eventModeOnStart`, this.EVENT_MODE_ON_RECEIVE = `eventModeOnReceive`; }e = new ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o)(); n.default = e, t.exports = n.default; }, { 55: 55 }], 102: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(100); const a = (r = i) && r.__esModule ? r : { default: r }; let s; let o; const u = (s = `application/dash+xml`, { create: l, createAll: function (e, t) { const n = []; e = e || `[data-dashjs-player]`; for (var r = (t = t || document).querySelectorAll(e), i = 0; i < r.length; i++) { var a = l(r[i], null); n.push(a); } for (var o = t.querySelectorAll(`source[type="${s}"]`), i = 0; i < o.length; i++) { a = l((function (e) { let t = !0; for (;t;) { const n = e; if (t = !1, /^VIDEO$/i.test(n.nodeName)) return n; e = n.parentNode, t = !0; } }(o[i])), null); n.push(a); } return n; } }); function l (e, t, n) { if (!e || !/^VIDEO$/i.test(e.nodeName)) return null; if (e._dashjs_player) return e._dashjs_player; let r = void 0; const i = e.id || e.name || `video element`; if (!(t = t || [].slice.call(e.querySelectorAll(`source`)).filter((e) => { return e.type == s; })[0]) && e.src)(t = document.createElement(`source`)).src = e.src; else if (!t && !e.src) return null; return n = n || {}, (r = (0, a.default)(n).create()).initialize(e, t.src, e.autoplay), (o = o || r.getDebug().getLogger()).debug(`Converted ${i} to dash.js player and added content: ${t.src}`), e._dashjs_player = r; } let d = o = void 0; typeof window !== `undefined` && window && window.dashjs && window.dashjs.skipAutoCreate || typeof window === `undefined` || !window || !window.addEventListener || (window.document.readyState === `complete` ? window.dashjs ? u.createAll() : d = window.setInterval(() => { window.dashjs && (window.clearInterval(d), u.createAll()); }, 500) : window.addEventListener(`load`, function e () { window.removeEventListener(`load`, e), u.createAll(); })), n.default = u, t.exports = n.default; }, { 100: 100 }], 103: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const u = r(e(45)); var e = r(e(47)); function i (e) { const t = this.context; let n = void 0; let r = void 0; let a = void 0; let o = []; let i = e; function s (t, n) { o = o.filter((e) => { return !((isNaN(n) || e.start < n) && (isNaN(t) || e.end > t)); }); } return n = { getAllBufferRanges: function () { for (var t = [], e = 0; e < o.length; e++) { const n = o[e]; t.length === 0 || n.start > t[t.length - 1].end ? t.push({ start: n.start, end: n.end }) : t[t.length - 1].end = n.end; } const r = { start: function (e) { return t[e].start; }, end: function (e) { return t[e].end; } }; return Object.defineProperty(r, `length`, { get: function () { return t.length; } }), r; }, append: function (e) { a = e.segmentType !== `InitializationSegment` ? (o.push(e), o.sort((e, t) => { return e.start - t.start; }), null) : e, r.debug(`PreBufferSink appended chunk s: ${e.start}; e: ${e.end}`), i && i({ chunk: e }); }, remove: s, abort: function () {}, discharge: function (e, t) { let n; let r; const i = (n = e, r = t, o.filter((e) => { return (isNaN(r) || e.start < r) && (isNaN(n) || e.end > n); })); return a && (i.push(a), a = null), s(e, t), i; }, reset: function () { o = [], i = a = null; }, updateTimestampOffset: function () {}, hasDiscontinuitiesAfter: function () { return !1; }, waitForUpdateEnd: function (e) { e(); }, getBuffer: function () { return this; } }, r = (0, u.default)(t).getInstance().getLogger(n), n; }i.__dashjs_factory_name = `PreBufferSink`; e = e.default.getClassFactory(i); n.default = e, t.exports = n.default; }, { 45: 45, 47: 47 }], 104: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const A = r(e(45)); const I = r(e(232)); const R = r(e(46)); const b = r(e(54)); let i = r(e(47)); const D = r(e(207)); const M = r(e(51)); function a (i, r, e, a) { const o = this.context; const s = (0, R.default)(o).getInstance(); let u = void 0; let l = void 0; let d = void 0; let f = void 0; let c = void 0; let h = void 0; let t = []; let p = []; let g = e; function _ () { try { return f.buffered; } catch (e) { return d.error(`getAllBufferRanges exception: ${e.message}`), null; } } function m (n) { f && S(() => { try { let e = i.duration; let t = 0; n && !isNaN(n.start) && !isNaN(n.duration) && isFinite(n.duration) && (e = n.start + n.duration), n && !isNaN(n.start) && (t = n.start), f.appendWindowStart = 0, f.appendWindowEnd = e, f.appendWindowStart = t, d.debug(`Updated append window. Set start to ${f.appendWindowStart} and end to ${f.appendWindowEnd}`); } catch (e) { d.warn(`Failed to set append window`); } }); } function E () { const t = this; const o = this; p.length > 0 && (function () { c = !0; const i = p[0]; p.splice(0, 1); function e () { let e; let t; let n; let r = _(); e = o, t = r, n = i, (r = a) && r.length > 0 && r.length < t.length && (function (e, t) { for (let n = 0; n < e.length; n++) { const r = Math.round(e.start(n)); const i = Math.round(e.end(n)); if (i === t.start || r === t.end || t.start >= r && t.end <= i) return !0; } return !1; }(r, n)) && s.trigger(b.default.SOURCEBUFFER_REMOVE_COMPLETED, { buffer: e, from: t.end(t.length - 2), to: t.start(t.length - 1), unintended: !0 }), p.length > 0 ? E.call(this) : (c = !1, g && g({ chunk: i })); } var a = []; try { i.bytes.length === 0 ? e.call(t) : (a = _(), f.appendBuffer ? f.appendBuffer(i.bytes) : f.append(i.bytes, i), S(e.bind(t))); } catch (e) { d.fatal(`SourceBuffer append failed "${e}"`), p.length > 0 ? E() : c = !1, g && g({ chunk: i, error: new I.default(e.code, e.message) }); } }()); } function n () { let e; t.length > 0 && (e = t.shift(), f.updating ? S(e) : (e(), n())); } function y () { f.updating || n(); } function v () { f.updating || n(); } function T () { d.error(`SourceBufferSink error`); } function S (e) { t.push(e), f.updating || n(); } return u = { getType: function () { return l; }, getAllBufferRanges: _, getBuffer: function () { return f; }, append: function (e) { e ? (p.push(e), c || S(E.bind(this))) : g({ chunk: e, error: new I.default(M.default.APPEND_ERROR_CODE, M.default.APPEND_ERROR_MESSAGE) }); }, remove: function (t, n, e) { const r = this; S(() => { try { t >= 0 && t < n && (e || i.readyState !== `ended`) && f.remove(t, n), S(() => { s.trigger(b.default.SOURCEBUFFER_REMOVE_COMPLETED, { buffer: r, from: t, to: n, unintended: !1 }); }); } catch (e) { s.trigger(b.default.SOURCEBUFFER_REMOVE_COMPLETED, { buffer: r, from: t, to: n, unintended: !1, error: new I.default(e.code, e.message) }); } }); }, abort: function () { try { (i.readyState === `open` || f.setTextTrack && i.readyState === `ended`) && f.abort(); } catch (e) { d.error(`SourceBuffer append abort failed: "${e}"`); }p = []; }, reset: function (e) { if (f) { if (typeof f.removeEventListener === `function` && (f.removeEventListener(`updateend`, v, !1), f.removeEventListener(`error`, T, !1), f.removeEventListener(`abort`, T, !1)), clearInterval(h), t = [], !e) { try { f.getClassName && f.getClassName() === `TextSourceBuffer` || (d.debug(`Removing sourcebuffer from media source`), i.removeSourceBuffer(f)); } catch (e) { d.error(`Failed to remove source buffer from media source.`); }f = null; }c = !1; }p = [], g = null; }, updateTimestampOffset: function (e) { f.timestampOffset === e || isNaN(e) || S(() => { e < 0 && (e += 0.001), f.timestampOffset = e; }); }, hasDiscontinuitiesAfter: function (e) { try { const t = _(); if (t && t.length > 1) for (let n = 0, r = t.length; n < r; n++) if (n > 0 && e < t.start(n) && t.start(n) > t.end(n - 1) + 0.1) return !0; } catch (e) { d.error(`hasDiscontinuities exception: ${e.message}`); } return !1; }, waitForUpdateEnd: S, updateAppendWindow: m }, (function () { d = (0, A.default)(o).getInstance().getLogger(u), c = !1, l = r.type; const t = r.codec; try { if (t.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i)) throw new Error(`not really supported`); (f = a || i.addSourceBuffer(t)).changeType && a && (d.debug(`Doing period transition with changeType`), f.changeType(t)), m(); if (typeof f.addEventListener === `function`) try { f.addEventListener(`updateend`, v, !1), f.addEventListener(`error`, T, !1), f.addEventListener(`abort`, T, !1); } catch (e) { h = setInterval(y, 50); } else h = setInterval(y, 50); } catch (e) { if (!r.isText && t.indexOf(`codecs="stpp`) === -1 && t.indexOf(`codecs="wvtt`) === -1) throw e; const n = (0, D.default)(o).getInstance(); f = n.getTextSourceBuffer(); } }()), u; }a.__dashjs_factory_name = `SourceBufferSink`; i = i.default.getClassFactory(a); n.default = i, t.exports = n.default; }, { 207: 207, 232: 232, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54 }], 105: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const fe = r(e(108)); const ce = r(e(61)); const he = r(e(106)); const pe = r(e(116)); const ge = r(e(210)); const _e = r(e(46)); const me = r(e(54)); const Ee = r(e(45)); const ye = r(e(51)); const i = r(e(47)); const ve = r(e(232)); const Te = r(e(213)); const Se = r(e(227)); function a (u) { u = u || {}; const l = this.context; const s = (0, _e.default)(l).getInstance(); const e = (0, Se.default)(l).getInstance(); const d = u.manifestModel; const f = u.mediaPlayerModel; const a = u.manifestUpdater; const c = u.adapter; const i = u.capabilities; const h = u.errHandler; const p = u.timelineConverter; const t = u.dashMetrics; const g = u.abrController; const _ = u.playbackController; const o = u.eventController; const m = u.mediaController; const E = u.textController; const y = u.protectionController; const r = u.videoModel; const v = u.settings; let T = u.streamInfo; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; let C = void 0; let w = void 0; let O = void 0; let P = void 0; let L = void 0; let x = void 0; let n = void 0; let F = void 0; let U = void 0; let B = void 0; const k = [{ codec: `avc1`, compatibleCodecs: [`avc3`] }, { codec: `avc3`, compatibleCodecs: [`avc1`] }]; function G (e) { for (let t = I ? I.length : 0, n = 0; n < t; n++) { I[n].getFragmentModel().removeExecutedRequestsBeforeTime(K() + H()), I[n].reset(!1, e); }le(D = b = !(I = [])), s.off(me.default.CURRENT_TRACK_CHANGED, X, S); } function j () { G(), N = M = R = !1, U = n = w = !(C = {}); } function Y () { _ && _.pause(), O && (O.reset(), O = null), T = null, j(), s.off(me.default.DATA_UPDATE_COMPLETED, ne, S), s.off(me.default.BUFFERING_COMPLETED, te, S), s.off(me.default.INBAND_EVENTS, re, S), y && (s.off(me.default.KEY_ERROR, W, S), s.off(me.default.SERVER_CERTIFICATE_UPDATED, W, S), s.off(me.default.LICENSE_REQUEST_COMPLETE, W, S), s.off(me.default.KEY_SYSTEM_SELECTED, W, S), s.off(me.default.KEY_SESSION_CREATED, W, S), s.off(me.default.KEY_STATUSES_CHANGED, W, S)), le(!1); } function H () { return T ? T.duration : NaN; } function K () { return T ? T.start : NaN; } function q () { return T; } function V () { if (!(r && g && g.hasOwnProperty(`getBitrateList`) && c && c.hasOwnProperty(`getAllMediaInfoForType`) && c.hasOwnProperty(`getEventsFor`))) throw new Error(fe.default.MISSING_CONFIG_ERROR); } function W (e) { e.error && (h.error(e.error), A.fatal(e.error.message), Y()); } function z (e) { let t; const n = e ? e.type : null; let r = void 0; if (n === fe.default.MUXED) return r = `Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines`, A.fatal(r), void h.error(new ve.default(ye.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE, r, d.getValue())); if (n === fe.default.TEXT || n === fe.default.FRAGMENTED_TEXT || n === fe.default.EMBEDDED_TEXT || n === fe.default.IMAGE) return 1; if (t = e.codec, A.debug(`${n} codec: ${t}`), e.contentProtection && !i.supportsEncryptedMedia())h.error(new ve.default(ye.default.CAPABILITY_MEDIAKEYS_ERROR_CODE, ye.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)); else if (!i.supportsCodec(t)) return r = `${n}Codec (${t}) is not supported.`, void A.error(r); return 1; } function X (e) { let t, n, r, i; T && e.newMediaInfo.streamInfo.id === T.id && (t = e.newMediaInfo, n = d.getValue(), c.setCurrentMediaInfo(T.id, t.type, t), (r = ie(t)) && (i = _.getTime(), A.info(`Stream -  Process track changed at current time ${i}`), A.debug(`Stream -  Update stream controller`), n.refreshManifestOnSwitchTrack ? (A.debug(`Stream -  Refreshing manifest for switch track`), B = e, a.refreshManifest()) : (r.selectMediaInfo(t), t.type !== fe.default.FRAGMENTED_TEXT ? (g.updateTopQualityIndex(t), r.switchTrackAsked(), r.getFragmentModel().abortRequests()) : (r.getScheduleController().setSeekTarget(i), r.setBufferingTime(i), r.resetIndexHandler())))); } function Q (e, t) { let n; const r = c.getAllMediaInfoForType(T, e); let i = null; if (r && r.length !== 0) { e === fe.default.VIDEO && (M = !0), e === fe.default.AUDIO && (N = !0); for (let a = 0, o = r.length; a < o; a++)i = r[a], e === fe.default.EMBEDDED_TEXT ? E.addEmbeddedTrack(i) : z(i) && m.addTrack(i); e !== fe.default.EMBEDDED_TEXT && m.getTracksFor(e, T).length !== 0 && (e !== fe.default.IMAGE ? (m.checkInitialMediaSettingsForType(e, T), n = m.getCurrentTrackFor(e, T), s.trigger(me.default.STREAM_INITIALIZING, { streamInfo: T, mediaInfo: i }), (function (e, t, n, r) { const i = O.getModel(e ? e.type : null); const a = (0, he.default)(l).create({ streamInfo: T, type: e ? e.type : null, mimeType: e ? e.mimeType : null, timelineConverter: p, adapter: c, manifestModel: d, mediaPlayerModel: f, fragmentModel: i, dashMetrics: u.dashMetrics, baseURLController: u.baseURLController, abrController: g, playbackController: _, mediaController: m, textController: E, errHandler: h, settings: v, boxParser: x }); if (a.initialize(n, M), g.updateTopQualityIndex(e), r ? (a.setBuffer(r.buffer), a.setBufferingTime(r.currentTime), I[r.replaceIdx] = a) : I.push(a), !r || !r.ignoreMediaInfo) if (!e || e.type !== fe.default.TEXT && e.type !== fe.default.FRAGMENTED_TEXT)a.addMediaInfo(e, !0); else { for (var o = void 0, s = 0; s < t.length; s++)t[s].index === e.index && (o = s), a.addMediaInfo(t[s]); a.selectMediaInfo(t[o]); } }(n, r, t))) : P = (0, ge.default)(l).create({ streamInfo: T, adapter: c, baseURLController: u.baseURLController, timelineConverter: u.timelineConverter, debug: F, eventBus: s, events: me.default, dashConstants: ce.default })); } else A.info(`No ${e} data.`); } function Z () { let e; o && (e = c.getEventsFor(T), o.addInlineEvents(e)); } function $ (e) { const n = c.getAdaptationForType(T ? T.index : null, e, T); n && Array.isArray(n.Representation_asArray) && (n.Representation_asArray = n.Representation_asArray.filter((e, t) => { if (t === 0) return !0; t = c.getCodec(n, t, !0); return !!i.supportsCodec(t) || (A.error(`[Stream] codec not supported: ${t}`), !1); })); } function J () { for (var e = I.length, t = !!C.audio || !!C.video ? new ve.default(ye.default.DATA_UPDATE_FAILED_ERROR_CODE, ye.default.DATA_UPDATE_FAILED_ERROR_MESSAGE) : null, n = 0; n < e; n++) if (I[n].isUpdating() || w) return; if (D) { if (y) for (var r, n = 0; n < e && I[n]; n++) { I[n].getType() !== fe.default.AUDIO && I[n].getType() !== fe.default.VIDEO && I[n].getType() !== fe.default.FRAGMENTED_TEXT || (r = I[n].getMediaInfo()) && y.initializeForMedia(r); }t ? h.error(t) : R || (R = !0, p.setTimeSyncCompleted(!0), s.trigger(me.default.STREAM_INITIALIZED, { streamInfo: T, liveStartTime: L ? NaN : (function () { if (!T.manifestInfo.isDynamic) return NaN; for (let e = 0; e < I.length; e++) if (I[e].getType() === fe.default.AUDIO || I[e].getType() === fe.default.VIDEO) return I[e].getLiveStartTime(); return NaN; }()) })); for (n = 0; n < e && I[n]; n++)I[n].getScheduleController().start(); } } function ee (e) { for (var t = {}, n = 0, r = I.length; n < r; n++) { const i = I[n].createBuffer(e); i && (t[I[n].getType()] = i.getBuffer()); } return t; } function te () { const e = ae(); const t = e.length; if (t !== 0) { for (let n = 0; n < t; n++) if (!e[n].isBufferingCompleted() && (e[n].getType() === fe.default.AUDIO || e[n].getType() === fe.default.VIDEO)) return void A.warn(`onBufferingCompleted - One streamProcessor has finished but`, e[n].getType(), `one is not buffering completed`); A.debug(`onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED`), s.trigger(me.default.STREAM_BUFFERING_COMPLETED, { streamInfo: T }); } else A.warn(`onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined`); } function ne (e) { C[e.mediaType] = e.error, J(); } function re (e) { e = e.events, o && o.addInbandEvents(e); } function ie (t) { return t ? ae().filter((e) => { return e.getType() === t.type; })[0] : null; } function ae () { for (var e, t = [], n = void 0, r = 0; r < I.length; r++)(e = (n = I[r]).getType()) !== fe.default.AUDIO && e !== fe.default.VIDEO && e !== fe.default.FRAGMENTED_TEXT && e !== fe.default.TEXT || t.push(n); return t; } function oe (e, t, n) { n = arguments.length <= 2 || void 0 === n ? null : n; if (!e) return !1; e = e.getStreamInfo(), n = n ? n.getStreamInfo() : T; if (!e || !n) return !1; e = c.getAdaptationForType(e.index, t, e), n = c.getAdaptationForType(n.index, t, n); return e && n ? !(!se(n) && se(e)) : !e && !n; } function se (e) { return e && (e.ContentProtection || e.Representation && e.Representation.length > 0 && e.Representation[0].ContentProtection); } function ue (e, t, n) { n = arguments.length <= 2 || void 0 === n ? null : n; if (!e || !e.hasOwnProperty(`getStreamInfo`)) return !1; e = e.getStreamInfo(), n = n ? n.getStreamInfo() : T; if (!e || !n) return !1; e = c.getAdaptationForType(e.index, t, e), t = c.getAdaptationForType(n.index, t, n); if (!e || !t) return !e && !t; var n = e && t && e.mimeType === t.mimeType; const r = t.Representation_asArray.map((e) => { return e.codecs; }); var t = e.Representation_asArray.map((e) => { return e.codecs; }); var e = t.some((e) => { return r.indexOf(e) > -1; }); var t = t.some((t) => { return r.some((e) => { return (function (e, t) { for (var n = e.split(`.`)[0], e = t.indexOf(n) === 0, r = void 0, i = 0; i < k.length; i++) if (k[i].codec === n) { r = k[i]; break; } if (r) return e || r.compatibleCodecs.some((e) => { return t.indexOf(e) === 0; }); return e; }(e, t)); }); }); return e || t && n; } function le (e) { L = e; } function de () { return L; } return S = { initialize: function () { s.on(me.default.BUFFERING_COMPLETED, te, S), s.on(me.default.DATA_UPDATE_COMPLETED, ne, S), s.on(me.default.INBAND_EVENTS, re, S), y && (s.on(me.default.KEY_ERROR, W, S), s.on(me.default.SERVER_CERTIFICATE_UPDATED, W, S), s.on(me.default.LICENSE_REQUEST_COMPLETE, W, S), s.on(me.default.KEY_SYSTEM_SELECTED, W, S), s.on(me.default.KEY_SESSION_CREATED, W, S), s.on(me.default.KEY_STATUSES_CHANGED, W, S)), s.trigger(me.default.STREAM_UPDATED, { streamInfo: T }); }, getStreamId: function () { return T ? T.id : null; }, activate: function (e, t) { if (b) return t; let n = void 0; return s.on(me.default.CURRENT_TRACK_CHANGED, X, S), n = L ? ((function () { { let e; w = !0, V(), $(fe.default.VIDEO), $(fe.default.AUDIO), w = !(D = !0), I.length === 0 ? (e = `No streams to play.`, h.error(new ve.default(ye.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE, e, d.getValue())), A.debug(e)) : J(); } }()), t) : (function (e, t) { V(); const n = r.getElement(); Z(), w = !0, $(fe.default.VIDEO), $(fe.default.AUDIO), (!n || n && /^VIDEO$/i.test(n.nodeName)) && Q(fe.default.VIDEO, e); Q(fe.default.AUDIO, e), Q(fe.default.TEXT, e), Q(fe.default.FRAGMENTED_TEXT, e), Q(fe.default.EMBEDDED_TEXT, e), Q(fe.default.MUXED, e), Q(fe.default.IMAGE, e); e = ee(t); { w = !(D = !0), I.length === 0 ? (t = `No streams to play.`, h.error(new ve.default(ye.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE, t, d.getValue())), A.fatal(t)) : J(); } return e; }(e, t)), b = !0, n; }, deactivate: G, isActive: function () { return b; }, getDuration: H, getStartTime: K, getId: function () { return T ? T.id : null; }, getStreamInfo: q, getHasAudioTrack: function () { return N; }, getHasVideoTrack: function () { return M; }, preload: function (e, t) { if (!L) { Z(), Q(fe.default.VIDEO, e), Q(fe.default.AUDIO, e), Q(fe.default.TEXT, e), Q(fe.default.FRAGMENTED_TEXT, e), Q(fe.default.EMBEDDED_TEXT, e), Q(fe.default.MUXED, e), Q(fe.default.IMAGE, e), ee(t), s.on(me.default.CURRENT_TRACK_CHANGED, X, S); for (let n = 0; n < I.length && I[n]; n++)I[n].getScheduleController().start(); le(!0); } }, getThumbnailController: function () { return P; }, getBitrateListFor: function (e) { return V(), e === fe.default.IMAGE ? P ? P.getBitrateList() : [] : (e = (function (e) { for (let t = null, n = 0; n < I.length; n++) if ((t = I[n]).getType() === e) return t.getMediaInfo(); return null; }(e)), g.getBitrateList(e)); }, updateData: function (e) { A.info(`Manifest updated... updating data system wide.`), w = !(b = !1), T = e, s.trigger(me.default.STREAM_UPDATED, { streamInfo: T }), o && Z(), $(fe.default.VIDEO), $(fe.default.AUDIO); for (let t = 0, n = I.length; t < n; t++) { var r; const i = I[t]; i.updateStreamInfo(T), (r = c.getMediaInfoForType(T, i.getType())) && (g.updateTopQualityIndex(r), i.addMediaInfo(r, !0)); } if (B && (r = B.newMediaInfo).type !== fe.default.FRAGMENTED_TEXT) { e = ie(B.oldMediaInfo); if (!e) return; e.switchTrackAsked(), B = void 0; }w = !1, J(); }, reset: Y, getProcessors: ae, setMediaSource: function (e) { for (var t = 0; t < I.length;)z(I[t].getMediaInfo()) ? (I[t].setMediaSource(e), t++) : (I[t].reset(), I.splice(t, 1)); for (var n, t = 0; t < I.length; t++)I[t].dischargePreBuffer(); I.length === 0 && (n = `No streams to play.`, h.error(new ve.default(ye.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE, `${n}nostreams`, d.getValue())), A.fatal(n)); }, isMediaCodecCompatible: function (e) { const t = arguments.length <= 1 || void 0 === arguments[1] ? null : arguments[1]; return ue(e, fe.default.VIDEO, t) && ue(e, fe.default.AUDIO, t); }, isProtectionCompatible: function (e) { const t = arguments.length <= 1 || void 0 === arguments[1] ? null : arguments[1]; return oe(e, fe.default.VIDEO, t) && oe(e, fe.default.AUDIO, t); }, getPreloaded: de, getPreloadingScheduled: function () { return n; }, setPreloadingScheduled: function (e) { n = e; }, getIsEndedEventSignaled: function () { return U; }, setIsEndedEventSignaled: function (e) { U = e; } }, F = (0, Ee.default)(l).getInstance(), A = F.getLogger(S), j(), x = (0, Te.default)(l).getInstance(), O = (0, pe.default)(l).create({ streamInfo: T, mediaPlayerModel: f, dashMetrics: t, errHandler: h, settings: v, boxParser: x, dashConstants: ce.default, urlUtils: e }), S; }a.__dashjs_factory_name = `Stream`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 106: 106, 108: 108, 116: 116, 210: 210, 213: 213, 227: 227, 232: 232, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54, 61: 61 }], 106: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const z = r(e(108)); const X = r(e(61)); const Q = r(e(109)); const Z = r(e(150)); const $ = r(e(114)); const J = r(e(206)); const ee = r(e(121)); const te = r(e(62)); const ne = r(e(222)); const i = r(e(47)); const re = e(225); const ie = r(e(46)); const ae = r(e(54)); const oe = r(e(57)); const se = r(e(51)); const ue = r(e(232)); const le = r(e(45)); const de = r(e(224)); const fe = r(e(227)); const ce = r(e(213)); const he = r(e(234)); const pe = e(250); function a (n) { n = n || {}; const p = this.context; const o = (0, ie.default)(p).getInstance(); let s = n.streamInfo; let l = n.type; const r = n.errHandler; const i = n.mimeType; const a = n.timelineConverter; const g = n.adapter; const u = n.manifestModel; const d = n.mediaPlayerModel; const f = n.fragmentModel; const c = n.abrController; const h = n.playbackController; const _ = n.mediaController; const m = n.textController; const E = n.dashMetrics; const y = n.settings; const v = n.boxParser; let T = void 0; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; let C = void 0; let w = void 0; let O = void 0; function e () { return l; } function P () { R = [], I = null, w = 0; } function L (e) { e.error || D.setCurrentRepresentation(g.convertDataToRepresentationInfo(e.currentRepresentation)), e.error && e.error.code !== se.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE || h.getStreamController().getActiveStreamInfo().id === s.id && t(); } function x (e) { e = Y(e.newQuality); D.setCurrentRepresentation(e), E.pushPlayListTraceMetrics(new Date(), pe.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON), E.createPlaylistTraceMetrics(e.id, 1e3 * h.getTime(), h.getPlaybackRate()); } function F (e) { E.addBufferLevel(l, new Date(), 1e3 * e.bufferLevel); e = h.getStreamController().getActiveStreamInfo().id; u.getValue().doNotUpdateDVRWindowOnBufferUpdated || s.id !== e || t(); } function U (e) { E.addBufferState(l, e.state, D.getBufferTarget()), e.state !== Q.default.BUFFER_EMPTY || h.isSeeking() || E.pushPlayListTraceMetrics(new Date(), pe.PlayListTrace.REBUFFERING_REASON); } function B (e) { f.syncExecutedRequestsWithBufferedRange(b.getBuffer().getAllBufferRanges(), s.duration), e.from > h.getTime() && (w = e.from, O = !0); } function t () { const e = s.manifestInfo; var t = e.isDynamic; var t = a.calcSegmentAvailabilityRange(M.getCurrentRepresentation(), t); E.addDVRInfo(l, h.getTime(), e, t); } function k () { return b ? b.getBuffer() : null; } function G () { return R; } function j () { return I; } function Y (e) { var t = void 0; var t = void 0 !== e ? ((0, re.checkInteger)(e), M ? M.getRepresentationForQuality(e) : null) : M ? M.getCurrentRepresentation() : null; return g.convertDataToRepresentationInfo(t); } function H (e) { e.sender && (g.getIsTextTrack(i) && !m.isTextEnabled() || b && e.representationId && (b.appendInitSegment(e.representationId) || (e = C ? C.getInitRequest(I, M.getCurrentRepresentation()) : null, D.processInitRequest(e)))); } function K (e) { let t = void 0; b.getIsPruningInProgress() || (t = (function (e, t) { const n = Y(); const r = !isNaN(e); const i = h.getNormalizedTime(); let a = r ? e : w; let o = !1; let s = void 0; if (isNaN(a) || l === z.default.FRAGMENTED_TEXT && !m.isTextEnabled()) return null; { let u; b && (u = b.getRangeAt(a), e = b.getRangeAt(i), u === null && e === null || r || (!u || e && e.start != u.start && e.end != u.end) && b.getBuffer().hasDiscontinuitiesAfter(i) && l !== z.default.FRAGMENTED_TEXT && (f.removeExecutedRequestsAfterTime(e.end), o = !0)); } if (t)a = t.startTime + t.duration / 2, s = W(n, a, { timeThreshold: 0, ignoreIsFinished: !0 }); else { o = r || O || o; for (s = W(n, o ? a : void 0, { keepIdx: !o }), O = !1; s && s.action !== he.default.ACTION_COMPLETE && f.isFragmentLoaded(s);)s = W(n); } return s; }(e.seekTarget, e.replacement))) && (D.setSeekTarget(NaN), e.replacement || (isNaN(t.startTime + t.duration) || (w = t.startTime + t.duration), t.delayLoadingTime = (new Date()).getTime() + D.getTimeToLoadDelay(), D.setTimeToLoadDelay(0))), D.processMediaRequest(t); } function q (e) { const t = e.chunk; const n = t.bytes; const r = t.quality; const i = Y(r); var a = M && i ? M.getRepresentationForQuality(i.quality) : null; var e = g.getEventsFor(i.mediaInfo); var a = g.getEventsFor(i, a); (e && e.length > 0 || a && a.length > 0) && (a = (function (e, t, n, r) { try { for (var i = {}, a = [], o = n.concat(r), s = 0, u = o.length; s < u; s++)i[`${o[s].schemeIdUri}/${o[s].value}`] = o[s]; var l = (0, ce.default)(p).getInstance().parse(e); const d = l.getBoxes(`emsg`); if (!d || d.length === 0) return a; for (var l = l.getBox(`sidx`), l = !l || isNaN(l.earliest_presentation_time) || isNaN(l.timescale) ? t && !isNaN(t.mediaStartTime) ? t.mediaStartTime : 0 : l.earliest_presentation_time / l.timescale, f = Math.max(l, 0), c = M.getCurrentRepresentation(), s = 0, u = d.length; s < u; s++) { const h = g.getEvent(d[s], i, f, c); h && a.push(h); } return a; } catch (e) { return []; } }(n, f.getRequests({ state: Z.default.FRAGMENT_MODEL_EXECUTED, quality: r, index: t.index })[0], e, a)), o.trigger(ae.default.INBAND_EVENTS, { events: a }, { streamId: s.id })); } function V (e) { w = e.time, D.setSeekTarget(e.time); } function W (e, t, n) { let r = null; return C && (e = M && e ? M.getRepresentationForQuality(e.quality) : null, r = void 0 !== t && void 0 !== n ? C.getSegmentRequestForTime(I, e, t, n) : C.getNextSegmentRequest(I, e)), r; } return T = { initialize: function (e, t) { C = (0, oe.default)(p).create({ streamInfo: s, type: l, timelineConverter: a, dashMetrics: E, mediaPlayerModel: d, baseURLController: n.baseURLController, errHandler: r, settings: y, boxParser: v, events: ae.default, eventBus: o, errors: se.default, debug: (0, le.default)(p).getInstance(), requestModifier: (0, de.default)(p).getInstance(), dashConstants: X.default, constants: z.default, urlUtils: (0, fe.default)(p).getInstance() }), (A = s.manifestInfo.isDynamic) && (N = (0, ne.default)(p).create({ timelineConverter: a })), C.initialize(A), c.registerStreamType(l, T), M = (0, te.default)(p).create({ streamInfo: s, type: l, abrController: c, dashMetrics: E, playbackController: h, timelineConverter: a, dashConstants: X.default, events: ae.default, eventBus: o, errors: se.default }), (b = (function (e) { let t = null; if (!e) return r.error(new ue.default(se.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE, `${se.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE}not properly defined`)), null; t = e === z.default.VIDEO || e === z.default.AUDIO ? (0, $.default)(p).create({ streamInfo: s, type: e, mediaPlayerModel: d, manifestModel: u, fragmentModel: f, errHandler: r, mediaController: _, representationController: M, adapter: g, textController: m, abrController: c, playbackController: h, settings: y }) : (0, J.default)(p).create({ streamInfo: s, type: e, mimeType: i, mediaPlayerModel: d, manifestModel: u, fragmentModel: f, errHandler: r, mediaController: _, representationController: M, adapter: g, textController: m, abrController: c, playbackController: h, settings: y }); return t; }(l))) && b.initialize(e), (D = (0, ee.default)(p).create({ streamInfo: s, type: l, mimeType: i, adapter: g, dashMetrics: E, mediaPlayerModel: d, fragmentModel: f, abrController: c, playbackController: h, textController: m, mediaController: _, bufferController: b, settings: y })).initialize(t), w = 0, O = !1; }, getStreamId: function () { return s.id; }, getType: e, isUpdating: function () { return !!M && M.isUpdating(); }, getBufferController: function () { return b; }, getFragmentModel: function () { return f; }, getScheduleController: function () { return D; }, getRepresentationController: function () { return M; }, getRepresentationInfo: Y, getBufferLevel: function () { return b ? b.getBufferLevel() : 0; }, isBufferingCompleted: function () { return !!b && b.getIsBufferingCompleted(); }, createBuffer: function (e) { return k() || b ? b.createBuffer(R, e) : null; }, updateStreamInfo: function (e) { s = e, y.get().streaming.useAppendWindow && b.updateAppendWindow(); }, getStreamInfo: function () { return s; }, selectMediaInfo: function (e) { e === I || e && I && e.type !== I.type || (I = e); let t; let n; let r; let i; const a = g.getRealAdaptation(s, I); const o = g.getVoRepresentations(I); M && (t = M.getData(), n = c.getTopQualityIndexFor(l, s.id), r = c.getMinAllowedIndexFor(l), i = void 0, i = (e = null) !== t && t.id == a.id || l === z.default.FRAGMENTED_TEXT ? c.getQualityFor(l) : (e = c.getThroughputHistory().getAverageThroughput(l) || c.getInitialBitrateFor(l), c.getQualityForBitrate(I, e)), void 0 !== r && i < r && (i = r), n < i && (i = n), C.setMimeType(I ? I.mimeType : null), M.updateData(a, o, l, i)); }, addMediaInfo: function (e, t) { R.indexOf(e) === -1 && R.push(e), t && this.selectMediaInfo(e); }, getLiveStartTime: function () { if (!A) return NaN; if (!N) return NaN; let e = NaN; let t = Y(); const n = N.getLiveEdge(t); return isNaN(n) ? NaN : ((t = (function (e, t) { try { let n = null; let r = h.getLiveDelay(); const i = isNaN(s.manifestInfo.DVRWindowSize) ? r : s.manifestInfo.DVRWindowSize; const a = 0.1 * i; let o = void 0; if (!isFinite(i) || W(t, e - i + a, { ignoreIsFinished: !0 })) for (;!n && r <= i;)(n = W(t, o = e - r, { ignoreIsFinished: !0 })) || (r += 1); return n && h.setLiveDelay(r, !0), S.debug(`live edge: ${e}, live delay: ${r}, live target: ${o}`), n; } catch (e) { return null; } }(n, t))) && (e = !y.get().streaming.lowLatencyEnabled || t.duration < d.getLiveDelay() ? t.startTime : t.startTime + t.duration - d.getLiveDelay()), e); }, switchTrackAsked: function () { D.switchTrackAsked(); }, getMediaInfoArr: G, getMediaInfo: j, getMediaSource: function () { return b.getMediaSource(); }, setMediaSource: function (e) { b.setMediaSource(e, R); }, dischargePreBuffer: function () { b.dischargePreBuffer(); }, getBuffer: k, setBuffer: function (e) { b.setBuffer(e); }, setBufferingTime: function (e) { w = e; }, resetIndexHandler: function () { C && C.resetIndex(); }, getInitRequest: function (e) { return (0, re.checkInteger)(e), e = M ? M.getRepresentationForQuality(e) : null, C ? C.getInitRequest(I, e) : null; }, getFragmentRequest: W, finalisePlayList: function (e, t) { E.pushPlayListTraceMetrics(e, t); }, reset: function (e, t) { C && C.reset(), b && (b.reset(e, t), b = null), D && (D.reset(), D = null), M && (M.reset(), M = null), N && (N.reset(), N = null), c && c.unRegisterStreamType(l), o.off(ae.default.DATA_UPDATE_COMPLETED, L, T), o.off(ae.default.QUALITY_CHANGE_REQUESTED, x, T), o.off(ae.default.INIT_FRAGMENT_NEEDED, H, T), o.off(ae.default.MEDIA_FRAGMENT_NEEDED, K, T), o.off(ae.default.MEDIA_FRAGMENT_LOADED, q, T), o.off(ae.default.BUFFER_LEVEL_UPDATED, F, T), o.off(ae.default.BUFFER_LEVEL_STATE_CHANGED, U, T), o.off(ae.default.BUFFER_CLEARED, B, T), o.off(ae.default.SEEK_TARGET, V, T), P(), s = l = null; } }, S = (0, le.default)(p).getInstance().getLogger(T), P(), o.on(ae.default.DATA_UPDATE_COMPLETED, L, T, { priority: ie.default.EVENT_PRIORITY_HIGH }), o.on(ae.default.QUALITY_CHANGE_REQUESTED, x, T), o.on(ae.default.INIT_FRAGMENT_NEEDED, H, T), o.on(ae.default.MEDIA_FRAGMENT_NEEDED, K, T), o.on(ae.default.MEDIA_FRAGMENT_LOADED, q, T), o.on(ae.default.BUFFER_LEVEL_UPDATED, F, T), o.on(ae.default.BUFFER_LEVEL_STATE_CHANGED, U, T), o.on(ae.default.BUFFER_CLEARED, B, T), o.on(ae.default.SEEK_TARGET, V, T), T; }a.__dashjs_factory_name = `StreamProcessor`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 108: 108, 109: 109, 114: 114, 121: 121, 150: 150, 206: 206, 213: 213, 222: 222, 224: 224, 225: 225, 227: 227, 232: 232, 234: 234, 250: 250, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54, 57: 57, 61: 61, 62: 62 }], 107: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const u = r(e(232)); const i = r(e(159)); const l = e(248); const d = r(e(239)); const f = r(e(46)); const c = r(e(54)); const a = r(e(47)); const h = r(e(51)); function o (e) { e = e || {}; const a = `urn:mpeg:dash:resolve-to-zero:2013`; const t = this.context; const o = (0, f.default)(t).getInstance(); let s = (0, i.default)(t).create({ errHandler: e.errHandler, dashMetrics: e.dashMetrics, mediaPlayerModel: e.mediaPlayerModel, requestModifier: e.requestModifier, useFetch: e.settings ? e.settings.get().streaming.lowLatencyEnabled : null, errors: h.default }); return { load: function (n, r, i) { function t (e, t) { r.resolved = !0, r.resolvedContent = e || null, o.trigger(c.default.XLINK_ELEMENT_LOADED, { element: r, resolveObject: i, error: e || t ? null : new u.default(h.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE, h.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE + n) }); } let e; n === a ? t(null, !0) : (e = new d.default(n, l.HTTPRequest.XLINK_EXPANSION_TYPE), s.load({ request: e, success: function (e) { t(e); }, error: function () { t(null); } })); }, reset: function () { s && (s.abort(), s = null); } }; }o.__dashjs_factory_name = `XlinkLoader`, n.default = a.default.getClassFactory(o), t.exports = n.default; }, { 159: 159, 232: 232, 239: 239, 248: 248, 46: 46, 47: 47, 51: 51, 54: 54 }], 108: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } } function i () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, i)), this.init(); }Object.defineProperty(n, `__esModule`, { value: !0 }); const a = new ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(i, [{ key: `init`, value: function () { this.STREAM = `stream`, this.VIDEO = `video`, this.AUDIO = `audio`, this.TEXT = `text`, this.FRAGMENTED_TEXT = `fragmentedText`, this.EMBEDDED_TEXT = `embeddedText`, this.MUXED = `muxed`, this.IMAGE = `image`, this.STPP = `stpp`, this.TTML = `ttml`, this.VTT = `vtt`, this.WVTT = `wvtt`, this.ABR_STRATEGY_DYNAMIC = `abrDynamic`, this.ABR_STRATEGY_BOLA = `abrBola`, this.ABR_STRATEGY_L2A = `abrL2A`, this.ABR_STRATEGY_LoLP = `abrLoLP`, this.ABR_STRATEGY_THROUGHPUT = `abrThroughput`, this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA = `abrFetchThroughputCalculationDownloadedData`, this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING = `abrFetchThroughputCalculationMoofParsing`, this.LIVE_CATCHUP_MODE_DEFAULT = `liveCatchupModeDefault`, this.LIVE_CATCHUP_MODE_LOLP = `liveCatchupModeLoLP`, this.MOVING_AVERAGE_SLIDING_WINDOW = `slidingWindow`, this.MOVING_AVERAGE_EWMA = `ewma`, this.BAD_ARGUMENT_ERROR = `Invalid Arguments`, this.MISSING_CONFIG_ERROR = `Missing config parameter(s)`, this.TRACK_SWITCH_MODE_ALWAYS_REPLACE = `alwaysReplace`, this.TRACK_SWITCH_MODE_NEVER_REPLACE = `neverReplace`, this.TRACK_SELECTION_MODE_HIGHEST_BITRATE = `highestBitrate`, this.TRACK_SELECTION_MODE_WIDEST_RANGE = `widestRange`, this.LOCATION = `Location`, this.INITIALIZE = `initialize`, this.TEXT_SHOWING = `showing`, this.TEXT_HIDDEN = `hidden`, this.CC1 = `CC1`, this.CC3 = `CC3`, this.UTF8 = `utf-8`, this.SCHEME_ID_URI = `schemeIdUri`, this.START_TIME = `starttime`, this.SERVICE_DESCRIPTION_LL_SCHEME = `urn:dvb:dash:lowlatency:scope:2019`, this.SUPPLEMENTAL_PROPERTY_LL_SCHEME = `urn:dvb:dash:lowlatency:critical:2019`, this.XML = `XML`, this.ARRAY_BUFFER = `ArrayBuffer`, this.DVB_REPORTING_URL = `dvb:reportingUrl`, this.DVB_PROBABILITY = `dvb:probability`; } }])), i)(); n.default = a, t.exports = n.default; }, {}], 109: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } } function i () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, i)), this.init(); }Object.defineProperty(n, `__esModule`, { value: !0 }); const a = new ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(i, [{ key: `init`, value: function () { this.TCP_CONNECTION = `TcpList`, this.HTTP_REQUEST = `HttpList`, this.TRACK_SWITCH = `RepSwitchList`, this.BUFFER_LEVEL = `BufferLevel`, this.BUFFER_LOADED = `bufferLoaded`, this.ABANDON_LOAD = `abandonload`, this.ALLOW_LOAD = `allowload`, this.BUFFER_EMPTY = `bufferStalled`, this.BUFFER_STATE = `BufferState`, this.DVR_INFO = `DVRInfo`, this.DROPPED_FRAMES = `DroppedFrames`, this.SCHEDULING_INFO = `SchedulingInfo`, this.REQUESTS_QUEUE = `RequestsQueue`, this.MANIFEST_UPDATE = `ManifestUpdate`, this.MANIFEST_UPDATE_STREAM_INFO = `ManifestUpdatePeriodInfo`, this.MANIFEST_UPDATE_TRACK_INFO = `ManifestUpdateRepresentationInfo`, this.PLAY_LIST = `PlayList`, this.DVB_ERRORS = `DVBErrors`; } }])), i)(); n.default = a, t.exports = n.default; }, {}], 110: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } } function i () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, i)), this.init(); }Object.defineProperty(n, `__esModule`, { value: !0 }); const a = new ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(i, [{ key: `init`, value: function () { this.CLEARKEY_KEYSTEM_STRING = `org.w3.clearkey`, this.WIDEVINE_KEYSTEM_STRING = `com.widevine.alpha`, this.PLAYREADY_KEYSTEM_STRING = `com.microsoft.playready`; } }])), i)(); n.default = a, t.exports = n.default; }, {}], 111: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const V = r(e(190)); const W = r(e(108)); const z = r(e(109)); const X = r(e(231)); const Q = r(e(150)); const Z = r(e(46)); const $ = r(e(54)); const i = r(e(47)); const J = r(e(186)); const ee = r(e(187)); const te = r(e(188)); const ne = r(e(185)); const re = r(e(189)); const ie = r(e(45)); const ae = e(248); const oe = e(225); function a () { const o = this.context; const e = (0, ie.default)(o).getInstance(); const u = (0, Z.default)(o).getInstance(); let s = void 0; let l = void 0; let d = void 0; let i = void 0; let a = void 0; let f = void 0; let c = void 0; let h = void 0; let p = void 0; let g = void 0; let _ = void 0; let m = void 0; let E = void 0; let y = void 0; let v = void 0; let T = void 0; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let r = void 0; let D = void 0; let M = void 0; let N = void 0; function n () { (d = (0, V.default)(o).create({ dashMetrics: M, mediaPlayerModel: v, settings: N })).initialize(); } function t () { a = {}, f = {}, h = {}, c = {}, A = {}, b = {}, r = {}, D = {}, void 0 === g && (g = !1), R = I = S = void 0, clearTimeout(p), p = null; } function C (e) { e.mediaType === W.default.VIDEO && (S = e.oldQuality, I.push(S, y.getPlaybackQuality())); } function w (e) { e.metric !== z.default.HTTP_REQUEST || !e.value || e.value.type !== ae.HTTPRequest.MEDIA_SEGMENT_TYPE || e.mediaType !== W.default.AUDIO && e.mediaType !== W.default.VIDEO || R.push(e.mediaType, e.value, N.get().streaming.abr.useDeadTimeLatency), e.metric !== z.default.BUFFER_LEVEL || e.mediaType !== W.default.AUDIO && e.mediaType !== W.default.VIDEO || (function (e, t) { const n = N.get().streaming.abr.ABRStrategy; if (n === W.default.ABR_STRATEGY_L2A) return b[e] = !1, D[e] = !1, r[e] = !0; { if (n === W.default.ABR_STRATEGY_LoLP) return b[e] = !1, D[e] = !0, r[e] = !1; if (n === W.default.ABR_STRATEGY_BOLA) return b[e] = !0, D[e] = !1, r[e] = !1; if (n === W.default.ABR_STRATEGY_THROUGHPUT) return b[e] = !1, D[e] = !1, r[e] = !1; }!(function (e, t) { var n = v.getStableBufferTime(); var r = n; const i = 0.5 * n; var n = b[e]; var r = (n ? i : r) < t; (b[e] = r) !== n && (r ? l.info(`[${e}] switching from throughput to buffer occupancy ABR rule (buffer: ${t.toFixed(3)}).`) : l.info(`[${e}] switching from buffer occupancy to throughput ABR rule (buffer: ${t.toFixed(3)}).`)); }(e, t)); }(e.mediaType, 0.001 * e.value.level)); } function O (e, t) { return a[t] = a[t] || {}, a[t].hasOwnProperty(e) || (a[t][e] = 0), (function (e, t) { if (t !== W.default.VIDEO || !N.get().streaming.abr.limitBitrateByPortal || !c[t]) return e; g || K(); const n = E.getAdaptationForType(0, t).Representation; let r = e; if (_ > 0 && m > 0) { for (;r > 0 && n[r] && _ < n[r].width && _ - n[r - 1].width < n[r].width - _;)--r; for (;r < n.length - 1 && n[r].width === n[r + 1].width;)r += 1; } return r; }((function (e, t, n) { t = N.get().streaming.abr.maxRepresentationRatio[t]; if (isNaN(t) || t >= 1 || t < 0) return e; return Math.min(e, Math.round(n * t)); }((function (e, t) { let n = e; if (!c[t]) return n; const r = L(t); void 0 !== r && (n = Math.max(e, r)); t = P(t); void 0 !== t && (n = Math.min(n, t)); return n; }(a[t][e], e)), e, a[t][e])), e)); } function P (e) { var t; var t = (t = e, N.get().streaming.abr.maxBitrate[t]); return t > -1 ? B(c[e].getMediaInfo(), t) : void 0; } function L (e) { const t = (n = e, N.get().streaming.abr.minBitrate[n]); if (t > -1) { var n = c[e].getMediaInfo(); var e = k(n); var n = B(n, t); return e[n] && n < e.length - 1 && e[n].bitrate < 1e3 * t && n++, n; } } function x (e, t, n, r) { let i = t.id; var t = H(e); (0, oe.checkInteger)(n); i = O(e, i); n !== t && n >= 0 && n <= i && F(e, t, n, i, r); } function F (e, t, n, r, i) { let a, o, s; e && c[e] && (o = (a = c[e].getStreamInfo()) ? a.id : null, N.get().debug.logLevel === ie.default.LOG_LEVEL_DEBUG && (s = M.getCurrentBufferLevel(e), l.info(`[${e}] switch from ${t} to ${n}/${r} (buffer: ${s}) ${i ? JSON.stringify(i) : `.`}`)), r = e, s = n, f[o = o] = f[o] || {}, f[o][r] = s, u.trigger($.default.QUALITY_CHANGE_REQUESTED, { oldQuality: t, newQuality: n, reason: i }, { streamId: a.id, mediaType: e }), a = R.getAverageThroughput(e), isNaN(a) || T.setSavedBitrateSettings(e, a)); } function U (e, t) { h[e].state = t; } function B (e, t, n) { let r = e && e.type ? c[e.type].getRepresentationInfo() : null; if (N.get().streaming.abr.useDeadTimeLatency && n && r && r.fragmentDuration) { n /= 1e3; r = r.fragmentDuration; if (r < n) return 0; t *= 1 - n / r; } for (let i = k(e), a = i.length - 1; a >= 0; a--) { if (1e3 * t >= i[a].bitrate) return a; } return 0; } function k (e) { const t = []; if (!e || !e.bitrateList) return t; for (let n = e.bitrateList, r = e.type, i = void 0, a = 0, o = n.length; a < o; a++)(i = new X.default()).mediaType = r, i.qualityIndex = a, i.bitrate = n[a].bandwidth, i.width = n[a].width, i.height = n[a].height, i.scanType = n[a].scanType, t.push(i); return t; } function G (e) { return b[e]; } function j (e) { return r[e]; } function Y (e) { return D[e]; } function H (e) { if (e && c[e]) { var t = c[e].getStreamInfo(); var t = t ? t.id : null; if (t) return f[t] = f[t] || {}, f[t].hasOwnProperty(e) || (f[t][e] = 0), f[t][e]; } return 0; } function K () { let e; y && (e = N.get().streaming.abr.usePixelRatioInLimitBitrateByPortal && window.hasOwnProperty(`devicePixelRatio`) ? window.devicePixelRatio : 1, _ = y.getClientWidth() * e, m = y.getClientHeight() * e); } function q (e) { const t = e.request.mediaType; if (N.get().streaming.abr.autoSwitchBitrate[t]) { let n = c[t]; if (!n) return; var r = (0, J.default)(o).create({ abrController: s, streamProcessor: n, currentRequest: e.request, useBufferOccupancyABR: G(t), useL2AABR: j(t), useLoLPABR: Y(t), videoModel: y }); var r = d.shouldAbandonFragment(r); r.quality > ee.default.NO_CHANGE && ((n = n.getFragmentModel()).getRequests({ state: Q.default.FRAGMENT_MODEL_LOADING, index: e.request.index })[0] && (n.abortRequests(), U(t, z.default.ABANDON_LOAD), A[t].reset(), A[t].push({ oldValue: H(t), newValue: r.quality, confidence: 1, reason: r.reason }), x(t, i.getActiveStreamInfo(), r.quality, r.reason), clearTimeout(p), p = setTimeout(() => { U(t, z.default.ALLOW_LOAD), p = null; }, N.get().streaming.abandonLoadTimeout))); } } return s = { isPlayingAtTopQuality: function (e) { const t = e ? e.id : null; const n = H(W.default.AUDIO); var e = H(W.default.VIDEO); return n === O(W.default.AUDIO, t) && e === O(W.default.VIDEO, t); }, updateTopQualityIndex: function (e) { let t = e.type; let n = e.streamInfo.id; const r = e.representationCount - 1; return e = t, t = r, a[n = n] = a[n] || {}, a[n][e] = t, r; }, getThroughputHistory: function () { return R; }, getBitrateList: k, getQualityForBitrate: B, getTopBitrateInfoFor: function (e) { if (e && c && c[e]) { let t = c[e].getStreamInfo(); if (t && t.id) { t = O(e, t.id), e = k(c[e].getMediaInfo()); return e[t] ? e[t] : null; } } return null; }, getMaxAllowedIndexFor: P, getMinAllowedIndexFor: L, getInitialBitrateFor: function (e) { if (!(function () { if (!T || !T.hasOwnProperty(`getSavedBitrateSettings`)) throw new Error(W.default.MISSING_CONFIG_ERROR); }()), e === W.default.TEXT || e === W.default.FRAGMENTED_TEXT) return NaN; let t; const n = T.getSavedBitrateSettings(e); let r = N.get().streaming.abr.initialBitrate[e]; const i = N.get().streaming.abr.initialRepresentationRatio[e]; return r === -1 && (r = i > -1 ? (t = E.getAdaptationForType(0, e).Representation, Array.isArray(t) ? t[Math.max(Math.round(t.length * i) - 1, 0)].bandwidth : 0) : isNaN(n) ? e === W.default.VIDEO ? 1e3 : 100 : n), r; }, getQualityFor: H, getAbandonmentStateFor: function (e) { return h[e] ? h[e].state : null; }, setPlaybackQuality: x, checkPlaybackQuality: function (e) { let t, n, r, i, a; e && c && c[e] && (a = (n = c[e].getStreamInfo()) ? n.id : null, t = H(e), i = (0, J.default)(o).create({ abrController: s, streamProcessor: c[e], currentValue: t, switchHistory: A[e], droppedFramesHistory: I, useBufferOccupancyABR: G(e), useL2AABR: j(e), useLoLPABR: Y(e), videoModel: y }), !I || (r = y.getPlaybackQuality()) && I.push(S, r), N.get().streaming.abr.autoSwitchBitrate[e] && (n = L(e), r = O(e, a), i = (a = d.getMaxQuality(i)).quality, void 0 !== n && (i > ee.default.NO_CHANGE ? i : t) < n && (i = n), r < i && (i = r), A[e].push({ oldValue: t, newValue: i }), i > ee.default.NO_CHANGE && i != t ? (h[e].state === z.default.ALLOW_LOAD || t < i) && F(e, t, i, r, a.reason) : N.get().debug.logLevel === ie.default.LOG_LEVEL_DEBUG && (a = M.getCurrentBufferLevel(e, !0), l.debug(`[${e}] stay on ${t}/${r} (buffer: ${a})`)))); }, getTopQualityIndexFor: O, setElementSize: K, setWindowResizeEventCalled: function (e) { g = e; }, createAbrRulesCollection: n, registerStreamType: function (e, t) { A[e] = A[e] || (0, te.default)(o).create(), c[e] = t, h[e] = h[e] || {}, h[e].state = z.default.ALLOW_LOAD, b[e] = !1, r[e] = !1, D[e] = !1, u.on($.default.LOADING_PROGRESS, q, s), e === W.default.VIDEO && (u.on($.default.QUALITY_CHANGE_RENDERED, C, s), I = I || (0, ne.default)(o).create(), K()), u.on($.default.METRIC_ADDED, w, s), u.on($.default.PERIOD_SWITCH_COMPLETED, n, s), R = R || (0, re.default)(o).create({ settings: N }); }, unRegisterStreamType: function (e) { delete c[e]; }, setConfig: function (e) { e && (e.streamController && (i = e.streamController), e.domStorage && (T = e.domStorage), e.mediaPlayerModel && (v = e.mediaPlayerModel), e.dashMetrics && (M = e.dashMetrics), e.adapter && (E = e.adapter), e.videoModel && (y = e.videoModel), e.settings && (N = e.settings)); }, reset: function () { t(), u.off($.default.LOADING_PROGRESS, q, s), u.off($.default.QUALITY_CHANGE_RENDERED, C, s), u.off($.default.METRIC_ADDED, w, s), u.off($.default.PERIOD_SWITCH_COMPLETED, n, s), d && d.reset(); } }, l = e.getLogger(s), t(), s; }a.__dashjs_factory_name = `AbrController`; e = i.default.getSingletonFactory(a); e.QUALITY_DEFAULT = 0, i.default.updateSingletonFactory(a.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 108: 108, 109: 109, 150: 150, 185: 185, 186: 186, 187: 187, 188: 188, 189: 189, 190: 190, 225: 225, 231: 231, 248: 248, 45: 45, 46: 46, 47: 47, 54: 54 }], 112: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const u = r(e(148)); const l = r(e(212)); const d = r(e(227)); const f = r(e(85)); const i = r(e(47)); const c = r(e(46)); const h = r(e(54)); function a () { let e = void 0; let t = void 0; const n = this.context; const r = (0, c.default)(n).getInstance(); const i = (0, d.default)(n).getInstance(); let a = void 0; let o = void 0; function s (e) { a.invalidateSelectedIndexes(e.entry); } return e = { reset: function () { a.reset(), o.reset(); }, initialize: function (e) { a.setConfig({ adapter: t }), e = e, a.update(e), o.chooseSelector(t.getIsDVB(e)); }, resolve: function (e) { if (e = a.getForPath(e).reduce((e, t) => { t = o.select(t); return t ? (i.isRelative(t.url) ? e.url = i.resolve(t.url, e.url) : (e.url = t.url, e.serviceLocation = t.serviceLocation), e.availabilityTimeOffset = t.availabilityTimeOffset, e.availabilityTimeComplete = t.availabilityTimeComplete, e) : new f.default(); }, new f.default()), !i.isRelative(e.url)) return e; }, setConfig: function (e) { e.baseURLTreeModel && (a = e.baseURLTreeModel), e.baseURLSelector && (o = e.baseURLSelector), e.adapter && (t = e.adapter); } }, a = (0, u.default)(n).create(), o = (0, l.default)(n).create(), r.on(h.default.SERVICE_LOCATION_BLACKLIST_CHANGED, s, e), e; }a.__dashjs_factory_name = `BaseURLController`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 148: 148, 212: 212, 227: 227, 46: 46, 47: 47, 54: 54, 85: 85 }], 113: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const u = r(e(46)); function a (e) { e = e || {}; let t = void 0; let n = []; const r = (0, u.default)(this.context).getInstance(); const i = e.updateEventName; const a = e.addBlacklistEventName; function o (e) { n.indexOf(e) === -1 && (n.push(e), r.trigger(i, { entry: e })); } function s (e) { o(e.entry); } return t = { add: o, contains: function (e) { return !!(n.length && e && e.length) && n.indexOf(e) !== -1; }, reset: function () { n = []; } }, a && r.on(a, s, t), t; }a.__dashjs_factory_name = `BlackListController`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 46: 46, 47: 47 }], 114: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const ge = r(e(108)); const _e = r(e(109)); const me = r(e(150)); const Ee = r(e(104)); const ye = r(e(103)); const ve = r(e(111)); const Te = r(e(46)); const Se = r(e(54)); const i = r(e(47)); const Ae = r(e(45)); const Ie = r(e(220)); const Re = r(e(232)); const be = r(e(51)); const De = e(248); const Me = `BufferController`; function a (e) { e = e || {}; const r = this.context; const n = (0, Te.default)(r).getInstance(); const i = e.errHandler; const s = e.fragmentModel; const a = e.representationController; const t = e.mediaController; const o = e.adapter; const u = e.textController; const l = e.abrController; const d = e.playbackController; const f = e.streamInfo; const c = e.type; const h = e.settings; let p = void 0; let g = void 0; let _ = void 0; let m = void 0; let E = void 0; let y = void 0; let v = void 0; let T = void 0; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; let C = void 0; let w = void 0; let O = void 0; let P = void 0; let L = void 0; let x = void 0; function F (e) { return o.convertDataToRepresentationInfo(a.getRepresentationForQuality(e)); } function U (e, t) { if (!C || !e) return null; const n = e[0]; if (v) try { A = t && t[c] ? (0, Ee.default)(r).create(v, n, Y.bind(this), t[c]) : (0, Ee.default)(r).create(v, n, Y.bind(this), null), h.get().streaming.useAppendWindow && A.updateAppendWindow(f), typeof A.getBuffer().initialize === `function` && A.getBuffer().initialize(c, f, e, s); } catch (e) { g.fatal(`Caught error on create SourceBuffer: ${e}`), i.error(new Re.default(be.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE, be.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE + c)); } else A = (0, ye.default)(r).create(Y.bind(this)); return ie(F(_)), A; } function B (e) { g.info(`Init fragment finished loading saving to`, `${c}'s init cache`), C.save(e.chunk), g.debug(`Append Init fragment`, c, ` with representationId:`, e.chunk.representationId, ` and quality:`, e.chunk.quality, `, data size:`, e.chunk.bytes.byteLength), G(e.chunk); } function k (e) { const t = e.chunk; L ? (x = t, (e = A && A.getAllBufferRanges()) && e.length > 0 && d.getTimeToStreamEnd() > h.get().streaming.stallThreshold && (g.debug(`Clearing buffer because track changed - ${e.end(e.length - 1) + 0.5}`), te([{ start: 0, end: e.end(e.length - 1) + 0.5, force: !0 }]))) : G(t); } function G (e) { A.append(e), e.mediaInfo.type === ge.default.VIDEO && he(Se.default.VIDEO_CHUNK_RECEIVED, { chunk: e }); } function j (e) { if (e && e.length > 0) for (let t = 0, n = e.length; t < n; t++)g.debug(`Buffered range: ${e.start(t)} - ${e.end(t)}, currentTime = `, d.getTime()); } function Y (e) { let t, n; if (e.error) return e.error.code === 22 && (N = !0, y = 0.8 * fe(), g.warn(`Quota exceeded, Critical Buffer: ${y}`), y > 0 && (t = Math.max(0.2 * y, 1), r = y - t, n = Math.min(h.get().streaming.bufferTimeAtTopQuality, 0.9 * r), r = Math.min(h.get().streaming.bufferTimeAtTopQualityLongForm, 0.9 * r), r = { streaming: { bufferToKeep: parseFloat(t.toFixed(5)), bufferTimeAtTopQuality: parseFloat(n.toFixed(5)), bufferTimeAtTopQualityLongForm: parseFloat(r.toFixed(5)) } }, h.update(r))), void (e.error.code !== 22 && ce() || (g.warn(`Clearing playback buffer to overcome quota exceed situation`), he(Se.default.QUOTA_EXCEEDED, { criticalBufferLevel: y }), te(ee()))); N = !1, (b = e.chunk) && !isNaN(b.index) && (T = Math.max(b.index, T), Z()); var r = A.getAllBufferRanges(); b.segmentType === De.HTTPRequest.MEDIA_SEGMENT_TYPE ? (j(r), V(), (function () { if (c !== ge.default.AUDIO && c !== ge.default.VIDEO) return; if (isNaN(w)) return; const e = d.getTime(); let t = X(w, 0); if (e === w && t) return; const n = a.getCurrentRepresentation().segmentDuration; if (!(t = X(w, n))) return; Math.abs(e - w) > n ? w <= t.end && (d.seek(Math.max(w, t.start), !1, !0), w = NaN) : e < t.start && (d.seek(t.start, !1, !0), w = NaN); }())) : L && (e = d.getTime(), g.debug(`AppendToBuffer seek target should be ${e}`), he(Se.default.SEEK_TARGET, { time: e })), b && he(b.endFragment ? Se.default.BYTES_APPENDED_END_FRAGMENT : Se.default.BYTES_APPENDED, { quality: b.quality, startTime: b.start, index: b.index, bufferedRanges: r, mediaType: c }); } function H (e) { _ !== e.newQuality && (ie(this.getRepresentationInfo(e.newQuality)), _ = e.newQuality); } function K (e) { w = e.seekTime, m && (m = !(O = !0), S = Number.POSITIVE_INFINITY), c !== ge.default.FRAGMENTED_TEXT ? A.waitForUpdateEnd(() => { const e = (function () { const e = []; let t = A.getAllBufferRanges(); if (!t || t.length === 0) return e; let n = d.getTime(); const r = t.end(t.length - 1) + 0.5; const i = s.getRequests({ state: me.default.FRAGMENT_MODEL_EXECUTED, time: n, threshold: 0.01 })[0]; { let a; i ? (a = { start: 0, end: i.startTime - h.get().streaming.stallThreshold }, (n = s.getRequests({ state: me.default.FRAGMENT_MODEL_EXECUTED, time: i.startTime - i.duration / 2, threshold: 0.01 })[0]) && n.startTime != i.startTime && (a.end = n.startTime), a.start < a.end && a.end > t.start(0) && e.push(a), t = { start: i.startTime + i.duration + h.get().streaming.stallThreshold, end: r }, (a = s.getRequests({ state: me.default.FRAGMENT_MODEL_EXECUTED, time: i.startTime + i.duration + h.get().streaming.stallThreshold, threshold: 0.01 })[0]) && a.startTime !== i.startTime && (t.start = a.startTime + a.duration + h.get().streaming.stallThreshold), t.start < t.end && t.start < r && e.push(t)) : (g.debug(`getAllRangesWithSafetyFactor - No request found in current time position, removing full buffer 0 -`, r), e.push({ start: 0, end: r })); } return e; }()); e && e.length !== 0 || V(), te(e); }) : V(); } function q () { w = NaN; } function V () { (!L || c === ge.default.FRAGMENTED_TEXT && u.isTextEnabled()) && Q(); } function W () { $(); } function z () { w = NaN, $(); } function X (e, t) { let n; let r; let i; const a = A.getAllBufferRanges(); let o = null; let s = null; let u = 0; let l = void 0; const d = isNaN(t) ? 0.15 : t; if (a != null) { for (l = 0, i = a.length; l < i; l++) if (n = a.start(l), r = a.end(l), o === null)u = Math.abs(n - e), (n <= e && e < r || u <= d) && (o = n, s = r); else { if (!((u = n - s) <= d)) break; s = r; } if (o !== null) return { start: o, end: s }; } return null; } function Q () { let e, t; d && (e = (isNaN(w) ? d.getTime() : w) || 0, h.get().streaming.jumpGaps && (t = h.get().streaming.smallGapLimit), E = (t = X(e, t)) === null ? 0 : t.end - e, he(Se.default.BUFFER_LEVEL_UPDATED, { bufferLevel: E }), $()); } function Z () { S - 1 <= T && !m && void 0 === A.discharge && (m = !0, g.debug(`checkIfBufferingCompleted trigger BUFFERING_COMPLETED for ${c}`), he(Se.default.BUFFERING_COMPLETED)); } function $ () { c !== ge.default.AUDIO && c !== ge.default.VIDEO || (O && !m && E > 0 && d && d.getTimeToStreamEnd() - E < 0.1 && (m = !(O = !1), g.debug(`checkIfSufficientBuffer trigger BUFFERING_COMPLETED for type ${c}`), he(Se.default.BUFFERING_COMPLETED)), (!h.get().streaming.lowLatencyEnabled && E < h.get().streaming.stallThreshold || E === 0) && !m ? J(_e.default.BUFFER_EMPTY) : (m || E >= f.manifestInfo.minBufferTime) && J(_e.default.BUFFER_LOADED)); } function J (e) { R === e || e === _e.default.BUFFER_EMPTY && d.getTime() === 0 || c === ge.default.FRAGMENTED_TEXT && !u.isTextEnabled() || (R = e, he(Se.default.BUFFER_LEVEL_STATE_CHANGED, { state: e }), he(e === _e.default.BUFFER_LOADED ? Se.default.BUFFER_LOADED : Se.default.BUFFER_EMPTY), g.debug(e === _e.default.BUFFER_LOADED ? `Got enough buffer to start` : `Waiting for more buffer before starting playback`)); } function ee () { const e = []; const t = A.getAllBufferRanges(); if (!t || t.length === 0) return e; const n = d.getTime(); let r = Math.max(0, n - h.get().streaming.bufferToKeep); const i = s.getRequests({ state: me.default.FRAGMENT_MODEL_EXECUTED, time: n, threshold: 0.01 })[0]; if (i)r = Math.min(i.startTime, r); else if (n === 0 && d.getIsDynamic()) return []; if (t.start(0) <= r) { for (var a = { start: 0, end: r }, o = 0; o < t.length && t.end(o) <= r; o++)a.end = t.end(o); a.start < a.end && e.push(a); } return e; } function te (e) { e && A && e.length !== 0 && (P.push.apply(P, e), M || ne()); } function ne () { if (P.length === 0 || !A) return g.debug(`Nothing to prune, halt pruning`), void (M = !(P = [])); let e = A.getBuffer(); if (!e || !e.buffered || e.buffered.length === 0) return g.debug(`SourceBuffer is empty (or does not exist), halt pruning`), void (M = !(P = [])); e = P.shift(); g.debug(`Removing buffer from:`, e.start, `to`, e.end), M = !0, d.getTime() < e.end && (m = !1, T = 0), A.remove(e.start, e.end, e.force); } function re (e) { A === e.buffer && (g.debug(`onRemoved buffer from:`, e.from, `to`, e.to), j(A.getAllBufferRanges()), P.length === 0 && (M = !1), e.unintended && (g.warn(`Detected unintended removal from:`, e.from, `to`, e.to, `setting index handler time to`, e.from), he(Se.default.SEEK_TARGET, { time: e.from, mediaType: c, streamId: f.id })), M ? ne() : (L ? (L = !1, x && G(x)) : Q(), he(Se.default.BUFFER_CLEARED, { from: e.from, to: e.to, unintended: e.unintended, hasEnoughSpaceToAppend: ce(), quotaExceeded: N }))); } function ie (e) { e && void 0 !== e.MSETimeOffset && A && A.updateTimestampOffset && A.updateTimestampOffset(e.MSETimeOffset); } function ae (e) { e.error || m || ie(e.currentRepresentation); } function oe (e) { S = e.request.index, Z(); } function se (e) { e.newMediaInfo.streamInfo.id !== f.id || e.newMediaInfo.type !== c || (e = A && A.getAllBufferRanges()) && (g.info(`Track change asked`), t.getSwitchMode(c) === ge.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE && e && e.length > 0 && d.getTimeToStreamEnd() > h.get().streaming.stallThreshold && (m = !1, S = Number.POSITIVE_INFINITY)); } function ue () { ++D * (h.get().streaming.wallclockTimeUpdateInterval / 1e3) >= h.get().streaming.bufferPruningInterval && (D = 0, A && c !== ge.default.FRAGMENTED_TEXT && (m || te(ee()))); } function le () { $(); } function de (e, t) { v = e, A && t && typeof A.discharge === `function` && (I = A, U(t)); } function fe () { let e; const t = A.getAllBufferRanges(); let n = 0; let r = void 0; if (!t) return n; for (r = 0, e = t.length; r < e; r++)n += t.end(r) - t.start(r); return n; } function ce () { return fe() < y; } function he (e, t) { t = t || {}; n.trigger(e, t, { streamId: f.id, mediaType: c }); } function pe (e, t) { y = Number.POSITIVE_INFINITY, R = void 0, _ = ve.default.QUALITY_DEFAULT, S = Number.POSITIVE_INFINITY, b = null, O = N = M = m = !1, D = E = T = 0, P = [], w = NaN, A && (e || A.abort(), A.reset(t), A = null), L = !1; } return p = { initialize: function (e) { de(e), _ = l.getQualityFor(c), n.on(Se.default.DATA_UPDATE_COMPLETED, ae, this), n.on(Se.default.INIT_FRAGMENT_LOADED, B, this), n.on(Se.default.MEDIA_FRAGMENT_LOADED, k, this), n.on(Se.default.QUALITY_CHANGE_REQUESTED, H, this), n.on(Se.default.STREAM_COMPLETED, oe, this), n.on(Se.default.PLAYBACK_PLAYING, z, this), n.on(Se.default.PLAYBACK_PROGRESS, V, this), n.on(Se.default.PLAYBACK_TIME_UPDATED, V, this), n.on(Se.default.PLAYBACK_RATE_CHANGED, le, this), n.on(Se.default.PLAYBACK_SEEKING, K, this), n.on(Se.default.PLAYBACK_SEEKED, q, this), n.on(Se.default.PLAYBACK_STALLED, W, this), n.on(Se.default.WALLCLOCK_TIME_UPDATED, ue, this), n.on(Se.default.CURRENT_TRACK_CHANGED, se, this, { priority: Te.default.EVENT_PRIORITY_HIGH }), n.on(Se.default.SOURCEBUFFER_REMOVE_COMPLETED, re, this); }, getStreamId: function () { return f.id; }, getType: function () { return c; }, getBufferControllerType: function () { return Me; }, getRepresentationInfo: F, createBuffer: U, dischargePreBuffer: function () { if (A && I && typeof I.discharge === `function`) { const e = I.getAllBufferRanges(); if (e.length > 0) { for (var t = `Beginning ${c}PreBuffer discharge, adding buffer for:`, n = 0; n < e.length; n++)t += ` start: ${e.start(n)}, end: ${e.end(n)};`; g.debug(t); } else g.debug(`PreBuffer discharge requested, but there were no media segments in the PreBuffer.`); for (let r = I.discharge(), i = null, a = 0; a < r.length; a++) { const o = r[a]; const s = C.extract(o.streamId, o.representationId); s && (i !== s && (A.append(s), i = s), A.append(o)); }I.reset(), I = null; } }, getBuffer: function () { return A; }, setBuffer: function (e) { A = e; }, getBufferLevel: function () { return E; }, getRangeAt: X, setMediaSource: de, getMediaSource: function () { return v; }, appendInitSegment: function (e) { return !!(e = C.extract(f.id, e)) && (g.info(`Append Init fragment`, c, ` with representationId:`, e.representationId, ` and quality:`, e.quality, `, data size:`, e.bytes.byteLength), G(e), !0); }, replaceBuffer: function () { L = !0; }, getIsBufferingCompleted: function () { return m; }, getIsPruningInProgress: function () { return M; }, reset: function (e, t) { n.off(Se.default.DATA_UPDATE_COMPLETED, ae, this), n.off(Se.default.INIT_FRAGMENT_LOADED, B, this), n.off(Se.default.MEDIA_FRAGMENT_LOADED, k, this), n.off(Se.default.QUALITY_CHANGE_REQUESTED, H, this), n.off(Se.default.STREAM_COMPLETED, oe, this), n.off(Se.default.PLAYBACK_PLAYING, z, this), n.off(Se.default.PLAYBACK_PROGRESS, V, this), n.off(Se.default.PLAYBACK_TIME_UPDATED, V, this), n.off(Se.default.PLAYBACK_RATE_CHANGED, le, this), n.off(Se.default.PLAYBACK_SEEKING, K, this), n.off(Se.default.PLAYBACK_SEEKED, q, this), n.off(Se.default.PLAYBACK_STALLED, W, this), n.off(Se.default.WALLCLOCK_TIME_UPDATED, ue, this), n.off(Se.default.CURRENT_TRACK_CHANGED, se, this), n.off(Se.default.SOURCEBUFFER_REMOVE_COMPLETED, re, this), pe(e, t); }, updateAppendWindow: function () { A && !m && A.updateAppendWindow(f); } }, g = (0, Ae.default)(r).getInstance().getLogger(p), C = (0, Ie.default)(r).getInstance(), pe(), p; }a.__dashjs_factory_name = Me, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 103: 103, 104: 104, 108: 108, 109: 109, 111: 111, 150: 150, 220: 220, 232: 232, 248: 248, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54 }], 115: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const b = r(e(45)); const D = r(e(46)); const M = r(e(101)); const N = r(e(160)); function a () { const a = `urn:mpeg:dash:event:2012`; const o = 1; const s = `urn:mpeg:dash:event:callback:2015`; const u = 1; const e = 100; const l = 300; const d = this.context; const f = (0, D.default)(d).getInstance(); let t = void 0; let c = void 0; let r = void 0; let i = void 0; let h = void 0; let n = void 0; let p = void 0; let g = void 0; let _ = void 0; let m = void 0; let E = void 0; function y () { if (!g || !_) throw new Error(`setConfig function has to be called previously`); } function v () { E = !1, r = {}, i = {}, n = null, m = !(h = {}), p = Date.now() / 1e3; } function T () { try { n !== null && E && (clearInterval(n), n = null, E = !1, (function () { try { I(i), I(r); } catch (e) {} }())); } catch (e) { throw e; } } function S () { try { let e, t; m || (m = !0, t = (e = _.getTime()) - p, t = p > 0 ? Math.max(0, t) : 0, A(i, t, e), A(r, t, e), (function () { try { if (h) for (let e = _.getTime(), t = Object.keys(h), n = 0; n < t.length; n++) { const r = t[n]; let i = h[r]; i !== null && i.duration + i.calculatedPresentationTime < e && (c.debug(`Remove Event ${r} at time ${e}`), i = null, delete h[r]); } } catch (e) {} }()), p = e, m = !1); } catch (e) { m = !1; } } function A (e, t, n) { try { if (e) for (let r = Object.keys(e), i = 0; i < r.length; i++) { var a; const o = r[i]; const s = e[o]; void 0 !== s && (a = isNaN(s.duration) ? 0 : s.duration, s.calculatedPresentationTime <= n && s.calculatedPresentationTime + t + a >= n ? R(o, s, e, M.default.EVENT_MODE_ON_START) : ((function (e, t, n) { try { return n < e - t; } catch (e) { return !1; } }(n, a + t, s.calculatedPresentationTime)) || (function (e) { try { const t = e.eventStream.period.start + e.eventStream.period.duration; return e.calculatedPresentationTime > t; } catch (e) { return !1; } }(s))) && (c.debug(`Deleting event ${o} as it is expired or invalid`), delete e[o])); } } catch (e) {} } function I (i) { try { const e = (function () { const e = Object.keys(i); const r = _.getTime(); if (!e || e.length === 0) return { v: void 0 }; const t = i[e[0]].eventStream && i[e[0]].eventStream.period && !isNaN(i[e[0]].eventStream.period.duration) ? i[e[0]].eventStream.period.duration : NaN; const n = i[e[0]].eventStream && i[e[0]].eventStream.period && !isNaN(i[e[0]].eventStream.period.start) ? i[e[0]].eventStream.period.start : NaN; if (isNaN(t) || isNaN(n)) return { v: void 0 }; e.forEach((e) => { const t = i[e]; const n = t.calculatedPresentationTime; Math.abs(n - r) < l && R(e, t, i, M.default.EVENT_MODE_ON_START); }); }()); if (typeof e === `object`) return e.v; } catch (e) {} } function R (e, t, n, r) { try { const i = _.getTime(); if (r === M.default.EVENT_MODE_ON_RECEIVE) return c.debug(`Received event ${e}`), void f.trigger(t.eventStream.schemeIdUri, { event: t }, { mode: r }); t.duration > 0 && (h[e] = t), t.eventStream.schemeIdUri === a && t.eventStream.value === o ? t.duration === 0 && t.presentationTimeDelta === 0 || (c.debug(`Starting manifest refresh event ${e} at ${i}`), (function () { try { y(), g.refreshManifest(); } catch (e) {} }())) : t.eventStream.schemeIdUri === s && t.eventStream.value === u ? (c.debug(`Starting callback event ${e} at ${i}`), (function (e) { try { (0, N.default)(d).create({}).load({ method: `get`, url: e, request: { responseType: `arraybuffer` } }); } catch (e) { throw e; } }(t.messageData))) : (c.debug(`Starting event ${e} at ${i}`), f.trigger(t.eventStream.schemeIdUri, { event: t }, { mode: r })), delete n[e]; } catch (e) {} } return t = { addInlineEvents: function (e) { try { if (y(), e) for (let t = 0; t < e.length; t++) { const n = e[t]; c.debug(`Add inline event with id ${n.id}`), r[n.id] || R(n.id, n, e, M.default.EVENT_MODE_ON_RECEIVE), r[n.id] = n; }c.debug(`Added ${e.length} inline events`); } catch (e) { throw e; } }, addInbandEvents: function (e) { try { y(); for (let t = 0; t < e.length; t++) { const n = e[t]; n.id in i ? c.debug(`Repeated event with id ${n.id}`) : (n.eventStream.schemeIdUri === a && void 0 === i[n.id] && (function (e) { try { let t, n; e.eventStream.value == o && (t = e.calculatedPresentationTime, n = void 0, n = e.calculatedPresentationTime == 4294967295 ? NaN : e.calculatedPresentationTime + e.duration, f.trigger(M.default.MANIFEST_VALIDITY_CHANGED, { id: e.id, validUntil: t, newDuration: n, newManifestValidAfter: NaN }, { mode: M.default.EVENT_MODE_ON_START })); } catch (e) {} }(n)), i[n.id] = n, c.debug(`Add inband event with id ${n.id}`), R(n.id, n, e, M.default.EVENT_MODE_ON_RECEIVE)); }S(); } catch (e) { throw e; } }, start: function () { try { y(), c.debug(`Start Event Controller`), E || isNaN(e) || (E = !0, n = setInterval(S, e)); } catch (e) { throw e; } }, setConfig: function (e) { try { if (!e) return; e.manifestUpdater && (g = e.manifestUpdater), e.playbackController && (_ = e.playbackController); } catch (e) { throw e; } }, reset: function () { T(), v(); } }, c = (0, b.default)(d).getInstance().getLogger(t), v(), t; }a.__dashjs_factory_name = `EventController`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 101: 101, 160: 160, 45: 45, 46: 46, 47: 47 }], 116: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const h = r(e(108)); const p = r(e(233)); const g = r(e(150)); const _ = r(e(97)); const m = r(e(224)); const E = r(e(46)); const y = r(e(54)); const v = r(e(51)); const i = r(e(47)); const T = r(e(45)); function a (n) { n = n || {}; const r = this.context; const u = (0, E.default)(r).getInstance(); const i = n.errHandler; const a = n.mediaPlayerModel; const o = n.dashMetrics; const s = (0, T.default)(r).getInstance(); const l = n.streamInfo; let e = void 0; let d = void 0; let f = void 0; function t () { for (const e in f)f[e].reset(); f = {}; } function c (e) { let t, n, r, i, a, o, s; e.sender && (t = e.request, s = e.response, n = t.isInitializationRequest(), r = t.mediaInfo.streamInfo, e.error && (t.mediaType !== h.default.AUDIO && t.mediaType !== h.default.VIDEO && t.mediaType !== h.default.FRAGMENTED_TEXT || u.trigger(y.default.SERVICE_LOCATION_BLACKLIST_ADD, { entry: e.request.serviceLocation })), s && r ? (i = s, a = t, o = l.id, s = e.type !== y.default.FRAGMENT_LOADING_PROGRESS, (e = new p.default()).streamId = o, e.mediaInfo = a.mediaInfo, e.segmentType = a.type, e.start = a.startTime, e.duration = a.duration, e.end = e.start + e.duration, e.bytes = i, e.index = a.index, e.quality = a.quality, e.representationId = a.representationId, e.endFragment = s, e = e, u.trigger(n ? y.default.INIT_FRAGMENT_LOADED : y.default.MEDIA_FRAGMENT_LOADED, { chunk: e, request: t }, { streamId: r.id, mediaType: t.mediaType })) : d.warn(`No ${t.mediaType} bytes to push or stream is inactive.`)); } return e = { getStreamId: function () { return l.id; }, getModel: function (e) { let t = f[e]; return t || (t = (0, g.default)(r).create({ streamInfo: l, type: e, dashMetrics: o, fragmentLoader: (0, _.default)(r).create({ dashMetrics: o, mediaPlayerModel: a, errHandler: i, requestModifier: (0, m.default)(r).getInstance(), settings: n.settings, boxParser: n.boxParser, eventBus: u, events: y.default, errors: v.default, dashConstants: n.dashConstants, urlUtils: n.urlUtils }), debug: s, eventBus: u, events: y.default }), f[e] = t), t; }, reset: function () { u.off(y.default.FRAGMENT_LOADING_COMPLETED, c, this), u.off(y.default.FRAGMENT_LOADING_PROGRESS, c, this), t(); } }, d = s.getLogger(e), t(), u.on(y.default.FRAGMENT_LOADING_COMPLETED, c, e), u.on(y.default.FRAGMENT_LOADING_PROGRESS, c, e), e; }a.__dashjs_factory_name = `FragmentController`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 108: 108, 150: 150, 224: 224, 233: 233, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54, 97: 97 }], 117: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const y = r(e(45)); const v = r(e(54)); const T = r(e(46)); function a () { const e = this.context; const c = (0, T.default)(e).getInstance(); let t = void 0; let n = void 0; let h = void 0; let r = void 0; let i = void 0; let p = void 0; let g = void 0; let a = void 0; let _ = void 0; let m = void 0; let E = void 0; function o () { E.debug(`Stopping the gap controller`), i && (clearInterval(i), i = null), (function () { c.off(v.default.WALLCLOCK_TIME_UPDATED, l, this), c.off(v.default.PLAYBACK_SEEKING, u, this), c.off(v.default.BYTES_APPENDED_END_FRAGMENT, s, t); }()), p = NaN, r = 0, m = i = null; } function s () { i || (function () { try { i || (E.debug(`Starting the gap controller`), i = setInterval(() => { d() && f(g.getTime()); }, 100)); } catch (e) {} }()); } function u () { m && (clearTimeout(m), m = null); } function l () { let e; d() && ++r >= 30 && (e = g.getTime(), n === e ? f(e, !0) : (n = e, p = NaN), r = 0); } function d () { return h.get().streaming.jumpGaps && a.getActiveStreamProcessors().length > 0 && (!g.isSeeking() || a.hasStreamFinishedBuffering(a.getActiveStream())) && !g.isPaused() && !a.getIsStreamSwitchInProgress() && !a.getHasMediaOrIntialisationError(); } function f (e, t) { const n = !(arguments.length <= 1 || void 0 === t) && t; const r = h.get().streaming.smallGapLimit; const i = h.get().streaming.jumpLargeGaps; const a = _.getBufferRange(); let o = NaN; let s = !1; const u = (function (e, t) { try { if (!e || e.length <= 1 && t > 0) return NaN; for (var n = NaN, r = 0; isNaN(n) && r < e.length;) { const i = r > 0 ? e.end(r - 1) : 0; t < e.start(r) && i - t < 0.1 && (n = r), r += 1; } return n; } catch (e) { return null; } }(a, e)); isNaN(u) || (t = (f = a.start(u)) - e) > 0 && (t <= r || i) && (o = f); let l; let d; var f = g.getTimeToStreamEnd(); isNaN(o) && n && isFinite(f) && !isNaN(f) && f < r && (o = parseFloat(g.getStreamEndTime().toFixed(5)), s = !0), o > 0 && p !== o && e < o && !m && (d = o - e, s ? (E.warn(`Jumping to end of stream because of gap from ${e} to ${o}. Gap duration: ${d}`), c.trigger(v.default.GAP_CAUSED_SEEK_TO_PERIOD_END, { seekTime: o, duration: d })) : (s = g.getIsDynamic(), l = u > 0 ? a.end(u - 1) : e, s = s ? 1e3 * d : 0, m = window.setTimeout(() => { g.seek(o, !0, !0), E.warn(`Jumping gap starting at ${l} and ending at ${o}. Jumping by: ${d}`), c.trigger(v.default.GAP_CAUSED_INTERNAL_SEEK, { seekTime: o, duration: d }), m = null; }, s)), p = o); } return t = { reset: o, setConfig: function (e) { e && (e.settings && (h = e.settings), e.playbackController && (g = e.playbackController), e.streamController && (a = e.streamController), e.videoModel && (_ = e.videoModel), e.timelineConverter && e.timelineConverter, e.adapter && e.adapter); }, initialize: function () { !(function () { c.on(v.default.WALLCLOCK_TIME_UPDATED, l, this), c.on(v.default.PLAYBACK_SEEKING, u, this), c.on(v.default.BYTES_APPENDED_END_FRAGMENT, s, t); }()); } }, E = (0, y.default)(e).getInstance().getLogger(t), o(), t; }a.__dashjs_factory_name = `GapController`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 45: 45, 46: 46, 47: 47, 54: 54 }], 118: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const S = r(e(108)); const A = r(e(54)); const I = r(e(46)); const i = r(e(47)); const R = r(e(45)); function a () { const e = this.context; const a = (0, I.default)(e).getInstance(); let t = void 0; let o = void 0; let s = void 0; let r = void 0; let n = void 0; let u = void 0; const i = [S.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE, S.default.TRACK_SWITCH_MODE_NEVER_REPLACE]; const l = [S.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE, S.default.TRACK_SELECTION_MODE_WIDEST_RANGE]; function d (e, t) { if (!e || !t) return []; t = t.id; return s[t] && s[t][e] ? s[t][e].list : []; } function f (e, t) { return !e || !t || t && !s[t.id] ? null : s[t.id][e].current; } function c (e, t) { if (e && e.streamInfo) { const n = e.type; var r = e.streamInfo; const i = r.id; var r = f(n, r); if (s[i] && s[i][n] && !E(e, r) && (s[i][n].current = e, !s[i][n].current || t && n === S.default.FRAGMENTED_TEXT || a.trigger(A.default.CURRENT_TRACK_CHANGED, { oldMediaInfo: r, newMediaInfo: e, switchMode: g(n) }), !t)) { e = (function (e) { e = { lang: e.lang, viewpoint: e.viewpoint, roles: e.roles, accessibility: e.accessibility, audioChannelConfiguration: e.audioChannelConfiguration }; return e.lang || e.viewpoint || e.role && e.role.length > 0 || e.accessibility && e.accessibility.length > 0 || e.audioChannelConfiguration && e.audioChannelConfiguration.length > 0 ? e : null; }(e)); if (!e || !s[i][n].storeLastSettings) return; e.roles && (e.role = e.roles[0], delete e.roles), e.accessibility && (e.accessibility = e.accessibility[0]), e.audioChannelConfiguration && (e.audioChannelConfiguration = e.audioChannelConfiguration[0]), u.setSavedMediaSettings(n, e); } } } function h (e, t) { e && t && (n[e] = t); } function p (e) { return e ? n[e] : null; } function g (e) { return r.get().streaming.trackSwitchMode[e]; } function _ () { return r.get().streaming.selectionModeForInitialTrack; } function m (e) { return e === S.default.AUDIO || e === S.default.VIDEO || e === S.default.TEXT || e === S.default.FRAGMENTED_TEXT || e === S.default.IMAGE; } function E (e, t) { if (!e && !t) return !0; if (!e || !t) return !1; const n = e.id === t.id; const r = e.viewpoint === t.viewpoint; const i = e.lang === t.lang; const a = e.roles.toString() === t.roles.toString(); const o = e.accessibility.toString() === t.accessibility.toString(); var t = e.audioChannelConfiguration.toString() === t.audioChannelConfiguration.toString(); return n && r && i && a && o && t; } function y () { s = {}, n = { audio: null, video: null, fragmentedText: null }; } function v (t, e) { const n = !t.lang || e.lang.match(t.lang); const r = !t.viewpoint || t.viewpoint === e.viewpoint; const i = !t.role || !!e.roles.filter((e) => { return e === t.role; })[0]; const a = !t.accessibility || !!e.accessibility.filter((e) => { return e === t.accessibility; })[0]; var e = !t.audioChannelConfiguration || !!e.audioChannelConfiguration.filter((e) => { return e === t.audioChannelConfiguration; })[0]; return n && r && i && a && e; } function T (e, t) { if (e === S.default.FRAGMENTED_TEXT) return t[0]; function n (e) { let t; let n = 0; let r = []; return e.forEach((e) => { t = Math.max.apply(Math, e.bitrateList.map((e) => { return e.bandwidth; })), n < t ? (n = t, r = [e]) : t === n && r.push(e); }), r; } const r = _(); let i = []; var e = function (e) { let t; let n = 0; let r = []; return e.forEach((e) => { t = e.representationCount, n < t ? (n = t, r = [e]) : t === n && r.push(e); }), r; }; switch (r) { case S.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:(i = n(t)).length > 1 && (i = e(i)); break; case S.default.TRACK_SELECTION_MODE_WIDEST_RANGE:(i = e(t)).length > 1 && (i = n(t)); break; default:o.warn(`Track selection mode is not supported: ${r}`); } return i[0]; } return t = { checkInitialMediaSettingsForType: function (e, t) { let n = p(e); var t = d(e, t); const r = []; n || h(e, n = u.getSavedMediaSettings(e)), t && t.length !== 0 && (n && t.forEach((e) => { v(n, e) && r.push(e); }), r.length === 0 ? c(T(e, t), !0) : r.length > 1 ? c(T(e, r)) : c(r[0])); }, addTrack: function (e) { if (e) { const t = e.type; if (m(t)) { let n = e.streamInfo.id; s[n] || (s[n] = { audio: { list: [], storeLastSettings: !0, current: null }, video: { list: [], storeLastSettings: !0, current: null }, text: { list: [], storeLastSettings: !0, current: null }, fragmentedText: { list: [], storeLastSettings: !0, current: null }, image: { list: [], storeLastSettings: !0, current: null } }); for (var r = s[n][t].list, i = 0, a = r.length; i < a; ++i) if (E(r[i], e)) return; r.push(e); n = p(t); n && v(n, e) && !f(t, e.streamInfo) && c(e); } } }, getTracksFor: d, getCurrentTrackFor: f, isCurrentTrack: function (e) { if (!e) return !1; const t = e.type; const n = e.streamInfo.id; return s[n] && s[n][t] && E(s[n][t].current, e); }, setTrack: c, setInitialSettings: h, getInitialSettings: p, setSwitchMode: function (e, t) { let n; o.warn(`deprecated: Please use updateSettings({streaming: { trackSwitchMode: mode } }) instead`), i.indexOf(t) !== -1 ? ((n = {})[e] = t, r.update({ streaming: { trackSwitchMode: n } })) : o.warn(`Track switch mode is not supported: ${t}`); }, getSwitchMode: g, setSelectionModeForInitialTrack: function (e) { o.warn(`deprecated: Please use updateSettings({streaming: { selectionModeForInitialTrack: mode } }) instead`), l.indexOf(e) !== -1 ? r.update({ streaming: { selectionModeForInitialTrack: e } }) : o.warn(`Track selection mode is not supported: ${e}`); }, getSelectionModeForInitialTrack: _, isMultiTrackSupportedByType: m, isTracksEqual: E, matchSettings: v, saveTextSettingsDisabled: function () { u.setSavedMediaSettings(S.default.FRAGMENTED_TEXT, null); }, setConfig: function (e) { e && (e.domStorage && (u = e.domStorage), e.settings && (r = e.settings)); }, reset: y }, o = (0, R.default)(e).getInstance().getLogger(t), y(), t; }a.__dashjs_factory_name = `MediaController`; e = i.default.getSingletonFactory(a); i.default.updateSingletonFactory(a.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 108: 108, 45: 45, 46: 46, 47: 47, 54: 54 }], 119: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(45)); function o () { let e = void 0; let r = void 0; const t = this.context; return e = { createMediaSource: function () { const e = `WebKitMediaSource` in window; return `MediaSource` in window ? new MediaSource() : e ? new WebKitMediaSource() : null; }, attachMediaSource: function (e, t) { return e = window.URL.createObjectURL(e), t.setSource(e), e; }, detachMediaSource: function (e) { e.setSource(null); }, setDuration: function (e, t) { return e.duration != t && (e.duration = t), e.duration; }, setSeekable: function (e, t, n) { e && typeof e.setLiveSeekableRange === `function` && typeof e.clearLiveSeekableRange === `function` && e.readyState === `open` && t >= 0 && t < n && (e.clearLiveSeekableRange(), e.setLiveSeekableRange(t, n)); }, signalEndOfStream: function (e) { if (e && e.readyState === `open`) { for (let t = e.sourceBuffers, n = 0; n < t.length; n++) { if (t[n].updating) return; if (t[n].buffered.length === 0) return; }r.info(`call to mediaSource endOfStream`), e.endOfStream(); } } }, r = (0, a.default)(t).getInstance().getLogger(e), e; }o.__dashjs_factory_name = `MediaSourceController`, n.default = i.default.getSingletonFactory(o), t.exports = n.default; }, { 45: 45, 47: 47 }], 120: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const pe = r(e(108)); const ge = r(e(109)); const _e = r(e(46)); const me = r(e(54)); const i = r(e(47)); const Ee = r(e(45)); function a () { const e = this.context; const r = (0, _e.default)(e).getInstance(); let t = void 0; let l = void 0; let i = void 0; let o = void 0; let s = void 0; let u = void 0; let n = void 0; let a = void 0; let d = void 0; let f = void 0; let c = void 0; let h = void 0; let p = void 0; let g = void 0; let _ = void 0; let m = void 0; let E = void 0; let y = void 0; let v = void 0; let T = void 0; let S = void 0; let A = void 0; let I = void 0; function R (e) { let t, n; a && isNaN(d) || (t = d, isNaN(t) && (p ? (t = e.liveStartTime, (e = (e = o.getCurrentDVRInfo()) ? e.range : null) && (n = G(!0), isNaN(n) || (l.info(`Start time from URI parameters: ${n}`), t = Math.max(Math.min(t, n), e.start)))) : (t = h.start, n = G(!1), !isNaN(n) && n < t + h.duration && (l.info(`Start time from URI parameters: ${n}`), t = Math.max(t, n)))), isNaN(t) || t === u.getTime() || (r.trigger(me.default.PLAYBACK_SEEKING, { seekTime: t }), O(t, !1, !0))); } function b () { return parseFloat((D() - P()).toFixed(5)); } function D () { return h.start + h.duration; } function M () { h && u && u.getElement() ? u.play() : _ = !0; } function N () { return h && u ? u.isPaused() : null; } function C () { h && u && u.pause(); } function w () { return h && u ? u.isSeeking() : null; } function O (e, t, n) { h && u && e !== (isNaN(y) ? u.getTime() : y) && (!0 === n ? (u.removeEventListener(`seeking`, Q), l.info(`Requesting internal seek to time: ${e}`)) : (y = e, r.trigger(me.default.PLAYBACK_SEEK_ASKED), l.info(`Requesting seek to time: ${e}`)), u.setCurrentTime(e, t)); } function P () { return h && u ? u.getTime() : null; } function L () { let e; let t = P(); return !p || isNaN(E) || (e = E / 1e3) < t && (t -= e), t; } function x () { return h && u ? u.getPlaybackRate() : null; } function F () { return h && u ? u.getEnded() : null; } function U () { return p; } function B () { if (!p || isNaN(E)) return NaN; const e = L(); if (isNaN(e) || e === 0) return 0; const t = (new Date()).getTime() + 1e3 * n.getClientTimeOffset(); return Math.max(((t - E - 1e3 * e) / 1e3).toFixed(3), 0); } function k () { a = _ = !1, E = c = 0, y = d = NaN, u && (r.off(me.default.STREAM_INITIALIZED, R, this), r.off(me.default.DATA_UPDATE_COMPLETED, K, this), r.off(me.default.BUFFER_LEVEL_STATE_CHANGED, fe, this), r.off(me.default.LOADING_PROGRESS, de, this), r.off(me.default.PLAYBACK_PROGRESS, ae, this), r.off(me.default.PLAYBACK_TIME_UPDATED, ae, this), r.off(me.default.PLAYBACK_ENDED, re, this), r.off(me.default.STREAM_INITIALIZING, he, this), Y(), u.removeEventListener(`canplay`, q), u.removeEventListener(`play`, V), u.removeEventListener(`waiting`, W), u.removeEventListener(`playing`, z), u.removeEventListener(`pause`, X), u.removeEventListener(`error`, ie), u.removeEventListener(`seeking`, Q), u.removeEventListener(`seeked`, Z), u.removeEventListener(`timeupdate`, $), u.removeEventListener(`progress`, J), u.removeEventListener(`ratechange`, ee), u.removeEventListener(`loadedmetadata`, te), u.removeEventListener(`stalled`, ce), u.removeEventListener(`ended`, ne)), p = h = u = f = null; } function G (e) { const t = A.getURIFragmentData(); if (!t || !t.t) return NaN; const n = i.getStreams()[0].getStreamInfo().start; t.t = t.t.split(`,`)[0]; const r = t.t.indexOf(`posix:`) !== -1 ? t.t.substring(6) === `now` ? Date.now() / 1e3 : parseInt(t.t.substring(6)) : NaN; return e && !isNaN(r) ? r - E / 1e3 : parseInt(t.t) + n; } function j () { f === null && (f = setInterval(() => { r.trigger(me.default.WALLCLOCK_TIME_UPDATED, { isDynamic: p, time: new Date() }), p && N() && (function () { const e = Date.now(); (!m || m + 500 < e) && (m = e, $()); }()); }, I.get().streaming.wallclockTimeUpdateInterval)); } function Y () { clearInterval(f), f = null; } function H () { let e, t, n; !N() && p && u.getReadyState() !== 0 && (e = L(), t = e, t = (n = (n = o.getCurrentDVRInfo()) ? n.range : null) ? (l.debug(`Checking DVR window for at ${t} with DVR window range ${n.start} - ${n.end}`), t > n.end ? Math.max(n.end - c, n.start) : t > 0 && t + 0.25 < n.start && Math.abs(t - n.start) < 31536e4 ? n.start : t) : NaN, isNaN(t) || t === e || (l.debug(`UpdateCurrentTime: Seek to actual time: ${t} from currentTime: ${e}`), O(t))); } function K (e) { e.error || (e = (e = s.convertDataToRepresentationInfo(e.currentRepresentation)) ? e.mediaInfo.streamInfo : null) !== null && h.id === e.id && (h = e, H()); } function q () { r.trigger(me.default.CAN_PLAY); } function V () { l.info(`Native video element event: play`), H(), j(), r.trigger(me.default.PLAYBACK_STARTED, { startTime: P() }); } function W () { l.info(`Native video element event: waiting`), r.trigger(me.default.PLAYBACK_WAITING, { playingTime: P() }); } function z () { l.info(`Native video element event: playing`), r.trigger(me.default.PLAYBACK_PLAYING, { playingTime: P() }); } function X () { l.info(`Native video element event: pause`), r.trigger(me.default.PLAYBACK_PAUSED, { ended: F() }); } function Q () { let e = P(); isNaN(y) || y === e || (e = y), y = NaN, l.info(`Seeking to: ${e}`), j(), r.trigger(me.default.PLAYBACK_SEEKING, { seekTime: e }); } function Z () { l.info(`Native video element event: seeked`), r.trigger(me.default.PLAYBACK_SEEKED), u.addEventListener(`seeking`, Q); } function $ () { h && r.trigger(me.default.PLAYBACK_TIME_UPDATED, { timeToEnd: b(), time: P() }); } function J () { r.trigger(me.default.PLAYBACK_PROGRESS); } function ee () { const e = x(); l.info(`Native video element event: ratechange: `, e), r.trigger(me.default.PLAYBACK_RATE_CHANGED, { playbackRate: e }); } function te () { l.info(`Native video element event: loadedmetadata`), r.trigger(me.default.PLAYBACK_METADATA_LOADED), j(); } function ne () { l.info(`Native video element event: ended`), C(), Y(), r.trigger(me.default.PLAYBACK_ENDED, { isLast: i.getActiveStreamInfo().isLast }); } function re (e) { f && e.isLast && (l.info(`onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended`), e = e.seekTime ? e.seekTime : D(), u.setCurrentTime(e), C(), Y()); } function ie (e) { e = e.target || e.srcElement; r.trigger(me.default.PLAYBACK_ERROR, { error: e.error }); } function ae () { p && oe() && I.get().streaming.liveCatchup.playbackRate > 0 && !N() && !w() && (!(function () { try { if (oe() && I.get().streaming.liveCatchup.playbackRate > 0 && P() > 0) { var e = ue(); const t = B(); const n = g.getLiveDelay(); const r = g.getLiveCatchupLatencyThreshold(); const i = I.get().streaming.liveCatchup.minDrift; if (e !== pe.default.LIVE_CATCHUP_MODE_LOLP) return (function (e, t, n, r) { try { const i = Math.abs(e - t); return r < i && (isNaN(n) || e <= n); } catch (e) { return !1; } }(t, n, r, i)); const a = se(); var e = I.get().streaming.liveCatchup.playbackBufferMin; return (function (e, t, n, r, i, a) { try { const o = Math.abs(e - t); return (isNaN(a) || e <= a) && (n < o || r < i); } catch (e) { return !1; } }(t, n, i, a, e, r)); } } catch (e) { return !1; } }()) ? le : function () { { let e, t, n, r, i, a; u && (i = u.getPlaybackRate(), e = I.get().streaming.liveCatchup.playbackRate, t = B(), a = g.getLiveDelay(), n = se(), (i = (ue() === pe.default.LIVE_CATCHUP_MODE_LOLP ? (I.get().streaming.liveCatchup.minDrift, r = I.get().streaming.liveCatchup.playbackBufferMin, (function (e, t, n, r, i, a) { const o = e; var e = void 0; { let s, u; i < r ? (s = 5 * (i - r), u = 2 * o / (1 + Math.pow(Math.E, -s)), e = 1 - o + u, l.debug(`[LoL+ playback control_buffer-based] bufferLevel: ${i}, newRate: ${e}`)) : (e = Math.abs(t - n) <= 0.02 * n ? 1 : (s = 5 * (t - n), u = 2 * o / (1 + Math.pow(Math.E, -s)), 1 - o + u), l.debug(`[LoL+ playback control_latency-based] latency: ${t}, newRate: ${e}`)); }T && n / 2 < i && (T = !1); Math.abs(a - e) <= S && (e = null); return { newRate: e }; }(e, t, a, r, n, i))) : (function (e, t, n, r, i) { const a = e; var e = t - n; var t = 5 * e; var t = 2 * a / (1 + Math.pow(Math.E, -t)); var t = 1 - a + t; T && (n / 2 < r ? T = !1 : e > 0 && (t = 1)); Math.abs(i - t) <= S && (t = null); return { newRate: t }; }(e, t, a, n, i))).newRate) && u.setPlaybackRate(i), a = t - a, I.get().streaming.liveCatchup.maxDrift > 0 && !v && a > I.get().streaming.liveCatchup.maxDrift ? (l.info(`Low Latency catchup mechanism. Latency too high, doing a seek to live point`), v = !0, (function () { const e = o.getCurrentDVRInfo(); O((e ? e.range : null).end - g.getLiveDelay(), !0, !1); }())) : v = !1); } })(); } function oe () { return I.get().streaming.liveCatchup.enabled || I.get().streaming.lowLatencyEnabled; } function se () { let t = null; return i.getActiveStreamProcessors().forEach((e) => { e = e.getBufferLevel(); t = t === null ? e : Math.min(t, e); }), t; } function ue () { const e = I.get().streaming.liveCatchup.playbackBufferMin; return I.get().streaming.liveCatchup.mode !== pe.default.LIVE_CATCHUP_MODE_LOLP || e === null || isNaN(e) ? pe.default.LIVE_CATCHUP_MODE_DEFAULT : pe.default.LIVE_CATCHUP_MODE_LOLP; } function le () { u && u.setPlaybackRate(1); } function de (e) { !1 !== e.stream || !I.get().streaming.lowLatencyEnabled || isNaN(e.request.duration) || (e = 1.2 * e.request.duration) > g.getLiveDelay() && (l.warn(`Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:`, e.toFixed(2)), e = { streaming: { liveDelay: e } }, I.update(e)); } function fe (e) { e.streamId === h.id && (oe() ? e.state !== ge.default.BUFFER_EMPTY || w() || T || (T = !0, le()) : u.setStallState(e.mediaType, e.state === ge.default.BUFFER_EMPTY)); } function ce (e) { r.trigger(me.default.PLAYBACK_STALLED, { e: e }); } function he (e) { !(function (e, t) { if (e && e.manifestInfo && e.manifestInfo.serviceDescriptions) { for (var n = void 0, r = 0; r < e.manifestInfo.serviceDescriptions.length; r++) { const i = e.manifestInfo.serviceDescriptions[r]; if (i.schemeIdUri === pe.default.SERVICE_DESCRIPTION_LL_SCHEME) { n = i; break; } }n && t && t.supplementalProperties && t.supplementalProperties[pe.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME] === `true` && (n.latency && n.latency.target > 0 && (l.debug(`Apply LL properties coming from service description. Target Latency (ms):`, n.latency.target), I.update({ streaming: { lowLatencyEnabled: !0, liveDelay: n.latency.target / 1e3, liveCatchup: { minDrift: n.latency.max > n.latency.target ? (n.latency.max - n.latency.target) / 1e3 : void 0 } } })), n.playbackRate && n.playbackRate.max > 1 && (l.debug(`Apply LL properties coming from service description. Max PlaybackRate:`, n.playbackRate.max), I.update({ streaming: { lowLatencyEnabled: !0, liveCatchup: { playbackRate: n.playbackRate.max - 1 } } }))); } }(e.streamInfo, e.mediaInfo)); } return t = { initialize: function (e, t, n) { h = e, u.addEventListener(`canplay`, q), u.addEventListener(`play`, V), u.addEventListener(`waiting`, W), u.addEventListener(`playing`, z), u.addEventListener(`pause`, X), u.addEventListener(`error`, ie), u.addEventListener(`seeking`, Q), u.addEventListener(`seeked`, Z), u.addEventListener(`timeupdate`, $), u.addEventListener(`progress`, J), u.addEventListener(`ratechange`, ee), u.addEventListener(`loadedmetadata`, te), u.addEventListener(`stalled`, ce), u.addEventListener(`ended`, ne), p = h.manifestInfo.isDynamic, a = !(T = v = !1) === t, d = n, n = typeof navigator !== `undefined` ? navigator.userAgent.toLowerCase() : ``, n = /safari/.test(n) && !/chrome/.test(n), S = n ? 0.25 : 0.02, r.on(me.default.STREAM_INITIALIZED, R, this), r.on(me.default.DATA_UPDATE_COMPLETED, K, this), r.on(me.default.LOADING_PROGRESS, de, this), r.on(me.default.BUFFER_LEVEL_STATE_CHANGED, fe, this), r.on(me.default.PLAYBACK_PROGRESS, ae, this), r.on(me.default.PLAYBACK_TIME_UPDATED, ae, this), r.on(me.default.PLAYBACK_ENDED, re, this, { priority: _e.default.EVENT_PRIORITY_HIGH }), r.on(me.default.STREAM_INITIALIZING, he, this), _ && (_ = !1, M()); }, setConfig: function (e) { e && (e.streamController && (i = e.streamController), e.dashMetrics && (o = e.dashMetrics), e.mediaPlayerModel && (g = e.mediaPlayerModel), e.adapter && (s = e.adapter), e.videoModel && (u = e.videoModel), e.timelineConverter && (n = e.timelineConverter), e.uriFragmentModel && (A = e.uriFragmentModel), e.settings && (I = e.settings)); }, getStartTimeFromUriParameters: G, getTimeToStreamEnd: b, getTime: P, getNormalizedTime: L, getPlaybackRate: x, getPlayedRanges: function () { return h && u ? u.getPlayedRanges() : null; }, getEnded: F, getIsDynamic: U, getStreamController: function () { return i; }, computeAndSetLiveDelay: function (e, t, n) { var r = void 0; let i = void 0; let a = void 0; const o = !isNaN(e) && isFinite(e) ? e : NaN; var e = s.getSuggestedPresentationDelay(); var r = I.get().streaming.lowLatencyEnabled ? 0 : g.getLiveDelay() ? g.getLiveDelay() : I.get().streaming.liveDelayFragmentCount === null || isNaN(I.get().streaming.liveDelayFragmentCount) || isNaN(o) ? !0 === I.get().streaming.useSuggestedPresentationDelay && e !== null && !isNaN(e) && e > 0 ? e : isNaN(o) ? isNaN(n) ? 4 * h.manifestInfo.minBufferTime : 4 * n : 4 * o : o * I.get().streaming.liveDelayFragmentCount; return (a = s.getAvailabilityStartTime()) !== null && (E = a), i = t > 0 ? (t = Math.max(t - 10, t / 2), Math.min(r, t)) : r, c = i; }, getLiveDelay: function () { return c; }, setLiveDelay: function (e) { !(arguments.length <= 1 || void 0 === arguments[1]) && arguments[1] && e < c || (c = e); }, getCurrentLiveLatency: B, play: M, isPaused: N, pause: C, isSeeking: w, getStreamEndTime: D, seek: O, reset: k }, l = (0, Ee.default)(e).getInstance().getLogger(t), k(), t; }a.__dashjs_factory_name = `PlaybackController`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 108: 108, 109: 109, 45: 45, 46: 46, 47: 47, 54: 54 }], 121: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const ae = r(e(108)); const oe = r(e(109)); const se = r(e(203)); const ue = r(e(150)); const le = r(e(46)); const de = r(e(54)); const i = r(e(47)); const fe = r(e(45)); function a (e) { e = e || {}; const t = this.context; const n = (0, le.default)(t).getInstance(); const s = e.adapter; const u = e.dashMetrics; const r = e.mediaPlayerModel; const l = e.fragmentModel; const d = e.abrController; const f = e.playbackController; const i = e.textController; const a = e.streamInfo; const c = e.type; const h = e.mimeType; const p = e.mediaController; const g = e.bufferController; const _ = e.settings; let o = void 0; let m = void 0; let E = void 0; let y = void 0; let v = void 0; let T = void 0; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; let C = void 0; let w = void 0; let O = void 0; let P = void 0; let L = void 0; function x () { return !1 === y; } function F () { x() || E && !g.getIsBufferingCompleted() && (m.debug(`Schedule Controller starts`), y = !1, u.createPlaylistTraceMetrics(E.id, 1e3 * f.getTime(), f.getPlaybackRate()), k(0)); } function U () { y || (m.debug(`Schedule Controller stops`), m.debug(`${c} Schedule Controller stops`), y = !0, clearTimeout(S)); } function B () { let e, t; y || v || f.isPaused() && !_.get().streaming.scheduleWhilePaused || (c === ae.default.FRAGMENTED_TEXT || c === ae.default.TEXT) && !i.isTextEnabled() || g.getIsBufferingCompleted() ? U() : ((function () { let e = f.getTime(); let t = 1.5; { isNaN(E.fragmentDuration) && (o = u.getCurrentSchedulingInfo(E.mediaInfo.type), t = o ? 1.5 * o.duration : 1.5); } const n = l.getRequests({ state: ue.default.FRAGMENT_MODEL_EXECUTED, time: e + t, threshold: 0 })[0]; { var r, i, a, o; n && N.indexOf(n) === -1 && !s.getIsTextTrack(h) && (r = _.get().streaming.fastSwitchEnabled, i = g.getBufferLevel(), a = d.getAbandonmentStateFor(c), o = !p.isCurrentTrack(n.mediaInfo) && p.getSwitchMode(n.mediaInfo.type) === ae.default.TRACK_SWITCH_MODE_NEVER_REPLACE, e = n.quality < E.quality, r && (o || e) && t <= i && a !== oe.default.ABANDON_LOAD ? (j(n), L = !0, m.debug(`Reloading outdated fragment at index: `, n.index)) : n.quality > E.quality && !w && ne(f.getTime() + i)); } }()), e = N.length > 0, w || isNaN(M) || C || e || (function (e, t) { D[t] = D[t] || {}; const n = d.getTopQualityIndexFor(e, t); return D[t][e] != n && (m.info(`Top quality ${e} index has changed from ${D[t][e]} to ${n}`), D[t][e] = n, 1); }(c, a.id)) || R.execute(c, E, I) ? (G(!0), !e && P && d.checkPlaybackQuality(c), P = E.quality === M && !C || w ? (t = N.shift()) && t.isInitializationRequest() ? (n.trigger(de.default.INIT_FRAGMENT_NEEDED, { representationId: t.representationId, sender: o }, { streamId: a.id, mediaType: c }), !1) : (n.trigger(de.default.MEDIA_FRAGMENT_NEEDED, { seekTarget: A, replacement: t }, { streamId: a.id, mediaType: c }), !0) : (C ? (m.debug(`Switch track for ${c}, representation id = ${E.id}`), (w = p.getSwitchMode(c) === ae.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE) && g.replaceBuffer && g.replaceBuffer(), C = !1) : m.debug(`Quality has changed, get init request for representationid = ${E.id}`), n.trigger(de.default.INIT_FRAGMENT_NEEDED, { representationId: E.id, sender: o }, { streamId: a.id, mediaType: c }), M = E.quality, !1)) : k(500)); } function k (e) { clearTimeout(S), S = setTimeout(B, e); } function G (e) { v !== e ? v = e : m.debug(`isFragmentProcessingInProgress is already equal to`, e); } function j (e) { N.push(e); } function Y (e) { let t; f && l && ((t = l.getRequests({ state: ue.default.FRAGMENT_MODEL_EXECUTED, time: f.getTime(), threshold: 0 })[0]) && f.getTime() >= t.startTime && ((!b.mediaInfo || t.mediaInfo.type === b.mediaInfo.type && t.mediaInfo.id !== b.mediaInfo.id) && e && n.trigger(de.default.TRACK_CHANGE_RENDERED, { mediaType: c, oldMediaInfo: b.mediaInfo, newMediaInfo: t.mediaInfo }), t.quality === b.quality && t.adaptationIndex === b.adaptationIndex || !e || n.trigger(de.default.QUALITY_CHANGE_RENDERED, { mediaType: c, oldQuality: b.quality, newQuality: t.quality }), b = { mediaInfo: t.mediaInfo, quality: t.quality, adaptationIndex: t.adaptationIndex })); } function H () { U(), G(!1), m.info(`Stream ${a.id} is complete`); } function K (e) { e.request.mediaInfo.streamInfo.id === a.id && e.request.mediaType === c && (m.info(`OnFragmentLoadingCompleted - Url:`, e.request ? e.request.url : `undefined`, e.request.range ? `, Range:${e.request.range}` : ``), s.getIsTextTrack(h) && G(!1), e.error && e.request.serviceLocation && !y && (j(e.request), G(!1), k(0)), w && (O = e.request)); } function q () { Y(!0); } function V (e) { let t, n; w && !isNaN(e.startTime) && (w = !1, l.addExecutedRequest(O)), G(!1), L && !isNaN(e.startTime) ? (t = f.getTime(), k((n = e.startTime + E.fragmentDuration) <= t + (e = 1.5 * E.fragmentDuration) ? 0 : 1e3 * (n - (t + e))), L = !1) : k(0); } function W (e) { m.info(`onFragmentLoadingAbandoned request: ${e.request.url} has been aborted`), f.isSeeking() || C || (m.info(`onFragmentLoadingAbandoned request: ${e.request.url} has to be downloaded again, origin is not seeking process or switch track call`), j(e.request)), G(!1), k(0); } function z () {} function X () { U(); } function Q (e) { w && _.get().streaming.flushBufferAtTrackSwitch && f.seek(f.getTime() + 0.001, !1, !0), e.hasEnoughSpaceToAppend && e.quotaExceeded && F(); } function Z () { U(), G(!1); } function $ () { l.abortRequests(), U(); } function J () { !y && _.get().streaming.scheduleWhilePaused || F(); } function ee (e) { ne(e.seekTime), re(0), y && F(); e = E.DVRWindow && f ? E.DVRWindow.end - f.getTime() : NaN; u.updateManifestUpdateInfo({ latency: e }), v ? l.abortRequests() : k(0); } function te (e) { u.updatePlayListTraceMetrics({ playbackspeed: e.playbackRate.toString() }); } function ne (e) { A = e; } function re (e) { T = e; } function ie () { b = { mediaInfo: void (T = 0), quality: M = A = NaN, adaptationIndex: NaN }, D = {}, N = [], L = w = C = !(y = !(v = !(P = !(O = null)))); } return o = { initialize: function (e) { I = e, R = (0, se.default)(t).create({ abrController: d, dashMetrics: u, mediaPlayerModel: r, textController: i, settings: _ }), n.on(de.default.DATA_UPDATE_STARTED, z, this), n.on(de.default.FRAGMENT_LOADING_COMPLETED, K, this), n.on(de.default.STREAM_COMPLETED, H, this), n.on(de.default.BUFFER_CLEARED, Q, this), n.on(de.default.BYTES_APPENDED_END_FRAGMENT, V, this), n.on(de.default.QUOTA_EXCEEDED, Z, this), n.on(de.default.PLAYBACK_SEEKING, ee, this), n.on(de.default.PLAYBACK_STARTED, J, this), n.on(de.default.PLAYBACK_RATE_CHANGED, te, this), n.on(de.default.PLAYBACK_TIME_UPDATED, q, this), n.on(de.default.URL_RESOLUTION_FAILED, $, this), n.on(de.default.FRAGMENT_LOADING_ABANDONED, W, this), n.on(de.default.BUFFERING_COMPLETED, X, this); }, getType: function () { return c; }, getStreamId: function () { return a.id; }, setCurrentRepresentation: function (e) { E = e; }, setSeekTarget: ne, setTimeToLoadDelay: re, getTimeToLoadDelay: function () { return T; }, switchTrackAsked: function () { C = !0; }, isStarted: x, start: F, stop: U, reset: function () { n.off(de.default.DATA_UPDATE_STARTED, z, this), n.off(de.default.FRAGMENT_LOADING_COMPLETED, K, this), n.off(de.default.STREAM_COMPLETED, H, this), n.off(de.default.BUFFER_CLEARED, Q, this), n.off(de.default.BYTES_APPENDED_END_FRAGMENT, V, this), n.off(de.default.QUOTA_EXCEEDED, Z, this), n.off(de.default.PLAYBACK_SEEKING, ee, this), n.off(de.default.PLAYBACK_STARTED, J, this), n.off(de.default.PLAYBACK_RATE_CHANGED, te, this), n.off(de.default.PLAYBACK_TIME_UPDATED, q, this), n.off(de.default.URL_RESOLUTION_FAILED, $, this), n.off(de.default.FRAGMENT_LOADING_ABANDONED, W, this), n.off(de.default.BUFFERING_COMPLETED, X, this), U(), Y(!1), ie(); }, getBufferTarget: function () { return R.getBufferTarget(c, E, I); }, processInitRequest: function (e) { e && (G(!0), l.executeRequest(e)); }, processMediaRequest: function (e) { e ? (m.debug(`Next fragment request url is ${e.url}`), l.executeRequest(e)) : (f.getIsDynamic() && m.debug(`Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling.`), G(!1), k(_.get().streaming.lowLatencyEnabled ? 100 : 500)); }, getPlaybackController: function () { return f; } }, m = (0, fe.default)(t).getInstance().getLogger(o), ie(), o; }a.__dashjs_factory_name = `ScheduleController`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 108: 108, 109: 109, 150: 150, 203: 203, 45: 45, 46: 46, 47: 47, 54: 54 }], 122: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const ye = r(e(108)); const ve = r(e(109)); const Te = r(e(105)); const Se = r(e(99)); const Ae = r(e(46)); const Ie = r(e(54)); const i = r(e(47)); const Re = e(250); const be = r(e(45)); const De = r(e(220)); const Me = r(e(227)); const Ne = r(e(101)); const Ce = r(e(123)); const we = r(e(119)); const Oe = r(e(232)); const Pe = r(e(51)); const Le = r(e(115)); function a () { const s = this.context; const u = (0, Ae.default)(s).getInstance(); let n = void 0; let l = void 0; let d = void 0; let f = void 0; let r = void 0; let c = void 0; let h = void 0; let p = void 0; let o = void 0; let i = void 0; let g = void 0; let _ = void 0; let m = void 0; let E = void 0; let y = void 0; let a = void 0; let v = void 0; let T = void 0; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; let C = void 0; let w = void 0; let O = void 0; let P = void 0; let L = void 0; let t = void 0; let x = void 0; let F = void 0; let U = void 0; let B = void 0; let k = void 0; let G = void 0; let j = void 0; function Y () { let e; !ue() || (e = O.getPlaybackQuality()) && p.addDroppedFrames(e); } function H (e) { const t = $(e.seekTime); t === I && k && k.length > 0 && k.forEach((e) => { e.deactivate(!0); }), t && t !== I ? (de(Re.PlayListTrace.END_OF_PERIOD_STOP_REASON), te(t, I, e.seekTime)) : de(Re.PlayListTrace.USER_REQUEST_STOP_REASON), fe(Re.PlayList.SEEK_START_REASON); } function K (e) { const t = ee(); de(Re.PlayListTrace.END_OF_PERIOD_STOP_REASON), te(t, I, e.seekTime), fe(Re.PlayList.SEEK_START_REASON); } function q () { l.debug(`[onPlaybackStarted]`), x ? (x = !1, fe(Re.PlayList.INITIAL_PLAYOUT_START_REASON)) : t && (t = !1, fe(Re.PlayList.RESUME_FROM_PAUSE_START_REASON)); } function V (e) { l.debug(`[onPlaybackPaused]`), e.ended || (t = !0, de(Re.PlayListTrace.USER_REQUEST_STOP_REASON)); } function W () { F && (clearInterval(F), F = null); } function z () { U = U || setInterval(() => { !(function () { if (!I || !X(I)) return; function e () { let e; let n; const t = i[a]; const r = a === 0 ? I : i[a - 1]; !t.getPreloadingScheduled() && X(r) && w && (e = [ye.default.VIDEO, ye.default.AUDIO], n = !0, e.forEach((e) => { e = h.getMediaInfoForType(t.getStreamInfo(), e); h.getVoRepresentations(e).forEach((e) => { var t = h.getIsDynamic(); var t = S.calcSegmentAvailabilityRange(e, t); t.end < t.start && (n = !1); }); }), n && (function (t) { const e = arguments.length <= 1 || void 0 === arguments[1] ? null : arguments[1]; { w && !t.getPreloaded() && Z(t, e) && (t.setPreloadingScheduled(!0), l.info(`[onStreamCanLoadNext] Preloading next stream with id ${t.getId()}`), t.preload(w, B), k.push(t), t.getProcessors().forEach((e) => { e.setBufferingTime(t.getStartTime()); })); } }(t, r))), a += 1; } var i = (function (e) { try { const n = e || (I || null); if (n) { const t = (function () { const t = n.getStreamInfo().start; return { v: A.filter((e) => { return e.getStreamInfo().start > t; }) }; }()); if (typeof t === `object`) return t.v; } } catch (e) { return []; } }(I)); var a = 0; for (;a < i.length;)e(); }()); }, 500); } function X (e) { try { if (!e) return !1; let t = e.getProcessors().filter((e) => { return e.getType() === ye.default.AUDIO || e.getType() === ye.default.VIDEO; }); if (!t || t.length === 0) return !1; t = t.filter((e) => { return !e.isBufferingCompleted(); }); return t && t.length === 0; } catch (e) { return !1; } } function Q () { const e = he().isLast; w && e && (l.info(`[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController.`), o.signalEndOfStream(w)); } function Z (e, t) { try { return j.get().streaming.reuseExistingSourceBuffers && t.isProtectionCompatible(e, t) && (G || t.isMediaCodecCompatible(e, t)) && !(function (e) { try { var t = e.getStreamInfo(); var t = h.getAdaptationForType(t.index, ye.default.FRAGMENTED_TEXT, t); return t ? t.codecs.indexOf(`stpp`) !== -1 || t.codecs.indexOf(`wvtt`) !== -1 : !1; } catch (e) { return !1; } }(e)); } catch (e) { return !1; } } function $ (e) { if (isNaN(e)) return null; let t = 0; let n = null; const r = A.length; r > 0 && (t += A[0].getStartTime()); for (let i = 0; i < r; i++) if (n = A[i], e < (t = parseFloat((t + n.getDuration()).toFixed(5)))) return n; return null; } function e () { return I ? I.getProcessors() : []; } function J (e) { let t; I.getIsEndedEventSignaled() || (I.setIsEndedEventSignaled(!0), (t = ee()) ? (l.debug(`StreamController onEnded, found next stream with id ${t.getStreamInfo().id}`), te(t, I, NaN)) : (l.debug(`StreamController no next stream found`), I.setIsEndedEventSignaled(!1)), de(t ? Re.PlayListTrace.END_OF_PERIOD_STOP_REASON : Re.PlayListTrace.END_OF_CONTENT_STOP_REASON), 0), e && e.isLast && W(); } function ee (e) { var t = arguments.length <= 0 || void 0 === e ? null : e; var e = t || (I || null); if (e) { for (var t = e.getStreamInfo().start, e = e.getStreamInfo().duration, n = parseFloat((t + e).toFixed(5)), r = 0, i = -1, a = NaN; r < A.length;) { const o = A[r].getStreamInfo().start - n; o >= 0 && (isNaN(a) || o < a) && (a = o, i = r), r += 1; } return i >= 0 ? A[i] : null; } return null; } function te (e, t, n) { let r; M || !e || t === e && e.isActive() || (M = !0, u.trigger(Ie.default.PERIOD_SWITCH_STARTED, { fromStreamInfo: t ? t.getStreamInfo() : null, toStreamInfo: e.getStreamInfo() }), r = !1, t && (r = Z(e, t), t.deactivate(r)), n = isNaN(n) ? !r && t ? e.getStreamInfo().start : NaN : n, l.info(`Switch to stream ${e.getId()}. Seektime is ${n}, current playback time is ${P.getTime()}`), l.info(`Seamless period switch is set to ${r}`), I = e, k = k.filter((e) => { return e.getId() !== I.getId(); }), P.initialize(he(), !!t, n), O.getElement() ? ne(n, t === null, !1, r) : re(n, r), 0); } function ne (e, t, n, r) { let i = void 0; function a () { w && w.readyState === `open` && (l.debug(`MediaSource is open!`), window.URL.revokeObjectURL(i), w.removeEventListener(`sourceopen`, a), w.removeEventListener(`webkitsourceopen`, a), ie(), t || u.trigger(Ie.default.SOURCE_INITIALIZED), n ? I.setMediaSource(w) : re(e, r)); }w ? r ? (re(e, r), t || u.trigger(Ie.default.SOURCE_INITIALIZED)) : (o.detachMediaSource(O), w.addEventListener(`sourceopen`, a, !1), w.addEventListener(`webkitsourceopen`, a, !1), i = o.attachMediaSource(w, O), l.debug(`MediaSource attached to element.  Waiting on open...`)) : ((w = o.createMediaSource()).addEventListener(`sourceopen`, a, !1), w.addEventListener(`webkitsourceopen`, a, !1), i = o.attachMediaSource(w, O), l.debug(`MediaSource attached to element.  Waiting on open...`)); } function re (e, t) { !(B = I.activate(w, t ? B : void 0)) || (t = Object.keys(B)).length > 0 && B[t[0]].changeType && (G = !0), x || isNaN(e) || (e === P.getTime() ? u.trigger(Ie.default.SEEK_TARGET, { time: e }, { streamId: I.getId() }) : P.seek(e)), !D && x || P.play(), M = !1, u.trigger(Ie.default.PERIOD_SWITCH_COMPLETED, { toStreamInfo: he() }); } function ie (e) { e = e || he().manifestInfo.duration; e && !isNaN(e) && (e = o.setDuration(w, e), l.debug(`Duration successfully set to: ${e}`)); } function ae () { try { !(function () { const n = h.getStreamsInfo(); if (n.length === 0) throw new Error(`There are no streams`); p.updateManifestUpdateInfo({ currentTime: P.getTime(), buffered: O.getBufferRange(), presentationStartTime: n[0].start, clientTimeOffset: S.getClientTimeOffset() }), A.length > 0 && (A = A.filter((t) => { const e = n.filter((e) => { return e.id === t.getId(); }).length > 0 || t.getId() === I.getId(); return e || l.debug(`Removing stream ${t.getId()}`), e; })); for (var e, t, r = 0, i = n.length; r < i; r++) { const a = n[r]; let o = (function (e) { for (let t = 0, n = A.length; t < n; t++) if (A[t].getId() === e.id) return A[t]; return null; }(a)); o ? o.updateData(a) : (o = (0, Te.default)(s).create({ manifestModel: c, mediaPlayerModel: L, dashMetrics: p, manifestUpdater: f, adapter: h, timelineConverter: S, capabilities: d, errHandler: T, baseURLController: g, abrController: _, playbackController: P, eventController: E, mediaController: m, textController: y, protectionController: R, videoModel: O, streamInfo: a, settings: j }), A.push(o), o.initialize()), p.addManifestUpdateStreamInfo(a); }I || (h.getIsDynamic() && A.length && (t = n[0].manifestInfo, e = (function (t, e) { try { let r = NaN; return e && !isNaN(e.maxFragmentDuration) && isFinite(e.maxFragmentDuration) ? e.maxFragmentDuration : (t && t.length === 1 && (function () { const n = t[0]; const e = [ye.default.VIDEO, ye.default.AUDIO, ye.default.FRAGMENTED_TEXT].reduce((e, t) => { t = h.getMediaInfoForType(n, t); return t && e.push(t), e; }, []).reduce((t, e) => { e = h.getVoRepresentations(e); return e && e.length > 0 && e.forEach((e) => { e && t.push(e); }), t; }, []).reduce((e, t) => { t = h.convertDataToRepresentationInfo(t); return t && t.fragmentDuration && !isNaN(t.fragmentDuration) && e.push(t.fragmentDuration), e; }, []); r = Math.max.apply(Math, (function (e) { if (Array.isArray(e)) { for (var t = 0, n = Array(e.length); t < e.length; t++)n[t] = e[t]; return n; } return Array.from(e); }(e))); }()), isFinite(r) ? r : NaN); } catch (e) { return NaN; } }(n, t)), P.computeAndSetLiveDelay(e, t.DVRWindowSize, t.minBufferTime)), t = null, !(t = $(P.getStartTimeFromUriParameters(h.getIsDynamic()))) && h.getIsDynamic() && A.length && (l.debug(`Dynamic stream: Trying to find the correct starting period`), t = (function () { try { const e = S.calcPresentationTimeFromWallTime(new Date(), h.getRegularPeriods()[0]); const t = P.getLiveDelay(); return $(e - t); } catch (e) { return null; } }())), te(t !== null ? t : A[0], null, NaN), F = F || setInterval(() => { !M && P.getTimeToStreamEnd() <= 0 && u.trigger(Ie.default.PLAYBACK_ENDED, { isLast: he().isLast }); }, 200), z()), u.trigger(Ie.default.STREAMS_COMPOSED); }()); } catch (e) { T.error(new Oe.default(Pe.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE, `${e.message}nostreamscomposed`, c.getValue())), C = !0, me(); } } function oe () { const e = c.getValue(); R && (u.trigger(Ie.default.PROTECTION_CREATED, { controller: R, manifest: e }), R.setMediaElement(O.getElement()), b && R.setProtectionData(b)), ae(); } function se (r) { r.error ? (C = !0, me()) : (function () { const e = r.manifest; h.updatePeriods(e); var t = h.getUTCTimingSources(); var t = h.getIsDynamic() ? t.concat(L.getUTCTimingSources()) : t; const n = v.isHTTPS(r.manifest.url); t.forEach((e) => { e.value.replace(/.*?:\/\//g, ``) === L.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g, ``) && (e.value = e.value.replace(n ? new RegExp(/^(http:)?\/\//i) : new RegExp(/^(https:)?\/\//i), n ? `https://` : `http://`), l.debug(`Matching default timing source protocol to manifest protocol: `, e.value)); }), g.initialize(e), i.setConfig({ dashMetrics: p, baseURLController: g }), i.initialize(t, j.get().streaming.useManifestDateHeaderTimeSource); }()); } function ue () { return !!I && I.getHasVideoTrack(); } function le () { return !!I && I.getHasAudioTrack(); } function de (t, n) { n = n || new Date(), e().forEach((e) => { e.finalisePlayList(n, t); }), p.addPlayList(); } function fe (e) { p.createPlaylistMetrics(1e3 * P.getTime(), e); } function ce (e) { if (e.error) { let t = ``; switch (e.error.code) { case 1:t = `MEDIA_ERR_ABORTED`; break; case 2:t = `MEDIA_ERR_NETWORK`; break; case 3:t = `MEDIA_ERR_DECODE`; break; case 4:t = `MEDIA_ERR_SRC_NOT_SUPPORTED`; break; case 5:t = `MEDIA_ERR_ENCRYPTED`; break; default:t = `UNKNOWN`; }N = !0, e.error.message && (t += ` (${e.error.message})`), e.error.msExtendedCode && (t += ` (0x${(e.error.msExtendedCode >>> 0).toString(16).toUpperCase()})`), l.fatal(`Video Element Error: ${t}`), e.error && l.fatal(e.error), T.error(new Oe.default(e.error.code, t)), me(); } } function he () { return I ? I.getStreamInfo() : null; } function pe () { if (!(r && r.hasOwnProperty(`load`) && S && S.hasOwnProperty(`initialize`) && S.hasOwnProperty(`reset`) && S.hasOwnProperty(`getClientTimeOffset`) && c && T && p && P)) throw new Error(ye.default.MISSING_CONFIG_ERROR); } function ge (e) { isNaN(e.newDuration) || ie(e.newDuration); } function _e () { U = F = I = R = null, D = !(t = !(x = !(C = N = M = !(A = [])))), k = []; } function me () { pe(), i.reset(), de(N || C ? Re.PlayListTrace.FAILURE_STOP_REASON : Re.PlayListTrace.USER_REQUEST_STOP_REASON); for (let e = 0, t = A ? A.length : 0; e < t; e++) { A[e].reset(N); }u.off(Ie.default.PLAYBACK_TIME_UPDATED, Y, n), u.off(Ie.default.PLAYBACK_SEEKING, H, n), u.off(Ie.default.GAP_CAUSED_SEEK_TO_PERIOD_END, K, n), u.off(Ie.default.PLAYBACK_ERROR, ce, n), u.off(Ie.default.PLAYBACK_STARTED, q, n), u.off(Ie.default.PLAYBACK_PAUSED, V, n), u.off(Ie.default.PLAYBACK_ENDED, J, n), u.off(Ie.default.MANIFEST_UPDATED, se, n), u.off(Ie.default.STREAM_BUFFERING_COMPLETED, Q, n), u.off(Ie.default.MANIFEST_VALIDITY_CHANGED, ge, n), u.off(Ie.default.TIME_SYNCHRONIZATION_COMPLETED, oe, n), u.off(Ne.default.METRIC_ADDED, Ee, n), g.reset(), f.reset(), E.reset(), p.clearAllCurrentMetrics(), c.setValue(null), r.reset(), S.reset(), a.reset(), w && (o.detachMediaSource(O), w = null), O = null, R && (R.setMediaElement(null), b = R = null, c.getValue() && u.trigger(Ie.default.PROTECTION_DESTROYED, { data: c.getValue().url })), W(), clearInterval(U), U = null, u.trigger(Ie.default.STREAM_TEARDOWN_COMPLETE), _e(); } function Ee (e) { let t; e.metric === ve.default.DVR_INFO && (t = le() ? ye.default.AUDIO : ye.default.VIDEO, e.mediaType === t && o.setSeekable(w, e.value.range.start, e.value.range.end)); } return n = { initialize: function (e, t) { pe(), D = e, b = t, S.initialize(), (f = (0, Se.default)(s).create()).setConfig({ manifestModel: c, adapter: h, manifestLoader: r, errHandler: T, settings: j }), f.initialize(), (E = (0, Le.default)(s).getInstance()).setConfig({ manifestUpdater: f, playbackController: P }), E.start(), u.on(Ie.default.PLAYBACK_TIME_UPDATED, Y, n), u.on(Ie.default.PLAYBACK_SEEKING, H, n), u.on(Ie.default.GAP_CAUSED_SEEK_TO_PERIOD_END, K, n), u.on(Ie.default.PLAYBACK_ERROR, ce, n), u.on(Ie.default.PLAYBACK_STARTED, q, n), u.on(Ie.default.PLAYBACK_PAUSED, V, n), u.on(Ie.default.PLAYBACK_ENDED, J, n, { priority: Ae.default.EVENT_PRIORITY_HIGH }), u.on(Ie.default.MANIFEST_UPDATED, se, n), u.on(Ie.default.STREAM_BUFFERING_COMPLETED, Q, n), u.on(Ie.default.MANIFEST_VALIDITY_CHANGED, ge, n), u.on(Ie.default.TIME_SYNCHRONIZATION_COMPLETED, oe, n), u.on(Ne.default.METRIC_ADDED, Ee, n); }, getActiveStreamInfo: he, hasVideoTrack: ue, hasAudioTrack: le, switchToVideoElement: function (e) { I && (P.initialize(he()), ne(e, !1, !0, !1)); }, getStreamById: function (t) { return A.filter((e) => { return e.getId() === t; })[0]; }, getStreamForTime: $, getTimeRelativeToStreamId: function (e, t) { for (var n, r, i = null, a = 0, o = 0; o < A.length; o++) { if (n = (i = A[o]).getStartTime(), r = i.getDuration(), Number.isFinite(n) && (a = n), i.getId() === t) return e - a; Number.isFinite(r) && (a += r); } return null; }, load: function (e) { pe(), r.load(e); }, loadWithManifest: function (e) { !(function () { if (!f || !f.hasOwnProperty(`setManifest`)) throw new Error(`initialize function has to be called previously`); }()), f.setManifest(e); }, getActiveStreamProcessors: e, setConfig: function (e) { e && (e.capabilities && (d = e.capabilities), e.manifestLoader && (r = e.manifestLoader), e.manifestModel && (c = e.manifestModel), e.mediaPlayerModel && (L = e.mediaPlayerModel), e.protectionController && (R = e.protectionController), e.adapter && (h = e.adapter), e.dashMetrics && (p = e.dashMetrics), e.errHandler && (T = e.errHandler), e.timelineConverter && (S = e.timelineConverter), e.videoModel && (O = e.videoModel), e.playbackController && (P = e.playbackController), e.abrController && (_ = e.abrController), e.mediaController && (m = e.mediaController), e.textController && (y = e.textController), e.settings && (j = e.settings), e.baseURLController && (g = e.baseURLController)); }, setProtectionData: function (e) { b = e; }, getIsStreamSwitchInProgress: function () { return M; }, getHasMediaOrIntialisationError: function () { return N || C; }, hasStreamFinishedBuffering: X, getStreams: function () { return A; }, getActiveStream: function () { return I; }, reset: me }, l = (0, be.default)(s).getInstance().getLogger(n), i = (0, Ce.default)(s).getInstance(), o = (0, we.default)(s).getInstance(), a = (0, De.default)(s).getInstance(), v = (0, Me.default)(s).getInstance(), _e(), n; }a.__dashjs_factory_name = `StreamController`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 101: 101, 105: 105, 108: 108, 109: 109, 115: 115, 119: 119, 123: 123, 220: 220, 227: 227, 232: 232, 250: 250, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54, 99: 99 }], 123: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const S = r(e(232)); const A = e(248); const I = r(e(46)); const R = r(e(54)); const b = r(e(51)); const i = r(e(47)); const D = r(e(45)); const M = r(e(227)); function a () { const e = this.context; const r = (0, I.default)(e).getInstance(); const c = (0, M.default)(e).getInstance(); let t = void 0; let a = void 0; let n = void 0; let i = void 0; let o = void 0; let s = void 0; let u = void 0; let h = void 0; function l (e) { i = e; } function d (e) { n = e; } function f (e) { let t; let n; let r = Date.parse(e); return isNaN(r) && (n = void 0, t = /^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(t = e), n = Date.UTC(parseInt(t[1], 10), parseInt(t[2], 10) - 1, parseInt(t[3], 10), parseInt(t[4], 10), parseInt(t[5], 10), t[6] && (parseInt(t[6], 10) || 0), t[7] && 1e3 * parseFloat(t[7]) || 0), t[9] && t[10] && (e = 60 * parseInt(t[9], 10) + parseInt(t[10], 10), n += (t[8] === `+` ? -1 : 1) * e * 60 * 1e3), r = new Date(n).getTime()), r; } function p (e) { return Date.parse(e); } function g (e) { return Date.parse(e); } function _ (e, t, n) { n(); } function m (e, t, n) { e = f(e); isNaN(e) ? n() : t(e); } function E (n, e, r, t, i) { let a; let o; let s; let u = !1; const l = new XMLHttpRequest(); const d = i ? A.HTTPRequest.HEAD : A.HTTPRequest.GET; const f = e.match(/\S+/g); e = f.shift(), a = function () { u || (u = !0, f.length ? E(n, f.join(` `), r, t, i) : t()); }, o = function () { let e, t; l.status === 200 && (e = i ? l.getResponseHeader(`Date`) : l.response, t = n(e), isNaN(t) || (r(t), u = !0)); }, !c.isRelative(e) || (s = h.resolve()) && (e = c.resolve(e, s.url)), l.open(d, e), l.timeout = 5e3, l.onload = o, l.onloadend = a, l.send(); } function y (e, t, n) { E(g, e, t, n, !0); } function v () { var e = u.getLatestMPDRequestHeaderValueByID(`Date`); var e = e !== null ? new Date(e).getTime() : Number.NaN; isNaN(e) ? T(!0) : (d(e - (new Date()).getTime()), T(!1, e / 1e3, n)); } function T (e, t, n) { l(!1), r.trigger(R.default.TIME_SYNCHRONIZATION_COMPLETED, { time: t, offset: n, error: e ? new S.default(b.default.TIME_SYNC_FAILED_ERROR_CODE, b.default.TIME_SYNC_FAILED_ERROR_MESSAGE) : null }); } return t = { initialize: function (e, t) { o = t, n = 0, i = !1, s = { "urn:mpeg:dash:utc:http-head:2014": y, "urn:mpeg:dash:utc:http-xsdate:2014": E.bind(null, f), "urn:mpeg:dash:utc:http-iso:2014": E.bind(null, p), "urn:mpeg:dash:utc:direct:2014": m, "urn:mpeg:dash:utc:http-head:2012": y, "urn:mpeg:dash:utc:http-xsdate:2012": E.bind(null, f), "urn:mpeg:dash:utc:http-iso:2012": E.bind(null, p), "urn:mpeg:dash:utc:direct:2012": m, "urn:mpeg:dash:utc:http-ntp:2014": _, "urn:mpeg:dash:utc:ntp:2014": _, "urn:mpeg:dash:utc:sntp:2014": _ }, i || (function e (t, n) { const r = n || 0; var n = t[r]; const i = function (e, t) { const n = !e || !t; n && o ? v() : T(n, e, t); }; l(!0); n ? s.hasOwnProperty(n.schemeIdUri) ? s[n.schemeIdUri](n.value, (e) => { const t = (new Date()).getTime(); const n = e - t; d(n), a.info(`Local time: ${new Date(t)}`), a.info(`Server time: ${new Date(e)}`), a.info(`Server Time - Local Time (ms): ${n}`), i(e, n); }, () => { e(t, r + 1); }) : e(t, r + 1) : (d(0), i()); }(e)); }, getOffsetToDeviceTimeMs: function () { return n; }, setConfig: function (e) { e && (e.dashMetrics && (u = e.dashMetrics), e.baseURLController && (h = e.baseURLController)); }, reset: function () { l(!1); } }, a = (0, D.default)(e).getInstance().getLogger(t), t; }a.__dashjs_factory_name = `TimeSyncController`; e = i.default.getSingletonFactory(a); e.HTTP_TIMEOUT_MS = 5e3, i.default.updateSingletonFactory(a.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 227: 227, 232: 232, 248: 248, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54 }], 124: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const p = r(e(107)); const g = r(e(46)); const _ = r(e(54)); const i = r(e(47)); const m = r(e(3)); const E = r(e(227)); const y = r(e(61)); const v = `onLoad`; function a (e) { e = e || {}; const t = this.context; const i = (0, g.default)(t).getInstance(); const s = (0, E.default)(t).getInstance(); let n = void 0; let r = void 0; let u = void 0; let l = void 0; let a = void 0; let d = void 0; function o (e, t, n) { let r; const i = {}; let a = void 0; i.elements = e, i.type = t, i.resolveType = n, i.elements.length === 0 && c(i); for (let o = 0; o < i.elements.length; o++)r = i.elements[o], a = s.isHTTPURL(r.url) ? r.url : r.originalContent.BaseURL + r.url, d.load(a, r, i); } function f (e) { let t; var n = void 0; var n = e.element; const r = e.resolveObject; n.resolvedContent && ((e = 0) === n.resolvedContent.indexOf(`<?xml`) && (e = n.resolvedContent.indexOf(`?>`) + 2), t = `${n.resolvedContent.substr(0, e)}<response>${n.resolvedContent.substr(e)}</response>`, n.resolvedContent = a.xml_str2json(t)), (function (e) { let t = void 0; for (t = 0; t < e.elements.length; t++) if (!1 === e.elements[t].resolved) return !1; return !0; }(r)) && c(r); } function c (e) { let t = []; let n = void 0; let r = void 0; if (!(function (e) { let t = []; let n = void 0; let r = void 0; let i = void 0; let a = void 0; let o = void 0; let s = void 0; for (a = e.elements.length - 1; a >= 0; a--) { if (n = e.elements[a], r = `${n.type}_asArray`, n.resolvedContent) { if (n.resolvedContent) for (o = 0; o < n.resolvedContent[r].length; o++)i = n.resolvedContent[r][o], t.push(i); } else delete n.originalContent[`xlink:actuate`], delete n.originalContent[`xlink:href`], t.push(n.originalContent); for (n.parentElement[r].splice(n.index, 1), s = 0; s < t.length; s++)n.parentElement[r].splice(n.index + s, 0, t[s]); t = []; }e.elements.length > 0 && u.run(l); }(e)), e.resolveType === `onActuate` && i.trigger(_.default.XLINK_READY, { manifest: l }), e.resolveType === v) switch (e.type) { case y.default.PERIOD:for (n = 0; n < l[`${y.default.PERIOD}_asArray`].length; n++)(r = l[`${y.default.PERIOD}_asArray`][n]).hasOwnProperty(`${y.default.ADAPTATION_SET}_asArray`) && (t = t.concat(h(r[`${y.default.ADAPTATION_SET}_asArray`], r, y.default.ADAPTATION_SET, v))), r.hasOwnProperty(`${y.default.EVENT_STREAM}_asArray`) && (t = t.concat(h(r[`${y.default.EVENT_STREAM}_asArray`], r, y.default.EVENT_STREAM, v))); o(t, y.default.ADAPTATION_SET, v); break; case y.default.ADAPTATION_SET:i.trigger(_.default.XLINK_READY, { manifest: l }); } } function h (e, t, n, r) { for (var i, a = [], o = void 0, s = void 0, s = e.length - 1; s >= 0; s--)(o = e[s]).hasOwnProperty(`xlink:href`) && o[`xlink:href`] === `urn:mpeg:dash:resolve-to-zero:2013` && e.splice(s, 1); for (s = 0; s < e.length; s++)(o = e[s]).hasOwnProperty(`xlink:href`) && o.hasOwnProperty(`xlink:actuate`) && o[`xlink:actuate`] === r && (i = { url: o[`xlink:href`], parentElement: t, type: n, index: s, resolveType: r, originalContent: o, resolvedContent: null, resolved: !1 }, a.push(i)); return a; } return n = { resolveManifestOnLoad: function (e) { a = new m.default({ escapeMode: !1, attributePrefix: ``, arrayAccessForm: `property`, emptyNodeForm: `object`, stripWhitespaces: !1, enableToStringFunc: !1, ignoreRoot: !0, matchers: r }), o(h((l = e).Period_asArray, l, y.default.PERIOD, v), y.default.PERIOD, v); }, setMatchers: function (e) { e && (r = e); }, setIron: function (e) { e && (u = e); }, reset: function () { i.off(_.default.XLINK_ELEMENT_LOADED, f, n), d && (d.reset(), d = null); } }, i.on(_.default.XLINK_ELEMENT_LOADED, f, n), d = (0, p.default)(t).create({ errHandler: e.errHandler, dashMetrics: e.dashMetrics, mediaPlayerModel: e.mediaPlayerModel, requestModifier: e.requestModifier, settings: e.settings }), n; }a.__dashjs_factory_name = `XlinkController`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 107: 107, 227: 227, 3: 3, 46: 46, 47: 47, 54: 54, 61: 61 }], 125: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(139)); const a = r(e(126)); const o = r(e(127)); const s = r(e(132)); const u = r(e(137)); function l () { const t = this.context; return { createMetricsReporting: function (e) { return (0, i.default)(t).getInstance({ eventBus: e.eventBus, dashMetrics: e.dashMetrics, metricsConstants: e.metricsConstants, events: e.events }), (0, o.default)(t).create(e); }, getReportingFactory: function () { return (0, u.default)(t).getInstance(); }, getMetricsHandlerFactory: function () { return (0, s.default)(t).getInstance(); } }; }l.__dashjs_factory_name = `MetricsReporting`; e = dashjs.FactoryMaker.getClassFactory(l); e.events = a.default, dashjs.FactoryMaker.updateClassFactory(l.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 126: 126, 127: 127, 132: 132, 137: 137, 139: 139 }], 126: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(55); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this), this.METRICS_INITIALISATION_COMPLETE = `internal_metricsReportingInitialized`, this.BECAME_REPORTING_PLAYER = `internal_becameReportingPlayer`, this.CMCD_DATA_GENERATED = `cmcdDataGenerated`; }e = new ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o)(); n.default = e, t.exports = n.default; }, { 55: 55 }], 127: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const u = r(e(128)); const l = r(e(141)); const d = r(e(126)); function i (i) { i = i || {}; let e = void 0; let a = {}; const o = this.context; const t = i.eventBus; const n = i.events; function r (e) { let r; e.error || (r = Object.keys(a), (0, l.default)(o).getInstance({ adapter: i.adapter, constants: i.constants }).getMetrics(e.manifest).forEach((e) => { const t = JSON.stringify(e); if (a.hasOwnProperty(t))r.splice(t, 1); else try { const n = (0, u.default)(o).create(i); n.initialize(e), a[t] = n; } catch (e) {} }), r.forEach((e) => { a[e].reset(), delete a[e]; }), t.trigger(d.default.METRICS_INITIALISATION_COMPLETE)); } function s () { Object.keys(a).forEach((e) => { a[e].reset(); }), a = {}; } return e = { reset: function () { t.off(n.MANIFEST_UPDATED, r, e), t.off(n.STREAM_TEARDOWN_COMPLETE, s, e); } }, t.on(n.MANIFEST_UPDATED, r, e), t.on(n.STREAM_TEARDOWN_COMPLETE, s, e), e; }i.__dashjs_factory_name = `MetricsCollectionController`, n.default = dashjs.FactoryMaker.getClassFactory(i), t.exports = n.default; }, { 126: 126, 128: 128, 141: 141 }], 128: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const s = r(e(130)); const u = r(e(131)); const l = r(e(129)); function i (t) { t = t || {}; let n = void 0; let r = void 0; let i = void 0; const a = this.context; function o () { n && n.reset(), r && r.reset(), i && i.reset(); } return { initialize: function (e) { try { (i = (0, s.default)(a).create({ mediaElement: t.mediaElement })).initialize(e.Range), (r = (0, u.default)(a).create({ debug: t.debug, metricsConstants: t.metricsConstants })).initialize(e.Reporting, i), (n = (0, l.default)(a).create({ debug: t.debug, eventBus: t.eventBus, metricsConstants: t.metricsConstants, events: t.events })).initialize(e.metrics, r); } catch (e) { throw o(), e; } }, reset: o }; }i.__dashjs_factory_name = `MetricsController`, n.default = dashjs.FactoryMaker.getClassFactory(i), t.exports = n.default; }, { 129: 129, 130: 130, 131: 131 }], 129: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(132); const a = (r = i) && r.__esModule ? r : { default: r }; function o (e) { e = e || {}; let o = []; let t = void 0; const n = this.context; const r = e.eventBus; const i = e.events; const s = (0, a.default)(n).getInstance({ debug: e.debug, eventBus: e.eventBus, metricsConstants: e.metricsConstants }); function u (t) { o.forEach((e) => { e.handleNewMetric(t.metric, t.value, t.mediaType); }); } return t = { initialize: function (e, a) { e.split(`,`).forEach((e, t, n) => { let r, i; e.indexOf(`(`) === -1 || e.indexOf(`)`) !== -1 || (i = n[t + 1]) && i.indexOf(`(`) === -1 && i.indexOf(`)`) !== -1 && (e += `,${i}`, delete n[t + 1]), (r = s.create(e, a)) && o.push(r); }), r.on(i.METRIC_ADDED, u, t), r.on(i.METRIC_UPDATED, u, t); }, reset: function () { r.off(i.METRIC_ADDED, u, t), r.off(i.METRIC_UPDATED, u, t), o.forEach((e) => { return e.reset(); }), o = []; } }; }o.__dashjs_factory_name = `MetricsHandlersController`, n.default = dashjs.FactoryMaker.getClassFactory(o), t.exports = n.default; }, { 132: 132 }], 130: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(215); const u = (r = i) && r.__esModule ? r : { default: r }; function a (e) { e = e || {}; let t; let a = !1; const n = this.context; let o = void 0; const s = e.mediaElement; return t = { initialize: function (e) { e && e.length && (e.forEach((e) => { const t = e.starttime; var e = t + e.duration; o.add(t, e); }), a = !!e[0]._useWallClockTime); }, reset: function () { o.clear(); }, isEnabled: function () { let e; const t = o.length; if (!t) return !0; e = a ? (new Date()).getTime() / 1e3 : s.currentTime; for (let n = 0; n < t; n += 1) { const r = o.start(n); const i = o.end(n); if (r <= e && e < i) return !0; } return !1; } }, o = (0, u.default)(n).create(), t; }a.__dashjs_factory_name = `RangeController`, n.default = dashjs.FactoryMaker.getClassFactory(a), t.exports = n.default; }, { 215: 215 }], 131: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(137); const a = (r = i) && r.__esModule ? r : { default: r }; function o (e) { let r = []; const n = (0, a.default)(this.context).getInstance(e); return { initialize: function (e, t) { e.some((e) => { e = n.create(e, t); if (e) return r.push(e), !0; }); }, reset: function () { r.forEach((e) => { return e.reset(); }), r = []; }, report: function (t, n) { r.forEach((e) => { return e.report(t, n); }); } }; }o.__dashjs_factory_name = `ReportingController`, n.default = dashjs.FactoryMaker.getClassFactory(o), t.exports = n.default; }, { 137: 137 }], 132: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const l = r(e(133)); const d = r(e(134)); const f = r(e(136)); const c = r(e(135)); function i (i) { let e = void 0; const a = (i = i || {}).debug ? i.debug.getLogger(e) : {}; const o = /([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/; const s = this.context; const u = { BufferLevel: l.default, DVBErrors: d.default, HttpList: f.default, PlayList: c.default, RepSwitchList: c.default, TcpList: c.default }; return e = { create: function (e, t) { let n; const r = e.match(o); if (r) { try { (n = u[r[1]](s).create({ eventBus: i.eventBus, metricsConstants: i.metricsConstants })).initialize(r[1], t, r[3], r[5]); } catch (e) { n = null, a.error(`MetricsHandlerFactory: Could not create handler for type ${r[1]} with args ${r[3]}, ${r[5]} (${e.message})`); } return n; } }, register: function (e, t) { u[e] = t; }, unregister: function (e) { delete u[e]; } }; }i.__dashjs_factory_name = `MetricsHandlerFactory`, n.default = dashjs.FactoryMaker.getSingletonFactory(i), t.exports = n.default; }, { 133: 133, 134: 134, 135: 135, 136: 136 }], 133: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(140); const f = (r = i) && r.__esModule ? r : { default: r }; function a (e) { e = e || {}; let r = void 0; let i = void 0; let a = void 0; let o = void 0; let t = void 0; const n = this.context; const s = (0, f.default)(n).getInstance(); const u = []; const l = e.metricsConstants; function d () { const e = (function () { try { return Object.keys(u).map((e) => { return u[e]; }).reduce((e, t) => { return e.level < t.level ? e : t; }); } catch (e) { } }()); e && t !== e.t && (t = e.t, r.report(a, e)); } return { initialize: function (e, t, n) { t && (i = s.validateN(n), r = t, a = s.reconstructFullMetricName(e, n), o = setInterval(d, i)); }, reset: function () { clearInterval(o), i = 0, t = r = o = null; }, handleNewMetric: function (e, t, n) { e === l.BUFFER_LEVEL && (u[n] = t); } }; }a.__dashjs_factory_name = `BufferLevelHandler`, n.default = dashjs.FactoryMaker.getClassFactory(a), t.exports = n.default; }, { 140: 140 }], 134: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(126); const o = (r = i) && r.__esModule ? r : { default: r }; n.default = dashjs.FactoryMaker.getClassFactory((e) => { let n = void 0; const r = (e = e || {}).eventBus; const i = e.metricsConstants; function a () { r.off(o.default.METRICS_INITIALISATION_COMPLETE, a, this), r.trigger(o.default.BECAME_REPORTING_PLAYER); } return { initialize: function (e, t) { t && (n = t, r.on(o.default.METRICS_INITIALISATION_COMPLETE, a, this)); }, reset: function () { n = null; }, handleNewMetric: function (e, t) { e === i.DVB_ERRORS && n && n.report(e, t); } }; }), t.exports = n.default; }, { 126: 126 }], 135: [function (e, t, n) { "use strict"; function r () { let n = void 0; let r = void 0; return { initialize: function (e, t) { n = e, r = t; }, reset: function () { r = null, n = void 0; }, handleNewMetric: function (e, t) { e === n && r && r.report(n, t); } }; }Object.defineProperty(n, `__esModule`, { value: !0 }), r.__dashjs_factory_name = `GenericMetricHandler`, n.default = dashjs.FactoryMaker.getClassFactory(r), t.exports = n.default; }, {}], 136: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(140); const f = (r = i) && r.__esModule ? r : { default: r }; function a (e) { e = e || {}; let i = void 0; let a = void 0; let o = void 0; let s = void 0; let u = void 0; let n = []; const l = (0, f.default)(this.context).getInstance(); const r = e.metricsConstants; function d () { n.length && i && i.report(s, n), n = []; } return { initialize: function (e, t, n, r) { t && (a = l.validateN(n), i = t, r && r.length && (o = r), s = l.reconstructFullMetricName(e, n, r), u = setInterval(d, a)); }, reset: function () { clearInterval(u), n = [], i = o = a = u = null; }, handleNewMetric: function (e, t) { e === r.HTTP_REQUEST && (o && o !== t.type || n.push(t)); } }; }a.__dashjs_factory_name = `HttpListHandler`, n.default = dashjs.FactoryMaker.getClassFactory(a), t.exports = n.default; }, { 140: 140 }], 137: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(138); const s = (r = i) && r.__esModule ? r : { default: r }; function a (e) { e = e || {}; const r = { "urn:dvb:dash:reporting:2014": s.default }; const i = this.context; let t = void 0; const a = e.debug ? e.debug.getLogger(t) : {}; const o = e.metricsConstants; return t = { create: function (t, e) { let n = void 0; try { (n = r[t.schemeIdUri](i).create({ metricsConstants: o })).initialize(t, e); } catch (e) { n = null, a.error(`ReportingFactory: could not create Reporting with schemeIdUri ${t.schemeIdUri} (${e.message})`); } return n; }, register: function (e, t) { r[e] = t; }, unregister: function (e) { delete r[e]; } }; }a.__dashjs_factory_name = `ReportingFactory`, n.default = dashjs.FactoryMaker.getSingletonFactory(a), t.exports = n.default; }, { 138: 138 }], 138: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const h = r(e(142)); const p = r(e(143)); function i (e) { e = e || {}; let t; const n = this.context; let r = void 0; let i = void 0; let a = void 0; let o = void 0; let s = void 0; let u = void 0; const l = []; const d = e.metricsConstants; function f (e, t, n) { function r () { const e = l.indexOf(i); e !== -1 && (l.splice(e, 1), i.status >= 200 && i.status < 300 ? t && t() : n && n()); } var i = new XMLHttpRequest(); l.push(i); try { i.open(`GET`, e), i.onloadend = r, i.onerror = r, i.send(); } catch (e) { i.onerror(); } } function c () { o = a = !1, u = s = null; } return t = { report: function (t, e) { Array.isArray(e) || (e = [e]), o && u.isEnabled() && e.forEach((e) => { e = r.serialise(e); t !== d.DVB_ERRORS && (e = `metricname=${t}&${e}`), f(e = `${s}?${e}`, null, () => { o = !1; }); }); }, initialize: function (e, t) { if (u = t, !(s = e.dvb_reportingUrl)) throw new Error(`required parameter missing (dvb:reportingUrl)`); a || ((e = e.dvb_probability) && (e === 1e3 || e / 1e3 >= i.random()) && (o = !0), a = !0); }, reset: function () { c(); } }, r = (0, h.default)(n).getInstance(), i = (0, p.default)(n).getInstance(), c(), t; }i.__dashjs_factory_name = `DVBReporting`, n.default = dashjs.FactoryMaker.getClassFactory(i), t.exports = n.default; }, { 142: 142, 143: 143 }], 139: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const p = r(e(144)); const g = r(e(126)); function i (e) { let t = void 0; let r = void 0; const n = (e = e || {}).eventBus; const i = e.dashMetrics; const a = e.metricsConstants; const o = e.events; function s (e) { const t = new p.default(); if (r) { for (const n in e)e.hasOwnProperty(n) && (t[n] = e[n]); t.mpdurl || (t.mpdurl = r.originalUrl || r.url), t.terror || (t.terror = new Date()), i.addDVBErrors(t); } } function u (e) { e.error || (r = e.manifest); } function l (e) { s({ errorcode: p.default.BASE_URL_CHANGED, servicelocation: e.entry }); } function d () { s({ errorcode: p.default.BECAME_REPORTER }); } function f (e) { let t; e.metric === a.HTTP_REQUEST && ((t = e.value).responsecode === 0 || t.responsecode >= 400 || t.responsecode < 100 || t.responsecode >= 600) && s({ errorcode: t.responsecode || p.default.CONNECTION_ERROR, url: t.url, terror: t.tresponse, servicelocation: t._serviceLocation }); } function c (e) { let t = void 0; switch (e.error ? e.error.code : 0) { case MediaError.MEDIA_ERR_NETWORK:t = p.default.CONNECTION_ERROR; break; case MediaError.MEDIA_ERR_DECODE:t = p.default.CORRUPT_MEDIA_OTHER; break; default:return; }s({ errorcode: t }); } function h () { n.on(o.MANIFEST_UPDATED, u, t), n.on(o.SERVICE_LOCATION_BLACKLIST_CHANGED, l, t), n.on(o.METRIC_ADDED, f, t), n.on(o.METRIC_UPDATED, f, t), n.on(o.PLAYBACK_ERROR, c, t), n.on(g.default.BECAME_REPORTING_PLAYER, d, t); } return t = { initialise: h, reset: function () { n.off(o.MANIFEST_UPDATED, u, t), n.off(o.SERVICE_LOCATION_BLACKLIST_CHANGED, l, t), n.off(o.METRIC_ADDED, f, t), n.off(o.METRIC_UPDATED, f, t), n.off(o.PLAYBACK_ERROR, c, t), n.off(g.default.BECAME_REPORTING_PLAYER, d, t); } }, h(), t; }i.__dashjs_factory_name = `DVBErrorsTranslator`, n.default = dashjs.FactoryMaker.getSingletonFactory(i), t.exports = n.default; }, { 126: 126, 144: 144 }], 140: [function (e, t, n) { "use strict"; function r () { return { reconstructFullMetricName: function (e, t, n) { return t && (e += `(${t}`, n && n.length && (e += `,${n}`), e += `)`), e; }, validateN: function (e) { if (!e) throw new Error(`missing n`); if (isNaN(e)) throw new Error(`n is NaN`); if (e < 0) throw new Error(`n must be positive`); return e; } }; }Object.defineProperty(n, `__esModule`, { value: !0 }), r.__dashjs_factory_name = `HandlerHelpers`, n.default = dashjs.FactoryMaker.getSingletonFactory(r), t.exports = n.default; }, {}], 141: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(145)); const f = r(e(146)); const a = r(e(147)); function o (e) { const l = (e = e || {}).adapter; const d = e.constants; return { getMetrics: function (u) { const t = []; return u && u.Metrics_asArray && u.Metrics_asArray.forEach((e) => { const o = new i.default(); const s = l.getIsDynamic(u); e.hasOwnProperty(`metrics`) && (o.metrics = e.metrics, e.Range_asArray && e.Range_asArray.forEach((e) => { let t; let n; let r; let i; const a = new f.default(); a.starttime = (t = u, n = e, r = void 0, i = 0, s ? i = l.getAvailabilityStartTime(t) / 1e3 : (t = l.getRegularPeriods(t)).length && (i = t[0].start), r = i, n && n.hasOwnProperty(d.START_TIME) && (r += n.starttime), r), e.hasOwnProperty(`duration`) ? a.duration = e.duration : a.duration = l.getDuration(u), a._useWallClockTime = s, o.Range.push(a); }), e.Reporting_asArray && (e.Reporting_asArray.forEach((e) => { const t = new a.default(); e.hasOwnProperty(d.SCHEME_ID_URI) && (t.schemeIdUri = e.schemeIdUri, e.hasOwnProperty(`value`) && (t.value = e.value), e.hasOwnProperty(d.DVB_REPORTING_URL) && (t.dvb_reportingUrl = e[d.DVB_REPORTING_URL]), e.hasOwnProperty(d.DVB_PROBABILITY) && (t.dvb_probability = e[d.DVB_PROBABILITY]), o.Reporting.push(t)); }), t.push(o))); }), t; } }; }o.__dashjs_factory_name = `ManifestParsing`, n.default = dashjs.FactoryMaker.getSingletonFactory(o), t.exports = n.default; }, { 145: 145, 146: 146, 147: 147 }], 142: [function (e, t, n) { "use strict"; function r () { return { serialise: function n (e) { const t = []; let r = []; let i = void 0; let a = void 0; for (i in e) if (e.hasOwnProperty(i) && i.indexOf(`_`) !== 0) { if ((a = e[i]) == null && (a = ``), Array.isArray(a)) { if (!a.length) continue; r = [], a.forEach((e) => { const t = Object.prototype.toString.call(e).slice(8, -1) !== `Object`; r.push(t ? e : n(e)); }), a = r.map(encodeURIComponent).join(`,`); } else typeof a === `string` ? a = encodeURIComponent(a) : a instanceof Date ? a = a.toISOString() : typeof a === `number` && (a = Math.round(a)); t.push(`${i}=${a}`); } return t.join(`&`); } }; }Object.defineProperty(n, `__esModule`, { value: !0 }), r.__dashjs_factory_name = `MetricSerialiser`, n.default = dashjs.FactoryMaker.getSingletonFactory(r), t.exports = n.default; }, {}], 143: [function (e, t, n) { "use strict"; function r () { let e; const r = window.crypto || window.msCrypto; const t = Uint32Array; const i = Math.pow(2, 8 * t.BYTES_PER_ELEMENT) - 1; const n = 10; let a = void 0; let o = void 0; function s () { r && (a = a || new t(n), r.getRandomValues(a), o = 0); } return e = { random: function (e, t) { let n = void 0; return e = e || 0, t = t || 1, r ? (o === a.length && s(), n = a[o] / i, o += 1) : n = Math.random(), n * (t - e) + e; } }, s(), e; }Object.defineProperty(n, `__esModule`, { value: !0 }), r.__dashjs_factory_name = `RNG`, n.default = dashjs.FactoryMaker.getSingletonFactory(r), t.exports = n.default; }, {}], 144: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.mpdurl = null, this.errorcode = null, this.terror = null, this.url = null, this.ipaddress = null, this.servicelocation = null; }r.SSL_CONNECTION_FAILED_PREFIX = `SSL`, r.DNS_RESOLUTION_FAILED = `C00`, r.HOST_UNREACHABLE = `C01`, r.CONNECTION_REFUSED = `C02`, r.CONNECTION_ERROR = `C03`, r.CORRUPT_MEDIA_ISOBMFF = `M00`, r.CORRUPT_MEDIA_OTHER = `M01`, r.BASE_URL_CHANGED = `F00`, r.BECAME_REPORTER = `S00`, n.default = r, t.exports = n.default; }, {}], 145: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.metrics = ``, this.Range = [], this.Reporting = []; }n.default = r, t.exports = n.default; }, {}], 146: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.starttime = 0, this.duration = 1 / 0, this._useWallClockTime = !1; }n.default = r, t.exports = n.default; }, {}], 147: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.schemeIdUri = ``, this.value = ``, this.dvb_reportingUrl = ``, this.dvb_probability = 1e3; }n.default = r, t.exports = n.default; }, {}], 148: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); function u (e, t) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, u)), this.data = { baseUrls: e || null, selectedIdx: t || NaN }, this.children = []; } const l = r(e(223)); var e = r(e(47)); function i () { let e; let i = void 0; let a = void 0; const t = this.context; const r = (0, l.default)(t).getInstance(); function o (e, t, n) { n = a.getBaseURLsFromElement(n); e[t] ? r.areEqual(n, e[t].data.baseUrls) || (e[t].data.baseUrls = n, e[t].data.selectedIdx = NaN) : e[t] = new u(n); } function n (e) { !(function () { if (!a || !a.hasOwnProperty(`getBaseURLsFromElement`) || !a.hasOwnProperty(`getRepresentationSortFunction`)) throw new Error(`setConfig function has to be called previously`); }()); const t = a.getBaseURLsFromElement(e); r.areEqual(t, i.data.baseUrls) || (i.data.baseUrls = t, i.data.selectedIdx = NaN), e && e.Period_asArray && e.Period_asArray.forEach((e, r) => { o(i.children, r, e), e.AdaptationSet_asArray && e.AdaptationSet_asArray.forEach((e, n) => { o(i.children[r].children, n, e), e.Representation_asArray && e.Representation_asArray.sort(a.getRepresentationSortFunction()).forEach((e, t) => { o(i.children[r].children[n].children, t, e); }); }); }); } function s () { i = new u(); } return e = { reset: s, update: function (e) { n(e); }, getForPath: function (e) { let t = i; const n = [t.data]; return e && e.forEach((e) => { (t = t.children[e]) && n.push(t.data); }), n.filter((e) => { return e.baseUrls.length; }); }, invalidateSelectedIndexes: function (t) { !(function t (n, e) { e = e || i; n(e.data), e.children && e.children.forEach((e) => { return t(n, e); }); }((e) => { isNaN(e.selectedIdx) || t === e.baseUrls[e.selectedIdx].serviceLocation && (e.selectedIdx = NaN); })); }, setConfig: function (e) { e.adapter && (a = e.adapter); } }, s(), e; }i.__dashjs_factory_name = `BaseURLTreeModel`, n.default = e.default.getClassFactory(i), t.exports = n.default; }, { 223: 223, 47: 47 }], 149: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const m = r(e(46)); const E = r(e(101)); const y = r(e(126)); const i = r(e(47)); const v = r(e(45)); const T = r(e(48)); const S = e(248); const A = r(e(65)); const I = r(e(49)); const R = `m`; const b = `a`; const D = `v`; const M = `i`; const N = `c`; const C = `o`; const w = `d`; const O = `s`; const P = `v`; const L = `l`; function a () { let r = void 0; let e = void 0; let d = void 0; let f = void 0; let c = void 0; let h = void 0; let p = void 0; let g = void 0; const t = this.context; const i = (0, m.default)(t).getInstance(); const a = (0, T.default)(t).getInstance(); function n () { d = { pr: 1, nor: null, st: null, sf: null, sid: `${I.default.generateUuid()}`, cid: null }, p = {}, h = {}, g = {}; } function _ () { const e = {}; const t = (a.get().streaming.cmcd.cid ? a.get().streaming.cmcd : d).cid; return e.v = 1, e.sid = (a.get().streaming.cmcd.sid ? a.get().streaming.cmcd : d).sid, e.sid = `${e.sid}`, t && (e.cid = `${t}`), isNaN(d.pr) || d.pr === 1 || d.pr === null || (e.pr = d.pr), d.st && (e.st = d.st), d.sf && (e.sf = d.sf), e; } function o (e) { try { d.pr = e.playbackRate; } catch (e) {} } function s (e) { try { const t = r.getIsDynamic(e.data) ? `${L}` : `${P}`; const n = e.protocol && e.protocol === `MSS` ? `${O}` : `${w}`; d.st = t, d.sf = n; } catch (e) {} } function u (e) { try { e.state && e.mediaType && e.state === E.default.BUFFER_EMPTY && (p[e.mediaType] || (p[e.mediaType] = !0), h[e.mediaType] || (h[e.mediaType] = !0)); } catch (e) {} } function l () { for (var e in p)p.hasOwnProperty(e) && (p[e] = !0); for (var e in h)h.hasOwnProperty(e) && (h[e] = !0); } return e = { getQueryParameter: function (e) { try { if (a.get().streaming.cmcd && a.get().streaming.cmcd.enabled) { const t = (function (e) { try { return e.type === S.HTTPRequest.MPD_TYPE ? (function () { const e = _(); return e.ot = `${R}`, e; }()) : e.type === S.HTTPRequest.MEDIA_SEGMENT_TYPE ? ((function (e) { g.hasOwnProperty(e) || (g[e] = !1); h.hasOwnProperty(e) || (h[e] = !1); p.hasOwnProperty(e) || (p[e] = !1); }(e.mediaType)), (function (e) { const t = _(); const n = (function (e) { try { const t = e.quality; const n = e.mediaInfo.bitrateList; return parseInt(n[t].bandwidth / 1e3); } catch (e) { return null; } }(e)); const r = (function (e) { try { return isNaN(e.duration) ? null : Math.round(1e3 * e.duration); } catch (e) { return null; } }(e)); const i = e.mediaType === `video` ? `${D}` : e.mediaType === `audio` ? `${b}` : e.mediaType === `fragmentedText` ? `${N}` : null; const a = (function (e) { try { return 100 * parseInt(f.getThroughputHistory().getSafeAverageThroughput(e) / 100); } catch (e) { return null; } }(e.mediaType)); const o = (function (e) { try { const t = d.pr; const n = c.getCurrentBufferLevel(e); return isNaN(t) || isNaN(n) ? null : 100 * parseInt(n / t * 10); } catch (e) { return null; } }(e.mediaType)); const s = (function (e) { try { const t = c.getCurrentBufferLevel(e); return isNaN(t) ? null : 100 * parseInt(10 * t); } catch (e) { return null; } }(e.mediaType)); const u = (function (e) { try { const t = f.getTopBitrateInfoFor(e); return Math.round(t.bitrate / 1e3); } catch (e) { return null; } }(e.mediaType)); const l = d.pr; n && (t.br = n); i && (t.ot = i); isNaN(r) || (t.d = r); isNaN(a) || (t.mtp = a); isNaN(o) || (t.dl = o); isNaN(s) || (t.bl = s); isNaN(u) || (t.tb = u); isNaN(l) || l === 1 || (t.pr = l); p[e.mediaType] && (t.bs = !0, p[e.mediaType] = !1); !h[e.mediaType] && g[e.mediaType] || (t.su = !0, h[e.mediaType] = !1, g[e.mediaType] = !0); return t; }(e))) : e.type === S.HTTPRequest.INIT_SEGMENT_TYPE ? (function () { const e = _(); return e.ot = `${M}`, e.su = !0, e; }()) : e.type === S.HTTPRequest.OTHER_TYPE || e.type === S.HTTPRequest.XLINK_EXPANSION_TYPE ? (function () { const e = _(); return e.ot = `${C}`, e; }()) : null; } catch (e) { return null; } }(e)); const n = (function (i) { try { const e = (function () { if (!i) return { v: null }; const e = Object.keys(i).sort((e, t) => { return e.localeCompare(t); }); const r = e.length; return { v: e.reduce((e, t, n) => { return t === `v` && i[t] === 1 || (typeof i[t] !== `string` || t === `ot` && t === `sf` && t === `st` ? e += `${t}=${i[t]}` : e += `${t}="${i[t].replace(/"/g, `"`)}"`, n < r - 1 && (e += `,`)), e; }, ``).replace(/=true/g, ``) }; }()); if (typeof e === `object`) return e.v; } catch (e) { return null; } }(t)); return i.trigger(y.default.CMCD_DATA_GENERATED, { url: e.url, mediaType: e.mediaType, cmcdData: t, cmcdString: n }), { key: `CMCD`, value: n }; } return null; } catch (e) { return null; } }, setConfig: function (e) { e && (e.abrController && (f = e.abrController), e.dashMetrics && (c = e.dashMetrics), e.playbackController && e.playbackController); }, reset: function () { i.off(E.default.PLAYBACK_RATE_CHANGED, o, this), i.off(E.default.MANIFEST_LOADED, s, this), i.off(E.default.BUFFER_LEVEL_STATE_CHANGED, u, e), i.off(E.default.PLAYBACK_SEEKED, l, e), n(); }, initialize: function () { i.on(E.default.PLAYBACK_RATE_CHANGED, o, e), i.on(E.default.MANIFEST_LOADED, s, e), i.on(E.default.BUFFER_LEVEL_STATE_CHANGED, u, e), i.on(E.default.PLAYBACK_SEEKED, l, e); } }, (0, v.default)(t).getInstance().getLogger(e), r = (0, A.default)(t).getInstance(), n(), e; }a.__dashjs_factory_name = `CmcdModel`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 101: 101, 126: 126, 248: 248, 45: 45, 46: 46, 47: 47, 48: 48, 49: 49, 65: 65 }], 150: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const T = r(e(234)); const S = `loading`; const A = `executed`; function a (e) { let t; const n = (e = e || {}).eventBus; const r = e.events; const i = e.dashMetrics; const a = e.fragmentLoader; const o = e.debug; const s = e.streamInfo; const u = e.type; let l = void 0; let d = void 0; let f = void 0; function c (i) { let a; return !!i && (a = !1, d.some((e) => { if (n = i, r = e, !isNaN(n.index) && n.startTime === r.startTime && n.adaptationIndex === r.adaptationIndex && n.type === r.type || (r = i, t = e, isNaN(r.index) && isNaN(t.index) && r.quality === t.quality) || (t = e, (e = i).action === T.default.ACTION_COMPLETE && e.action === t.action)) return a = !0; let t, n, r; }), a); } function h (e) { return isNaN(e.duration) ? 0.25 : Math.min(e.duration / 8, 0.5); } function p (n) { d = d.filter((e) => { const t = h(e); return isNaN(e.startTime) || void 0 !== n && e.startTime >= n - t; }); } function g (n, r) { r <= n + 0.5 || (d = d.filter((e) => { const t = h(e); return isNaN(e.startTime) || e.startTime >= r - t || isNaN(e.duration) || e.startTime + e.duration <= n + t; })); } function _ (e, t) { i.addSchedulingInfo(e, t), i.addRequestsQueue(e.mediaType, f, d); } function m (e) { e.sender === a && (f.splice(f.indexOf(e.request), 1), e.response && !e.error && d.push(e.request), _(e.request, e.error ? `failed` : A), n.trigger(r.FRAGMENT_LOADING_COMPLETED, { request: e.request, response: e.response, error: e.error, sender: this }, { streamId: s.id, mediaType: u })); } function E (e) { e.sender === a && n.trigger(r.FRAGMENT_LOADING_PROGRESS, { request: e.request, response: e.response, error: e.error, sender: this }, { streamId: s.id, mediaType: u }); } function y (e) { e.sender === a && n.trigger(r.FRAGMENT_LOADING_ABANDONED, { request: e.request }, { streamId: s.id, mediaType: u }); } function v () { d = [], f = []; } return t = { getStreamId: function () { return s.id; }, getType: function () { return u; }, getRequests: function (t) { const e = t ? t.state instanceof Array ? t.state : [t.state] : []; let n = []; return e.forEach((e) => { e = (function (e) { let t = void 0; switch (e) { case S:t = f; break; case A:t = d; break; default:t = []; } return t; }(e)); n = n.concat(function (e, n) { if (n.hasOwnProperty(`time`)) return [(function (e, t, n) { for (let r = e.length - 1; r >= 0; r--) { const i = e[r]; const a = i.startTime; const o = a + i.duration; if (n = isNaN(n) ? h(i) : n, !isNaN(a) && !isNaN(o) && a <= t + n && t - n < o || isNaN(a) && isNaN(t)) return i; } return null; }(e, n.time, n.threshold))]; return e.filter((e) => { for (const t in n) if (t !== `state` && n.hasOwnProperty(t) && e[t] != n[t]) return !1; return !0; }); }(e, t)); }), n; }, isFragmentLoaded: c, isFragmentLoadedOrPending: function (e) { let t; let n = !1; let r = 0; if (!(n = c(e))) for (r = 0; r < f.length; r++)t = f[r], e.url === t.url && e.startTime === t.startTime && (n = !0); return n; }, removeExecutedRequestsBeforeTime: p, removeExecutedRequestsAfterTime: function (t) { d = d.filter((e) => { return isNaN(e.startTime) || void 0 !== t && e.startTime < t; }); }, syncExecutedRequestsWithBufferedRange: function (e, t) { if (e && e.length !== 0) { for (var n = 0, r = 0, i = e.length; r < i; r++)g(n, e.start(r)), n = e.end(r); t > 0 && g(n, t); } else p(); }, abortRequests: function () { l.debug(`abort requests`), a.abort(), f = []; }, executeRequest: function (e) { switch (e.action) { case T.default.ACTION_COMPLETE:d.push(e), _(e, A), l.debug(`STREAM_COMPLETED`), n.trigger(r.STREAM_COMPLETED, { request: e }, { streamId: e.mediaInfo.streamInfo.id, mediaType: e.mediaType }); break; case T.default.ACTION_DOWNLOAD:_(e, S), f.push(e), e = e, n.trigger(r.FRAGMENT_LOADING_STARTED, { request: e }, { streamId: s.id, mediaType: u }), a.load(e); break; default:l.warn(`Unknown request action.`); } }, reset: function () { n.off(r.LOADING_COMPLETED, m, this), n.off(r.LOADING_DATA_PROGRESS, E, this), n.off(r.LOADING_ABANDONED, y, this), a && a.reset(), v(); }, addExecutedRequest: function (e) { d.push(e); } }, l = o.getLogger(t), v(), n.on(r.LOADING_COMPLETED, m, t), n.on(r.LOADING_DATA_PROGRESS, E, t), n.on(r.LOADING_ABANDONED, y, t), t; }a.__dashjs_factory_name = `FragmentModel`; e = i.default.getClassFactory(a); e.FRAGMENT_MODEL_LOADING = S, e.FRAGMENT_MODEL_EXECUTED = A, e.FRAGMENT_MODEL_CANCELED = `canceled`, e.FRAGMENT_MODEL_FAILED = `failed`, i.default.updateClassFactory(a.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 234: 234, 47: 47 }], 151: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(46)); const a = r(e(54)); var e = r(e(47)); function o () { const e = this.context; const t = (0, i.default)(e).getInstance(); let n = void 0; return { getValue: function () { return n; }, setValue: function (e) { (n = e) && t.trigger(a.default.MANIFEST_LOADED, { data: e }); } }; }o.__dashjs_factory_name = `ManifestModel`, n.default = e.default.getSingletonFactory(o), t.exports = n.default; }, { 46: 46, 47: 47, 54: 54 }], 152: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const f = r(e(96)); const i = r(e(47)); const c = r(e(108)); const h = r(e(190)); const p = r(e(48)); const g = e(225); function a () { let e; let i = void 0; let r = void 0; let a = void 0; const t = { scheme: `urn:mpeg:dash:utc:http-xsdate:2014`, value: `http://time.akamai.com/?iso&ms` }; const n = this.context; const o = (0, p.default)(n).getInstance(); function s (e) { for (var t = void 0, t = 0; t < a.length; t++) if (a[t].rulename === e) return t; return -1; } function u () { return o.get().streaming.lowLatencyEnabled ? o.get().streaming.liveDelay || 3 : o.get().streaming.liveDelay; } function l (e, t) { d(e, t); const n = new f.default(); n.schemeIdUri = e, n.value = t, i.push(n); } function d (n, r) { (0, g.checkParameterType)(n, `string`), (0, g.checkParameterType)(r, `string`), i.forEach((e, t) => { e.schemeIdUri === n && e.value === r && i.splice(t, 1); }); } return e = { getABRCustomRules: function () { return a; }, addABRCustomRule: function (e, t, n) { if (typeof e !== `string` || e !== h.default.ABANDON_FRAGMENT_RULES && e !== h.default.QUALITY_SWITCH_RULES || typeof t !== `string`) throw c.default.BAD_ARGUMENT_ERROR; const r = s(t); r === -1 ? a.push({ type: e, rulename: t, rule: n }) : (a[r].type = e, a[r].rule = n); }, removeABRCustomRule: function (e) { e ? (e = s(e)) !== -1 && a.splice(e, 1) : a = []; }, getStableBufferTime: function () { if (o.get().streaming.lowLatencyEnabled) return 0.6 * u(); const e = o.get().streaming.stableBufferTime; return e > -1 ? e : o.get().streaming.fastSwitchEnabled ? 20 : 12; }, getRetryAttemptsForType: function (e) { const t = isNaN(o.get().streaming.retryAttempts.lowLatencyMultiplyFactor) ? 5 : o.get().streaming.retryAttempts.lowLatencyMultiplyFactor; return o.get().streaming.lowLatencyEnabled ? o.get().streaming.retryAttempts[e] * t : o.get().streaming.retryAttempts[e]; }, getRetryIntervalsForType: function (e) { const t = isNaN(o.get().streaming.retryIntervals.lowLatencyReductionFactor) ? 10 : o.get().streaming.retryIntervals.lowLatencyReductionFactor; return o.get().streaming.lowLatencyEnabled ? o.get().streaming.retryIntervals[e] / t : o.get().streaming.retryIntervals[e]; }, getLiveDelay: u, getLiveCatchupLatencyThreshold: function () { try { let e = o.get().streaming.liveCatchup.latencyThreshold; const t = u(); if (e !== null && !isNaN(e)) return Math.max(e, t); e = o.get().streaming.liveCatchup.minDrift, e = !isNaN(t) && t ? isNaN(e) ? u() : o.get().streaming.liveCatchup.minDrift + u() : NaN; return e && !isNaN(e) ? Math.max(4 * e, 5) : NaN; } catch (e) { return NaN; } }, addUTCTimingSource: l, removeUTCTimingSource: d, getUTCTimingSources: function () { return i; }, clearDefaultUTCTimingSources: function () { i = []; }, restoreDefaultUTCTimingSources: function () { l(t.scheme, t.value); }, setXHRWithCredentialsForType: function t (e, n) { e ? r[e] = !!n : Object.keys(r).forEach((e) => { t(e, n); }); }, getXHRWithCredentialsForType: function (e) { return void 0 === (e = r[e]) ? r.default : e; }, getDefaultUtcTimingSource: function () { return t; }, reset: function () {} }, r = { default: !(i = []) }, a = [], e; }a.__dashjs_factory_name = `MediaPlayerModel`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 108: 108, 190: 190, 225: 225, 47: 47, 48: 48, 96: 96 }], 153: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const h = r(e(108)); const E = r(e(109)); const u = r(e(238)); const y = e(248); const d = r(e(251)); const p = r(e(244)); const g = r(e(245)); const _ = r(e(246)); const v = r(e(247)); const T = e(249); const S = r(e(253)); const A = r(e(46)); const I = r(e(252)); const R = r(e(54)); var e = r(e(47)); function i (e) { const r = (e = e || {}).settings; var e = this.context; const i = (0, A.default)(e).getInstance(); var e = void 0; let a = void 0; function t () { i.trigger(R.default.METRICS_CHANGED); } function o (e) { i.trigger(R.default.METRIC_CHANGED, { mediaType: e }), t(); } function l (e, t, n) { i.trigger(R.default.METRIC_UPDATED, { mediaType: e, metric: t, value: n }), o(e); } function f (e, t, n) { i.trigger(R.default.METRIC_ADDED, { mediaType: e, metric: t, value: n }), o(e); } function s (e, t) { let n = null; return e && (a.hasOwnProperty(e) ? n = a[e] : t || (n = new u.default(), a[e] = n)), n; } function c (e, t, n) { e = s(e); e !== null && (e[t].push(n), e[t].length > r.get().streaming.metricsMaxListDepth && e[t].shift()); } function m (e, t, n) { c(e, t, n), f(e, t, n); } return e = { clearCurrentMetricsForType: function (e) { delete a[e], o(e); }, clearAllCurrentMetrics: function () { a = {}, t(); }, getMetricsFor: s, addHttpRequest: function e (t, n, r, i, a, o, s, u, l, d, f, c, h, p, g) { const _ = new y.HTTPRequest(); o && o !== i && (e(t, null, r, i, a, null, null, u, l, null, null, null, h, null, null), _.actualurl = o), _.tcpid = n, _.type = r, _.url = i, _.range = u, _.trequest = l, _.tresponse = d, _.responsecode = c, _._tfinish = f, _._stream = t, _._mediaduration = h, _._quality = a, _._responseHeaders = p, _._serviceLocation = s, g ? g.forEach((e) => { let t, n, r, i; t = _, n = e.s, r = e.d, i = e.b, (e = new y.HTTPRequestTrace()).s = n, e.d = r, e.b = i, t.trace.push(e), t.interval || (t.interval = 0), t.interval += r; }) : (delete _.interval, delete _.trace), m(t, E.default.HTTP_REQUEST, _); }, addRepresentationSwitch: function (e, t, n, r, i) { const a = new d.default(); a.t = t, a.mt = n, a.to = r, i ? a.lto = i : delete a.lto, m(e, E.default.TRACK_SWITCH, a); }, addBufferLevel: function (e, t, n) { const r = new p.default(); r.t = t, r.level = n, m(e, E.default.BUFFER_LEVEL, r); }, addBufferState: function (e, t, n) { const r = new g.default(); r.target = n, r.state = t, m(e, E.default.BUFFER_STATE, r); }, addDVRInfo: function (e, t, n, r) { const i = new _.default(); i.time = t, i.range = r, i.manifestInfo = n, m(e, E.default.DVR_INFO, i); }, addDroppedFrames: function (e, t) { const n = new v.default(); const r = s(e).DroppedFrames; t && (n.time = t.creationTime, n.droppedFrames = t.droppedVideoFrames, r.length > 0 && r[r.length - 1] == n || m(e, E.default.DROPPED_FRAMES, n)); }, addSchedulingInfo: function (e, t, n, r, i, a, o, s, u) { const l = new S.default(); l.mediaType = e, l.t = t, l.type = n, l.startTime = r, l.availabilityStartTime = i, l.duration = a, l.quality = o, l.range = s, l.state = u, m(e, E.default.SCHEDULING_INFO, l); }, addRequestsQueue: function (e, t, n) { const r = new I.default(); r.loadingRequests = t, r.executedRequests = n, s(e).RequestsQueue = r, f(e, E.default.REQUESTS_QUEUE, r); }, addManifestUpdate: function (e, t, n, r, i, a, o, s, u, l) { const d = new T.ManifestUpdate(); d.mediaType = e, d.type = t, d.requestTime = n, d.fetchTime = r, d.availabilityStartTime = i, d.presentationStartTime = a, d.clientTimeOffset = o, d.currentTime = s, d.buffered = u, d.latency = l, c(h.default.STREAM, E.default.MANIFEST_UPDATE, d), f(e, E.default.MANIFEST_UPDATE, d); }, updateManifestUpdateInfo: function (e, t) { if (e) { for (const n in t)e[n] = t[n]; l(e.mediaType, E.default.MANIFEST_UPDATE, e); } }, addManifestUpdateStreamInfo: function (e, t, n, r, i) { let a; e && ((a = new T.ManifestUpdateStreamInfo()).id = t, a.index = n, a.start = r, a.duration = i, e.streamInfo.push(a), l(e.mediaType, E.default.MANIFEST_UPDATE_STREAM_INFO, e)); }, addManifestUpdateRepresentationInfo: function (e, t, n, r, i, a, o, s) { let u; e && e.representationInfo && ((u = new T.ManifestUpdateRepresentationInfo()).id = t, u.index = n, u.streamIndex = r, u.mediaType = i, u.startNumber = o, u.fragmentInfoType = s, u.presentationTimeOffset = a, e.representationInfo.push(u), l(e.mediaType, E.default.MANIFEST_UPDATE_TRACK_INFO, e)); }, addPlayList: function (e) { e.trace && Array.isArray(e.trace) ? e.trace.forEach((e) => { e.hasOwnProperty(`subreplevel`) && !e.subreplevel && delete e.subreplevel; }) : delete e.trace, m(h.default.STREAM, E.default.PLAY_LIST, e); }, addDVBErrors: function (e) { m(h.default.STREAM, E.default.DVB_ERRORS, e); } }, a = {}, e; }i.__dashjs_factory_name = `MetricsModel`, n.default = e.default.getSingletonFactory(i), t.exports = n.default; }, { 108: 108, 109: 109, 238: 238, 244: 244, 245: 245, 246: 246, 247: 247, 248: 248, 249: 249, 251: 251, 252: 252, 253: 253, 46: 46, 47: 47, 54: 54 }], 154: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const l = r(e(243)); var e = r(e(47)); function i () { let u = void 0; return { initialize: function (e) { if (u = new l.default(), !e) return null; const t = e.indexOf(`#`); if (t !== -1) for (let n = e.substr(t + 1).split(`&`), r = 0, i = n.length; r < i; ++r) { var a; const o = n[r]; const s = o.indexOf(`=`); s !== -1 && (a = o.substring(0, s), u.hasOwnProperty(a) && (u[a] = o.substr(s + 1))); } }, getURIFragmentData: function () { return u; } }; }i.__dashjs_factory_name = `URIFragmentModel`, n.default = e.default.getSingletonFactory(i), t.exports = n.default; }, { 243: 243, 47: 47 }], 155: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const g = r(e(46)); const _ = r(e(54)); const m = r(e(45)); function a () { let e = void 0; let t = void 0; let o = void 0; let n = void 0; let r = void 0; const i = `element is not video or audio DOM type!`; const a = this.context; const s = (0, g.default)(a).getInstance(); const u = []; function l () { o && (o.playbackRate = r || 1, o.removeEventListener(`canplay`, l)); } function d (e) { o && (o.readyState <= 2 && e > 0 ? o.addEventListener(`canplay`, l) : o.playbackRate = e); } function f () { return u.length > 0; } function c () { let e; o && f() && o.playbackRate === 0 && ((e = document.createEvent(`Event`)).initEvent(`waiting`, !0, !1), o.dispatchEvent(e)); } function h () { return o ? o.buffered : null; } function p (e, t, n, r, i) { if (o) for (let a = 0; a < o.textTracks.length; a++) if (o.textTracks[a].kind === e && (!t || o.textTracks[a].label == t) && o.textTracks[a].language === n && o.textTracks[a].isTTML === r && o.textTracks[a].isEmbedded === i) return o.textTracks[a]; return null; } return e = { initialize: function () { s.on(_.default.PLAYBACK_PLAYING, c, this); }, setCurrentTime: function (t, e) { if (o) { if (o.currentTime == t) return; try { t = e ? (function (e) { const t = h(); let n = e; let r = 9999999999; if (t) for (let i = 0; i < t.length; i++) { const a = t.start(i); const o = t.end(i); const s = Math.abs(a - e); const u = Math.abs(o - e); if (a <= e && e <= o) return e; s < r && (r = s, n = a), u < r && (r = u, n = o); } return n; }(t)) : t, o.currentTime = t; } catch (e) { o.readyState === 0 && e.code === e.INVALID_STATE_ERR && setTimeout(() => { o.currentTime = t; }, 400); } } }, play: function () { let e; o && (o.autoplay = !0, (e = o.play()) && e.catch && typeof Promise !== `undefined` && e.catch((e) => { e.name === `NotAllowedError` && s.trigger(_.default.PLAYBACK_NOT_ALLOWED), t.warn(`Caught pending play exception - continuing (${e})`); })); }, isPaused: function () { return o ? o.paused : null; }, pause: function () { o && (o.pause(), o.autoplay = !1); }, isStalled: f, isSeeking: function () { return o ? o.seeking : null; }, getTime: function () { return o ? o.currentTime : null; }, getPlaybackRate: function () { return o ? o.playbackRate : null; }, setPlaybackRate: d, getPlayedRanges: function () { return o ? o.played : null; }, getEnded: function () { return o ? o.ended : null; }, setStallState: function (e, t) { (t ? function (e) { let t = void 0; if (e === null || !o || o.seeking || u.indexOf(e) !== -1) return; u.push(e), o && u.length === 1 && ((t = document.createEvent(`Event`)).initEvent(`waiting`, !0, !1), r = o.playbackRate, d(0), o.dispatchEvent(t)); } : function (e) { const t = u.indexOf(e); let n = void 0; if (e === null) return; t !== -1 && u.splice(t, 1); o && !1 === f() && o.playbackRate === 0 && (d(r || 1), o.paused || ((n = document.createEvent(`Event`)).initEvent(`playing`, !0, !1), o.dispatchEvent(n))); })(e); }, getElement: function () { return o; }, setElement: function (e) { if (!(e == null || e && /^(VIDEO|AUDIO)$/i.test(e.nodeName))) throw i; (o = e) && (o.preload = `auto`); }, setSource: function (e) { o && (e ? o.src = e : (o.removeAttribute(`src`), o.load())); }, getSource: function () { return o ? o.src : null; }, getTTMLRenderingDiv: function () { return n; }, setTTMLRenderingDiv: function (e) { (n = e).style.position = `absolute`, n.style.display = `flex`, n.style.overflow = `hidden`, n.style.pointerEvents = `none`, n.style.top = 0, n.style.left = 0; }, getPlaybackQuality: function () { if (!o) return null; const e = `webkitDroppedFrameCount` in o && `webkitDecodedFrameCount` in o; let t = null; return `getVideoPlaybackQuality` in o ? t = o.getVideoPlaybackQuality() : e && (t = { droppedVideoFrames: o.webkitDroppedFrameCount, totalVideoFrames: o.webkitDroppedFrameCount + o.webkitDecodedFrameCount, creationTime: new Date() }), t; }, addEventListener: function (e, t) { o && o.addEventListener(e, t); }, removeEventListener: function (e, t) { o && o.removeEventListener(e, t); }, getReadyState: function () { return o ? o.readyState : NaN; }, getBufferRange: h, getClientWidth: function () { return o ? o.clientWidth : NaN; }, getClientHeight: function () { return o ? o.clientHeight : NaN; }, getTextTracks: function () { return o ? o.textTracks : []; }, getTextTrack: p, addTextTrack: function (e, t, n, r, i) { if (!o) return null; let a = p(e, t, n, r, i); return a || ((a = o.addTextTrack(e, t, n)).isEmbedded = i, a.isTTML = r), a; }, appendChild: function (e) { o && (o.appendChild(e), void 0 !== e.isTTML && (o.textTracks[o.textTracks.length - 1].isTTML = e.isTTML, o.textTracks[o.textTracks.length - 1].isEmbedded = e.isEmbedded)); }, removeChild: function (e) { o && o.removeChild(e); }, getVideoWidth: function () { return o ? o.videoWidth : NaN; }, getVideoHeight: function () { return o ? o.videoHeight : NaN; }, getVideoRelativeOffsetTop: function () { const e = o.parentNode.host || o.parentNode; return e ? o.getBoundingClientRect().top - e.getBoundingClientRect().top : NaN; }, getVideoRelativeOffsetLeft: function () { const e = o.parentNode.host || o.parentNode; return e ? o.getBoundingClientRect().left - e.getBoundingClientRect().left : NaN; }, reset: function () { s.off(_.default.PLAYBACK_PLAYING, c, this); } }, t = (0, m.default)(a).getInstance().getLogger(e), e; }a.__dashjs_factory_name = `VideoModel`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 45: 45, 46: 46, 47: 47, 54: 54 }], 156: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const o = r(e(48)); const S = r(e(108)); function a (e) { e = e || {}; const t = this.context; const r = e.requestModifier; const E = e.boxParser; const y = (0, o.default)(t).getInstance(); function v (t, e) { t.reader.read().then(e).catch((e) => { t.onerror && t.response.status === 200 && t.onerror(e); }); } function T (e, t, n, r, i) { switch (e) { case S.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING:return (function (n, r) { try { let e = void 0; let t = void 0; e = n.filter((e, t) => { return t > 0 && t < n.length - 1; }), t = r.filter((e, t) => { return t > 0 && t < r.length - 1; }); let i = 0; if (e.length > 1) { for (var a, o = 0; o < e.length; o++) { e[o] && t[o] && (a = t[o].ts - e[o].ts, i += a); } return i; } return null; } catch (e) { return null; } }(t, n)); case S.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA:default:return a(r, i); } } function a (n, t) { try { if ((n = n.filter((e) => { return e.bytes > t / 4 / n.length; })).length > 1) { const e = (r = 0, i = (n[n.length - 1].ts - n[0].ts) / n.length, n.forEach((e, t) => { t = n[t + 1]; t && (e = t.ts - e.ts, r += e < i ? e : 0); }), { v: r }); if (typeof e === `object`) return e.v; } return null; } catch (e) { return null; } let r, i; } return { load: function (m) { let e = new Date(); const t = m.request; const n = new Headers(); t.range && n.append(`Range`, `bytes=${t.range}`), t.requestStartDate || (t.requestStartDate = e), r && r.modifyRequestHeader({ setRequestHeader: function (e, t) { n.append(e, t); } }), e = void 0, typeof window.AbortController === `function` && (e = new AbortController(), (m.abortController = e).signal.onabort = m.onabort), e = { method: m.method, headers: n, credentials: m.withCredentials ? `include` : void 0, signal: e ? e.signal : void 0 }, fetch(m.url, e).then((e) => { m.response || (m.response = {}), m.response.status = e.status, m.response.statusText = e.statusText, m.response.responseURL = e.url, e.ok || m.onerror(); let t = ``; let n = !0; let r = !1; var i = void 0; try { for (var a = e.headers.keys()[Symbol.iterator](); !(n = (o = a.next()).done); n = !0) { var o = o.value; t += `${o}: ${e.headers.get(o)}\r\n`; } } catch (e) { r = !0, i = e; } finally { try { !n && a.return && a.return(); } finally { if (r) throw i; } } if (m.response.responseHeaders = t, !e.body) return e.arrayBuffer().then((e) => { e = { loaded: (m.response.response = e).byteLength, total: e.byteLength, stream: !1 }; m.progress(e), m.onload(), m.onend(); }); const s = parseInt(e.headers.get(`Content-Length`), 10); let u = 0; let l = !1; let d = new Uint8Array(); let f = 0; m.reader = e.body.getReader(); const c = []; const h = []; const p = []; let g = !0; const _ = y.get().streaming.abr.fetchThroughputCalculationMode; var i = function e (t) { let n; let r = t.value; if (t.done) return d && (m.progress({ loaded: u, total: isNaN(s) ? u : s, lengthComputable: !0, time: T(_, h, p, c, u), stream: !0 }), m.response.response = d.buffer), m.onload(), void m.onend(); r && r.length > 0 && (d = (function (e, t) { if (e.length === 0) return t; const n = new Uint8Array(e.length + t.length); return n.set(e), n.set(t, e.length), n; }(d, r)), u += r.length, c.push({ ts: Date.now(), bytes: r.length }), _ === S.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING && g && E.findLastTopIsoBoxCompleted([`moof`], d, f).found && (g = !1, h.push({ ts: performance.now(), bytes: r.length })), (n = E.findLastTopIsoBoxCompleted([`moov`, `mdat`], d, f)).found ? (t = n.lastCompletedOffset + n.size, _ === S.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING && (g = !0, p.push({ ts: performance.now(), bytes: d.length })), r = void 0, d = t === d.length ? (r = d, new Uint8Array()) : (r = new Uint8Array(d.subarray(0, t)), d.subarray(t)), m.progress({ data: r.buffer, lengthComputable: !1, noTrace: !0 }), f = 0) : (f = n.lastCompletedOffset, l || (m.progress({ lengthComputable: !1, noTrace: !0 }), l = !0))), v(m, e); }; v(m, i); }).catch((e) => { m.onerror && m.onerror(e); }); }, abort: function (e) { if (e.abortController)e.abortController.abort(); else if (e.reader) try { e.reader.cancel(), e.onabort(); } catch (e) {} }, calculateDownloadedTime: T }; }a.__dashjs_factory_name = `FetchLoader`; i = i.default.getClassFactory(a); n.default = i, t.exports = n.default; }, { 108: 108, 47: 47, 48: 48 }], 157: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; } function i (e, t, n) { return t in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e; }Object.defineProperty(n, `__esModule`, { value: !0 }); const w = r(e(160)); const O = r(e(156)); const P = e(248); let a = r(e(47)); const L = r(e(232)); const o = r(e(149)); const x = r(e(49)); const s = r(e(45)); function u (e) { e = e || {}; let t; const _ = this.context; const m = e.errHandler; const E = e.dashMetrics; const y = e.mediaPlayerModel; const v = e.requestModifier; const T = e.boxParser; const S = e.useFetch || !1; const n = e.errors; const A = e.requestTimeout || 0; let r = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; function C (n, t) { const r = n.request; const i = []; let a = !0; let o = !0; let s = new Date(); let u = s; let l = 0; var d = void 0; if (!v || !E || !m) throw new Error(`config object is not correct or missing`); function e (e) { o = !1, r.requestStartDate = s, r.requestEndDate = new Date(), r.firstByteDate = r.firstByteDate || s, r.checkExistenceOnly || (E.addHttpRequest(r, d.response ? d.response.responseURL : null, d.response ? d.response.status : null, d.response && d.response.getAllResponseHeaders ? d.response.getAllResponseHeaders() : d.response ? d.response.responseHeaders : [], e ? i : null), r.type === P.HTTPRequest.MPD_TYPE && E.addManifestUpdate(r.type, r.requestStartDate, r.requestEndDate)); } let f; var c = function () { I.indexOf(d) !== -1 && (I.splice(I.indexOf(d), 1), o && (e(!1), t > 0 ? (function () { t--; const e = { config: n }; b.push(e), e.timeout = setTimeout(() => { b.indexOf(e) !== -1 && (b.splice(b.indexOf(e), 1), C(n, t)); }, y.getRetryIntervalsForType(r.type)); }()) : (m.error(new L.default(D[r.type], `${r.url} is not available`, { request: r, response: d.response })), n.error && n.error(r, `error`, d.response.statusText), n.complete && n.complete(r, d.response.statusText)))); }; var h = void 0; var h = S && window.fetch && r.responseType === `arraybuffer` && r.type === P.HTTPRequest.MEDIA_SEGMENT_TYPE ? (0, O.default)(_).create({ requestModifier: v, boxParser: T }) : (0, w.default)(_).create({ requestModifier: v }); let p = v.modifyRequestURL(r.url); const g = (function (e) { try { const t = []; const n = M.getQueryParameter(e); return n && t.push(n), t; } catch (e) { return []; } }(r)); var d = { url: p = x.default.addAditionalQueryParameterToUrl(p, g), method: r.checkExistenceOnly ? P.HTTPRequest.HEAD : P.HTTPRequest.GET, withCredentials: y.getXHRWithCredentialsForType(r.type), request: r, onload: function () { d.response.status >= 200 && d.response.status <= 299 && (e(!0), n.success && n.success(d.response.response, d.response.statusText, d.response.responseURL), n.complete && n.complete(r, d.response.statusText)); }, onend: c, onerror: c, progress: function (e) { const t = new Date(); a && (a = !1, (!e.lengthComputable || e.lengthComputable && e.total !== e.loaded) && (r.firstByteDate = t)), e.lengthComputable && (r.bytesLoaded = e.loaded, r.bytesTotal = e.total), e.noTrace || (i.push({ s: u, d: e.time ? e.time : t.getTime() - u.getTime(), b: [e.loaded ? e.loaded - l : 0] }), u = t, l = e.loaded), n.progress && e && n.progress(e); }, onabort: function () { n.abort && n.abort(r); }, ontimeout: function (e) { let t; let n = void 0; n = e.lengthComputable ? (t = e.loaded / e.total * 100, `Request timeout: loaded: ${e.loaded}, out of: ${e.total} : ${t.toFixed(3)}% Completed`) : `Request timeout: non-computable download size`, N.warn(n); }, loader: h, timeout: A }; var c = (new Date()).getTime(); isNaN(r.delayLoadingTime) || c >= r.delayLoadingTime ? (I.push(d), h.load(d)) : (f = { httpRequest: d }, R.push(f), f.delayTimeout = setTimeout(() => { if (R.indexOf(f) !== -1) { R.splice(R.indexOf(f), 1); try { s = new Date(), u = s, I.push(f.httpRequest), h.load(f.httpRequest); } catch (e) { f.httpRequest.onerror(); } } }, r.delayLoadingTime - c)); } return r = { load: function (e) { e.request ? C(e, y.getRetryAttemptsForType(e.request.type)) : e.error && e.error(e.request, `error`); }, abort: function () { b.forEach((e) => { clearTimeout(e.timeout), e.config.request && e.config.abort && e.config.abort(e.config.request); }), b = [], R.forEach((e) => { return clearTimeout(e.delayTimeout); }), R = [], I.forEach((e) => { e.onloadend = e.onerror = e.onprogress = void 0, e.loader.abort(e); }), I = []; } }, N = (0, s.default)(_).getInstance().getLogger(r), I = [], R = [], b = [], M = (0, o.default)(_).getInstance(), i(t = {}, P.HTTPRequest.MPD_TYPE, n.DOWNLOAD_ERROR_ID_MANIFEST_CODE), i(t, P.HTTPRequest.XLINK_EXPANSION_TYPE, n.DOWNLOAD_ERROR_ID_XLINK_CODE), i(t, P.HTTPRequest.INIT_SEGMENT_TYPE, n.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE), i(t, P.HTTPRequest.MEDIA_SEGMENT_TYPE, n.DOWNLOAD_ERROR_ID_CONTENT_CODE), i(t, P.HTTPRequest.INDEX_SEGMENT_TYPE, n.DOWNLOAD_ERROR_ID_CONTENT_CODE), i(t, P.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE, n.DOWNLOAD_ERROR_ID_CONTENT_CODE), i(t, P.HTTPRequest.OTHER_TYPE, n.DOWNLOAD_ERROR_ID_CONTENT_CODE), D = t, r; }u.__dashjs_factory_name = `HTTPLoader`; a = a.default.getClassFactory(u); n.default = a, t.exports = n.default; }, { 149: 149, 156: 156, 160: 160, 232: 232, 248: 248, 45: 45, 47: 47, 49: 49 }], 158: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const a = r(e(157)); function o () { let n = void 0; function e () { n = {}; } function t () { e(); } return t(), { getLoader: function (e) { for (const t in n) if (n.hasOwnProperty(t) && e.startsWith(t)) return n[t]; return a.default; }, registerLoader: function (e, t) { n[e] = t; }, unregisterLoader: function (e) { n[e] && delete n[e]; }, unregisterAllLoader: e, reset: t }; }o.__dashjs_factory_name = `SchemeLoaderFactory`; i = i.default.getSingletonFactory(o); n.default = i, t.exports = n.default; }, { 157: 157, 47: 47 }], 159: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const o = r(e(158)); function a (n) { n = n || {}; const r = this.context; let i = void 0; let a = void 0; return i = (0, o.default)(r).getInstance(), { load: function (e) { const t = i.getLoader(e && e.request ? e.request.url : null); (a = t(r).create({ errHandler: n.errHandler, mediaPlayerModel: n.mediaPlayerModel, requestModifier: n.requestModifier, useFetch: n.useFetch || null, dashMetrics: n.dashMetrics, boxParser: n.boxParser ? n.boxParser : null, constants: n.constants ? n.constants : null, dashConstants: n.dashConstants ? n.dashConstants : null, urlUtils: n.urlUtils ? n.urlUtils : null, requestTimeout: isNaN(n.requestTimeout) ? 0 : n.requestTimeout, errors: n.errors })).load(e); }, abort: function () { a && a.abort(); } }; }a.__dashjs_factory_name = `URLLoader`; i = i.default.getClassFactory(a); n.default = i, t.exports = n.default; }, { 158: 158, 47: 47 }], 160: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a (e) { const i = (e = e || {}).requestModifier; return { load: function (e) { const t = new Date(); const n = e.request; let r = new XMLHttpRequest(); r.open(e.method, e.url, !0), n.responseType && (r.responseType = n.responseType), n.range && r.setRequestHeader(`Range`, `bytes=${n.range}`), n.requestStartDate || (n.requestStartDate = t), i && (r = i.modifyRequestHeader(r)), r.withCredentials = e.withCredentials, r.onload = e.onload, r.onloadend = e.onend, r.onerror = e.onerror, r.onprogress = e.progress, r.onabort = e.onabort, r.ontimeout = e.ontimeout, r.timeout = e.timeout, r.send(), e.response = r; }, abort: function (e) { (e = e.response).onloadend = e.onerror = e.onprogress = void 0, e.abort(); } }; }a.__dashjs_factory_name = `XHRLoader`; e = e.default.getClassFactory(a); n.default = e, t.exports = n.default; }, { 47: 47 }], 161: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, null, [{ key: `findCencContentProtection`, value: function (e) { for (var t = null, n = 0; n < e.length; ++n) { const r = e[n]; r.schemeIdUri.toLowerCase() !== `urn:mpeg:dash:mp4protection:2011` || r.value.toLowerCase() !== `cenc` && r.value.toLowerCase() !== `cbcs` || (t = r); } return t; } }, { key: `getPSSHData`, value: function (e) { let t = 8; const n = new DataView(e); const r = n.getUint8(t); return t += 20, r > 0 && (t += 4 + 16 * n.getUint32(t)), t += 4, e.slice(t); } }, { key: `getPSSHForKeySystem`, value: function (e, t) { t = a.parsePSSHList(t); return e && t.hasOwnProperty(e.uuid.toLowerCase()) ? t[e.uuid.toLowerCase()] : null; } }, { key: `parseInitDataFromContentProtection`, value: function (e, t) { return `pssh` in e ? (e.pssh.__text = e.pssh.__text.replace(/\r?\n|\r/g, ``).replace(/\s+/g, ``), t.decodeArray(e.pssh.__text).buffer) : null; } }, { key: `parsePSSHList`, value: function (e) { if (e == null) return []; for (var t = new DataView(e.buffer || e), n = {}, r = 0; ;) { var i; var a; let o = void 0; const s = r; if (r >= t.buffer.byteLength) break; if (i = r + t.getUint32(r), r += 4, t.getUint32(r) === 1886614376) if (r += 4, (a = t.getUint8(r)) === 0 || a === 1) { r++, r += 3, o = ``; for (var u = void 0, l = void 0, u = 0; u < 4; u++)o += (l = t.getUint8(r + u).toString(16)).length === 1 ? `0${l}` : l; for (r += 4, o += `-`, u = 0; u < 2; u++)o += (l = t.getUint8(r + u).toString(16)).length === 1 ? `0${l}` : l; for (r += 2, o += `-`, u = 0; u < 2; u++)o += (l = t.getUint8(r + u).toString(16)).length === 1 ? `0${l}` : l; for (r += 2, o += `-`, u = 0; u < 2; u++)o += (l = t.getUint8(r + u).toString(16)).length === 1 ? `0${l}` : l; for (r += 2, o += `-`, u = 0; u < 6; u++)o += (l = t.getUint8(r + u).toString(16)).length === 1 ? `0${l}` : l; r += 6, o = o.toLowerCase(), t.getUint32(r), r += 4, n[o] = t.buffer.slice(s, i), r = i; } else r = i; else r = i; } return n; } }])), a); function a () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)); }n.default = i, t.exports = n.default; }, {}], 162: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const c = r(e(164)); const h = r(e(165)); const i = r(e(163)); const a = r(e(170)); const p = r(e(172)); const g = r(e(173)); const _ = r(e(171)); const m = [{ generateKeyRequest: `generateKeyRequest`, addKey: `addKey`, cancelKeyRequest: `cancelKeyRequest`, needkey: `needkey`, keyerror: `keyerror`, keyadded: `keyadded`, keymessage: `keymessage` }, { generateKeyRequest: `webkitGenerateKeyRequest`, addKey: `webkitAddKey`, cancelKeyRequest: `webkitCancelKeyRequest`, needkey: `webkitneedkey`, keyerror: `webkitkeyerror`, keyadded: `webkitkeyadded`, keymessage: `webkitkeymessage` }]; const E = [{ setMediaKeys: `setMediaKeys`, MediaKeys: `MediaKeys`, release: `close`, needkey: `needkey`, error: `keyerror`, message: `keymessage`, ready: `keyadded`, close: `keyclose` }, { setMediaKeys: `msSetMediaKeys`, MediaKeys: `MSMediaKeys`, release: `close`, needkey: `msneedkey`, error: `mskeyerror`, message: `mskeymessage`, ready: `mskeyadded`, close: `mskeyclose` }]; function o () { let l = void 0; const d = this.context; function f (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; if (typeof e[r[Object.keys(r)[0]]] === `function`) return r; } return null; } return l = { createProtectionSystem: function (e) { let t = null; const n = (0, h.default)(d).getInstance(); n.setConfig({ debug: e.debug, BASE64: e.BASE64 }), n.initialize(); let r; let i; let a; let o; let s; var u = (r = (u = e).debug, i = r.getLogger(l), a = u.eventBus, o = u.errHandler, (s = u.videoModel ? u.videoModel.getElement() : null) && void 0 === s.onencrypted || s && void 0 === s.mediaKeys ? f(s, E) ? (i.info(`EME detected on this user agent! (ProtectionModel_3Feb2014)`), (0, g.default)(d).create({ debug: r, eventBus: a, events: u.events, api: f(s, E) })) : f(s, m) ? (i.info(`EME detected on this user agent! (ProtectionModel_01b)`), (0, _.default)(d).create({ debug: r, eventBus: a, errHandler: o, events: u.events, api: f(s, m) })) : (i.warn(`No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!`), null) : (i.info(`EME detected on this user agent! (ProtectionModel_21Jan2015)`), (0, p.default)(d).create({ debug: r, eventBus: a, events: u.events }))); return !t && u && (t = (0, c.default)(d).create({ protectionModel: u, protectionKeyController: n, eventBus: e.eventBus, debug: e.debug, events: e.events, BASE64: e.BASE64, constants: e.constants }), e.capabilities.setEncryptedMediaSupported(!0)), t; } }; }o.__dashjs_factory_name = `Protection`; e = dashjs.FactoryMaker.getClassFactory(o); e.events = i.default, e.errors = a.default, dashjs.FactoryMaker.updateClassFactory(o.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 163: 163, 164: 164, 165: 165, 170: 170, 171: 171, 172: 172, 173: 173 }], 163: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(55); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this), this.INTERNAL_KEY_MESSAGE = `internalKeyMessage`, this.INTERNAL_KEY_SYSTEM_SELECTED = `internalKeySystemSelected`, this.INTERNAL_KEY_STATUS_CHANGED = `internalkeyStatusChanged`, this.KEY_ADDED = `public_keyAdded`, this.KEY_ERROR = `public_keyError`, this.KEY_MESSAGE = `public_keyMessage`, this.KEY_SESSION_CLOSED = `public_keySessionClosed`, this.KEY_SESSION_CREATED = `public_keySessionCreated`, this.KEY_SESSION_REMOVED = `public_keySessionRemoved`, this.KEY_STATUSES_CHANGED = `public_keyStatusesChanged`, this.KEY_SYSTEM_ACCESS_COMPLETE = `public_keySystemAccessComplete`, this.KEY_SYSTEM_SELECTED = `public_keySystemSelected`, this.LICENSE_REQUEST_COMPLETE = `public_licenseRequestComplete`, this.LICENSE_REQUEST_SENDING = `public_licenseRequestSending`, this.NEED_KEY = `needkey`, this.PROTECTION_CREATED = `public_protectioncreated`, this.PROTECTION_DESTROYED = `public_protectiondestroyed`, this.SERVER_CERTIFICATE_UPDATED = `serverCertificateUpdated`, this.TEARDOWN_COMPLETE = `protectionTeardownComplete`, this.VIDEO_ELEMENT_SELECTED = `videoElementSelected`; }e = new ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o)(); n.default = e, t.exports = n.default; }, { 55: 55 }], 164: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const N = r(e(161)); const C = r(e(183)); const w = r(e(182)); const O = r(e(170)); const P = r(e(232)); function i (e) { let t; const p = (e = e || {}).protectionKeyController; let g = e.protectionModel; const _ = e.eventBus; const m = e.events; const n = e.debug; const d = e.BASE64; const s = e.constants; let o = []; let E = void 0; let f = void 0; let y = void 0; let c = void 0; let r = void 0; let u = void 0; let v = void 0; function i () { if (!(_ && _.hasOwnProperty(`on`) && p && p.hasOwnProperty(`getSupportedKeySystemsFromContentProtection`))) throw new Error(`Missing config parameter(s)`); } function h (e, t) { const n = N.default.getPSSHForKeySystem(v, e); const r = S(v); if (n) { for (let i = g.getAllInitData(), a = 0; a < i.length; a++) if (p.initDataEquals(n, i[a])) return void E.info(`DRM: Ignoring initData because we have already seen it!`); try { g.createKeySession(n, r, l(v), t); } catch (e) { _.trigger(m.KEY_SESSION_CREATED, { data: null, error: new P.default(O.default.KEY_SESSION_CREATED_ERROR_CODE, O.default.KEY_SESSION_CREATED_ERROR_MESSAGE + e.message) }); } } else e ? g.createKeySession(e, r, l(v), t) : _.trigger(m.KEY_SESSION_CREATED, { data: null, error: new P.default(O.default.KEY_SESSION_CREATED_ERROR_CODE, `${O.default.KEY_SESSION_CREATED_ERROR_MESSAGE}Selected key system is ${v ? v.systemString : null}.  needkey/encrypted event contains no initData corresponding to that key system!`) }); } function T (e, t) { i(), g.loadKeySession(e, t, l(v)); } function a (e) { i(), e ? (g.setMediaElement(e), _.on(m.NEED_KEY, M, this)) : e === null && (g.setMediaElement(e), _.off(m.NEED_KEY, M, this)); } function S (e) { let t = null; return e && (e = e.systemString, c && (t = e in c ? c[e] : null)), t; } function A (e) { var t = S(e); const n = []; const r = []; const i = t && t.audioRobustness && t.audioRobustness.length > 0 ? t.audioRobustness : u; const a = t && t.videoRobustness && t.videoRobustness.length > 0 ? t.videoRobustness : u; const o = l(e); var e = t && t.distinctiveIdentifier ? t.distinctiveIdentifier : `optional`; var t = t && t.persistentState ? t.persistentState : o === `temporary` ? `optional` : `required`; return y.forEach((e) => { e.type === s.AUDIO ? n.push(new C.default(e.codec, i)) : e.type === s.VIDEO && r.push(new C.default(e.codec, a)); }), new w.default(n, r, e, t, [o]); } function l (e) { e = S(e); return e && e.sessionType ? e.sessionType : r; } function I (n, s) { const u = this; const r = []; n = n.sort((e, t) => { return (c && c[e.ks.systemString] && c[e.ks.systemString].priority >= 0 ? c[e.ks.systemString].priority : n.length) - (c && c[t.ks.systemString] && c[t.ks.systemString].priority >= 0 ? c[t.ks.systemString].priority : n.length); }); let t; let l = void 0; if (v) for (l = 0; l < n.length; l++) { if (v === n[l].ks) if ((function () { r.push({ ks: n[l].ks, configs: [A(v)] }); function t (e) { _.off(m.KEY_SYSTEM_ACCESS_COMPLETE, t, u), e.error ? s || _.trigger(m.KEY_SYSTEM_SELECTED, { error: new P.default(O.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE, O.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE + e.error) }) : (E.info(`DRM: KeySystem Access Granted`), _.trigger(m.KEY_SYSTEM_SELECTED, { data: e.data }), e = S(v), p.isClearKey(v) && e && e.hasOwnProperty(`clearkeys`) && (e = { kids: Object.keys(e.clearkeys) }, n[l].initData = (new TextEncoder()).encode(JSON.stringify(e))), n[l].sessionId ? T(n[l].sessionId, n[l].initData) : n[l].initData && h(n[l].initData, n[l].cdmData)); } return _.on(m.KEY_SYSTEM_ACCESS_COMPLETE, t, u), g.requestKeySystemAccess(r), `break`; }()) === `break`) break; } else void 0 === v ? (function () { v = null, f.push(n); for (let e = 0; e < n.length; e++)r.push({ ks: n[e].ks, configs: [A(n[e].ks)] }); function a (e) { _.off(m.KEY_SYSTEM_ACCESS_COMPLETE, a, u), e.error ? (v = void 0, _.off(m.INTERNAL_KEY_SYSTEM_SELECTED, t, u), s || _.trigger(m.KEY_SYSTEM_SELECTED, { data: null, error: new P.default(O.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE, O.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE + e.error) })) : (o = e.data, E.info(`DRM: KeySystem Access Granted (${o.keySystem.systemString})!  Selecting key system...`), g.selectKeySystem(o)); } var o = void 0; t = function e (t) { if (_.off(m.INTERNAL_KEY_SYSTEM_SELECTED, e, u), _.off(m.KEY_SYSTEM_ACCESS_COMPLETE, a, u), t.error)v = void 0, s || _.trigger(m.KEY_SYSTEM_SELECTED, { data: null, error: new P.default(O.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE, `${O.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE}Error selecting key system! -- ${t.error}`) }); else { if (!g) return; v = g.getKeySystem(), _.trigger(m.KEY_SYSTEM_SELECTED, { data: o }); const n = S(v); n && n.serverCertificate && n.serverCertificate.length > 0 && g.setServerCertificate(d.decodeArray(n.serverCertificate).buffer); for (var r, i = 0; i < f.length; i++) for (l = 0; l < f[i].length; l++) if (v === f[i][l].ks) { p.isClearKey(v) && n && n.hasOwnProperty(`clearkeys`) && (r = { kids: Object.keys(n.clearkeys) }, f[i][l].initData = (new TextEncoder()).encode(JSON.stringify(r))), f[i][l].sessionId ? T(f[i][l].sessionId, f[i][l].initData) : f[i][l].initData !== null && h(f[i][l].initData, f[i][l].cdmData); break; } } }, _.on(m.INTERNAL_KEY_SYSTEM_SELECTED, t, u), _.on(m.KEY_SYSTEM_ACCESS_COMPLETE, a, u), g.requestKeySystemAccess(r); }()) : f.push(n); } function R (e, t) { _.trigger(m.LICENSE_REQUEST_COMPLETE, { data: e, error: t }); } function b (e) { e.error ? _.trigger(m.KEY_STATUSES_CHANGED, { data: null, error: e.error }) : E.debug(`DRM: key status = ${e.status}`); } function D (e) { E.debug(`DRM: onKeyMessage`); var t = e.data; _.trigger(m.KEY_MESSAGE, { data: t }); const n = t.messageType ? t.messageType : `license-request`; let r = t.message; const i = t.sessionToken; var t = S(v); const a = v ? v.systemString : null; const o = p.getLicenseServer(v, t, n); const s = { sessionToken: i, messageType: n }; if (r && r.byteLength !== 0) { if (!o) return E.debug(`DRM: License server request not required for this message (type = ${e.data.messageType}).  Session ID = ${i.getSessionID()}`), void R(s); if (p.isClearKey(v)) { var u = p.processClearKeyLicenseRequest(v, t, r); if (u) return E.debug(`DRM: ClearKey license request handled by application!`), R(s), void g.updateKeySession(i, u); } let l; let d; let f; let c; let h; var u = null; t && t.serverURL ? typeof (h = t.serverURL) === `string` && h !== `` ? u = h : typeof h === `object` && h.hasOwnProperty(n) && (u = h[n]) : u = t && t.laURL && t.laURL !== `` ? t.laURL : p.isClearKey(v) ? v.getLicenseServerUrlFromMediaInfo(y) : (c = N.default.getPSSHData(i.initData), (u = v.getLicenseServerURLFromInitData(c)) || e.data.laURL), (u = o.getServerURLFromMessage(u, r, n)) ? (d = !(l = {}), h = function (e) { if (e) for (const t in e)t.toLowerCase() === `authorization` && (d = !0), l[t] = e[t]; }, t && h(t.httpRequestHeaders), h(v.getRequestHeadersFromMessage(r)), t && typeof t.withCredentials === `boolean` && (d = t.withCredentials), f = function (e, t, n, r) { r = e.response ? o.getErrorResponse(e.response, n, r) : `NONE`; R(t, new P.default(O.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE, `${O.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE + n} update, XHR complete. status is "${e.statusText}" (${e.status}), readyState is ${e.readyState}.  Response is ${r}`)); }, c = v.getLicenseRequestFromMessage(r), e = o.getHTTPMethod(n), h = o.getResponseType(a, n), r = t && !isNaN(t.httpTimeout) ? t.httpTimeout : 8e3, t = i.getSessionID() || null, (function e (t, n, r, i, a, o, s, u, l, d, f, c) { const h = new XMLHttpRequest(); h.open(r, t, !0); h.responseType = i; h.withCredentials = a; u > 0 && (h.timeout = u); for (const p in n)h.setRequestHeader(p, n[p]); const g = function () { s--, setTimeout(() => { e(t, n, r, i, a, o, s, u, l, d, f, c); }, 1e3); }; h.onload = function () { this.status === 200 || s <= 0 ? l(this) : (E.warn(`License request failed (${this.status}). Retrying it... Pending retries: ${s}`), g()); }; h.ontimeout = h.onerror = function () { s <= 0 ? f(this) : (E.warn(`License request network request failed . Retrying it... Pending retries: ${s}`), g()); }; h.onabort = function () { d(this); }; _.trigger(m.LICENSE_REQUEST_SENDING, { url: t, headers: n, payload: o, sessionId: c }); h.send(o); }(u, l, e, h, d, c, 3, r, (e) => { let t; g && (e.status === 200 && (t = o.getLicenseMessage(e.response, a, n)) !== null ? (R(s), g.updateKeySession(i, t)) : f(e, s, a, n)); }, (e) => { R(s, new P.default(O.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE, `${O.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE + a} update, XHR aborted. status is "${e.statusText}" (${e.status}), readyState is ${e.readyState}`)); }, (e) => { R(s, new P.default(O.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE, `${O.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE + a} update, XHR error. status is "${e.statusText}" (${e.status}), readyState is ${e.readyState}`)); }, t))) : R(s, new P.default(O.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE, O.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE)); } else R(s, new P.default(O.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE, O.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE)); } function M (e, t) { if (E.debug(`DRM: onNeedKey`), e.key.initDataType === `cenc`) if (y.length === 0 && (E.warn(`DRM: onNeedKey called before initializeForMedia, wait until initialized`), (t = void 0 === t ? 1 : t + 1) < 5))o.push(setTimeout(() => { M(e, t); }, 500)); else { let n = e.key.initData; if (ArrayBuffer.isView(n) && (n = n.buffer), v) { const r = N.default.getPSSHForKeySystem(v, n); if (r) for (let i = g.getAllInitData(), a = 0; a < i.length; a++) if (p.initDataEquals(r, i[a])) return void E.warn(`DRM: Ignoring initData because we have already seen it!`); }E.debug(`DRM: initData:`, String.fromCharCode.apply(null, new Uint8Array(n))); n = p.getSupportedKeySystems(n, c); n.length !== 0 ? I(n, !1) : E.debug(`DRM: Received needkey event with initData, but we don't support any of the key systems!`); } else E.warn(`DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: ${e.key.initDataType}`); } return t = { initializeForMedia: function (e) { if (!e) throw new Error(`mediaInfo can not be null or undefined`); i(), _.on(m.INTERNAL_KEY_MESSAGE, D, this), _.on(m.INTERNAL_KEY_STATUS_CHANGED, b, this), y.push(e), (e = p.getSupportedKeySystemsFromContentProtection(e.contentProtection)) && e.length > 0 && I(e, !0); }, createKeySession: h, loadKeySession: T, removeKeySession: function (e) { i(), g.removeKeySession(e); }, closeKeySession: function (e) { i(), g.closeKeySession(e); }, setServerCertificate: function (e) { i(), g.setServerCertificate(e); }, setMediaElement: a, setSessionType: function (e) { r = e; }, setRobustnessLevel: function (e) { u = e; }, setProtectionData: function (e) { c = e, p.setProtectionData(e); }, getSupportedKeySystemsFromContentProtection: function (e) { return i(), p.getSupportedKeySystemsFromContentProtection(e); }, getKeySystems: function () { return p ? p.getKeySystems() : []; }, setKeySystems: function (e) { p && p.setKeySystems(e); }, stop: function () { g && g.stop(); }, reset: function () { i(), _.off(m.INTERNAL_KEY_MESSAGE, D, this), _.off(m.INTERNAL_KEY_STATUS_CHANGED, b, this), a(null), v = void 0, g && (g.reset(), g = null), o.forEach((e) => { return clearTimeout(e); }), o = [], y = []; } }, E = n.getLogger(t), f = [], y = [], r = `temporary`, u = ``, t; }i.__dashjs_factory_name = `ProtectionController`, n.default = dashjs.FactoryMaker.getClassFactory(i), t.exports = n.default; }, { 161: 161, 170: 170, 182: 182, 183: 183, 232: 232 }], 165: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const l = r(e(161)); const d = r(e(166)); const f = r(e(168)); const c = r(e(169)); const h = r(e(167)); const p = r(e(175)); const g = r(e(176)); const _ = r(e(177)); const m = r(e(174)); const E = r(e(110)); function i () { const r = this.context; let t = void 0; let n = void 0; let i = void 0; let u = void 0; let a = void 0; let o = void 0; let s = void 0; return t = { initialize: function () { u = []; let e = (0, h.default)(r).getInstance({ BASE64: a }); u.push(e), e = (0, c.default)(r).getInstance({ BASE64: a }), u.push(e), e = (0, d.default)(r).getInstance({ BASE64: a }), u.push(e), o = e, e = (0, f.default)(r).getInstance({ BASE64: a, debug: n }), u.push(e), s = e; }, setProtectionData: function (e) { for (var t, n = 0; n < u.length; n++) { let r = u[n]; r.hasOwnProperty(`init`) && r.init((t = r.systemString, r = void 0, r = null, e && (r = t in e ? e[t] : null), r)); } }, isClearKey: function (e) { return e === o || e === s; }, initDataEquals: function (e, t) { if (e.byteLength !== t.byteLength) return !1; for (let n = new Uint8Array(e), r = new Uint8Array(t), i = 0; i < n.length; i++) if (n[i] !== r[i]) return !1; return !0; }, getKeySystems: function () { return u; }, setKeySystems: function (e) { u = e; }, getKeySystemBySystemString: function (e) { for (let t = 0; t < u.length; t++) if (u[t].systemString === e) return u[t]; return null; }, getSupportedKeySystemsFromContentProtection: function (e) { let t = void 0; let n = void 0; var r = void 0; let i = void 0; const a = []; if (e) for (var o, s = l.default.findCencContentProtection(e), r = 0; r < u.length; ++r) for (n = u[r], i = 0; i < e.length; ++i) { (t = e[i]).schemeIdUri.toLowerCase() === n.schemeIdURI && (o = n.getInitData(t, s), a.push({ ks: u[r], initData: o, cdmData: n.getCDMData(), sessionId: n.getSessionId(t) })); } return a; }, getSupportedKeySystems: function (e, t) { for (var n, r = [], i = l.default.parsePSSHList(e), a = void 0, o = 0; o < u.length; ++o)n = (a = u[o]).systemString, n = !t || n in t, a.uuid in i && n && r.push({ ks: a, initData: i[a.uuid], cdmData: a.getCDMData(), sessionId: a.getSessionId() }); return r; }, getLicenseServer: function (e, t, n) { return n === `license-release` || n === `individualization-request` ? null : (n = null, t && t.hasOwnProperty(`drmtoday`) ? n = (0, p.default)(r).getInstance({ BASE64: a }) : e.systemString === E.default.WIDEVINE_KEYSTEM_STRING ? n = (0, _.default)(r).getInstance() : e.systemString === E.default.PLAYREADY_KEYSTEM_STRING ? n = (0, g.default)(r).getInstance() : e.systemString === E.default.CLEARKEY_KEYSTEM_STRING && (n = (0, m.default)(r).getInstance()), n); }, processClearKeyLicenseRequest: function (e, t, n) { try { return e.getClearKeysFromProtectionData(t, n); } catch (e) { return i.error(`Failed to retrieve clearkeys from ProtectionData`), null; } }, setConfig: function (e) { e && (e.debug && (n = e.debug, i = n.getLogger(t)), e.BASE64 && (a = e.BASE64)); } }; }i.__dashjs_factory_name = `ProtectionKeyController`, n.default = dashjs.FactoryMaker.getSingletonFactory(i), t.exports = n.default; }, { 110: 110, 161: 161, 166: 166, 167: 167, 168: 168, 169: 169, 174: 174, 175: 175, 176: 176, 177: 177 }], 166: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const u = r(e(180)); const l = r(e(178)); const a = r(e(161)); var e = r(e(110)); const o = `e2719d58-a985-b3c9-781a-b030af78d30e`; const s = e.default.CLEARKEY_KEYSTEM_STRING; const c = `urn:uuid:${o}`; function i (e) { const i = (e = e || {}).BASE64; const f = { attributes: [`Laurl`, `laurl`], prefixes: [`clearkey`, `dashif`] }; return { uuid: o, schemeIdURI: c, systemString: s, getInitData: function (e, t) { try { let n; let r = a.default.parseInitDataFromContentProtection(e, i); return !r && t && (n = { kids: [(function (e) { try { let t = e.replace(/-/g, ``); return (t = btoa(t.match(/\w{2}/g).map((e) => { return String.fromCharCode(parseInt(e, 16)); }).join(``))).replace(/=/g, ``); } catch (e) { return null; } }(t[`cenc:default_KID`]))] }, r = (new TextEncoder()).encode(JSON.stringify(n))), r; } catch (e) { return null; } }, getRequestHeadersFromMessage: function () { return { "Content-Type": `application/json` }; }, getLicenseRequestFromMessage: function (e) { return JSON.parse(String.fromCharCode.apply(null, new Uint8Array(e))); }, getLicenseServerURLFromInitData: function () { return null; }, getCDMData: function () { return null; }, getSessionId: function () { return null; }, getLicenseServerUrlFromMediaInfo: function (e) { try { if (!e || e.length === 0) return null; for (var t = 0, n = null; t < e.length && !n;) { const r = e[t]; if (r && r.contentProtection && r.contentProtection.length > 0) { const i = r.contentProtection.filter((e) => { return e.schemeIdUri && e.schemeIdUri === c; }); if (i && i.length > 0) for (let a = 0; a < i.length && !n;) { for (let o = i[a], s = 0; s < f.attributes.length && !n;) { for (let u = 0, l = f.attributes[s]; u < f.prefixes.length && !n;) { const d = f.prefixes[u]; o[l] && o[l].__prefix && o[l].__prefix === d && o[l].__text && (n = o[l].__text), u += 1; }s += 1; }a += 1; } }t += 1; } return n; } catch (e) { return null; } }, getClearKeysFromProtectionData: function (e, t) { let n = null; if (e) { for (var r = JSON.parse(String.fromCharCode.apply(null, new Uint8Array(t))), i = [], a = 0; a < r.kids.length; a++) { const o = r.kids[a]; const s = e.clearkeys && e.clearkeys.hasOwnProperty(o) ? e.clearkeys[o] : null; if (!s) throw new Error(`DRM: ClearKey keyID (${o}) is not known!`); i.push(new u.default(o, s)); }n = new l.default(i); } return n; } }; }i.__dashjs_factory_name = `KeySystemClearKey`, n.default = dashjs.FactoryMaker.getSingletonFactory(i), t.exports = n.default; }, { 110: 110, 161: 161, 178: 178, 180: 180 }], 167: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const f = r(e(161)); var e = r(e(110)); const i = `9a04f079-9840-4286-ab92-e65be0885f95`; const a = e.default.PLAYREADY_KEYSTEM_STRING; let o = void 0; function s (e) { let s = `utf-16`; const l = (e = e || {}).BASE64; function d () { if (!l || !l.hasOwnProperty(`decodeArray`) || !l.hasOwnProperty(`decodeArray`)) throw new Error(`Missing config parameter(s)`); } return { uuid: i, schemeIdURI: `urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95`, systemString: a, getInitData: function (e) { let t; let n; const r = new Uint8Array([112, 115, 115, 104, 0, 0, 0, 0]); const i = new Uint8Array([154, 4, 240, 121, 152, 64, 66, 134, 171, 146, 230, 91, 224, 136, 95, 149]); let a = 0; let o = null; let s = void 0; let u = void 0; if (d(), !e) return null; if (`pssh` in e) return f.default.parseInitDataFromContentProtection(e, l); if (`pro` in e)o = l.decodeArray(e.pro.__text); else { if (!(`prheader` in e)) return null; o = l.decodeArray(e.prheader.__text); } return t = o.length, n = 4 + r.length + i.length + 4 + t, e = new ArrayBuffer(n), s = new Uint8Array(e), (u = new DataView(e)).setUint32(0, n), a += 4, s.set(r, 4), a += r.length, s.set(i, a), a += i.length, u.setUint32(a, t), a += 4, s.set(o, a), s.buffer; }, getRequestHeadersFromMessage: function (e) { for (var t = void 0, n = {}, r = new DOMParser(), e = new (s === `utf-16` ? Uint16Array : Uint8Array)(e), e = String.fromCharCode.apply(null, e), i = (t = r.parseFromString(e, `application/xml`)).getElementsByTagName(`name`), a = t.getElementsByTagName(`value`), o = 0; o < i.length; o++)n[i[o].childNodes[0].nodeValue] = a[o].childNodes[0].nodeValue; return n.hasOwnProperty(`Content`) && (n[`Content-Type`] = n.Content, delete n.Content), n.hasOwnProperty(`Content-Type`) || (n[`Content-Type`] = `text/xml; charset=utf-8`), n; }, getLicenseRequestFromMessage: function (e) { let t = null; const n = new DOMParser(); let r = new (s === `utf-16` ? Uint16Array : Uint8Array)(e); return d(), r = String.fromCharCode.apply(null, r), (r = n.parseFromString(r, `application/xml`)).getElementsByTagName(`PlayReadyKeyMessage`)[0] ? ((r = r.getElementsByTagName(`Challenge`)[0].childNodes[0].nodeValue) && (t = l.decode(r)), t) : e; }, getLicenseServerURLFromInitData: function (e) { if (e) for (let t = new DataView(e), n = t.getUint16(4, !0), r = 6, i = new DOMParser(), a = 0; a < n; a++) { var o = t.getUint16(r, !0); r += 2; const s = t.getUint16(r, !0); if (r += 2, o === 1) { var u = e.slice(r, r + s); var o = String.fromCharCode.apply(null, new Uint16Array(u)); var u = i.parseFromString(o, `application/xml`); if (u.getElementsByTagName(`LA_URL`)[0]) { o = u.getElementsByTagName(`LA_URL`)[0].childNodes[0].nodeValue; if (o) return o; } if (u.getElementsByTagName(`LUI_URL`)[0]) { u = u.getElementsByTagName(`LUI_URL`)[0].childNodes[0].nodeValue; if (u) return u; } } else r += s; } return null; }, getCDMData: function () { let e = void 0; let t = void 0; let n = void 0; let r = void 0; if (d(), o && o.cdmData) { for (e = [], r = 0; r < o.cdmData.length; ++r)e.push(o.cdmData.charCodeAt(r)), e.push(0); for (e = String.fromCharCode.apply(null, e), e = l.encode(e), t = `<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>`.replace(`%CUSTOMDATA%`, e), n = [], r = 0; r < t.length; ++r)n.push(t.charCodeAt(r)), n.push(0); return new Uint8Array(n).buffer; } return null; }, getSessionId: function (e) { return o && o.sessionId ? o.sessionId : e && e.sessionId ? e.sessionId : null; }, setPlayReadyMessageFormat: function (e) { if (e !== `utf-8` && e !== `utf-16`) throw new Error(`Specified message format is not one of "utf-8" or "utf-16"`); s = e; }, init: function (e) { e && (o = e); } }; }s.__dashjs_factory_name = `KeySystemPlayReady`, n.default = dashjs.FactoryMaker.getSingletonFactory(s), t.exports = n.default; }, { 110: 110, 161: 161 }], 168: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const l = r(e(180)); const d = r(e(178)); const i = r(e(161)); var e = r(e(110)); const a = `1077efec-c0b2-4d02-ace3-3c1e52e2fb4b`; const o = e.default.CLEARKEY_KEYSTEM_STRING; function s (e) { const t = e.BASE64; const u = e.debug.getLogger(void 0); return { uuid: a, schemeIdURI: `urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b`, systemString: o, getInitData: function (e) { return i.default.parseInitDataFromContentProtection(e, t); }, getRequestHeadersFromMessage: function () { return null; }, getLicenseRequestFromMessage: function (e) { return new Uint8Array(e); }, getLicenseServerURLFromInitData: function () { return null; }, getCDMData: function () { return null; }, getSessionId: function () { return null; }, getClearKeysFromProtectionData: function (e, t) { let n = null; if (e) { for (var r = JSON.parse(String.fromCharCode.apply(null, new Uint8Array(t))), i = [], a = 0; a < r.kids.length; a++) { const o = r.kids[a]; const s = e.clearkeys && e.clearkeys.hasOwnProperty(o) ? e.clearkeys[o] : null; if (!s) throw new Error(`DRM: ClearKey keyID (${o}) is not known!`); i.push(new l.default(o, s)); }n = new d.default(i), u.warn(`ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4`); } return n; } }; }s.__dashjs_factory_name = `KeySystemW3CClearKey`, n.default = dashjs.FactoryMaker.getSingletonFactory(s), t.exports = n.default; }, { 110: 110, 161: 161, 178: 178, 180: 180 }], 169: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(161)); var e = r(e(110)); const a = `edef8ba9-79d6-4ace-a3c8-27dcd51d21ed`; const o = e.default.WIDEVINE_KEYSTEM_STRING; function s (e) { let t = null; const n = (e = e || {}).BASE64; return { uuid: a, schemeIdURI: `urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed`, systemString: o, init: function (e) { e && (t = e); }, getInitData: function (e) { return i.default.parseInitDataFromContentProtection(e, n); }, getRequestHeadersFromMessage: function () { return null; }, getLicenseRequestFromMessage: function (e) { return new Uint8Array(e); }, getLicenseServerURLFromInitData: function () { return null; }, getCDMData: function () { return null; }, getSessionId: function (e) { return t && t.sessionId ? t.sessionId : e && e.sessionId ? e.sessionId : null; } }; }s.__dashjs_factory_name = `KeySystemWidevine`, n.default = dashjs.FactoryMaker.getSingletonFactory(s), t.exports = n.default; }, { 110: 110, 161: 161 }], 170: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(52); function o () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this), this.MEDIA_KEYERR_CODE = 100, this.MEDIA_KEYERR_UNKNOWN_CODE = 101, this.MEDIA_KEYERR_CLIENT_CODE = 102, this.MEDIA_KEYERR_SERVICE_CODE = 103, this.MEDIA_KEYERR_OUTPUT_CODE = 104, this.MEDIA_KEYERR_HARDWARECHANGE_CODE = 105, this.MEDIA_KEYERR_DOMAIN_CODE = 106, this.MEDIA_KEY_MESSAGE_ERROR_CODE = 107, this.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE = 108, this.SERVER_CERTIFICATE_UPDATED_ERROR_CODE = 109, this.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE = 110, this.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE = 111, this.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE = 112, this.KEY_SESSION_CREATED_ERROR_CODE = 113, this.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE = 114, this.MEDIA_KEYERR_UNKNOWN_MESSAGE = `An unspecified error occurred. This value is used for errors that don't match any of the other codes.`, this.MEDIA_KEYERR_CLIENT_MESSAGE = `The Key System could not be installed or updated.`, this.MEDIA_KEYERR_SERVICE_MESSAGE = `The message passed into update indicated an error from the license service.`, this.MEDIA_KEYERR_OUTPUT_MESSAGE = `There is no available output device with the required characteristics for the content protection system.`, this.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE = `A hardware configuration change caused a content protection error.`, this.MEDIA_KEYERR_DOMAIN_MESSAGE = `An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.`, this.MEDIA_KEY_MESSAGE_ERROR_MESSAGE = `Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!`, this.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE = `DRM: Empty key message from CDM`, this.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE = `Error updating server certificate -- `, this.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE = `DRM: KeyStatusChange error! -- License has expired`, this.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE = `DRM: No license server URL specified!`, this.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE = `DRM: KeySystem Access Denied! -- `, this.KEY_SESSION_CREATED_ERROR_MESSAGE = `DRM: unable to create session! --`, this.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE = `DRM: licenser error! --`; }e = new ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o)(); n.default = e, t.exports = n.default; }, { 52: 52 }], 171: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const v = r(e(165)); const T = r(e(184)); const S = r(e(232)); const A = r(e(179)); const I = r(e(182)); const R = r(e(181)); const b = r(e(170)); function i (e) { e = e || {}; const t = this.context; const h = e.eventBus; const p = e.events; const n = e.debug; const i = e.api; const a = e.errHandler; let r = void 0; let o = void 0; let g = void 0; let s = void 0; let _ = void 0; let u = void 0; let l = void 0; let d = void 0; let f = void 0; function c () { g && y(); for (let e = 0; e < l.length; e++)m(l[e]); h.trigger(p.TEARDOWN_COMPLETE); } function m (t) { try { g[i.cancelKeyRequest](s.systemString, t.sessionID); } catch (e) { h.trigger(p.KEY_SESSION_CLOSED, { data: null, error: `Error closing session (${t.sessionID}) ${e.message}` }); } } function E (e, t) { if (t && e) { for (let n = e.length, r = 0; r < n; r++) if (e[r].sessionID == t) return e[r]; return null; } return null; } function y () { g.removeEventListener(i.keyerror, f), g.removeEventListener(i.needkey, f), g.removeEventListener(i.keymessage, f), g.removeEventListener(i.keyadded, f); } return r = { getAllInitData: function () { for (var e = [], t = 0; t < u.length; t++)e.push(u[t].initData); for (t = 0; t < l.length; t++)e.push(l[t].initData); return e; }, requestKeySystemAccess: function (e) { for (var t = (t = g) || document.createElement(`video`), n = !1, r = 0; r < e.length; r++) for (let i = e[r].ks.systemString, a = e[r].configs, o = null, s = null, u = 0; u < a.length; u++) { const l = a[u].videoCapabilities; if (l && l.length !== 0) { s = []; for (let d = 0; d < l.length; d++)t.canPlayType(l[d].contentType, i) !== `` && s.push(l[d]); } if (s && (!s || s.length !== 0)) { n = !0; const f = new I.default(o, s); const c = _.getKeySystemBySystemString(i); h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE, { data: new R.default(c, f) }); break; } }n || h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE, { error: `Key system access denied! -- No valid audio/video content configurations detected!` }); }, getKeySystem: function () { return s; }, selectKeySystem: function (e) { s = e.keySystem, h.trigger(p.INTERNAL_KEY_SYSTEM_SELECTED); }, setMediaElement: function (e) { if (g !== e) { if (g) { y(); for (let t = 0; t < l.length; t++)m(l[t]); l = []; }(g = e) && (g.addEventListener(i.keyerror, f), g.addEventListener(i.needkey, f), g.addEventListener(i.keymessage, f), g.addEventListener(i.keyadded, f), h.trigger(p.VIDEO_ELEMENT_SELECTED)); } }, createKeySession: function (e) { if (!s) throw new Error(`Can not create sessions until you have selected a key system`); if (d || l.length === 0) { const t = { sessionID: null, initData: e, getSessionID: function () { return this.sessionID; }, getExpirationTime: function () { return NaN; }, getSessionType: function () { return `temporary`; } }; return u.push(t), g[i.generateKeyRequest](s.systemString, new Uint8Array(e)), t; } throw new Error(`Multiple sessions not allowed!`); }, updateKeySession: function (e, t) { const n = e.sessionID; if (_.isClearKey(s)) for (let r = 0; r < t.keyPairs.length; r++)g[i.addKey](s.systemString, t.keyPairs[r].key, t.keyPairs[r].keyID, n); else g[i.addKey](s.systemString, new Uint8Array(t), new Uint8Array(e.initData), n); }, closeKeySession: m, setServerCertificate: function () {}, loadKeySession: function () {}, removeKeySession: function () {}, stop: c, reset: c }, o = n.getLogger(r), u = [], l = [], _ = (s = g = null, v.default)(t).getInstance(), f = { handleEvent: function (e) { let t = null; switch (e.type) { case i.needkey:var n = ArrayBuffer.isView(e.initData) ? e.initData.buffer : e.initData; h.trigger(p.NEED_KEY, { key: new T.default(n, `cenc`) }); break; case i.keyerror:if (t = (t = E(l, e.sessionId)) || E(u, e.sessionId)) { var n = b.default.MEDIA_KEYERR_CODE; var r = ``; switch (e.errorCode.code) { case 1:n = b.default.MEDIA_KEYERR_UNKNOWN_CODE, r += `MEDIA_KEYERR_UNKNOWN - ${b.default.MEDIA_KEYERR_UNKNOWN_MESSAGE}`; break; case 2:n = b.default.MEDIA_KEYERR_CLIENT_CODE, r += `MEDIA_KEYERR_CLIENT - ${b.default.MEDIA_KEYERR_CLIENT_MESSAGE}`; break; case 3:n = b.default.MEDIA_KEYERR_SERVICE_CODE, r += `MEDIA_KEYERR_SERVICE - ${b.default.MEDIA_KEYERR_SERVICE_MESSAGE}`; break; case 4:n = b.default.MEDIA_KEYERR_OUTPUT_CODE, r += `MEDIA_KEYERR_OUTPUT - ${b.default.MEDIA_KEYERR_OUTPUT_MESSAGE}`; break; case 5:n = b.default.MEDIA_KEYERR_HARDWARECHANGE_CODE, r += `MEDIA_KEYERR_HARDWARECHANGE - ${b.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE}`; break; case 6:n = b.default.MEDIA_KEYERR_DOMAIN_CODE, r += `MEDIA_KEYERR_DOMAIN - ${b.default.MEDIA_KEYERR_DOMAIN_MESSAGE}`; }r += `  System Code = ${e.systemCode}`, h.trigger(p.KEY_ERROR, { data: new S.default(n, r, t) }); } else o.error(`No session token found for key error`); break; case i.keyadded:(t = (t = E(l, e.sessionId)) || E(u, e.sessionId)) ? (o.debug(`DRM: Key added.`), h.trigger(p.KEY_ADDED, { data: t })) : o.debug(`No session token found for key added`); break; case i.keymessage:(d = e.sessionId !== null && void 0 !== e.sessionId) ? !(t = E(l, e.sessionId)) && u.length > 0 && (t = u.shift(), l.push(t), t.sessionID = e.sessionId, h.trigger(p.KEY_SESSION_CREATED, { data: t })) : u.length > 0 && (t = u.shift(), l.push(t), u.length !== 0 && a.error(new S.default(b.default.MEDIA_KEY_MESSAGE_ERROR_CODE, b.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))), t ? (r = ArrayBuffer.isView(e.message) ? e.message.buffer : e.message, t.keyMessage = r, h.trigger(p.INTERNAL_KEY_MESSAGE, { data: new A.default(t, r, e.defaultURL) })) : o.warn(`No session token found for key message`); } } }, r; }i.__dashjs_factory_name = `ProtectionModel_01b`, n.default = dashjs.FactoryMaker.getClassFactory(i), t.exports = n.default; }, { 165: 165, 170: 170, 179: 179, 181: 181, 182: 182, 184: 184, 232: 232 }], 172: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const m = r(e(165)); const E = r(e(184)); const y = r(e(170)); const v = r(e(232)); const T = r(e(179)); const S = r(e(181)); const A = r(e(110)); function i (e) { e = e || {}; const t = this.context; const o = e.eventBus; const s = e.events; const n = e.debug; let r = void 0; let u = void 0; let l = void 0; let i = void 0; let d = void 0; let f = void 0; let a = void 0; let c = void 0; function h (e) { const t = e.session; return t.removeEventListener(`keystatuseschange`, e), t.removeEventListener(`message`, e), t.close(); } function p (e) { for (let t = 0; t < f.length; t++) if (f[t] === e) { f.splice(t, 1); break; } } function g (e) { let t = void 0; let n = void 0; return e && e.length > 0 && (e[0] && (typeof e[0] === `string` ? t = e[0] : n = e[0]), e[1] && (typeof e[1] === `string` ? t = e[1] : n = e[1])), { status: t, keyId: n }; } function _ (t, e, n, r) { const i = { session: t, initData: e, sessionId: r, handleEvent: function (e) { switch (e.type) { case `keystatuseschange`:o.trigger(s.KEY_STATUSES_CHANGED, { data: this }), e.target.keyStatuses.forEach(function () { const e = g(arguments); e.status === `expired` ? o.trigger(s.INTERNAL_KEY_STATUS_CHANGED, { error: new v.default(y.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE, y.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE) }) : o.trigger(s.INTERNAL_KEY_STATUS_CHANGED, e); }); break; case `message`:var t = ArrayBuffer.isView(e.message) ? e.message.buffer : e.message; o.trigger(s.INTERNAL_KEY_MESSAGE, { data: new T.default(this, t, void 0, e.messageType) }); } }, getSessionID: function () { return t.sessionId; }, getExpirationTime: function () { return t.expiration; }, getKeyStatuses: function () { return t.keyStatuses; }, getUsable: function () { let e = !1; return t.keyStatuses.forEach(function () { g(arguments).status === `usable` && (e = !0); }), e; }, getSessionType: function () { return n; } }; return t.addEventListener(`keystatuseschange`, i), t.addEventListener(`message`, i), t.closed.then(() => { p(i), u.debug(`DRM: Session closed.  SessionID = ${i.getSessionID()}`), o.trigger(s.KEY_SESSION_CLOSED, { data: i.getSessionID() }); }), f.push(i), i; } return r = { getAllInitData: function () { for (var e = [], t = 0; t < f.length; t++)f[t].initData && e.push(f[t].initData); return e; }, requestKeySystemAccess: function (e) { !(function i (a, e) { if (void 0 === navigator.requestMediaKeySystemAccess || typeof navigator.requestMediaKeySystemAccess !== `function`) return void o.trigger(s.KEY_SYSTEM_ACCESS_COMPLETE, { error: `Insecure origins are not allowed` }); !(function (t) { const n = a[t].ks; const e = a[t].configs; let r = n.systemString; r === A.default.PLAYREADY_KEYSTEM_STRING && e[0].persistentState === `required` && (r += `.recommendation`), navigator.requestMediaKeySystemAccess(r, e).then((e) => { var t = typeof e.getConfiguration === `function` ? e.getConfiguration() : null; var t = new S.default(n, t); t.mksa = e, o.trigger(s.KEY_SYSTEM_ACCESS_COMPLETE, { data: t }); }).catch((e) => { ++t < a.length ? i(a, t) : o.trigger(s.KEY_SYSTEM_ACCESS_COMPLETE, { error: `Key system access denied! ${e.message}` }); }); }(e)); }(e, 0)); }, getKeySystem: function () { return l; }, selectKeySystem: function (t) { t.mksa.createMediaKeys().then((e) => { l = t.keySystem, d = e, i ? i.setMediaKeys(d).then(() => { o.trigger(s.INTERNAL_KEY_SYSTEM_SELECTED); }) : o.trigger(s.INTERNAL_KEY_SYSTEM_SELECTED); }).catch(() => { o.trigger(s.INTERNAL_KEY_SYSTEM_SELECTED, { error: `Error selecting keys system (${t.keySystem.systemString})! Could not create MediaKeys -- TODO` }); }); }, setMediaElement: function (e) { i !== e && (i && (i.removeEventListener(`encrypted`, a), i.setMediaKeys && i.setMediaKeys(null)), (i = e) && (i.addEventListener(`encrypted`, a), i.setMediaKeys && d && i.setMediaKeys(d))); }, setServerCertificate: function (e) { if (!l || !d) throw new Error(`Can not set server certificate until you have selected a key system`); d.setServerCertificate(e).then(() => { u.info(`DRM: License server certificate successfully updated.`), o.trigger(s.SERVER_CERTIFICATE_UPDATED); }).catch((e) => { o.trigger(s.SERVER_CERTIFICATE_UPDATED, { error: new v.default(y.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE, y.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE + e.name) }); }); }, createKeySession: function (e, t, n) { if (!l || !d) throw new Error(`Can not create sessions until you have selected a key system`); const r = d.createSession(n); const i = _(r, e, n); var t = this.getKeySystem().systemString === A.default.CLEARKEY_KEYSTEM_STRING && (e || t && t.clearkeys) ? `keyids` : `cenc`; r.generateRequest(t, e).then(() => { u.debug(`DRM: Session created.  SessionID = ${i.getSessionID()}`), o.trigger(s.KEY_SESSION_CREATED, { data: i }); }).catch((e) => { p(i), o.trigger(s.KEY_SESSION_CREATED, { data: null, error: new v.default(y.default.KEY_SESSION_CREATED_ERROR_CODE, `${y.default.KEY_SESSION_CREATED_ERROR_MESSAGE}Error generating key request -- ${e.name}`) }); }); }, updateKeySession: function (t, e) { const n = t.session; c.isClearKey(l) && (e = e.toJWK()), n.update(e).catch((e) => { o.trigger(s.KEY_ERROR, { data: new v.default(y.default.MEDIA_KEYERR_CODE, `Error sending update() message! ${e.name}`, t) }); }); }, loadKeySession: function (t, e, n) { if (!l || !d) throw new Error(`Can not load sessions until you have selected a key system`); for (let r = 0; r < f.length; r++) if (t === f[r].sessionId) return void u.warn(`DRM: Ignoring session ID because we have already seen it!`); const i = d.createSession(n); const a = _(i, e, n, t); i.load(t).then((e) => { e ? (u.debug(`DRM: Session loaded.  SessionID = ${a.getSessionID()}`), o.trigger(s.KEY_SESSION_CREATED, { data: a })) : (p(a), o.trigger(s.KEY_SESSION_CREATED, { data: null, error: new v.default(y.default.KEY_SESSION_CREATED_ERROR_CODE, `${y.default.KEY_SESSION_CREATED_ERROR_MESSAGE}Could not load session! Invalid Session ID (${t})`) })); }).catch((e) => { p(a), o.trigger(s.KEY_SESSION_CREATED, { data: null, error: new v.default(y.default.KEY_SESSION_CREATED_ERROR_CODE, `${y.default.KEY_SESSION_CREATED_ERROR_MESSAGE}Could not load session (${t})! ${e.name}`) }); }); }, removeKeySession: function (t) { t.session.remove().then(() => { u.debug(`DRM: Session removed.  SessionID = ${t.getSessionID()}`), o.trigger(s.KEY_SESSION_REMOVED, { data: t.getSessionID() }); }, (e) => { o.trigger(s.KEY_SESSION_REMOVED, { data: null, error: `Error removing session (${t.getSessionID()}). ${e.name}` }); }); }, closeKeySession: function (t) { h(t).catch((e) => { p(t), o.trigger(s.KEY_SESSION_CLOSED, { data: null, error: `Error closing session (${t.getSessionID()}) ${e.name}` }); }); }, stop: function () { for (var e = void 0, t = 0; t < f.length; t++)(e = f[t]).getUsable() || h(e).catch(() => { p(e); }); }, reset: function () { const n = f.length; let r = void 0; n !== 0 ? (function () { for (var t = function (e) { p(e), f.length === 0 && (i ? (i.removeEventListener(`encrypted`, a), i.setMediaKeys(null).then(() => { o.trigger(s.TEARDOWN_COMPLETE); })) : o.trigger(s.TEARDOWN_COMPLETE)); }, e = 0; e < n; e++)!(function (e) { r.session.closed.then(() => { t(e); }), h(r).catch(() => { t(e); }); }(r = f[e])); }()) : o.trigger(s.TEARDOWN_COMPLETE); } }, u = n.getLogger(r), f = [], c = (d = i = l = null, m.default)(t).getInstance(), a = { handleEvent: function (e) { let t; e.type === `encrypted` && e.initData && (t = ArrayBuffer.isView(e.initData) ? e.initData.buffer : e.initData, o.trigger(s.NEED_KEY, { key: new E.default(t, e.initDataType) })); } }, r; }i.__dashjs_factory_name = `ProtectionModel_21Jan2015`, n.default = dashjs.FactoryMaker.getClassFactory(i), t.exports = n.default; }, { 110: 110, 165: 165, 170: 170, 179: 179, 181: 181, 184: 184, 232: 232 }], 173: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const E = r(e(165)); const y = r(e(184)); const v = r(e(232)); const T = r(e(170)); const S = r(e(179)); const A = r(e(182)); const I = r(e(181)); function i (e) { e = e || {}; const t = this.context; const p = e.eventBus; const g = e.events; const n = e.debug; const _ = e.api; let r = void 0; let a = void 0; let i = void 0; let o = void 0; let s = void 0; let u = void 0; let l = void 0; let d = void 0; let m = void 0; function f () { try { for (let e = 0; e < l.length; e++)c(l[e]); i && i.removeEventListener(_.needkey, d), p.trigger(g.TEARDOWN_COMPLETE); } catch (e) { p.trigger(g.TEARDOWN_COMPLETE, { error: `Error tearing down key sessions and MediaKeys! -- ${e.message}` }); } } function c (e) { const t = e.session; t.removeEventListener(_.error, e), t.removeEventListener(_.message, e), t.removeEventListener(_.ready, e), t.removeEventListener(_.close, e); for (let n = 0; n < l.length; n++) if (l[n] === e) { l.splice(n, 1); break; }t[_.release](); } function h () { function e () { i.removeEventListener(`loadedmetadata`, t), i[_.setMediaKeys](s), p.trigger(g.VIDEO_ELEMENT_SELECTED); } var t = null; i.readyState >= 1 ? e() : (t = e.bind(this), i.addEventListener(`loadedmetadata`, t)); } return r = { getAllInitData: function () { for (var e = [], t = 0; t < l.length; t++)e.push(l[t].initData); return e; }, requestKeySystemAccess: function (e) { for (var t = !1, n = 0; n < e.length; n++) for (let r = e[n].ks.systemString, i = e[n].configs, a = null, o = null, s = 0; s < i.length; s++) { const u = i[s].audioCapabilities; const l = i[s].videoCapabilities; if (u && u.length !== 0) { a = []; for (let d = 0; d < u.length; d++)window[_.MediaKeys].isTypeSupported(r, u[d].contentType) && a.push(u[d]); } if (l && l.length !== 0) { o = []; for (let f = 0; f < l.length; f++)window[_.MediaKeys].isTypeSupported(r, l[f].contentType) && o.push(l[f]); } if (!(!a && !o || a && a.length === 0 || o && o.length === 0)) { t = !0; const c = new A.default(a, o); const h = m.getKeySystemBySystemString(r); p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE, { data: new I.default(h, c) }); break; } }t || p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE, { error: `Key system access denied! -- No valid audio/video content configurations detected!` }); }, getKeySystem: function () { return o; }, selectKeySystem: function (e) { try { s = e.mediaKeys = new window[_.MediaKeys](e.keySystem.systemString), o = e.keySystem, u = e, i && h(), p.trigger(g.INTERNAL_KEY_SYSTEM_SELECTED); } catch (e) { p.trigger(g.INTERNAL_KEY_SYSTEM_SELECTED, { error: `Error selecting keys system (${o.systemString})! Could not create MediaKeys -- TODO` }); } }, setMediaElement: function (e) { i !== e && (i && i.removeEventListener(_.needkey, d), (i = e) && (i.addEventListener(_.needkey, d), s && h())); }, createKeySession: function (e, t, n, r) { if (!o || !s || !u) throw new Error(`Can not create sessions until you have selected a key system`); let i = null; if (u.ksConfiguration.videoCapabilities && u.ksConfiguration.videoCapabilities.length > 0 && (i = u.ksConfiguration.videoCapabilities[0]), i === null && u.ksConfiguration.audioCapabilities && u.ksConfiguration.audioCapabilities.length > 0 && (i = u.ksConfiguration.audioCapabilities[0]), i === null) throw new Error(`Can not create sessions for unknown content types.`); i = i.contentType, r = s.createSession(i, new Uint8Array(e), r ? new Uint8Array(r) : null), e = { session: r, initData: e, getSessionID: function () { return this.session.sessionId; }, getExpirationTime: function () { return NaN; }, getSessionType: function () { return `temporary`; }, handleEvent: function (e) { switch (e.type) { case _.error:p.trigger(g.KEY_ERROR, { data: new v.default(T.default.MEDIA_KEYERR_CODE, `KeyError`, this) }); break; case _.message:var t = ArrayBuffer.isView(e.message) ? e.message.buffer : e.message; p.trigger(g.INTERNAL_KEY_MESSAGE, { data: new S.default(this, t, e.destinationURL) }); break; case _.ready:a.debug(`DRM: Key added.`), p.trigger(g.KEY_ADDED); break; case _.close:a.debug(`DRM: Session closed.  SessionID = ${this.getSessionID()}`), p.trigger(g.KEY_SESSION_CLOSED, { data: this.getSessionID() }); } } }, r.addEventListener(_.error, e), r.addEventListener(_.message, e), r.addEventListener(_.ready, e), r.addEventListener(_.close, e), l.push(e), a.debug(`DRM: Session created.  SessionID = ${e.getSessionID()}`), p.trigger(g.KEY_SESSION_CREATED, { data: e }); }, updateKeySession: function (e, t) { e = e.session, m.isClearKey(o) ? e.update(new Uint8Array(t.toJWK())) : e.update(new Uint8Array(t)); }, closeKeySession: c, setServerCertificate: function () {}, loadKeySession: function () {}, removeKeySession: function () {}, stop: f, reset: f }, a = n.getLogger(r), l = [], m = (u = s = o = i = null, E.default)(t).getInstance(), d = { handleEvent: function (e) { e.type === _.needkey && e.initData && (e = ArrayBuffer.isView(e.initData) ? e.initData.buffer : e.initData, p.trigger(g.NEED_KEY, { key: new y.default(e, `cenc`) })); } }, r; }i.__dashjs_factory_name = `ProtectionModel_3Feb2014`, n.default = dashjs.FactoryMaker.getClassFactory(i), t.exports = n.default; }, { 165: 165, 170: 170, 179: 179, 181: 181, 182: 182, 184: 184, 232: 232 }], 174: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const a = r(e(180)); const o = r(e(178)); function i () { return { getServerURLFromMessage: function (e) { return e; }, getHTTPMethod: function () { return `POST`; }, getResponseType: function () { return `json`; }, getLicenseMessage: function (e) { if (!e.hasOwnProperty(`keys`)) return null; for (var t = [], n = 0; n < e.keys.length; n++) { var r = e.keys[n]; const i = r.kid.replace(/=/g, ``); var r = r.k.replace(/=/g, ``); t.push(new a.default(i, r)); } return new o.default(t); }, getErrorResponse: function (e) { return String.fromCharCode.apply(null, new Uint8Array(e)); } }; }i.__dashjs_factory_name = `ClearKey`, n.default = dashjs.FactoryMaker.getSingletonFactory(i), t.exports = n.default; }, { 178: 178, 180: 180 }], 175: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(110); const a = (r = i) && r.__esModule ? r : { default: r }; function o (e) { const n = (e = e || {}).BASE64; const r = {}; r[a.default.WIDEVINE_KEYSTEM_STRING] = { responseType: `json`, getLicenseMessage: function (e) { return n.decodeArray(e.license); }, getErrorResponse: function (e) { return e; } }, r[a.default.PLAYREADY_KEYSTEM_STRING] = { responseType: `arraybuffer`, getLicenseMessage: function (e) { return e; }, getErrorResponse: function (e) { return String.fromCharCode.apply(null, new Uint8Array(e)); } }; return { getServerURLFromMessage: function (e) { return e; }, getHTTPMethod: function () { return `POST`; }, getResponseType: function (e) { return r[e].responseType; }, getLicenseMessage: function (e, t) { return (function () { if (!n || !n.hasOwnProperty(`decodeArray`)) throw new Error(`Missing config parameter(s)`); }()), r[t].getLicenseMessage(e); }, getErrorResponse: function (e, t) { return r[t].getErrorResponse(e); } }; }o.__dashjs_factory_name = `DRMToday`, n.default = dashjs.FactoryMaker.getSingletonFactory(o), t.exports = n.default; }, { 110: 110 }], 176: [function (e, t, n) { "use strict"; function r () { const s = `http://schemas.xmlsoap.org/soap/envelope/`; function u (e) { e = String.fromCharCode.apply(null, new Uint8Array(e)); return decodeURIComponent(escape(e)); } return { getServerURLFromMessage: function (e) { return e; }, getHTTPMethod: function () { return `POST`; }, getResponseType: function () { return `arraybuffer`; }, getLicenseMessage: function (e) { return (function (e) { if (window.DOMParser) { var t = u(e); var t = (new window.DOMParser()).parseFromString(t, `text/xml`); var t = t ? t.getElementsByTagNameNS(s, `Envelope`)[0] : null; var t = t ? t.getElementsByTagNameNS(s, `Body`)[0] : null; if (t ? t.getElementsByTagNameNS(s, `Fault`)[0] : null) return null; } return e; }.call(this, e)); }, getErrorResponse: function (e) { return (function (e) { let t = ``; let n = ``; let r = ``; if (window.DOMParser) { const i = u(e); var a = (new window.DOMParser()).parseFromString(i, `text/xml`); var o = a ? a.getElementsByTagNameNS(s, `Envelope`)[0] : null; var e = o ? o.getElementsByTagNameNS(s, `Body`)[0] : null; var a = e ? e.getElementsByTagNameNS(s, `Fault`)[0] : null; var o = a ? a.getElementsByTagName(`detail`)[0] : null; var e = o ? o.getElementsByTagName(`Exception`)[0] : null; var o = null; if (a === null) return i; t = (o = a.getElementsByTagName(`faultstring`)[0].firstChild) ? o.nodeValue : null, e !== null && (n = (o = e.getElementsByTagName(`StatusCode`)[0]) ? o.firstChild.nodeValue : null, e = (r = (o = e.getElementsByTagName(`Message`)[0]) ? o.firstChild.nodeValue : null) ? r.lastIndexOf(`[`) + 1 : -1, o = r ? r.indexOf(`]`) : -1, r = r ? r.substring(e, o) : ``); } return t = `code: ${n}, name: ${t}`, r && (t += `, message: ${r}`), t; }.call(this, e)); } }; }Object.defineProperty(n, `__esModule`, { value: !0 }), r.__dashjs_factory_name = `PlayReady`, n.default = dashjs.FactoryMaker.getSingletonFactory(r), t.exports = n.default; }, {}], 177: [function (e, t, n) { "use strict"; function r () { return { getServerURLFromMessage: function (e) { return e; }, getHTTPMethod: function () { return `POST`; }, getResponseType: function () { return `arraybuffer`; }, getLicenseMessage: function (e) { return e; }, getErrorResponse: function (e) { return String.fromCharCode.apply(null, new Uint8Array(e)); } }; }Object.defineProperty(n, `__esModule`, { value: !0 }), r.__dashjs_factory_name = `Widevine`, n.default = dashjs.FactoryMaker.getSingletonFactory(r), t.exports = n.default; }, {}], 178: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, [{ key: `toJWK`, value: function () { for (var e = void 0, t = this.keyPairs.length, n = { keys: [] }, e = 0; e < t; e++) { const r = { kty: `oct`, alg: `A128KW`, kid: this.keyPairs[e].keyID, k: this.keyPairs[e].key }; n.keys.push(r); } this.type && (n.type = this.type); const i = JSON.stringify(n); const a = i.length; const o = new ArrayBuffer(a); const s = new Uint8Array(o); for (e = 0; e < a; e++)s[e] = i.charCodeAt(e); return o; } }])), a); function a (e, t) { if (!(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)), t && t !== `persistent` && t !== `temporary`) throw new Error(`Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'`); this.keyPairs = e, this.type = t; }n.default = i, t.exports = n.default; }, {}], 179: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function i (e, t, n, r) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, i)), this.sessionToken = e, this.message = t, this.defaultURL = n, this.messageType = r || `license-request`; }n.default = i, t.exports = n.default; }, {}], 180: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r (e, t) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.keyID = e, this.key = t; }n.default = r, t.exports = n.default; }, {}], 181: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r (e, t) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.keySystem = e, this.ksConfiguration = t; }n.default = r, t.exports = n.default; }, {}], 182: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function a (e, t, n, r, i) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)), this.initDataTypes = [`cenc`], e && e.length && (this.audioCapabilities = e), t && t.length && (this.videoCapabilities = t), this.distinctiveIdentifier = n, this.persistentState = r, this.sessionTypes = i; }n.default = a, t.exports = n.default; }, {}], 183: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r (e, t) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.contentType = e, this.robustness = t; }n.default = r, t.exports = n.default; }, {}], 184: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r (e, t) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.initData = e, this.initDataType = t; }n.default = r, t.exports = n.default; }, {}], 185: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a () { let i = []; let a = 0; let o = 0; return { push: function (e, t) { let n = t && t.droppedVideoFrames ? t.droppedVideoFrames : 0; const r = t && t.totalVideoFrames ? t.totalVideoFrames : 0; var t = n - a; a = n, n = r - o, o = r, isNaN(e) || (i[e] ? (i[e].droppedVideoFrames += t, i[e].totalVideoFrames += n) : i[e] = { droppedVideoFrames: t, totalVideoFrames: n }); }, getFrameHistory: function () { return i; }, reset: function (e) { i = [], a = e.droppedVideoFrames, o = e.totalVideoFrames; } }; }a.__dashjs_factory_name = `DroppedFramesHistory`; e = e.default.getClassFactory(a); n.default = e, t.exports = n.default; }, { 47: 47 }], 186: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a (e) { const t = (e = e || {}).abrController; const n = e.switchHistory; const r = e.droppedFramesHistory; const i = e.currentRequest; const a = e.useBufferOccupancyABR; const o = e.useL2AABR; const s = e.useLoLPABR; const u = e.streamProcessor ? e.streamProcessor.getScheduleController() : null; const l = e.streamProcessor ? e.streamProcessor.getRepresentationInfo() : null; const d = e.videoModel ? e.videoModel : null; function f () { return l ? l.mediaInfo : null; } return { getMediaType: function () { const e = f(); return e ? e.type : null; }, getMediaInfo: f, getDroppedFramesHistory: function () { return r; }, getCurrentRequest: function () { return i; }, getSwitchHistory: function () { return n; }, getStreamInfo: function () { const e = f(); return e ? e.streamInfo : null; }, getScheduleController: function () { return u; }, getAbrController: function () { return t; }, getRepresentationInfo: function () { return l; }, useBufferOccupancyABR: function () { return a; }, useL2AABR: function () { return o; }, useLoLPABR: function () { return s; }, getVideoModel: function () { return d; } }; }a.__dashjs_factory_name = `RulesContext`, n.default = e.default.getClassFactory(a), t.exports = n.default; }, { 47: 47 }], 187: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); const a = (r = i) && r.__esModule ? r : { default: r }; const o = { DEFAULT: 0.5, STRONG: 1, WEAK: 0 }; function s (e, t, n) { let r; return { quality: void 0 === e ? -1 : e, reason: void 0 === t ? null : t, priority: (r = n) !== o.DEFAULT && r !== o.STRONG && r !== o.WEAK ? o.DEFAULT : r }; }s.__dashjs_factory_name = `SwitchRequest`; e = a.default.getClassFactory(s); e.NO_CHANGE = -1, e.PRIORITY = o, a.default.updateClassFactory(s.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 47: 47 }], 188: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const o = r(e(187)); function a () { let i = []; let a = []; return { push: function (e) { e.newValue === o.default.NO_CHANGE && (e.newValue = e.oldValue), i[e.oldValue] || (i[e.oldValue] = { noDrops: 0, drops: 0, dropSize: 0 }); const t = (r = e.newValue - e.oldValue) < 0 ? 1 : 0; let n = t ? -r : 0; var r = t ? 0 : 1; i[e.oldValue].drops += t, i[e.oldValue].dropSize += n, i[e.oldValue].noDrops += r, a.push({ idx: e.oldValue, noDrop: r, drop: t, dropSize: n }), a.length > 8 && (n = a.shift(), i[n.idx].drops -= n.drop, i[n.idx].dropSize -= n.dropSize, i[n.idx].noDrops -= n.noDrop); }, getSwitchRequests: function () { return i; }, reset: function () { i = [], a = []; } }; }a.__dashjs_factory_name = `SwitchRequestHistory`; i = i.default.getClassFactory(a); n.default = i, t.exports = n.default; }, { 187: 187, 47: 47 }], 189: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const v = r(e(108)); var e = r(e(47)); function i (e) { const s = 3; const u = 4; const l = 4; const d = 1.3; const f = 1.3; const c = (e = e || {}).settings; let h = void 0; let p = void 0; let g = void 0; let _ = void 0; let m = void 0; function E (e, t, n, r) { const i = Math.pow(0.5, n / r.fast); e.fastEstimate = (1 - i) * t + i * e.fastEstimate; r = Math.pow(0.5, n / r.slow); e.slowEstimate = (1 - r) * t + r * e.slowEstimate, e.totalWeight += n; } function n (e, t, n) { return c.get().streaming.abr.movingAverageMethod !== v.default.MOVING_AVERAGE_SLIDING_WINDOW ? (function (e, t) { let n = e ? m.throughputHalfLife : m.latencyHalfLife; const r = (e ? g : _)[t]; if (!r || r.totalWeight <= 0) return NaN; t = r.fastEstimate / (1 - Math.pow(0.5, r.totalWeight / n.fast)), n = r.slowEstimate / (1 - Math.pow(0.5, r.totalWeight / n.slow)); return e ? Math.min(t, n) : Math.max(t, n); }(e, t)) : (function (e, t, n) { n = (function (e, t, n) { let r = void 0; var i = void 0; var i = e ? (r = h[t], n ? s : u) : (r = p[t], l); if (r) { if (i >= r.length)i = r.length; else if (e) for (let a = 1; a < i; ++a) { const o = r[r.length - a] / r[r.length - a - 1]; if ((f <= o || o <= 1 / d) && (i += 1) === r.length) break; } } else i = 0; return i; }(e, t, n)), t = (e ? h : p)[t]; return n !== 0 && t && t.length !== 0 ? (t = t.slice(-n)).reduce((e, t) => { return e + t; }) / t.length : NaN; }(e, t, n)); } function r (e, t) { return n(!0, e, t); } function y (e) { h[e] = h[e] || [], p[e] = p[e] || [], g[e] = g[e] || { fastEstimate: 0, slowEstimate: 0, totalWeight: 0 }, _[e] = _[e] || { fastEstimate: 0, slowEstimate: 0, totalWeight: 0 }; } function t () { h = {}, p = {}, g = {}, _ = {}; }e = { push: function (e, t, n) { if (t.trace && t.trace.length) { const r = t.tresponse.getTime() - t.trequest.getTime() || 1; const i = t._tfinish.getTime() - t.tresponse.getTime() || 1; let a = t.trace.reduce((e, t) => { return e + t.b[0]; }, 0); var o = void 0; var o = c.get().streaming.lowLatencyEnabled ? t.trace.reduce((e, t) => { return e + t.d; }, 0) : n ? i : r + i; var n = Math.round(8 * a / o); if (y(e), a = i, (o = e) === v.default.VIDEO ? a < c.get().streaming.cacheLoadThresholds[v.default.VIDEO] : o === v.default.AUDIO && a < c.get().streaming.cacheLoadThresholds[v.default.AUDIO]) { if (h[e].length > 0 && !h[e].hasCachedEntries) return; h[e].hasCachedEntries = !0; } else h[e] && h[e].hasCachedEntries && (delete h[a = e], delete p[a], delete g[a], delete _[a], y(a)); h[e].push(n), h[e].length > 20 && h[e].shift(), p[e].push(r), p[e].length > 20 && p[e].shift(), E(g[e], n, 0.001 * i, m.throughputHalfLife), E(_[e], r, 1, m.latencyHalfLife); } }, getAverageThroughput: r, getSafeAverageThroughput: function (e, t) { return t = r(e, t), isNaN(t) || (t *= c.get().streaming.abr.bandwidthSafetyFactor), t; }, getAverageLatency: function (e) { return n(!1, e); }, reset: t }; return m = { throughputHalfLife: { fast: 3, slow: 8 }, latencyHalfLife: { fast: 1, slow: 2 } }, t(), e; }i.__dashjs_factory_name = `ThroughputHistory`, n.default = e.default.getClassFactory(i), t.exports = n.default; }, { 108: 108, 47: 47 }], 190: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const l = r(e(197)); const d = r(e(194)); const f = r(e(191)); const c = r(e(193)); const h = r(e(196)); const p = r(e(192)); const g = r(e(195)); const _ = r(e(200)); const i = r(e(47)); const m = r(e(187)); const E = r(e(108)); const y = `qualitySwitchRules`; const v = `abandonFragmentRules`; function a (e) { e = e || {}; const s = this.context; const t = e.mediaPlayerModel; const n = e.dashMetrics; const r = e.settings; let i = void 0; let a = void 0; function o (e) { return e.filter((e) => { return e.quality > m.default.NO_CHANGE; }); } function u (e) { let t; let n; const r = {}; let i = void 0; let a = void 0; let o = void 0; if (e.length !== 0) { for (r[m.default.PRIORITY.STRONG] = m.default.NO_CHANGE, r[m.default.PRIORITY.WEAK] = m.default.NO_CHANGE, r[m.default.PRIORITY.DEFAULT] = m.default.NO_CHANGE, i = 0, t = e.length; i < t; i += 1)(n = e[i]).quality !== m.default.NO_CHANGE && (r[n.priority] = r[n.priority] > m.default.NO_CHANGE ? Math.min(r[n.priority], n.quality) : n.quality); return r[m.default.PRIORITY.WEAK] !== m.default.NO_CHANGE && (a = r[m.default.PRIORITY.WEAK]), r[m.default.PRIORITY.DEFAULT] !== m.default.NO_CHANGE && (a = r[m.default.PRIORITY.DEFAULT]), r[m.default.PRIORITY.STRONG] !== m.default.NO_CHANGE && (a = r[m.default.PRIORITY.STRONG]), a !== m.default.NO_CHANGE && (o = a), (0, m.default)(s).create(o); } } return { initialize: function () { i = [], a = [], r.get().streaming.abr.useDefaultABRRules && (r.get().streaming.abr.ABRStrategy === E.default.ABR_STRATEGY_L2A ? i.push((0, g.default)(s).create({ dashMetrics: n, mediaPlayerModel: t, settings: r })) : r.get().streaming.abr.ABRStrategy === E.default.ABR_STRATEGY_LoLP ? i.push((0, _.default)(s).create({ dashMetrics: n })) : (i.push((0, p.default)(s).create({ dashMetrics: n, mediaPlayerModel: t, settings: r })), i.push((0, l.default)(s).create({ dashMetrics: n })), i.push((0, d.default)(s).create({ dashMetrics: n })), i.push((0, h.default)(s).create()), i.push((0, c.default)(s).create()), a.push((0, f.default)(s).create({ dashMetrics: n, mediaPlayerModel: t, settings: r })))), t.getABRCustomRules().forEach((e) => { e.type === y && i.push(e.rule(s).create()), e.type === v && a.push(e.rule(s).create()); }); }, reset: function () { [i, a].forEach((e) => { e && e.length && e.forEach((e) => { return e.reset && e.reset(); }); }), i = [], a = []; }, getMaxQuality: function (t) { return u(o(i.map((e) => { return e.getMaxIndex(t); }))) || (0, m.default)(s).create(); }, shouldAbandonFragment: function (t) { return u(o(a.map((e) => { return e.shouldAbandon(t); }))) || (0, m.default)(s).create(); }, getQualitySwitchRules: function () { return i; } }; }a.__dashjs_factory_name = `ABRRulesCollection`; e = i.default.getClassFactory(a); e.QUALITY_SWITCH_RULES = y, e.ABANDON_FRAGMENT_RULES = v, i.default.updateSingletonFactory(a.__dashjs_factory_name, e), n.default = e, t.exports = n.default; }, { 108: 108, 187: 187, 191: 191, 192: 192, 193: 193, 194: 194, 195: 195, 196: 196, 197: 197, 200: 200, 47: 47 }], 191: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const m = r(e(187)); const i = r(e(47)); const a = r(e(45)); function E (e) { e = e || {}; const l = this.context; const d = e.mediaPlayerModel; const f = e.dashMetrics; const c = e.settings; let t = void 0; let h = void 0; let p = void 0; let g = void 0; let _ = void 0; function n () { p = {}, g = {}, _ = []; } return t = { shouldAbandon: function (e) { const t = (0, m.default)(l).create(m.default.NO_CHANGE, { name: E.__dashjs_factory_name }); if (!(e && e.hasOwnProperty(`getMediaInfo`) && e.hasOwnProperty(`getMediaType`) && e.hasOwnProperty(`getCurrentRequest`) && e.hasOwnProperty(`getRepresentationInfo`) && e.hasOwnProperty(`getAbrController`))) return t; let n; let r = e.getMediaInfo(); const i = e.getMediaType(); var a = e.getCurrentRequest(); if (!isNaN(a.index)) { if (n = i, o = a.index, p[n] = p[n] || {}, p[n][o] = p[n][o] || {}, d.getStableBufferTime() < f.getCurrentBufferLevel(i)) return t; var o = p[i][a.index]; if (o === null || a.firstByteDate === null || g.hasOwnProperty(o.id)) return t; if (void 0 === o.firstByteTime && (_[i] = [], o.firstByteTime = a.firstByteDate.getTime(), o.segmentDuration = a.duration, o.bytesTotal = a.bytesTotal, o.id = a.index), o.bytesLoaded = a.bytesLoaded, o.elapsedTime = (new Date()).getTime() - o.firstByteTime, o.bytesLoaded > 0 && o.elapsedTime > 0 && (s = i, u = Math.round(8 * o.bytesLoaded / o.elapsedTime), _[s] = _[s] || [], _[s].push(u)), _[i].length >= 5 && o.elapsedTime > 500 && o.bytesLoaded < o.bytesTotal) { var s; var u; var a = _[i].reduce((e, t) => { return e + t; }, 0); if (o.measuredBandwidthInKbps = Math.round(a / _[i].length), o.estimatedTimeOfDownload = +(8 * o.bytesTotal / o.measuredBandwidthInKbps / 1e3).toFixed(2), o.estimatedTimeOfDownload < 1.8 * o.segmentDuration || e.getRepresentationInfo().quality === 0) return t; g.hasOwnProperty(o.id) || (s = e.getAbrController(), u = o.bytesTotal - o.bytesLoaded, a = s.getBitrateList(r), e = s.getQualityForBitrate(r, o.measuredBandwidthInKbps * c.get().streaming.abr.bandwidthSafetyFactor), e = void 0 !== (r = s.getMinAllowedIndexFor(i)) ? Math.max(r, e) : e, o.bytesTotal * a[e].bitrate / a[s.getQualityFor(i)].bitrate < u && (t.quality = e, t.reason.throughput = o.measuredBandwidthInKbps, t.reason.fragmentID = o.id, g[o.id] = o, h.debug(`[${i}] frag id`, o.id, ` is asking to abandon and switch to quality to `, e, ` measured bandwidth was`, o.measuredBandwidthInKbps), delete p[i][o.id])); } else o.bytesLoaded === o.bytesTotal && delete p[i][o.id]; } return t; }, reset: n }, h = (0, a.default)(l).getInstance().getLogger(t), n(), t; }E.__dashjs_factory_name = `AbandonRequestsRule`, n.default = i.default.getClassFactory(E), t.exports = n.default; }, { 187: 187, 45: 45, 47: 47 }], 192: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const h = r(e(109)); const R = r(e(187)); const i = r(e(47)); const p = e(248); const g = r(e(46)); const b = r(e(54)); const D = r(e(45)); function a (e) { e = e || {}; const _ = this.context; const m = e.dashMetrics; const a = e.mediaPlayerModel; const t = (0, g.default)(_).getInstance(); let n = void 0; let E = void 0; let y = void 0; function o (e, t, r) { const n = r.reduce((e, t, n) => { return t > r[e] ? n : e; }, 0); if (n === 0) return null; t = Math.max(e, 10 + 2 * t.length), t = (r[n] - 1) / (t / 10 - 1); return { gp: t, Vp: 10 / t }; } function v (e) { const t = {}; const n = e.getMediaInfo().bitrateList.map((e) => { return e.bandwidth; }); var r = (r = n.map((e) => { return Math.log(e); })).map((e) => { return e - r[0] + 1; }); const i = a.getStableBufferTime(); var e = o(i, n, r); return e ? (t.state = 1, t.bitrates = n, t.utilities = r, t.stableBufferTime = i, t.Vp = e.Vp, t.gp = e.gp, t.lastQuality = 0, T(t)) : t.state = 0, t; } function T (e) { e.placeholderBuffer = 0, e.mostAdvancedSegmentStart = NaN, e.lastSegmentWasReplacement = !1, e.lastSegmentStart = NaN, e.lastSegmentDurationS = NaN, e.lastSegmentRequestTimeMs = NaN, e.lastSegmentFinishTimeMs = NaN; } function S (e, t) { let n; let r; const i = a.getStableBufferTime(); e.stableBufferTime !== i && ((n = o(i, e.bitrates, e.utilities)).Vp === e.Vp && n.gp === e.gp || (t = (r = m.getCurrentBufferLevel(t)) + e.placeholderBuffer, t -= 10, t *= n.Vp / e.Vp, t += 10, e.stableBufferTime = i, e.Vp = n.Vp, e.gp = n.gp, e.placeholderBuffer = Math.max(0, t - r))); } function A (e, t) { return e.Vp * (e.utilities[t] + e.gp); } function I (e, t) { for (var n, r, i = e.bitrates[t], a = e.utilities[t], o = 0, s = t - 1; s >= 0; --s) { e.utilities[s] < e.utilities[t] && (r = e.bitrates[s], n = e.utilities[s], r = e.Vp * (e.gp + (i * n - r * a) / (i - r)), o = Math.max(o, r)); } return o; } function r () { for (const e in y)y.hasOwnProperty(e) && y[e].state === 2 && (y[e].placeholderBuffer = 0); } function i () { for (const e in y) { var t; !y.hasOwnProperty(e) || (t = y[e]).state !== 0 && (t.state = 1, T(t)); } } function s (e) { let t, n; e && e.chunk && e.chunk.mediaInfo && ((t = y[e.chunk.mediaInfo.type]) && t.state !== 0 && (n = e.chunk.start, isNaN(t.mostAdvancedSegmentStart) || n > t.mostAdvancedSegmentStart ? (t.mostAdvancedSegmentStart = n, t.lastSegmentWasReplacement = !1) : t.lastSegmentWasReplacement = !0, t.lastSegmentStart = n, t.lastSegmentDurationS = e.chunk.duration, t.lastQuality = e.chunk.quality, l(t, e.chunk.mediaInfo.type))); } function u (e) { let t; e && e.metric === h.default.HTTP_REQUEST && e.value && e.value.type === p.HTTPRequest.MEDIA_SEGMENT_TYPE && e.value.trace && e.value.trace.length && ((t = y[e.mediaType]) && t.state !== 0 && (t.lastSegmentRequestTimeMs = e.value.trequest.getTime(), t.lastSegmentFinishTimeMs = e.value._tfinish.getTime(), l(t, e.mediaType))); } function l (e, t) { let n; isNaN(e.lastSegmentStart) || isNaN(e.lastSegmentRequestTimeMs) || isNaN(e.placeholderBuffer) || (e.placeholderBuffer *= 0.99, isNaN(e.lastSegmentFinishTimeMs) || (n = m.getCurrentBufferLevel(t) + 0.001 * (e.lastSegmentFinishTimeMs - e.lastSegmentRequestTimeMs), t = A(e, e.lastQuality), n = Math.max(0, t - n), e.placeholderBuffer = Math.min(n, e.placeholderBuffer)), e.lastSegmentWasReplacement && !isNaN(e.lastSegmentDurationS) && (e.placeholderBuffer += e.lastSegmentDurationS), e.lastSegmentStart = NaN, e.lastSegmentRequestTimeMs = NaN); } function d (e) { let t; !e || (t = y[e.mediaType]) && t.state !== 0 && (t.abrQuality = e.newQuality); } function f (e) { let t, n; !e || (t = y[e.mediaType]) && t.state !== 0 && (n = m.getCurrentBufferLevel(e.mediaType), e = void 0, e = t.abrQuality > 0 ? I(t, t.abrQuality) : 10, n = Math.max(0, e - n), t.placeholderBuffer = Math.min(t.placeholderBuffer, n)); } function c () { y = {}; } return n = { getMaxIndex: function (e) { const t = (0, R.default)(_).create(); if (!(e && e.hasOwnProperty(`getMediaInfo`) && e.hasOwnProperty(`getMediaType`) && e.hasOwnProperty(`getScheduleController`) && e.hasOwnProperty(`getStreamInfo`) && e.hasOwnProperty(`getAbrController`) && e.hasOwnProperty(`useBufferOccupancyABR`))) return t; const n = e.getMediaInfo(); const r = e.getMediaType(); const i = e.getScheduleController(); var a = e.getStreamInfo(); const o = e.getAbrController(); let s = o.getThroughputHistory(); const u = a ? a.id : null; let l = a && a.manifestInfo && a.manifestInfo.isDynamic; var d = e.useBufferOccupancyABR(); if (t.reason = t.reason || {}, !d) return t; i.setTimeToLoadDelay(0); const f = (g = (p = e).getMediaType(), (c = y[g]) ? c.state !== 0 && S(c, g) : (c = v(p), y[g] = c), c); if (f.state === 0) return t; let c; let h; var a = m.getCurrentBufferLevel(r); var d = s.getAverageThroughput(r, l); var e = s.getSafeAverageThroughput(r, l); var p = s.getAverageLatency(r); var g = void 0; if (t.reason.state = f.state, t.reason.throughput = d, t.reason.latency = p, isNaN(d)) return t; switch (f.state) { case 1:g = o.getQualityForBitrate(n, e, p), t.quality = g, t.reason.throughput = e, f.placeholderBuffer = Math.max(0, I(f, g) - a), f.lastQuality = g, !isNaN(f.lastSegmentDurationS) && a >= f.lastSegmentDurationS && (f.state = 2); break; case 2:c = f, l = r, s = Date.now(), isNaN(c.lastSegmentFinishTimeMs) ? isNaN(c.lastCallTimeMs) || (h = 0.001 * (s - c.lastCallTimeMs), c.placeholderBuffer += Math.max(0, h)) : (h = 0.001 * (s - c.lastSegmentFinishTimeMs), c.placeholderBuffer += Math.max(0, h)), c.lastCallTimeMs = s, c.lastSegmentStart = NaN, c.lastSegmentRequestTimeMs = NaN, c.lastSegmentFinishTimeMs = NaN, S(c, l), g = (function (e, t) { for (var n = e.bitrates.length, r = NaN, i = NaN, a = 0; a < n; ++a) { const o = (e.Vp * (e.utilities[a] + e.gp) - t) / e.bitrates[a]; (isNaN(i) || i <= o) && (i = o, r = a); } return r; }(f, a + f.placeholderBuffer)); l = o.getQualityForBitrate(n, e, p); g > f.lastQuality && l < g && (g = Math.max(l, f.lastQuality)); l = Math.max(0, a + f.placeholderBuffer - A(f, g)); l <= f.placeholderBuffer ? (f.placeholderBuffer -= l, l = 0) : (l -= f.placeholderBuffer, f.placeholderBuffer = 0, g < o.getTopQualityIndexFor(r, u) ? i.setTimeToLoadDelay(1e3 * l) : l = 0), t.quality = g, t.reason.throughput = d, t.reason.latency = p, t.reason.bufferLevel = a, t.reason.placeholderBuffer = f.placeholderBuffer, t.reason.delay = l, f.lastQuality = g; break; default:E.debug(`BOLA ABR rule invoked in bad state.`), t.quality = o.getQualityForBitrate(n, e, p), t.reason.state = f.state, t.reason.throughput = e, t.reason.latency = p, f.state = 1, T(f); } return t; }, reset: function () { c(), t.off(b.default.BUFFER_EMPTY, r, n), t.off(b.default.PLAYBACK_SEEKING, i, n), t.off(b.default.MEDIA_FRAGMENT_LOADED, s, n), t.off(b.default.METRIC_ADDED, u, n), t.off(b.default.QUALITY_CHANGE_REQUESTED, d, n), t.off(b.default.FRAGMENT_LOADING_ABANDONED, f, n); } }, E = (0, D.default)(_).getInstance().getLogger(n), c(), t.on(b.default.BUFFER_EMPTY, r, n), t.on(b.default.PLAYBACK_SEEKING, i, n), t.on(b.default.MEDIA_FRAGMENT_LOADED, s, n), t.on(b.default.METRIC_ADDED, u, n), t.on(b.default.QUALITY_CHANGE_REQUESTED, d, n), t.on(b.default.FRAGMENT_LOADING_ABANDONED, f, n), n; }a.__dashjs_factory_name = `BolaRule`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 109: 109, 187: 187, 248: 248, 45: 45, 46: 46, 47: 47, 54: 54 }], 193: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const l = r(e(187)); const a = r(e(45)); function o () { const s = this.context; let e = void 0; let u = void 0; return e = { getMaxIndex: function (e) { const t = (0, l.default)(s).create(); if (!e || !e.hasOwnProperty(`getDroppedFramesHistory`)) return t; if (e = e.getDroppedFramesHistory()) { for (var n, r = e.getFrameHistory(), i = 0, a = l.default.NO_CHANGE, o = 1; o < r.length; o++) if (r[o] && (i = r[o].droppedVideoFrames, (n = r[o].totalVideoFrames) > 375 && i / n > 0.15)) { a = o - 1, u.debug(`index: ${a} Dropped Frames: ${i} Total Frames: ${n}`); break; } return (0, l.default)(s).create(a, { droppedFrames: i }); } return t; } }, u = (0, a.default)(s).getInstance().getLogger(e), e; }o.__dashjs_factory_name = `DroppedFramesRule`, n.default = i.default.getClassFactory(o), t.exports = n.default; }, { 187: 187, 45: 45, 47: 47 }], 194: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const s = r(e(46)); const h = r(e(54)); const i = r(e(47)); const p = r(e(45)); const g = r(e(187)); const _ = r(e(108)); const m = r(e(109)); function a (e) { e = e || {}; const u = 0.5; const t = 2; const l = this.context; const n = (0, s.default)(l).getInstance(); const d = e.dashMetrics; let r = void 0; let f = void 0; let c = void 0; function i () { (c = {})[_.default.VIDEO] = { ignoreCount: t }, c[_.default.AUDIO] = { ignoreCount: t }; } function a () { i(); } function o (e) { isNaN(e.startTime) || e.mediaType !== _.default.AUDIO && e.mediaType !== _.default.VIDEO || c[e.mediaType].ignoreCount > 0 && c[e.mediaType].ignoreCount--; } return r = { getMaxIndex: function (e) { const t = (0, g.default)(l).create(); if (!e || !e.hasOwnProperty(`getMediaType`)) return t; !(function () { if (!d || !d.hasOwnProperty(`getCurrentBufferLevel`) || !d.hasOwnProperty(`getCurrentBufferState`)) throw new Error(_.default.MISSING_CONFIG_ERROR); }()); let n; let r; let i; let a = e.getMediaType(); let o = d.getCurrentBufferState(a); let s = e.getRepresentationInfo().fragmentDuration; return c[a].ignoreCount > 0 || !s || (o && o.state === m.default.BUFFER_EMPTY ? (f.debug(`[${a}] Switch to index 0; buffer is empty.`), t.quality = 0, t.reason = `InsufficientBufferRule: Buffer is empty`) : (n = e.getMediaInfo(), i = (r = e.getAbrController()).getThroughputHistory(), o = d.getCurrentBufferLevel(a), e = i.getAverageThroughput(a), a = i.getAverageLatency(a), s = e * (o / s) * u, t.quality = r.getQualityForBitrate(n, s, a), t.reason = `InsufficientBufferRule: being conservative to avoid immediate rebuffering`)), t; }, reset: function () { i(), n.off(h.default.PLAYBACK_SEEKING, a, r), n.off(h.default.BYTES_APPENDED_END_FRAGMENT, o, r); } }, f = (0, p.default)(l).getInstance().getLogger(r), i(), n.on(h.default.PLAYBACK_SEEKING, a, r), n.on(h.default.BYTES_APPENDED_END_FRAGMENT, o, r), r; }a.__dashjs_factory_name = `InsufficientBufferRule`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 108: 108, 109: 109, 187: 187, 45: 45, 46: 46, 47: 47, 54: 54 }], 195: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const l = r(e(109)); const P = r(e(187)); const i = r(e(47)); const d = e(248); const f = r(e(46)); const c = r(e(54)); const h = r(e(45)); const L = r(e(108)); function a (e) { e = e || {}; const R = this.context; const b = e.dashMetrics; const t = (0, f.default)(R).getInstance(); let n = void 0; let D = void 0; let M = void 0; let N = void 0; function C (e) { const t = {}; const n = e.getMediaInfo(); var e = n.bitrateList.map((e) => { return e.bandwidth / 1e3; }); return t.state = 1, t.bitrates = e, t.lastQuality = 0, (function (e) { if (!e || !e.type) return; M[e.type] = {}, M[e.type].w = [], M[e.type].prev_w = [], M[e.type].Q = 0, M[e.type].segment_request_start_s = 0, M[e.type].segment_download_finish_s = 0, M[e.type].B_target = 1.5; }(n)), w(t), t; } function w (e) { e.placeholderBuffer = 0, e.mostAdvancedSegmentStart = NaN, e.lastSegmentWasReplacement = !1, e.lastSegmentStart = NaN, e.lastSegmentDurationS = NaN, e.lastSegmentRequestTimeMs = NaN, e.lastSegmentFinishTimeMs = NaN; } function r () { for (const e in D) { var t; !D.hasOwnProperty(e) || (t = D[e]).state !== 0 && (t.state = 1, w(t)); } } function i (e) { let t, n, r; e && e.chunk && e.chunk.mediaInfo && (t = D[e.chunk.mediaInfo.type], n = M[e.chunk.mediaInfo.type], t && t.state !== 0 && (r = e.chunk.start, isNaN(t.mostAdvancedSegmentStart) || r > t.mostAdvancedSegmentStart ? (t.mostAdvancedSegmentStart = r, t.lastSegmentWasReplacement = !1) : t.lastSegmentWasReplacement = !0, t.lastSegmentStart = r, t.lastSegmentDurationS = e.chunk.duration, t.lastQuality = e.chunk.quality, o(t, n))); } function a (e) { let t, n; e && e.metric === l.default.HTTP_REQUEST && e.value && e.value.type === d.HTTPRequest.MEDIA_SEGMENT_TYPE && e.value.trace && e.value.trace.length && (t = D[e.mediaType], n = M[e.mediaType], t && t.state !== 0 && (t.lastSegmentRequestTimeMs = e.value.trequest.getTime(), t.lastSegmentFinishTimeMs = e.value._tfinish.getTime(), o(t, n))); } function o (e, t) { isNaN(e.lastSegmentStart) || isNaN(e.lastSegmentRequestTimeMs) || (t.segment_request_start_s = 0.001 * e.lastSegmentRequestTimeMs, t.segment_download_finish_s = 0.001 * e.lastSegmentFinishTimeMs, e.lastSegmentStart = NaN, e.lastSegmentRequestTimeMs = NaN); } function s (e) { let t; e && e.mediaType && ((t = D[e.mediaType]) && t.state !== 0 && (t.abrQuality = e.newQuality)); } function O (e, t) { if (e.length !== t.length) return -1; for (var n = 0, r = 0; r < e.length; r++)n += e[r] * t[r]; return n; } function u () { D = {}, M = {}; } return n = { getMaxIndex: function (e) { const t = (0, P.default)(R).create(); const n = Math.pow(4, 0.99); const r = Math.max(Math.pow(4, 1), n * Math.sqrt(4)); const i = e.getMediaInfo(); var a = e.getMediaType(); const o = i.bitrateList.map((e) => { return e.bandwidth; }); const s = o.length; let u = e.getScheduleController(); var l = e.getStreamInfo(); const d = e.getAbrController(); var f = d.getThroughputHistory(); var c = l && l.manifestInfo && l.manifestInfo.isDynamic; let h = e.useL2AABR(); const p = b.getCurrentBufferLevel(a, !0); const g = f.getSafeAverageThroughput(a, c); var l = f.getAverageThroughput(a, c); var c = f.getAverageLatency(a); var f = void 0; const _ = e.getVideoModel().getPlaybackRate(); if (!(e && e.hasOwnProperty(`getMediaInfo`) && e.hasOwnProperty(`getMediaType`) && e.hasOwnProperty(`getScheduleController`) && e.hasOwnProperty(`getStreamInfo`) && e.hasOwnProperty(`getAbrController`) && e.hasOwnProperty(`useL2AABR`))) return t; if (t.reason = t.reason || {}, !h || a === L.default.AUDIO) return t; u.setTimeToLoadDelay(0); const m = (u = (h = e).getMediaType(), (e = D[u]) || (e = C(h), D[u] = e), e); if (m.state === 0) return t; const E = M[a]; if (!E) return t; if (t.reason.state = m.state, t.reason.throughput = l, t.reason.latency = c, isNaN(l)) return t; switch (m.state) { case 1:if (f = d.getQualityForBitrate(i, g, c), t.quality = f, t.reason.throughput = g, m.lastQuality = f, !isNaN(m.lastSegmentDurationS) && p >= E.B_target) { m.state = 2, E.Q = n; for (var y = 0; y < s; ++y)y === m.lastQuality ? E.prev_w[y] = 1 : E.prev_w[y] = 0; } break; case 2:var v = []; var e = b.getCurrentHttpRequest(a).trace.reduce((e, t) => { return e + t.d; }, 0); var a = b.getCurrentHttpRequest(a).trace.reduce((e, t) => { return e + t.b[0]; }, 0); var T = Math.round(8 * a / e); T < 1 && (T = 1); for (var S = m.lastSegmentDurationS, A = 1, y = 0; y < s; ++y)o[y] = o[y] / 1e3, _ * o[y] > T && (A = -1), E.w[y] = E.prev_w[y] + A * (S / (2 * r)) * ((E.Q + n) * (_ * o[y] / T)); E.w = (function (e) { for (var t = e.length, n = !1, r = [], i = 0; i < t; ++i)r[i] = e[i]; for (var a = e.sort((e, t) => { return t - e; }), o = 0, s = 0, u = [], i = 0; i < t - 1; ++i) if ((s = ((o += a[i]) - 1) / (i + 1)) >= a[i + 1]) { n = !0; break; } for (n || (s = (o + a[t - 1] - 1) / t), i = 0; i < t; ++i)u[i] = Math.max(r[i] - s, 0); return u; }(E.w)); for (y = 0; y < s; ++y)v[y] = E.w[y] - E.prev_w[y], E.prev_w[y] = E.w[y]; E.Q = Math.max(0, E.Q - S + S * _ * ((O(o, E.prev_w) + O(o, v)) / T)); for (var I = [], y = 0; y < s; ++y)I[y] = Math.abs(o[y] - O(E.w, o)); (f = I.indexOf(Math.min.apply(Math, I))) > m.lastQuality && o[m.lastQuality + 1] <= T && (f = m.lastQuality + 1), o[f] >= T && (E.Q = 2 * Math.max(n, E.Q)), t.quality = f, t.reason.throughput = l, t.reason.latency = c, t.reason.bufferLevel = p, m.lastQuality = t.quality; break; default:N.debug(`L2A ABR rule invoked in bad state.`), t.quality = d.getQualityForBitrate(i, g, c), t.reason.state = m.state, t.reason.throughput = g, t.reason.latency = c, m.state = 1, w(m); } return t; }, reset: function () { u(), t.off(c.default.PLAYBACK_SEEKING, r, n), t.off(c.default.MEDIA_FRAGMENT_LOADED, i, n), t.off(c.default.METRIC_ADDED, a, n), t.off(c.default.QUALITY_CHANGE_REQUESTED, s, n); } }, N = (0, h.default)(R).getInstance().getLogger(n), u(), t.on(c.default.PLAYBACK_SEEKING, r, n), t.on(c.default.MEDIA_FRAGMENT_LOADED, i, n), t.on(c.default.METRIC_ADDED, a, n), t.on(c.default.QUALITY_CHANGE_REQUESTED, s, n), n; }a.__dashjs_factory_name = `L2ARule`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 108: 108, 109: 109, 187: 187, 248: 248, 45: 45, 46: 46, 47: 47, 54: 54 }], 196: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(45)); const l = r(e(187)); function o () { const s = this.context; let e = void 0; let u = void 0; return e = { getMaxIndex: function (e) { for (var t = (e = e ? e.getSwitchHistory() : null) ? e.getSwitchRequests() : [], n = 0, r = 0, i = 0, a = (0, l.default)(s).create(), o = 0; o < t.length; o++) if (void 0 !== t[o] && (n += t[o].drops, r += t[o].noDrops, i += t[o].dropSize, n + r >= 6 && n / r > 0.075)) { a.quality = o > 0 && t[o].drops > 0 ? o - 1 : o, a.reason = { index: a.quality, drops: n, noDrops: r, dropSize: i }, u.debug(`Switch history rule index: ${a.quality} samples: ${n + r} drops: ${n}`); break; } return a; } }, u = (0, a.default)(s).getInstance().getLogger(e), e; }o.__dashjs_factory_name = `SwitchHistoryRule`, n.default = i.default.getClassFactory(o), t.exports = n.default; }, { 187: 187, 45: 45, 47: 47 }], 197: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(45)); const h = r(e(187)); const p = r(e(108)); const g = r(e(109)); function o (e) { e = e || {}; const d = this.context; const f = e.dashMetrics; let t = void 0; let c = void 0; return t = { getMaxIndex: function (e) { const t = (0, h.default)(d).create(); if (!(e && e.hasOwnProperty(`getMediaInfo`) && e.hasOwnProperty(`getMediaType`) && e.hasOwnProperty(`useBufferOccupancyABR`) && e.hasOwnProperty(`getAbrController`) && e.hasOwnProperty(`getScheduleController`))) return t; !(function () { if (!f || !f.hasOwnProperty(`getCurrentBufferState`)) throw new Error(p.default.MISSING_CONFIG_ERROR); }()); const n = e.getMediaInfo(); const r = e.getMediaType(); const i = f.getCurrentBufferState(r); const a = e.getScheduleController(); const o = e.getAbrController(); const s = (u = e.getStreamInfo()) && u.manifestInfo ? u.manifestInfo.isDynamic : null; var u = (l = o.getThroughputHistory()).getSafeAverageThroughput(r, s); var l = l.getAverageLatency(r); var e = e.useBufferOccupancyABR(); return isNaN(u) || !i || e || o.getAbandonmentStateFor(r) !== g.default.ABANDON_LOAD && (i.state !== g.default.BUFFER_LOADED && !s || (t.quality = o.getQualityForBitrate(n, u, l), a.setTimeToLoadDelay(0), c.debug(`[${r}] requesting switch to index: `, t.quality, `Average throughput`, Math.round(u), `kbps`), t.reason = { throughput: u, latency: l })), t; }, reset: function () {} }, c = (0, a.default)(d).getInstance().getLogger(t), t; }o.__dashjs_factory_name = `ThroughputRule`, n.default = i.default.getClassFactory(o), t.exports = n.default; }, { 108: 108, 109: 109, 187: 187, 45: 45, 47: 47 }], 198: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(45)); const L = `manual_weight_selection`; const x = `random_weight_selection`; const F = `dynamic_weight_selection`; function o () { const e = this.context; let t = void 0; let S = void 0; let A = void 0; let I = void 0; let R = void 0; let b = void 0; let D = void 0; let M = void 0; let N = void 0; function n () { I = 1, R = 100, b = 0, M = D = A = null, N = F; } function C () { let e = 0; if (A) for (let t = 0; t < A.length; t++) { const n = A[t]; n.state.throughput > e && (e = n.state.throughput); } return e; } function w (e, n, r) { e = e.map((e, t) => { return r[t] * Math.pow(e - n[t], 2); }).reduce((e, t) => { return e + t; }); return (e < 0 ? -1 : 1) * Math.sqrt(Math.abs(e)); } function O (e, t, n) { for (var r, i = 0; i < t.length; i++) { let a = t[i]; let o = (r = e, w([(s = a).state.throughput, s.state.latency, s.state.rebuffer, s.state.switch], [r.state.throughput, r.state.latency, r.state.rebuffer, r.state.switch], [1, 1, 1, 1])); var s = Math.exp(-1 * Math.pow(o, 2) / (2 * Math.pow(0.1, 2))); r = n, o = s, s = void 0, s = (a = a).state, a = [0.01, 0.01, 0.01, 0.01], s.throughput = s.throughput + (r[0] - s.throughput) * a[0] * o, s.latency = s.latency + (r[1] - s.latency) * a[1] * o, s.rebuffer = s.rebuffer + (r[2] - s.rebuffer) * a[2] * o, s.switch = s.switch + (r[3] - s.switch) * a[3] * o; } } function P (e, t, n, r, i, a, o) { D = D || M[M.length - 1]; o = e.findWeightVector(t, n, r, i, a, o); o !== null && o !== -1 && (D = o); } return t = { getNextQuality: function (e, t, n, r, i, a, o) { const s = n; const u = r; const l = t; const d = (function (a) { A || (function () { A = []; let e; const t = a.bitrateList; const n = []; b = t[0].bandwidth, t.forEach((e) => { n.push(e.bandwidth), e.bandwidth < b && (b = e.bandwidth); }), e = (e = n).map((e) => { return Math.pow(e, 2); }).reduce((e, t) => { return e + t; }), I = Math.sqrt(e); for (let r = 0; r < t.length; r++) { const i = { qualityIndex: r, bitrate: t[r].bandwidth, state: { throughput: t[r].bandwidth / I, latency: 0, rebuffer: 0, switch: 0 } }; A.push(i), i.bitrate === b && 0; }M = (function (e) { const t = []; const n = (function (e) { for (var t = [], n = 0; n < e; n++) { const r = [Math.random() * C(), Math.random(), Math.random(), Math.random()]; t.push(r); } return t; }(Math.pow(e.length, 2))); t.push(n[0]); for (var r = [1, 1, 1, 1], i = 1; i < e.length; i++) { for (var a = null, o = null, s = 0; s < n.length; s++) { for (var u = n[s], l = null, d = 0; d < t.length; d++) { var f = w(u, t[d], r); (l === null || f < l) && (l = f); }(o === null || o < l) && (a = u, o = l); }t.push(a); } for (var c = null, h = null, s = 0; s < t.length; s++) { for (f = 0, d = 0; d < t.length; d++)s !== d && (f += w(t[s], t[d], r)); (c === null || c < f) && (c = f, h = s); } const p = []; p.push(t[h]), t.splice(h, 1); for (;t.length > 0;) { for (var l = null, g = null, s = 0; s < t.length; s++) { f = w(p[0], t[s], r); (l === null || f < l) && (l = f, g = s); }p.push(t[g]), t.splice(g, 1); } return p; }(A)); }()); return A; }(e)); let f = t / I; f > 1 && (f = C()), n /= R, S.debug(`getNextQuality called throughput:${f} latency:${n} bufferSize:${r} currentQualityIndex:${a} playbackRate:${i}`); const c = (r = d[a]).bitrate * o.getSegmentDuration() / l; var a = Math.max(0, c - u); if (u - c < o.getMinBuffer()) return S.debug(`Buffer is low for bitrate= ${r.bitrate} downloadTime=${c} currentBuffer=${u} rebuffer=${a}`), (function (e, t) { let n = 0; let r = e; if (A) for (let i = 0; i < A.length; i++) { const a = A[i]; a.bitrate < e.bitrate && a.bitrate > n && t > a.bitrate && (n = a.bitrate, r = a); } return r; }(r, l)).qualityIndex; switch (N) { case L:D = [0.4, 0.4, 0.4, 0.4]; break; case x:D = (function (e, t) { for (var n = [], r = Math.sqrt(2 / e), i = 0; i < t; i++)n.push(Math.random() * r); return D = n; }(d.length, 4)); break; case F:P(o, d, s, u, a, l, i); break; default:P(o, d, s, u, a, l, i); } for (var h = null, p = null, g = null, _ = 0; _ < d.length; _++) { const m = d[_]; var E = m.state; let y = [E.throughput, E.latency, E.rebuffer, E.switch]; const v = D.slice(); const T = o.getNextBufferWithBitrate(m.bitrate, u, l); var E = T < o.getMinBuffer(); E && S.debug(`Buffer is low for bitrate=${m.bitrate} downloadTime=${c} currentBuffer=${u} nextBuffer=${T}`), (m.bitrate > t - 1e4 || E) && m.bitrate !== b && (v[0] = 100); y = w(y, [f, 0, 0, 0], v); (h === null || y < h) && (h = y, p = m.qualityIndex, g = m, 0); } return i = Math.abs(r.bitrate - g.bitrate) / I, O(r, d, [f, n, a, i]), O(g, d, [f, 0, 0, i]), p; }, reset: function () { n(); } }, S = (0, a.default)(e).getInstance().getLogger(t), n(), t; }o.__dashjs_factory_name = `LearningAbrController`, n.default = i.default.getClassFactory(o), t.exports = n.default; }, { 45: 45, 47: 47 }], 199: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const d = r(e(202)); function a () { let e; let i = void 0; let a = void 0; let o = void 0; let s = void 0; function t () { s = o = a = i = null; } function u (e, t, n, r) { const i = new d.default(); return i.type = e, i.weights.bitrateReward = t || 1, i.weights.bitrateSwitchPenalty = 1, i.weights.rebufferPenalty = n || 1e3, i.weights.latencyPenalty = [], i.weights.latencyPenalty.push({ threshold: 1.1, penalty: 0.05 * r }), i.weights.latencyPenalty.push({ threshold: 1e8, penalty: 0.1 * n }), i.weights.playbackSpeedPenalty = r || 200, i; } function l (e, t, n, r, i) { i.bitrateWSum += i.weights.bitrateReward * e, i.lastBitrate && (i.bitrateSwitchWSum += i.weights.bitrateSwitchPenalty * Math.abs(e - i.lastBitrate)), i.lastBitrate = e, i.rebufferWSum += i.weights.rebufferPenalty * t; for (let a = 0; a < i.weights.latencyPenalty.length; a++) { const o = i.weights.latencyPenalty[a]; if (n <= o.threshold) { i.latencyWSum += o.penalty * n; break; } }i.playbackSpeedWSum += i.weights.playbackSpeedPenalty * Math.abs(1 - r), i.totalQoe = i.bitrateWSum - i.bitrateSwitchWSum - i.rebufferWSum - i.latencyWSum - i.playbackSpeedWSum; } return e = { setupPerSegmentQoe: function (e, t, n) { i = u(`segment`, e, t, n), a = e, o = t, s = n; }, logSegmentMetrics: function (e, t, n, r) { i && l(e, t, n, r, i); }, getPerSegmentQoe: function () { return i; }, calculateSingleUseQoe: function (e, t, n, r) { let i = null; return a && o && s && (i = u(`segment`, a, o, s)), i ? (l(e, t, n, r, i), i.totalQoe) : 0; }, reset: function () { t(); } }, t(), e; }a.__dashjs_factory_name = `LoLpQoeEvaluator`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 202: 202, 47: 47 }], 200: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(45)); const a = r(e(47)); const o = r(e(198)); const s = r(e(199)); const A = r(e(187)); const I = r(e(109)); const R = r(e(201)); const b = r(e(108)); function u (e) { const E = (e = e || {}).dashMetrics; const y = this.context; let v = void 0; let t = void 0; let T = void 0; let S = void 0; return t = { getMaxIndex: function (e) { try { const t = (0, A.default)(y).create(); const n = e.getMediaInfo().type; let r = e.getAbrController(); let i = e.getStreamInfo(); const a = r.getQualityFor(n, i); const o = e.getMediaInfo(); let s = E.getCurrentBufferState(n); const u = e.getScheduleController(); const l = E.getCurrentBufferLevel(n, !0); var d = i && i.manifestInfo ? i.manifestInfo.isDynamic : null; let f = u.getPlaybackController(); let c = f.getCurrentLiveLatency(); if (!e.useLoLPABR() || n === b.default.AUDIO) return t; c = c || 0; i = f.getPlaybackRate(), f = r.getThroughputHistory().getSafeAverageThroughput(n, d); if (v.debug(`Throughput ${Math.round(f)} kbps`), isNaN(f) || !s) return t; if (r.getAbandonmentStateFor(n) === I.default.ABANDON_LOAD) return t; for (var h = o.bitrateList, d = e.getRepresentationInfo().fragmentDuration, p = h[0].bandwidth / 1e3, g = h[h.length - 1].bandwidth / 1e3, _ = 0; _ < h.length; _++) { const m = h[_].bandwidth / 1e3; g < m ? g = m : m < p && (p = m); }s = h[a].bandwidth / 1e3, r = E.getCurrentHttpRequest(n, !0), r = (r.tresponse.getTime() - r.trequest.getTime()) / 1e3, r = d < r ? r - d : 0; S.setupPerSegmentQoe(d, g, p), S.logSegmentMetrics(s, r, c, i); d = (0, R.default)(y).create({ targetLatency: 1.5, bufferMin: 0.3, segmentDuration: d, qoeEvaluator: S }); return t.quality = T.getNextQuality(o, 1e3 * f, c, l, i, a, d), t.reason = { throughput: f, latency: c }, t.priority = A.default.PRIORITY.STRONG, u.setTimeToLoadDelay(0), t.quality !== a && console.log(`[TgcLearningRule][${n}] requesting switch to index: `, t.quality, `Average throughput`, Math.round(f), `kbps`), t; } catch (e) { throw e; } }, reset: function () { T.reset(), S.reset(); } }, v = (0, i.default)(y).getInstance().getLogger(t), T = (0, o.default)(y).create(), S = (0, s.default)(y).create(), t; }u.__dashjs_factory_name = `LoLPRule`, n.default = a.default.getClassFactory(u), t.exports = n.default; }, { 108: 108, 109: 109, 187: 187, 198: 198, 199: 199, 201: 201, 45: 45, 47: 47 }], 201: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a (e) { const p = e.targetLatency; const g = e.bufferMin; const _ = e.segmentDuration; const m = e.qoeEvaluator; var e = void 0; let n = void 0; let r = void 0; function t () { return _; } function E (e, t) { return _ < t ? e - _ : e + _ - t; } return e = { getMinBuffer: function () { return g; }, getSegmentDuration: t, getNextBufferWithBitrate: function (e, t, n) { return E(t, e * _ / n); }, getNextBuffer: E, findWeightVector: function (e, o, s, t, u, l) { let d = null; let f = null; let c = null; const h = Math.abs(o - r); return e.forEach((a) => { n.forEach((e) => { e[0]; var t = e[1]; const n = e[2]; var r = (e[3], a.bitrate * _ / u); const i = E(s, r); var r = (n === 0 ? 10 : 1 / n) * Math.max(1e-5, r - i); var t = (t === 0 ? 10 : 1 / t) * a.state.latency; var t = m.calculateSingleUseQoe(a.bitrate, r, t, l); (d === null || d < t) && (function (e, t, n) { if (p + n < e) return !1; return g <= t; }(o, i, h)) && (d = t, f = e, c = a.bitrate); }); }), f === null && c === null && (f = -1), r = o, f; } }, n = (function (f, e) { return (function (e, t, n) { for (var r = !0; r;) { const i = e; const a = t; const o = n; var r = !1; if (o === a) return i; for (var s = i.length, u = 0; u < s; u++) for (var l = i.shift(), d = 0; d < f.length; d++)i.push(l.concat(f[d])); e = i, t = a, n = o + 1, r = !0, s = u = l = d = void 0; } }(f.map((e) => { return [e]; }), e, 1)); }([0.2, 0.4, 0.6, 0.8, 1], 4)), r = 0, e; }a.__dashjs_factory_name = `LoLpWeightSelector`, n.default = e.default.getClassFactory(a), t.exports = n.default; }, { 47: 47 }], 202: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.type = null, this.lastBitrate = null, this.weights = {}, this.weights.bitrateReward = null, this.weights.bitrateSwitchPenalty = null, this.weights.rebufferPenalty = null, this.weights.latencyPenalty = null, this.weights.playbackSpeedPenalty = null, this.bitrateWSum = 0, this.bitrateSwitchWSum = 0, this.rebufferWSum = 0, this.latencyWSum = 0, this.playbackSpeedWSum = 0, this.totalQoe = 0; }n.default = r, t.exports = n.default; }, {}], 203: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const d = r(e(108)); const i = r(e(47)); const f = r(e(109)); function a (e) { const a = (e = e || {}).dashMetrics; const o = e.mediaPlayerModel; const s = e.textController; const u = e.abrController; const l = e.settings; function r (e, t, n) { let r; let i = NaN; return e && t ? i = e === d.default.FRAGMENTED_TEXT ? s.isTextEnabled() ? isNaN(t.fragmentDuration) ? (r = a.getCurrentSchedulingInfo(f.default.SCHEDULING_INFO)) ? r.duration : 0 : t.fragmentDuration : 0 : e === d.default.AUDIO && n ? (n = a.getCurrentBufferLevel(d.default.VIDEO), isNaN(t.fragmentDuration) ? n : Math.max(n, t.fragmentDuration)) : (t = t.mediaInfo.streamInfo, u.isPlayingAtTopQuality(t) ? t.manifestInfo.duration >= l.get().streaming.longFormContentDurationThreshold ? l.get().streaming.bufferTimeAtTopQualityLongForm : l.get().streaming.bufferTimeAtTopQuality : o.getStableBufferTime()) : i; } return { execute: function (e, t, n) { return !e || !t || a.getCurrentBufferLevel(e) < r(e, t, n); }, getBufferTarget: r }; }a.__dashjs_factory_name = `BufferLevelRule`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 108: 108, 109: 109, 47: 47 }], 204: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a () { let U = 0; function n (e) { return e === `red` ? `rgb(255, 0, 0)` : e === `green` ? `rgb(0, 255, 0)` : e === `blue` ? `rgb(0, 0, 255)` : e === `cyan` ? `rgb(0, 255, 255)` : e === `magenta` ? `rgb(255, 0, 255)` : e === `yellow` ? `rgb(255, 255, 0)` : e === `white` ? `rgb(255, 255, 255)` : e === `black` ? `rgb(0, 0, 0)` : e; } function B (e, t) { e = e.videoHeight / 15; return t ? `font-size: ${e}px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: ${t.foreground ? n(t.foreground) : `rgb(255, 255, 255)`}; font-style: ${t.italics ? `italic` : `normal`}; text-decoration: ${t.underline ? `underline` : `none`}; white-space: pre; background-color: ${t.background ? n(t.background) : `transparent`};` : `font-size: ${e}px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;`; } return { createHTMLCaptionsFromScreen: function (e, t, n, r) { for (var i = null, a = !1, o = -1, s = { start: t, end: n, spans: [] }, u = `style_cea608_white_black`, l = {}, d = {}, f = [], c = void 0, h = void 0, c = 0; c < 15; ++c) { const p = r.rows[c]; let g = ``; let _ = null; if (!1 === p.isEmpty()) { const m = (function (e) { for (var t = ``, n = 0; n < e.length; ++n) { t += e[n].uchar; } return t.length - t.replace(/^\s+/, ``).length; }(p.chars)); i === null && (i = { x: m, y1: c, y2: c + 1, p: [] }), m !== o && a && (i.p.push(s), s = { start: t, end: n, spans: [] }, i.y2 = c, i.name = `region_${i.x}_${i.y1}_${i.y2}`, !1 === l.hasOwnProperty(i.name) ? (f.push(i), l[i.name] = i) : l[i.name].p.contat(i.p), i = { x: m, y1: c, y2: c + 1, p: [] }); for (let E = 0; E < p.chars.length; ++E) { var y; const v = p.chars[E]; const T = v.penState; _ !== null && T.equals(_) || (g.trim().length > 0 && (s.spans.push({ name: u, line: g, row: c }), g = ``), y = `style_cea608_${T.foreground}_${T.background}`, T.underline && (y += `_underline`), T.italics && (y += `_italics`), d.hasOwnProperty(y) || (d[y] = JSON.parse(JSON.stringify(T))), _ = T, u = y), g += v.uchar; }g.trim().length > 0 && s.spans.push({ name: u, line: g, row: c }), a = !0, o = m; } else a = !1, o = -1, i && (i.p.push(s), s = { start: t, end: n, spans: [] }, i.y2 = c, i.name = `region_${i.x}_${i.y1}_${i.y2}`, !1 === l.hasOwnProperty(i.name) ? (f.push(i), l[i.name] = i) : l[i.name].p.contat(i.p), i = null); }i && (i.p.push(s), i.y2 = c + 1, i.name = `region_${i.x}_${i.y1}_${i.y2}`, !1 === l.hasOwnProperty(i.name) ? (f.push(i), l[i.name] = i) : l[i.name].p.contat(i.p), i = null); const S = []; for (c = 0; c < f.length; ++c) { const A = f[c]; const I = `sub_cea608_${U++}`; const R = document.createElement(`div`); R.id = I; var b = `left: ${3.125 * (b = A).x}%; top: ${6.66 * b.y1}%; width: ${100 - 3.125 * b.x}%; height: ${6.66 * Math.max(b.y2 - 1 - b.y1, 1)}%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;`; R.style.cssText = `position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;${b}`; b = document.createElement(`div`); b.className = `paragraph bodyStyle`, b.style.cssText = B(e); const D = document.createElement(`div`); D.className = `cueUniWrapper`, D.style.cssText = `unicode-bidi: normal; direction: ltr;`; for (let M = 0; M < A.p.length; ++M) for (var N = A.p[M], C = 0, h = 0; h < N.spans.length; ++h) { var w; var O; var P; const L = N.spans[h]; L.line.length > 0 && (h !== 0 && C != L.row && ((P = document.createElement(`br`)).className = `lineBreak`, D.appendChild(P)), w = !1, C === L.row && (w = !0), C = L.row, O = d[L.name], (P = document.createElement(`span`)).className = `spanPadding ${L.name} customSpanColor`, P.style.cssText = B(e, O), h !== 0 && w ? h === N.spans.length - 1 ? P.textContent = L.line.replace(/\s+$/g, ``) : P.textContent = L.line : N.spans.length > 1 && h < N.spans.length - 1 && L.row === N.spans[h + 1].row ? P.textContent = L.line.replace(/^\s+/g, ``) : P.textContent = L.line.trim(), D.appendChild(P)); }b.appendChild(D), R.appendChild(b); var x; const F = { bodyStyle: [`%`, 90] }; for (x in d)d.hasOwnProperty(x) && (F[x] = [`%`, 90]); S.push({ type: `html`, start: t, end: n, cueHTMLElement: R, cueID: I, cellResolution: [32, 15], isFromCEA608: !0, fontSize: F, lineHeight: {}, linePadding: {} }); } return S; } }; }a.__dashjs_factory_name = `EmbeddedTextHtmlRender`, n.default = e.default.getSingletonFactory(a), t.exports = n.default; }, { 47: 47 }], 205: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const E = r(e(108)); const y = r(e(46)); const v = r(e(54)); const i = r(e(47)); const T = r(e(220)); const S = r(e(104)); const A = r(e(207)); const I = r(e(232)); const R = r(e(51)); const b = `NotFragmentedTextBufferController`; function a (e) { e = e || {}; const r = this.context; const t = (0, y.default)(r).getInstance(); const i = (0, A.default)(r).getInstance(); const a = e.errHandler; const o = e.streamInfo; const s = e.type; const u = e.mimeType; const l = e.fragmentModel; let n = void 0; let d = void 0; let f = void 0; let c = void 0; let h = void 0; let p = void 0; function g (e) { c = e; } function _ (e) { p.extract(o.id, e.currentRepresentation.id) === null && (d = !1, t.trigger(v.default.INIT_FRAGMENT_NEEDED, { representationId: e.currentRepresentation.id, sender: n }, { streamId: o.id, mediaType: s })); } function m (e) { e.chunk.bytes && (p.save(e.chunk), h.append(e.chunk), d = !0, t.trigger(v.default.STREAM_COMPLETED, { request: e.request }, { streamId: o.id, mediaType: s })); } return n = { getBufferControllerType: function () { return b; }, initialize: function (e) { g(e), p = (0, T.default)(r).getInstance(); }, createBuffer: function (e) { let t; const n = e[0]; try { return h = (0, S.default)(r).create(c, n), f || ((t = h.getBuffer()).hasOwnProperty(E.default.INITIALIZE) && t.initialize(u, o, e, l), f = !0), h; } catch (e) { if (n && (n.isText || n.codec.indexOf(`codecs="stpp`) !== -1 || n.codec.indexOf(`codecs="wvtt`) !== -1)) try { h = i.getTextSourceBuffer(); } catch (e) { a.error(new I.default(R.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE, `${R.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE + s} : ${e.message}`)); } else a.error(new I.default(R.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE, R.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE + s)); } }, getStreamId: function () { return o.id; }, getType: function () { return s; }, getBuffer: function () { return h; }, getBufferLevel: function () { return 0; }, setMediaSource: g, getMediaSource: function () { return c; }, getIsBufferingCompleted: function () { return d; }, getIsPruningInProgress: function () { return !1; }, dischargePreBuffer: function () {}, appendInitSegment: function (e) { return p.extract(o.id, e) !== null; }, getRangeAt: function () { return null; }, reset: function (e) { t.off(v.default.DATA_UPDATE_COMPLETED, _, n), t.off(v.default.INIT_FRAGMENT_LOADED, m, n), !e && h && (h.abort(), h.reset(), h = null); }, updateTimestampOffset: function (e) { h.timestampOffset === e || isNaN(e) || (h.timestampOffset = e); } }, c = null, d = f = !1, t.on(v.default.DATA_UPDATE_COMPLETED, _, n), t.on(v.default.INIT_FRAGMENT_LOADED, m, n), n; }a.__dashjs_factory_name = b, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 104: 104, 108: 108, 207: 207, 220: 220, 232: 232, 46: 46, 47: 47, 51: 51, 54: 54 }], 206: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const a = r(e(108)); const i = r(e(47)); const o = r(e(114)); const s = r(e(205)); function u (e) { e = e || {}; let t; const n = this.context; let r = void 0; function i () { return r.getBuffer(); } return t = { getBufferControllerType: function () { return r.getBufferControllerType(); }, initialize: function (e, t) { return r.initialize(e, t); }, createBuffer: function (e, t) { return r.createBuffer(e, t); }, getType: function () { return r.getType(); }, getBuffer: i, setBuffer: function (e) { r.setBuffer(e); }, getBufferLevel: function () { return r.getBufferLevel(); }, setMediaSource: function (e) { r.setMediaSource(e); }, getMediaSource: function () { return r.getMediaSource(); }, getIsBufferingCompleted: function () { return r.getIsBufferingCompleted(); }, getIsPruningInProgress: function () { return r.getIsPruningInProgress(); }, dischargePreBuffer: function () { return r.dischargePreBuffer(); }, appendInitSegment: function (e) { r.appendInitSegment(e); }, getRangeAt: function (e) { return r.getRangeAt(e); }, reset: function (e) { r.reset(e); }, updateTimestampOffset: function (e) { const t = i(); t.timestampOffset === e || isNaN(e) || (t.timestampOffset = e); }, updateAppendWindow: function () { r.updateAppendWindow(); } }, r = e.type === a.default.FRAGMENTED_TEXT ? (0, o.default)(n).create({ streamInfo: e.streamInfo, type: e.type, mediaPlayerModel: e.mediaPlayerModel, manifestModel: e.manifestModel, fragmentModel: e.fragmentModel, errHandler: e.errHandler, mediaController: e.mediaController, representationController: e.representationController, adapter: e.adapter, textController: e.textController, abrController: e.abrController, playbackController: e.playbackController, settings: e.settings }) : (0, s.default)(n).create({ streamInfo: e.streamInfo, type: e.type, mimeType: e.mimeType, fragmentModel: e.fragmentModel, errHandler: e.errHandler }), t; }u.__dashjs_factory_name = `TextBufferController`, n.default = i.default.getClassFactory(u), t.exports = n.default; }, { 108: 108, 114: 114, 205: 205, 47: 47 }], 207: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const N = r(e(108)); const i = r(e(47)); const C = r(e(208)); const w = r(e(209)); const O = r(e(228)); const P = r(e(226)); const L = r(e(46)); const x = r(e(54)); const F = e(225); function a () { const e = this.context; let t = void 0; let h = void 0; let n = void 0; let r = void 0; let i = void 0; let p = void 0; let a = void 0; let g = void 0; let _ = void 0; let o = void 0; let s = void 0; let u = void 0; let l = void 0; let d = void 0; let f = void 0; let c = void 0; let m = void 0; let E = void 0; let y = void 0; let v = void 0; let T = void 0; function S (e) { void 0 === T && e.fromStreamInfo !== null && (T = this.getCurrentTrackIdx()); } function A () { void 0 === T && (T = this.getCurrentTrackIdx()); } function I () { void 0 !== T && (this.setTextTrack(T), T = void 0); } function R (e) { const n = this; const t = e.tracks; let r = e.index; l && t.some((e, t) => { if (p.matchSettings(l, e)) return n.setTextTrack(t), r = t, !0; }), (!1 === c || void 0 === c && !l || v) && this.setTextTrack(-1), f = r, u.trigger(x.default.TEXT_TRACKS_ADDED, { enabled: D(), index: r, tracks: t }), y = !0; } function b (e) { d || !e || !e.newMediaInfo || (e = e.newMediaInfo).type === N.default.FRAGMENTED_TEXT && (l = { lang: e.lang, role: e.roles[0], accessibility: e.accessibility[0] }); } function D () { return m && !E ? !1 : !0; } function M () { v = y = !(m = !0); } return t = { setConfig: function (e) { e && (e.errHandler && (n = e.errHandler), e.adapter && (r = e.adapter), e.manifestModel && (i = e.manifestModel), e.mediaController && (p = e.mediaController), e.videoModel && (a = e.videoModel), e.streamController && (g = e.streamController), e.textTracks && (_ = e.textTracks), e.vttParser && (o = e.vttParser), e.ttmlParser && (s = e.ttmlParser), h.setConfig({ errHandler: n, adapter: r, manifestModel: i, mediaController: p, videoModel: a, streamController: g, textTracks: _, vttParser: o, ttmlParser: s })); }, getTextSourceBuffer: function () { return h; }, getAllTracksAreDisabled: function () { return m; }, addEmbeddedTrack: function (e) { h.addEmbeddedTrack(e); }, getTextDefaultLanguage: function () { return l && l.lang || ``; }, setTextDefaultLanguage: function (e) { (0, F.checkParameterType)(e, `string`), (l = l || {}).lang = e, d = !0; }, setTextDefaultEnabled: function (e) { (0, F.checkParameterType)(e, `boolean`), (c = e) ? m = !1 : this.setTextTrack(-1); }, getTextDefaultEnabled: function () { return void 0 !== c && c; }, setInitialSettings: function (e) { l = e, d = !0; }, enableText: function (e) { (0, F.checkParameterType)(e, `boolean`), !c && e && (c = !0), D() !== e && (e && this.setTextTrack(f), e || (f = this.getCurrentTrackIdx(), y ? this.setTextTrack(-1) : v = !0)); }, isTextEnabled: D, setTextTrack: function (e) { const t = h.getConfig(); const n = t.fragmentModel; const r = t.fragmentedTracks; const i = t.videoModel; let a = void 0; let o = void 0; m = e === -1; const s = _.getCurrentTrackIdx(); if (s !== e) { m && p && p.saveTextSettingsDisabled(), _.setModeForTrackIdx(s, N.default.TEXT_HIDDEN), _.setCurrentTrackIdx(e), _.setModeForTrackIdx(e, N.default.TEXT_SHOWING); const u = _.getCurrentTrackInfo(); if (u && u.isFragmented && !u.isEmbedded) for (var l = 0; l < r.length; l++) { const d = r[l]; if (u.lang === d.lang && u.index === d.index && (d.id ? u.id === d.id : u.id === d.index)) if (d !== p.getCurrentTrackFor(N.default.FRAGMENTED_TEXT, g.getActiveStreamInfo()))n.abortRequests(), n.removeExecutedRequestsBeforeTime(), h.remove(), _.deleteCuesFromTrackIdx(s), p.setTrack(d), h.setCurrentFragmentedTrackIdx(l); else if (s === -1) { for (var f = g.getActiveStreamProcessors(), c = 0; c < f.length; c++) if (f[c].getType() === N.default.FRAGMENTED_TEXT) { o = f[c]; break; }o.setBufferingTime(i.getTime()), o.getScheduleController().start(); } } else if (u && !u.isFragmented) { for (f = g.getActiveStreamProcessors(), l = 0; l < f.length; l++) if (f[l].getType() === N.default.TEXT) { a = (o = f[l]).getMediaInfoArr(); break; } if (o && a) for (l = 0; l < a.length; l++) if (a[l].index === u.index && a[l].lang === u.lang) { o.selectMediaInfo(a[l]); break; } } } }, getCurrentTrackIdx: function () { return _.getCurrentTrackIdx(); }, enableForcedTextStreaming: function (e) { (0, F.checkParameterType)(e, `boolean`), E = e; }, reset: function () { M(), h.resetEmbedded(), h.reset(); } }, l = null, _ = (v = d = y = E = !(f = -1), w.default)(e).getInstance(), o = (0, O.default)(e).getInstance(), s = (0, P.default)(e).getInstance(), h = (0, C.default)(e).getInstance(), u = (0, L.default)(e).getInstance(), _.initialize(), u.on(x.default.TEXT_TRACKS_QUEUE_INITIALIZED, R, t), u.on(x.default.CURRENT_TRACK_CHANGED, b, t), u.on(x.default.PERIOD_SWITCH_STARTED, S, t), u.on(x.default.STREAM_COMPLETED, A, t), u.on(x.default.PERIOD_SWITCH_COMPLETED, I, t), M(), t; }a.__dashjs_factory_name = `TextController`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 108: 108, 208: 208, 209: 209, 225: 225, 226: 226, 228: 228, 46: 46, 47: 47, 54: 54 }], 208: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const ee = r(e(108)); const te = e(248); const E = r(e(240)); const y = r(e(213)); const v = r(e(215)); const i = r(e(47)); const T = r(e(45)); const S = r(e(209)); const A = r(e(204)); const ne = r(e(9)); const re = r(e(2)); const I = r(e(46)); const R = r(e(54)); const ie = r(e(232)); const ae = r(e(51)); function a () { const o = this.context; const n = (0, I.default)(o).getInstance(); let i = !1; let s = void 0; let L = void 0; let x = void 0; let F = void 0; let u = void 0; let U = void 0; let l = void 0; let B = void 0; let r = void 0; let a = void 0; let d = void 0; let k = void 0; let G = void 0; let j = void 0; let Y = void 0; let f = void 0; let H = void 0; let c = void 0; let K = void 0; let q = void 0; let V = void 0; let W = void 0; let z = void 0; let X = void 0; let Q = void 0; let Z = void 0; function e () { Y = NaN, K = G = null, j = !(f = []); } function t () { e(), d = [], B = null; } function h (e) { e = e.chunk; e.mediaInfo.embeddedCaptions && _(e.bytes, e); } function p () { V = [], (k = (0, S.default)(o).getInstance()).setConfig({ videoModel: H }), k.initialize(), x = (0, y.default)(o).getInstance(), X = [], i = !(z = q = null), Q = (W = 0, A.default)(o).getInstance(); let e; const t = c.getActiveStreamProcessors(); for (e in t) if (t[e].getType() === `video`) { Z = t[e].getRepresentationInfo().MSETimeOffset; break; }n.on(R.default.VIDEO_CHUNK_RECEIVED, h, this), n.on(R.default.BUFFER_CLEARED, m, this); } function g (e) { q = e; } function $ (e, t) { let n; let r; const i = new E.default(); const a = { subtitle: `subtitles`, caption: `captions` }; i.captionData = e, i.lang = t.lang, i.labels = t.labels, i.id = t.id ? t.id : t.index, i.index = t.index, i.isTTML = (n = !1, t.codec && t.codec.search(ee.default.STPP) >= 0 && (n = !0), t.mimeType && t.mimeType.search(ee.default.TTML) >= 0 && (n = !0), n), i.defaultTrack = (function (e) { let t = !1; V.length > 1 && e.isEmbedded ? t = e.id && e.id === ee.default.CC1 : V.length === 1 ? e.id && typeof e.id === `string` && e.id.substring(0, 2) === `CC` && (t = !0) : V.length === 0 && (t = e.index === d[0].index); return t; }(t)), i.isFragmented = !u.getIsTextTrack(t.mimeType), i.isEmbedded = !!t.isEmbedded, i.kind = r = (r = t.roles.length > 0 ? a[t.roles[0]] : a.caption) === a.caption || r === a.subtitle ? r : a.caption, i.roles = t.roles, i.accessibility = t.accessibility; e = (d ? d.length : 0) + V.length; k.addTextTrack(i, e); } function _ (e, t) { let n; var r = void 0; var i = void 0; var a = void 0; let o = void 0; let s = void 0; var u = void 0; const l = t.mediaInfo; const d = l.type; const f = l.mimeType; const c = l.codec || f; if (c) { if (d === ee.default.FRAGMENTED_TEXT) if (j || t.segmentType !== `InitializationSegment`) { if (!j) return; if (n = (s = x.getSamplesInfo(e)).sampleList, K === null && n.length > 0 && (K = n[0].cts - t.start * Y), c.search(ee.default.STPP) >= 0) for (B = B !== null ? B : J(c), i = 0; i < n.length; i++) { const h = (v = n[i]).cts; const p = h - K; this.buffered.add(p / Y, (p + v.duration) / Y); for (var g = new DataView(e, v.offset, v.subSizes[0]), u = ne.default.Utils.dataViewToString(g, ee.default.UTF8), _ = [], m = v.offset + v.subSizes[0], a = 1; a < v.subSizes.length; a++) { var E = new Uint8Array(e, m, v.subSizes[a]); var E = String.fromCharCode.apply(null, E); _.push(E), m += v.subSizes[a]; } try { const y = U.getValue().ttmlTimeIsRelative ? h / Y : 0; var r = B.parse(u, y, h / Y, (h + v.duration) / Y, _); k.addCaptions(q, K / Y, r); } catch (e) { G.removeExecutedRequestsBeforeTime(), this.remove(), L.error(`TTML parser error: ${e.message}`); } } else { for (var v, T = [], i = 0; i < n.length; i++) { (v = n[i]).cts -= K, this.buffered.add(v.cts / Y, (v.cts + v.duration) / Y); const S = e.slice(v.offset, v.offset + v.size); const A = ne.default.parseBuffer(S); for (a = 0; a < A.boxes.length; a++) { const I = A.boxes[a]; if (L.debug(`VTT box1: ${I.type}`), I.type !== `vtte` && I.type === `vttc`) for (L.debug(`VTT vttc boxes.length = ${I.boxes.length}`), o = 0; o < I.boxes.length; o++) { var R; var b; let D = I.boxes[o]; L.debug(`VTT box2: ${D.type}`), D.type === `payl` && (R = D.cue_text, L.debug(`VTT cue_text = ${R}`), b = v.cts / Y, D = (v.cts + v.duration) / Y, T.push({ start: b, end: D, data: R, styles: {} }), L.debug(`VTT ${b}-${D} : ${R}`)); } } }T.length > 0 && k.addCaptions(q, 0, T); } } else j = !0, Y = x.getMediaTimescaleFromMoov(e); else if (d === ee.default.TEXT) { g = new DataView(e, 0, e.byteLength); u = ne.default.Utils.dataViewToString(g, ee.default.UTF8); try { r = J(c).parse(u, 0), k.addCaptions(k.getCurrentTrackIdx(), 0, r); } catch (e) { F.error(new ie.default(ae.default.TIMED_TEXT_ERROR_ID_PARSE_CODE, ae.default.TIMED_TEXT_ERROR_MESSAGE_PARSE + e.message, u)); } } else if (d === ee.default.VIDEO) if (t.segmentType === te.HTTPRequest.INIT_SEGMENT_TYPE) { if (W === 0) for (W = x.getMediaTimescaleFromMoov(e), i = 0; i < V.length; i++)$(null, V[i]); } else { if (W === 0) return void L.warn(`CEA-608: No timescale for embeddedTextTrack yet`); t = (s = x.getSamplesInfo(e)).lastSequenceNumber; if (!X[0] && !X[1]) { let M; let N = void 0; for (i = 0; i < V.length; i++) { if (V[i].id === ee.default.CC1 ? N = k.getTrackIdxForId(ee.default.CC1) : V[i].id === ee.default.CC3 && (N = k.getTrackIdxForId(ee.default.CC3)), N === -1) return void L.warn(`CEA-608: data before track is ready.`); M = (function (i) { return function (e, t, n) { let r = null; (r = H.getTTMLRenderingDiv() ? Q.createHTMLCaptionsFromScreen(H.getElement(), e, t, n) : [{ start: e, end: t, data: n.getDisplayText(), styles: {} }]) && k.addCaptions(i, 0, r); }; }(N)), X[i] = new re.default.Cea608Parser(i + 1, { newCue: M }, null); } } if (W) { if (z !== null && t !== z + s.numSequences) for (i = 0; i < X.length; i++)X[i] && X[i].reset(); for (let C = (function (e, t) { if (t.length === 0) return null; for (var n = { splits: [], fields: [[], []] }, r = new DataView(e), i = 0; i < t.length; i++) for (let a = t[i], o = re.default.findCea608Nalus(r, a.offset, a.size), s = null, u = 0, l = 0; l < o.length; l++) for (let d = re.default.extractCea608DataFromRange(r, o[l]), f = 0; f < 2; f++)d[f].length > 0 && (a.cts !== s ? u = 0 : u += 1, n.fields[f].push([a.cts + Z * W, d[f], u]), s = a.cts); return n.fields.forEach((e) => { e.sort((e, t) => { return e[0] === t[0] ? e[2] - t[2] : e[0] - t[0]; }); }), n; }(e, s.sampleList)), w = 0; w < X.length; w++) { const O = C.fields[w]; const P = X[w]; if (P) for (i = 0; i < O.length; i++)P.addData(O[i][0] / W, O[i][1]); }z = t; } } } else L.error(`No text type defined`); } function J (e) { let t = void 0; return e.search(ee.default.VTT) >= 0 ? t = r : (e.search(ee.default.TTML) >= 0 || e.search(ee.default.STPP) >= 0) && (t = a), t; } function m (t) { V.forEach((e) => { e = k.getTrackIdxForId(e.id); e >= 0 && k.deleteCuesFromTrackIdx(e, t.from, t.to); }); } return s = { initialize: function (e, t, n, r) { i || p(), k.setConfig({ videoModel: H }), k.initialize(), x = x || (0, y.default)(o).getInstance(), (function (e, t, n, r) { e = !u.getIsTextTrack(e); if (d = d.concat(n), e) { G = r, s.buffered = (0, v.default)(o).create(), f = l.getTracksFor(ee.default.FRAGMENTED_TEXT, t); for (var i = l.getCurrentTrackFor(ee.default.FRAGMENTED_TEXT, t), a = 0; a < f.length; a++) if (f[a] === i) { g(a); break; } } for (a = 0; a < d.length; a++)$(null, d[a]); }(e, t, n, r)); }, append: _, abort: function () { k.deleteAllTextTracks(), e(), x = null, d = []; }, addEmbeddedTrack: function (e) { if (i || p(), e) if (e.id === ee.default.CC1 || e.id === ee.default.CC3) { for (let t = 0; t < V.length; t++) if (V[t].id === e.id) return; V.push(e); } else L.warn(`Embedded track ${e.id} not supported!`); }, resetEmbedded: function () { n.off(R.default.VIDEO_CHUNK_RECEIVED, h, this), n.off(R.default.BUFFER_CLEARED, m, this), k && k.deleteAllTextTracks(), i = !1, V = [], X = [null, null], z = null; }, setConfig: function (e) { e && (e.errHandler && (F = e.errHandler), e.adapter && (u = e.adapter), e.manifestModel && (U = e.manifestModel), e.mediaController && (l = e.mediaController), e.videoModel && (H = e.videoModel), e.streamController && (c = e.streamController), e.textTracks && (k = e.textTracks), e.vttParser && (r = e.vttParser), e.ttmlParser && (a = e.ttmlParser)); }, getConfig: function () { return { fragmentModel: G, fragmentedTracks: f, videoModel: H }; }, setCurrentFragmentedTrackIdx: g, remove: function (e, t) { void 0 === e && e === t && (e = this.buffered.start(0), t = this.buffered.end(this.buffered.length - 1)), this.buffered.remove(e, t); }, reset: function () { t(), k = H = c = null; } }, L = (0, T.default)(o).getInstance().getLogger(s), t(), s; }a.__dashjs_factory_name = `TextSourceBuffer`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 108: 108, 2: 2, 204: 204, 209: 209, 213: 213, 215: 215, 232: 232, 240: 240, 248: 248, 45: 45, 46: 46, 47: 47, 51: 51, 54: 54, 9: 9 }], 209: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const N = r(e(108)); const C = r(e(46)); const w = r(e(54)); const i = r(e(47)); const O = r(e(45)); const P = e(17); const L = e(225); function a () { const e = this.context; const p = (0, C.default)(e).getInstance(); let t = void 0; let u = void 0; let l = void 0; let g = void 0; let a = void 0; let o = void 0; let d = void 0; let _ = void 0; let m = void 0; let E = void 0; let y = void 0; let v = void 0; let r = void 0; let T = void 0; let S = void 0; let n = void 0; let A = void 0; let i = void 0; function s (e) { const t = a[e].kind; const n = void 0 !== a[e].id ? a[e].id : a[e].lang; const r = a[e].lang; const i = a[e].isTTML; var e = a[e].isEmbedded; return g.addTextTrack(t, n, r, i, e); } function f (e, t) { const n = g.getClientWidth(); const r = g.getClientHeight(); let i = g.getVideoWidth(); let a = g.getVideoHeight(); const o = g.getVideoRelativeOffsetTop(); const s = g.getVideoRelativeOffsetLeft(); if (i !== 0 && a !== 0) { let u = i / a; let l = !1; e.isFromCEA608 && (u = 3.5 / 3, l = !0); i = (function (e, t, n, r, i, a) { let o = 0; let s = 0; n / r < e / t ? o = (s = t) / r * n : s = (o = e) / n * r; n = 0, r = 0; return i < o / s ? n = (r = s) * i : r = (n = o) / i, e = (e - n) / 2, t = (t - r) / 2, a ? { x: e + 0.1 * n, y: t + 0.1 * r, w: 0.8 * n, h: 0.8 * r } : { x: e, y: t, w: n, h: r }; }.call(this, n, r, i, a, u, l)), a = i.w, u = i.h, l = i.x, i = i.y; if (a != E || u != y || l != _ || i != m || t) { _ = l + s, m = i + o, E = a, y = u, !v || (u = v.style) && (u.left = `${_}px`, u.top = `${m}px`, u.width = `${E}px`, u.height = `${y}px`, u.zIndex = T && document[T] || S ? A : null, p.trigger(w.default.CAPTION_CONTAINER_RESIZE)); const d = e.activeCues; if (d) for (let f = d.length, c = 0; c < f; ++c) { const h = d[c]; h.scaleCue(h); } } } } function c (e) { let t; let n = void 0; var r = void 0; let i = void 0; let a = void 0; let o = void 0; if (e.cellResolution) { const s = [E / e.cellResolution[0], y / e.cellResolution[1]]; if (e.linePadding) for (n in e.linePadding) if (e.linePadding.hasOwnProperty(n)) for (var r = (e.linePadding[n] * s[0]).toString(), u = document.getElementsByClassName(`spanPadding`), l = 0; l < u.length; l++)u[l].style.cssText = u[l].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi, `$1${r}`), u[l].style.cssText = u[l].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi, `$1${r}`); if (e.fontSize) { for (n in e.fontSize) if (e.fontSize.hasOwnProperty(n)) { e.fontSize[n][0] === `%` ? i = e.fontSize[n][1] / 100 : e.fontSize[n][0] === `c` && (i = e.fontSize[n][1]), r = (i * s[1]).toString(), o = n !== `defaultFontSize` ? document.getElementsByClassName(n) : document.getElementsByClassName(`paragraph`); for (let d = 0; d < o.length; d++)o[d].style.cssText = o[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi, `$1${r}`); } if (e.lineHeight) for (n in e.lineHeight) if (e.lineHeight.hasOwnProperty(n)) { e.lineHeight[n][0] === `%` ? a = e.lineHeight[n][1] / 100 : e.fontSize[n][0] === `c` && (a = e.lineHeight[n][1]), r = (a * s[1]).toString(), o = document.getElementsByClassName(n); for (let f = 0; f < o.length; f++)o[f].style.cssText = o[f].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi, `$1${r}`); } } }e.isd && ((t = document.getElementById(e.cueID)) && v.removeChild(t), h(e)); } function h (a) { let e; v && (e = document.createElement(`div`), v.appendChild(e), n = (0, P.renderHTML)(a.isd, e, (e) => { const t = /^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/; const n = /^#(.*)$/; if (t.test(e)) { var r = t.exec(e); var i = parseInt(r[4], 10) - 1; return `data:image/png;base64,${btoa(a.images[i])}`; } if (n.test(e)) { i = (r = n.exec(e))[1]; return `data:image/png;base64,${a.embeddedImages[i]}`; } return null; }, v.clientHeight, v.clientWidth, !1, (e) => { u.info(`renderCaption :`, e); }, n, !0), e.id = a.cueID, p.trigger(w.default.CAPTION_RENDERED, { captionDiv: e, currentTrackIdx: d })); } function I (e) { return e >= 0 && a[e] ? g.getTextTrack(a[e].kind, a[e].id, a[e].lang, a[e].isTTML, a[e].isEmbedded) : null; } function R (e) { let t; const n = this; e !== d && (t = I(d = e), (function (e) { M.call(this), (e && e.renderingType === `html` ? function () { let e = document.getElementById(`native-cue-style`); if (e) return; (e = document.createElement(`style`)).id = `native-cue-style`, document.head.appendChild(e); const t = e.sheet; const n = g.getElement(); try { n && (n.id ? t.insertRule(`#${n.id}::cue {background: transparent}`, 0) : n.classList.length !== 0 ? t.insertRule(`.${n.className}::cue {background: transparent}`, 0) : t.insertRule(`video::cue {background: transparent}`, 0)); } catch (e) { u.info(`${e.message}`); } } : D).call(this); }.call(this, t)), r && (clearInterval(r), r = null), t && t.renderingType === `html` && (f.call(this, t, !0), window.ResizeObserver ? (i = new window.ResizeObserver(() => { f.call(n, t, !0); })).observe(g.getElement()) : r = setInterval(f.bind(this, t), 500))); } function b (e, t, n) { if (e.cues) for (let r = e.cues, i = r.length - 1; i >= 0; i--)a = r[i], o = t, s = n, (isNaN(o) || a.startTime >= o) && (isNaN(s) || a.endTime <= s) && e.removeCue(r[i]); let a, o, s; } function D () { const e = document.getElementById(`native-cue-style`); e && document.head.removeChild(e); } function M () { if (v) for (;v.firstChild;)v.removeChild(v.firstChild); } return t = { initialize: function () { typeof window !== `undefined` && typeof navigator !== `undefined` && (l = window.VTTCue || window.TextTrackCue, a = [], o = [], S = !(d = -1), A = 2147483647, n = r = v = null, void (y = E = m = _ = 0) !== document.fullscreenElement ? T = `fullscreenElement` : void 0 !== document.webkitIsFullScreen ? T = `webkitIsFullScreen` : document.msFullscreenElement ? T = `msFullscreenElement` : document.mozFullScreen && (T = `mozFullScreen`)); }, setDisplayCConTop: function (e) { (0, L.checkParameterType)(e, `boolean`), S = e, v && !document[T] && (v.style.zIndex = e ? A : null); }, addTextTrack: function (e, t) { const i = this; a.length !== t ? (a.push(e), a.length === t && (function () { a.sort((e, t) => { return e.index - t.index; }), v = g.getTTMLRenderingDiv(); for (var r = -1, e = 0; e < a.length; e++) { let t = s.call(i, e); o.push(t), a[e].defaultTrack && (t.default = !0, r = e); t = I(e); t && (t.mode = N.default.TEXT_SHOWING, v && (a[e].isTTML || a[e].isEmbedded) ? t.renderingType = `html` : t.renderingType = `default`), i.addCaptions(e, 0, a[e].captionData), p.trigger(w.default.TEXT_TRACK_ADDED); }R.call(i, r), r >= 0 && (function () { function t () { const e = I(r); e && f.call(this, e, !0), p.off(w.default.PLAYBACK_METADATA_LOADED, t, this); }p.on(w.default.PLAYBACK_METADATA_LOADED, t, i); for (let e = 0; e < a.length; e++) { const n = I(e); n && (n.mode = e === r ? N.default.TEXT_SHOWING : N.default.TEXT_HIDDEN); } }()), p.trigger(w.default.TEXT_TRACKS_QUEUE_INITIALIZED, { index: d, tracks: a }); }())) : u.error(`Trying to add too many tracks.`); }, addCaptions: function (e, t, n) { const r = I(e); const i = this; if (r && Array.isArray(n) && n.length !== 0) for (let a = 0; a < n.length; a++) { let o = void 0; const s = n[a]; r.cellResolution = s.cellResolution, r.isFromCEA608 = s.isFromCEA608, s.type === `html` && v ? ((o = new l(s.start - t, s.end - t, ``)).cueHTMLElement = s.cueHTMLElement, o.isd = s.isd, o.images = s.images, o.embeddedImages = s.embeddedImages, o.cueID = s.cueID, o.scaleCue = c.bind(i), o.cellResolution = s.cellResolution, o.lineHeight = s.lineHeight, o.linePadding = s.linePadding, o.fontSize = s.fontSize, v.style.left = `${_}px`, v.style.top = `${m}px`, v.style.width = `${E}px`, v.style.height = `${y}px`, o.onenter = function () { r.mode === N.default.TEXT_SHOWING && (this.isd ? (h(this), u.debug(`Cue enter id:${this.cueID}`)) : (v.appendChild(this.cueHTMLElement), c.call(i, this), p.trigger(w.default.CAPTION_RENDERED, { captionDiv: this.cueHTMLElement, currentTrackIdx: d }))); }, o.onexit = function () { if (v) for (let e = v.childNodes, t = 0; t < e.length; ++t)e[t].id === this.cueID && (u.debug(`Cue exit id:${e[t].id}`), v.removeChild(e[t]), --t); }) : s.data && (o = new l(s.start - t, s.end - t, s.data), s.styles && (void 0 !== s.styles.align && `align` in o && (o.align = s.styles.align), void 0 !== s.styles.line && `line` in o && (o.line = s.styles.line), void 0 !== s.styles.position && `position` in o && (o.position = s.styles.position), void 0 !== s.styles.size && `size` in o && (o.size = s.styles.size)), o.onenter = function () { r.mode === N.default.TEXT_SHOWING && p.trigger(w.default.CAPTION_RENDERED, { currentTrackIdx: d }); }); try { o ? r.addCue(o) : u.error(`impossible to display subtitles.`); } catch (e) { throw b(r), r.addCue(o), e; } } }, getCurrentTrackIdx: function () { return d; }, setCurrentTrackIdx: R, getTrackIdxForId: function (e) { for (var t = -1, n = 0; n < a.length; n++) if (a[n].id === e) { t = n; break; } return t; }, getCurrentTrackInfo: function () { return a[d]; }, setModeForTrackIdx: function (e, t) { (e = I(e)) && e.mode !== t && (e.mode = t); }, deleteCuesFromTrackIdx: function (e, t, n) { (e = I(e)) && b(e, t, n); }, deleteAllTextTracks: function () { for (let e = o ? o.length : 0, t = 0; t < e; t++) { const n = I(t); n && (b.call(this, n), n.mode = `disabled`); }o = [], a = [], r && (clearInterval(r), r = null), i && g && (i.unobserve(g.getElement()), i = null), d = -1, M.call(this); }, deleteTextTrack: function (e) { g.removeChild(o[e]), o.splice(e, 1); }, setConfig: function (e) { e && e.videoModel && (g = e.videoModel); } }, u = (0, O.default)(e).getInstance().getLogger(t), t; }a.__dashjs_factory_name = `TextTracks`, n.default = i.default.getSingletonFactory(a), t.exports = n.default; }, { 108: 108, 17: 17, 225: 225, 45: 45, 46: 46, 47: 47, 54: 54 }], 210: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(108)); const s = r(e(241)); const u = r(e(211)); const l = r(e(231)); const d = e(80); function o (e) { let t; const n = this.context; const r = e.streamInfo; let o = void 0; function i () { o && o.reset(); } return t = { getStreamId: function () { return r.id; }, provide: function (e, t) { if (typeof t === `function`) { let n = o.getCurrentTrack(); let r = void 0; if (!n || n.segmentDuration <= 0 || e == null)t(null); else { isNaN(n.segmentDuration) && (r = o.getThumbnailRequestForTime(e)) && (n.segmentDuration = r.duration), i = e % n.segmentDuration; var i = Math.floor(i * n.tilesHor * n.tilesVert / n.segmentDuration); const a = new s.default(); if (a.width = Math.floor(n.widthPerTile), a.height = Math.floor(n.heightPerTile), a.x = Math.floor(i % n.tilesHor) * n.widthPerTile, a.y = Math.floor(i / n.tilesHor) * n.heightPerTile, `readThumbnail` in n) return n.readThumbnail(e, (e) => { a.url = e, t(a); }); r ? (a.url = r.url, n.segmentDuration = NaN) : (r = Math.floor(e / n.segmentDuration), a.url = (n = (e = r) + (r = n).startNumber, e = (0, d.replaceTokenForTemplate)(r.templateUrl, `Number`, n), e = (0, d.replaceTokenForTemplate)(e, `Time`, (n - 1) * r.segmentDuration), e = (0, d.replaceTokenForTemplate)(e, `Bandwidth`, r.bandwidth), (0, d.unescapeDollarsInTemplate)(e))), t(a); } } }, setTrackByIndex: function (e) { o.setTrackByIndex(e); }, getCurrentTrackIndex: function () { return o.getCurrentTrackIndex(); }, getBitrateList: function () { const e = o.getTracks(); let n = 0; return e.map((e) => { const t = new l.default(); return t.mediaType = a.default.IMAGE, t.qualityIndex = n++, t.bitrate = e.bitrate, t.width = e.width, t.height = e.height, t; }); }, reset: i }, i(), o = (0, u.default)(n).create({ streamInfo: r, adapter: e.adapter, baseURLController: e.baseURLController, timelineConverter: e.timelineConverter, debug: e.debug, eventBus: e.eventBus, events: e.events, dashConstants: e.dashConstants }), t; }o.__dashjs_factory_name = `ThumbnailController`, n.default = i.default.getClassFactory(o), t.exports = n.default; }, { 108: 108, 211: 211, 231: 231, 241: 241, 47: 47, 80: 80 }], 211: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const v = r(e(108)); const T = r(e(61)); const i = r(e(47)); const S = r(e(242)); const A = r(e(227)); const I = e(80); const R = r(e(54)); const b = r(e(213)); const D = r(e(160)); const M = r(e(57)); const N = [`http://dashif.org/thumbnail_tile`, `http://dashif.org/guidelines/thumbnail_tile`]; function a (e) { const t = this.context; const s = e.adapter; const u = e.baseURLController; const r = e.streamInfo; const l = e.timelineConverter; const n = e.debug; const i = e.eventBus; const a = e.events; const o = e.dashConstants; const d = (0, A.default)(t).getInstance(); var e = void 0; let f = void 0; let c = void 0; let h = void 0; let p = void 0; let g = void 0; let _ = void 0; function m () { y(), g = (0, D.default)(t).create({}), _ = (0, b.default)(t).getInstance(), (c = (0, M.default)(t).create({ streamInfo: r, timelineConverter: l, baseURLController: u, debug: n, eventBus: i, events: a, dashConstants: o, urlUtils: d })).initialize(!!s && s.getIsDynamic()), (function () { if (!r || !s) return; if (!(p = s.getMediaInfoForType(r, v.default.IMAGE))) return; const e = s.getVoRepresentations(p); e && e.length > 0 && e.forEach((e) => { (e.segmentInfoType === T.default.SEGMENT_TEMPLATE && e.segmentDuration > 0 && e.media || e.segmentInfoType === T.default.SEGMENT_TIMELINE) && E(e), e.segmentInfoType === T.default.SEGMENT_BASE && E(e, !0); }); f.length > 0 && (f.sort((e, t) => { return e.bitrate - t.bitrate; }), h = f.length - 1); }()); } function E (e, t) { const n = new S.default(); n.id = e.id, n.bitrate = e.bandwidth, n.width = e.width, n.height = e.height, n.tilesHor = 1, n.tilesVert = 1, e.essentialProperties && e.essentialProperties.forEach((e) => { N.indexOf(e.schemeIdUri) >= 0 && e.value && ((e = e.value.split(`x`)).length !== 2 || isNaN(e[0]) || isNaN(e[1]) || (n.tilesHor = parseInt(e[0], 10), n.tilesVert = parseInt(e[1], 10))); }), t ? i.trigger(R.default.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED, { streamId: r.id, mediaType: v.default.IMAGE, mimeType: p.mimeType, representation: e, callback: function (e, t, i, a) { const o = []; i = (function (e, t) { for (var n, r = [], i = 0, a = void 0, a = 0, o = e.length; a < o; a++)n = e[a], (n = (0, I.getTimeBasedSegment)(l, s.getIsDynamic(), t, n.startTime, n.duration, n.timescale, n.media, n.mediaRange, i)) && (r.push(n), i++); return r; }(i, a)), n.segmentDuration = i[0].duration, n.readThumbnail = function (t, r) { let n = null; o.some((e) => { if (e.start <= t && e.end > t) return n = e.url, !0; }), n ? r(n) : i.some((n) => { if (n.mediaStartTime <= t && n.mediaStartTime + n.duration > t) { const e = u.resolve(a.path); return g.load({ method: `get`, url: e.url, request: { range: n.mediaRange, responseType: `arraybuffer` }, onload: function (e) { var t = _.getSamplesInfo(e.target.response); var t = new Blob([e.target.response.slice(t.sampleList[0].offset, t.sampleList[0].offset + t.sampleList[0].size)], { type: `image/jpeg` }); var t = window.URL.createObjectURL(t); o.push({ start: n.mediaStartTime, end: n.mediaStartTime + n.duration, url: t }), r && r(t); } }), !0; } }); }; } }) : (n.startNumber = e.startNumber, n.segmentDuration = e.segmentDuration, n.timescale = e.timescale, n.templateUrl = (t = e, (e = d.isRelative(t.media) ? d.resolve(t.media, u.resolve(t.path).url) : t.media) ? (0, I.replaceIDForTemplate)(e, t.id) : ``)), n.tilesHor > 0 && n.tilesVert > 0 && (n.widthPerTile = n.width / n.tilesHor, n.heightPerTile = n.height / n.tilesVert, f.push(n)); } function y () { f = [], h = -1, p = null; } return e = { initialize: m, getTracks: function () { return f; }, reset: y, setTrackByIndex: function (e) { f && f.length !== 0 && (e >= f.length && (e = f.length - 1), h = e); }, getCurrentTrack: function () { return h < 0 ? null : f[h]; }, getCurrentTrackIndex: function () { return h; }, getThumbnailRequestForTime: function (e) { for (var t = void 0, n = s.getVoRepresentations(p), r = 0; r < n.length; r++) if (f[h].id === n[r].id) { t = n[r]; break; } return c.getSegmentRequestForTime(p, t, e); } }, m(), e; }n.THUMBNAILS_SCHEME_ID_URIS = N, a.__dashjs_factory_name = `ThumbnailTracks`, n.default = i.default.getClassFactory(a); }, { 108: 108, 160: 160, 213: 213, 227: 227, 242: 242, 47: 47, 54: 54, 57: 57, 61: 61, 80: 80 }], 212: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const u = r(e(51)); const l = r(e(46)); const d = r(e(54)); const f = r(e(113)); const c = r(e(230)); const h = r(e(229)); const i = r(e(47)); const p = r(e(232)); const g = e(225); function a () { let e; const t = this.context; const r = (0, l.default)(t).getInstance(); let n = void 0; let i = void 0; let a = void 0; let o = void 0; function s () { n.reset(); } return e = { chooseSelector: function (e) { (0, g.checkParameterType)(e, `boolean`), o = e ? a : i; }, select: function (e) { if (e) { const t = e.baseUrls; let n = e.selectedIdx; if (!isNaN(n)) return t[n]; n = o.select(t); return n ? (e.selectedIdx = t.indexOf(n), n) : (r.trigger(d.default.URL_RESOLUTION_FAILED, { error: new p.default(u.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE, u.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE) }), void (o === i && s())); } }, reset: s, setConfig: function (e) { e.selector && (o = e.selector); } }, n = (0, f.default)(t).create({ updateEventName: d.default.SERVICE_LOCATION_BLACKLIST_CHANGED, addBlacklistEventName: d.default.SERVICE_LOCATION_BLACKLIST_ADD }), i = (0, h.default)(t).create({ blacklistController: n }), a = (0, c.default)(t).create({ blacklistController: n }), o = i, e; }a.__dashjs_factory_name = `BaseURLSelector`, n.default = i.default.getClassFactory(a), t.exports = n.default; }, { 113: 113, 225: 225, 229: 229, 230: 230, 232: 232, 46: 46, 47: 47, 51: 51, 54: 54 }], 213: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(45)); const a = r(e(221)); const o = r(e(47)); const s = r(e(9)); const d = r(e(237)); function u () { let r = void 0; let e = void 0; const n = this.context; function w (e) { if (!e) return null; void 0 === e.fileStart && (e.fileStart = 0); const t = s.default.parseBuffer(e); var e = (0, a.default)(n).create(); return e.setData(t), e; } function u (e, t) { return e[t + 3] >>> 0 | e[t + 2] << 8 >>> 0 | e[t + 1] << 16 >>> 0 | e[t] << 24 >>> 0; } function l (e, t) { return String.fromCharCode(e[t++]) + String.fromCharCode(e[t++]) + String.fromCharCode(e[t++]) + String.fromCharCode(e[t]); } return e = { parse: w, findLastTopIsoBoxCompleted: function (e, t, n) { if (void 0 === n && (n = 0), !t || n + 8 >= t.byteLength) return new d.default(0, !1); for (var r = t instanceof ArrayBuffer ? new Uint8Array(t) : t, i = void 0, a = 0; n < r.byteLength;) { const o = u(r, n); const s = l(r, n + 4); if (o === 0) break; n + o <= r.byteLength && (e.indexOf(s) >= 0 ? i = new d.default(n, !0, o) : a = n + o), n += o; } return i || new d.default(a, !1); }, getMediaTimescaleFromMoov: function (e) { return (e = (e = w(e)) ? e.getBox(`mdhd`) : void 0) ? e.timescale : NaN; }, getSamplesInfo: function (e) { if (!e || e.byteLength === 0) return { sampleList: [], lastSequenceNumber: NaN, totalDuration: NaN, numSequences: NaN }; for (var t, n, r, i = w(e), a = i.getBoxes(`moof`), o = i.getBoxes(`mfhd`), s = void 0, u = void 0, l = void 0, d = void 0, f = void 0, c = void 0, h = void 0, p = void 0, g = void 0, e = void 0, _ = void 0, e = i.getBoxes(`moof`).length, o = o[o.length - 1].sequence_number, u = [], m = -1, E = -1, c = 0; c < a.length; c++) for (var y = a[c], v = y.getChildBoxes(`traf`), d = 0; d < v.length; d++) { for (var T = v[d], S = T.getChildBox(`tfhd`), A = T.getChildBox(`tfdt`), s = A.baseMediaDecodeTime, I = T.getChildBoxes(`trun`), R = T.getChildBoxes(`subs`), f = 0; f < I.length; f++) for (var b = I[f], D = b.sample_count, g = (S.base_data_offset || 0) + (b.data_offset || 0), l = 0; l < D; l++) { t = void 0 !== (r = b.samples[l]).sample_duration ? r.sample_duration : S.default_sample_duration, n = void 0 !== r.sample_size ? r.sample_size : S.default_sample_size; const M = { dts: s, cts: s + (void 0 !== r.sample_composition_time_offset ? r.sample_composition_time_offset : 0), duration: t, offset: y.offset + g, size: n, subSizes: [n] }; if (R) for (h = 0; h < R.length; h++) { const N = R[h]; if (m < N.entry_count - 1 && E < l && (m++, E += N.entries[m].sample_delta), l == E) { M.subSizes = []; for (var C = N.entries[m], p = 0; p < C.subsample_count; p++)M.subSizes.push(C.subsamples[p].subsample_size); } }u.push(M), g += n, s += t; }_ = s - A.baseMediaDecodeTime; } return { sampleList: u, lastSequenceNumber: o, totalDuration: _, numSequences: e }; }, findInitRange: function (e) { let t = null; let n = w(e); return n && (e = n.getBox(`ftyp`), n = n.getBox(`moov`), r.debug(`Searching for initialization.`), n && n.isComplete && (t = `${(e || n).offset}-${n.offset + n.size - 1}`, r.debug(`Found the initialization.  Range: ${t}`))), t; }, parsePayload: function (e, t, n) { if (void 0 === n && (n = 0), !t || n + 8 >= t.byteLength) return new d.default(0, !1); for (var r = t instanceof ArrayBuffer ? new Uint8Array(t) : t, i = void 0, a = 0; n < r.byteLength;) { const o = u(r, n); const s = l(r, n + 4); if (o === 0) break; n + o <= r.byteLength && (e.indexOf(s) >= 0 ? i = new d.default(n, !0, o, s) : a = n + o), n += o; } return i || new d.default(a, !1); } }, r = (0, i.default)(n).getInstance().getLogger(e), e; }u.__dashjs_factory_name = `BoxParser`, n.default = o.default.getSingletonFactory(u), t.exports = n.default; }, { 221: 221, 237: 237, 45: 45, 47: 47, 9: 9 }], 214: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a () { let e; let t = void 0; return t = !(e = { supportsMediaSource: function () { const e = `WebKitMediaSource` in window; const t = `MediaSource` in window; return e || t; }, supportsEncryptedMedia: function () { return t; }, supportsCodec: function (e) { return !!(`MediaSource` in window && MediaSource.isTypeSupported(e)) || !!(`WebKitMediaSource` in window && WebKitMediaSource.isTypeSupported(e)); }, setEncryptedMediaSupported: function (e) { t = e; } }), e; }a.__dashjs_factory_name = `Capabilities`, n.default = e.default.getSingletonFactory(a), t.exports = n.default; }, { 47: 47 }], 215: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); const a = (r = i) && r.__esModule ? r : { default: r }; const o = e(225); function s () { return { customTimeRangeArray: [], length: 0, add: function (e, t) { for (var n = 0, n = 0; n < this.customTimeRangeArray.length && e > this.customTimeRangeArray[n].start; n++);for (this.customTimeRangeArray.splice(n, 0, { start: e, end: t }), n = 0; n < this.customTimeRangeArray.length - 1; n++) this.mergeRanges(n, n + 1) && n--; this.length = this.customTimeRangeArray.length; }, clear: function () { this.customTimeRangeArray = [], this.length = 0; }, remove: function (e, t) { for (let n = 0; n < this.customTimeRangeArray.length; n++) if (e <= this.customTimeRangeArray[n].start && t >= this.customTimeRangeArray[n].end) this.customTimeRangeArray.splice(n, 1), n--; else { if (e > this.customTimeRangeArray[n].start && t < this.customTimeRangeArray[n].end) { this.customTimeRangeArray.splice(n + 1, 0, { start: t, end: this.customTimeRangeArray[n].end }), this.customTimeRangeArray[n].end = e; break; }e > this.customTimeRangeArray[n].start && e < this.customTimeRangeArray[n].end ? this.customTimeRangeArray[n].end = e : t > this.customTimeRangeArray[n].start && t < this.customTimeRangeArray[n].end && (this.customTimeRangeArray[n].start = t); } this.length = this.customTimeRangeArray.length; }, mergeRanges: function (e, t) { const n = this.customTimeRangeArray[e]; const r = this.customTimeRangeArray[t]; return n.start <= r.start && r.start <= n.end && n.end <= r.end ? (n.end = r.end, this.customTimeRangeArray.splice(t, 1), !0) : r.start <= n.start && n.start <= r.end && r.end <= n.end ? (n.start = r.start, this.customTimeRangeArray.splice(t, 1), !0) : r.start <= n.start && n.start <= r.end && n.end <= r.end ? (this.customTimeRangeArray.splice(e, 1), !0) : n.start <= r.start && r.start <= n.end && r.end <= n.end && (this.customTimeRangeArray.splice(t, 1), !0); }, start: function (e) { return (0, o.checkInteger)(e), e >= this.customTimeRangeArray.length || e < 0 ? NaN : this.customTimeRangeArray[e].start; }, end: function (e) { return (0, o.checkInteger)(e), e >= this.customTimeRangeArray.length || e < 0 ? NaN : this.customTimeRangeArray[e].end; } }; }s.__dashjs_factory_name = `CustomTimeRanges`, n.default = a.default.getClassFactory(s), t.exports = n.default; }, { 225: 225, 47: 47 }], 216: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const d = r(e(45)); const f = r(e(108)); const c = [{ oldKey: `dashjs_vbitrate`, newKey: `dashjs_video_bitrate` }, { oldKey: `dashjs_abitrate`, newKey: `dashjs_audio_bitrate` }, { oldKey: `dashjs_vsettings`, newKey: `dashjs_video_settings` }, { oldKey: `dashjs_asettings`, newKey: `dashjs_audio_settings` }]; const h = `dashjs_?_bitrate`; const p = `dashjs_?_settings`; const g = `localStorage`; const _ = `lastBitrate`; const m = `lastMediaSettings`; function a (e) { e = e || {}; const t = this.context; const a = e.settings; let n = void 0; let o = void 0; let r = void 0; function i (e) { if (void 0 !== r) return r; r = !1; let t = void 0; try { typeof window !== `undefined` && (t = window[e]); } catch (e) { return o.warn(`DOMStorage access denied: ${e.message}`), r; } if (!t || e !== g && e !== `sessionStorage`) return r; try { t.setItem(`1`, `1`), t.removeItem(`1`), r = !0; } catch (e) { o.warn(`DOMStorage is supported, but cannot be used: ${e.message}`); } return r; } function s () { return 6e5 * Math.round((new Date()).getTime() / 6e5); } function u (e, t) { return i(e) && a.get().streaming[`${t}CachingInfo`].enabled; } function l () { if (!a) throw new Error(f.default.MISSING_CONFIG_ERROR); } return n = { getSavedBitrateSettings: function (e) { let t = NaN; if (l(), u(g, _)) { const n = h.replace(/\?/, e); try { var r = JSON.parse(localStorage.getItem(n)) || {}; const i = (new Date()).getTime() - parseInt(r.timestamp, 10) >= a.get().streaming.lastBitrateCachingInfo.ttl || !1; var r = parseFloat(r.bitrate); isNaN(r) || i ? i && localStorage.removeItem(n) : (t = r, o.debug(`Last saved bitrate for ${e} was ${r}`)); } catch (e) { return null; } } return t; }, setSavedBitrateSettings: function (e, t) { if (u(g, _) && t) { const n = h.replace(/\?/, e); try { localStorage.setItem(n, JSON.stringify({ bitrate: t.toFixed(3), timestamp: s() })); } catch (e) { o.error(e.message); } } }, getSavedMediaSettings: function (e) { var t = null; if (l(), u(g, m)) { const n = p.replace(/\?/, e); try { const r = JSON.parse(localStorage.getItem(n)) || {}; const i = (new Date()).getTime() - parseInt(r.timestamp, 10) >= a.get().streaming.lastMediaSettingsCachingInfo.ttl || !1; var t = r.settings; i && (localStorage.removeItem(n), t = null); } catch (e) { return null; } } return t; }, setSavedMediaSettings: function (e, t) { if (u(g, m)) { const n = p.replace(/\?/, e); try { localStorage.setItem(n, JSON.stringify({ settings: t, timestamp: s() })); } catch (e) { o.error(e.message); } } } }, o = (0, d.default)(t).getInstance().getLogger(n), i(g) && c.forEach((e) => { const t = localStorage.getItem(e.oldKey); if (t) { localStorage.removeItem(e.oldKey); try { localStorage.setItem(e.newKey, t); } catch (e) { o.error(e.message); } } }), n; }a.__dashjs_factory_name = `DOMStorage`; i = i.default.getSingletonFactory(a); n.default = i, t.exports = n.default; }, { 108: 108, 45: 45, 47: 47 }], 217: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a () { function e (t, e) { try { return new window.URL(t, e).toString(); } catch (e) { return t; } } function t (e, t) { let n = s; return t && d(e) ? (f(e) && (n = u), c(e) && (n = l), n = n(t), t = n.charAt(n.length - 1) !== `/` && e.charAt(0) !== `/` ? `/` : ``, [n, e].join(t)) : e; } let n = void 0; const r = /^[a-z][a-z0-9+\-_.]*:/i; const i = /^https?:\/\//i; const a = /^https:\/\//i; const o = /^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i; function s (e) { const t = e.indexOf(`/`); const n = e.lastIndexOf(`/`); return t !== -1 ? n === t + 1 ? e : (e.indexOf(`?`) !== -1 && (e = e.substring(0, e.indexOf(`?`))), e.substring(0, n + 1)) : ``; } function u (e) { e = e.match(o); return e ? e[1] : ``; } function l (e) { e = e.match(r); return e ? e[0] : ``; } function d (e) { return !r.test(e); } function f (e) { return d(e) && e.charAt(0) === `/`; } function c (e) { return e.indexOf(`//`) === 0; } return (function () { try { new window.URL(`x`, `http://y`); n = e; } catch (e) {} finally { n = n || t; } }()), { parseBaseUrl: s, parseOrigin: u, parseScheme: l, isRelative: d, isPathAbsolute: f, isSchemeRelative: c, isHTTPURL: function (e) { return i.test(e); }, isHTTPS: function (e) { return a.test(e); }, removeHostname: function (e) { return /^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1); }, resolve: function (e, t) { return n(e, t); } }; }a.__dashjs_factory_name = `DefaultURLUtils`, n.default = e.default.getSingletonFactory(a), t.exports = n.default; }, { 47: 47 }], 218: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a (e) { e = e || {}; let n = void 0; const s = new DataView(e.data); let u = 0; function r (e, t) { let n = !0; let r = 0; if (void 0 === t && (t = !1), r = e.tag > 16777215 ? (s.getUint32(u) !== e.tag && (n = !1), 4) : e.tag > 65535 ? (256 * s.getUint16(u) + s.getUint8(u + 2) !== e.tag && (n = !1), 3) : e.tag > 255 ? (s.getUint16(u) !== e.tag && (n = !1), 2) : (s.getUint8(u) !== e.tag && (n = !1), 1), !n && e.required && !t) throw new Error(`required tag not found`); return n && (u += r), n; } function i (e) { for (var t = 1, n = 128, r = -1, i = 0, a = s.getUint8(u), o = 0, o = 0; o < 8; o += 1) { if ((a & n) === n) { i = void 0 === e ? a & ~n : a, r = o; break; }n >>= 1; } for (o = 0; o < r; o += 1, t += 1)i = i << 8 | 255 & s.getUint8(u + t); return u += t, i; } return n = { getPos: function () { return u; }, setPos: function (e) { u = e; }, consumeTag: r, consumeTagAndSize: function (e, t) { return (t = r(e, t)) && i(), t; }, parseTag: function (e) { let t; return r(e), t = i(), n[e.parse](t); }, skipOverElement: function (e, t) { return e = r(e, t), t = void 0, e && (t = i(), u += t), e; }, getMatroskaCodedNum: i, getMatroskaFloat: function (e) { let t = void 0; switch (e) { case 4:t = s.getFloat32(u), u += 4; break; case 8:t = s.getFloat64(u), u += 8; } return t; }, getMatroskaUint: function (e) { for (var t = 0, n = 0; n < e; n += 1)t <<= 8, t |= 255 & s.getUint8(u + n); return u += e, t; }, moreData: function () { return u < s.byteLength; } }; }a.__dashjs_factory_name = `EBMLParser`, n.default = e.default.getClassFactory(a), t.exports = n.default; }, { 47: 47 }], 219: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(46)); const a = r(e(54)); var e = r(e(47)); function o () { const e = this.context; const t = (0, i.default)(e).getInstance(); return { error: function (e) { t.trigger(a.default.ERROR, { error: e }); } }; }o.__dashjs_factory_name = `ErrorHandler`, n.default = e.default.getSingletonFactory(o), t.exports = n.default; }, { 46: 46, 47: 47, 54: 54 }], 220: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a () { let r = {}; return { save: function (e) { const t = e.streamId; const n = e.representationId; r[t] = r[t] || {}, r[t][n] = e; }, extract: function (e, t) { return r && r[e] && r[e][t] ? r[e][t] : null; }, reset: function () { r = {}; } }; }a.__dashjs_factory_name = `InitCache`, n.default = e.default.getSingletonFactory(a), t.exports = n.default; }, { 47: 47 }], 221: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(236)); var e = r(e(47)); function a () { let o = void 0; function t (e) { const t = []; if (!e || !o || typeof o.fetchAll !== `function`) return t; for (var n, r = o.fetchAll(e), i = 0, a = r.length; i < a; i++)(n = s(r[i])) && t.push(n); return t; } function s (e) { if (!e) return null; const t = new i.default(e); return e.hasOwnProperty(`_incomplete`) && (t.isComplete = !e._incomplete), t; } return { getBox: function (e) { return e && o && o.boxes && o.boxes.length !== 0 && typeof o.fetch === `function` ? s(o.fetch(e)) : null; }, getBoxes: t, setData: function (e) { o = e; }, getLastBox: function () { if (!o || !o.boxes || !o.boxes.length) return null; const e = t(o.boxes[o.boxes.length - 1].type); return e.length > 0 ? e[e.length - 1] : null; } }; }a.__dashjs_factory_name = `IsoFile`, n.default = e.default.getClassFactory(a), t.exports = n.default; }, { 236: 236, 47: 47 }], 222: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(108)); function o (e) { let t = (e = e || {}).timelineConverter; return { getLiveEdge: function (e) { return (function () { if (!t || !t.hasOwnProperty(`getExpectedLiveEdge`)) throw new Error(a.default.MISSING_CONFIG_ERROR); }()), e.DVRWindow ? e.DVRWindow.end : 0; }, reset: function () { t = null; } }; }o.__dashjs_factory_name = `LiveEdgeFinder`, n.default = i.default.getClassFactory(o), t.exports = n.default; }, { 108: 108, 47: 47 }], 223: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(12)); function o () { return { areEqual: function (e, t) { return (0, a.default)(e, t); } }; }o.__dashjs_factory_name = `ObjectUtils`, n.default = i.default.getSingletonFactory(o), t.exports = n.default; }, { 12: 12, 47: 47 }], 224: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a () { return { modifyRequestURL: function (e) { return e; }, modifyRequestHeader: function (e) { return e; } }; }a.__dashjs_factory_name = `RequestModifier`, n.default = e.default.getSingletonFactory(a), t.exports = n.default; }, { 47: 47 }], 225: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }), n.checkParameterType = function (e, t) { if (typeof e !== t) throw a.default.BAD_ARGUMENT_ERROR; }, n.checkInteger = function (e) { if (e === null || isNaN(e) || e % 1 != 0) throw `${a.default.BAD_ARGUMENT_ERROR} : argument is not an integer`; }, n.checkRange = function (e, t, n) { if (e < t || n < e) throw `${a.default.BAD_ARGUMENT_ERROR} : argument out of range`; }, n.checkIsVideoOrAudioType = function (e) { if (typeof e !== `string` || e !== a.default.AUDIO && e !== a.default.VIDEO) throw a.default.BAD_ARGUMENT_ERROR; }; let r; const i = e(108); var a = (r = i) && r.__esModule ? r : { default: r }; }, { 108: 108 }], 226: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(45)); const o = r(e(46)); const S = r(e(54)); const A = e(17); function s () { const e = this.context; const y = (0, o.default)(e).getInstance(); let t = void 0; let v = void 0; let T = 0; return t = { parse: function (e, t, n, r, i) { let a; let o; let s = ``; const u = []; var l = void 0; const d = {}; const f = {}; let c = ``; let h = ``; const p = { onOpenTag: function (e, t, n) { if (n[` imagetype`] && !n[` imageType`] && (n[` imageType`] = n[` imagetype`]), t === `image` && (e === `http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt` || e === `http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt`)) { if (!n[` imageType`] || n[` imageType`].value !== `PNG`) return void v.warn(`smpte-tt imageType != PNG. Discarded`); c = n[`http://www.w3.org/XML/1998/namespace id`].value; } }, onCloseTag: function () { c && (f[c] = h.trim()), c = h = ``; }, onText: function (e) { c && (h += e); } }; if (!e) throw s = `no ttml data to parse`, new Error(s); d.data = e, y.trigger(S.default.TTML_TO_PARSE, d); const g = (0, A.fromXML)(d.data, (e) => { s = e; }, p); y.trigger(S.default.TTML_PARSED, { ttmlString: d.data, ttmlDoc: g }); for (var _, m = g.getMediaTimeEvents(), l = 0; l < m.length; l++) { const E = (0, A.generateISD)(g, m[l], (e) => { s = e; }); E.contents.some((e) => { return e.contents.length; }) && (a = m[l] + t < n ? n : m[l] + t) < (o = m[l + 1] + t > r ? r : m[l + 1] + t) && u.push({ start: a, end: o, type: `html`, cueID: (_ = void 0, _ = `cue_TTML_${T}`, T++, _), isd: E, images: i, embeddedImages: f }); } if (s !== ``) throw v.error(s), new Error(s); return u; } }, v = (0, a.default)(e).getInstance().getLogger(t), t; }s.__dashjs_factory_name = `TTMLParser`, n.default = i.default.getSingletonFactory(s), t.exports = n.default; }, { 17: 17, 45: 45, 46: 46, 47: 47, 54: 54 }], 227: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); let i = r(e(47)); const o = r(e(217)); function a () { let i = void 0; const a = []; const e = this.context; function n (e, t, n) { const r = (function (e) { for (var t = void 0, t = 0; t < a.length; t++) { if (a[t].regex.test(e)) return a[t].utils; } return i; }(n || t)); return (r && typeof r[e] === `function` ? r : i)[e](t, n); } return i = (0, o.default)(e).getInstance(), { registerUrlRegex: function (e, t) { a.push({ regex: e, utils: t }); }, parseBaseUrl: function (e) { return n(`parseBaseUrl`, e); }, parseOrigin: function (e) { return n(`parseOrigin`, e); }, parseScheme: function (e) { return n(`parseScheme`, e); }, isRelative: function (e) { return n(`isRelative`, e); }, isPathAbsolute: function (e) { return n(`isPathAbsolute`, e); }, isSchemeRelative: function (e) { return n(`isSchemeRelative`, e); }, isHTTPURL: function (e) { return n(`isHTTPURL`, e); }, isHTTPS: function (e) { return n(`isHTTPS`, e); }, removeHostname: function (e) { return n(`removeHostname`, e); }, resolve: function (e, t) { return n(`resolve`, e, t); } }; }a.__dashjs_factory_name = `URLUtils`; i = i.default.getSingletonFactory(a); n.default = i, t.exports = n.default; }, { 217: 217, 47: 47 }], 228: [function (e, t, n) { "use strict"; function r (e) { return e && e.__esModule ? e : { default: e }; }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = r(e(47)); const a = r(e(45)); function o () { const e = this.context; let t = void 0; let l = void 0; let d = void 0; let f = void 0; let c = void 0; let h = void 0; function p (e) { const t = e.split(`:`); const n = t.length - 1; return e = 60 * parseInt(t[n - 1], 10) + parseFloat(t[n]), n == 2 && (e += 3600 * parseInt(t[0], 10)), e; } return t = { parse: function (e) { let t; const n = []; let r = void 0; if (!e) return n; t = (e = e.split(d)).length, r = -1; for (let i = 0; i < t; i++) { var a; var o; var s; let u = e[i]; u.length > 0 && u !== `WEBVTT` && u.match(f) && (a = void 0, (o = (a = (o = u).split(f))[1].split(h)).shift(), a[1] = o[0], o.shift(), u = (s = { cuePoints: a, styles: (function (e) { const n = {}; return e.forEach((e) => { let t; e.split(/:/).length > 1 && ((t = e.split(/:/)[1]) && t.search(/%/) != -1 && (t = parseInt(t.replace(/%/, ``), 10)), (e.match(/align/) || e.match(/A/)) && (n.align = t), (e.match(/line/) || e.match(/L/)) && (n.line = t), (e.match(/position/) || e.match(/P/)) && (n.position = t), (e.match(/size/) || e.match(/S/)) && (n.size = t)); }), n; }(o)) }).cuePoints, a = s.styles, o = (function (e, t) { let n = t; let r = ``; let i = ``; let a = void 0; for (;e[n] !== `` && n < e.length;)n++; if ((a = n - t) > 1) for (let o = 0; o < a; o++) { if ((i = e[t + o]).match(f)) { r = ``; break; }r += i, o !== a - 1 && (r += `\n`); } else (i = e[t]).match(f) || (r = i); return r; }(e, i + 1)), s = p(u[0].replace(c, ``)), u = p(u[1].replace(c, ``)), !isNaN(s) && !isNaN(u) && r <= s && s < u ? o !== `` ? (r = s, n.push({ start: s, end: u, data: o, styles: a })) : l.error(`Skipping cue due to empty/malformed cue text`) : l.error(`Skipping cue due to incorrect cue timing`)); } return n; } }, l = (0, a.default)(e).getInstance().getLogger(t), d = /(?:\r\n|\r|\n)/gm, f = /-->/, c = /(^[\s]+|[\s]+$)/g, h = /\s\b/g, t; }o.__dashjs_factory_name = `VTTParser`, n.default = i.default.getSingletonFactory(o), t.exports = n.default; }, { 45: 45, 47: 47 }], 229: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a (e) { const r = (e = e || {}).blacklistController; return { select: function (e) { let n = 0; let t = void 0; return e && e.some((e, t) => { return n = t, !r.contains(e.serviceLocation); }) && (t = e[n]), t; } }; }a.__dashjs_factory_name = `BasicSelector`, n.default = e.default.getClassFactory(a), t.exports = n.default; }, { 47: 47 }], 230: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(47); var e = (r = i) && r.__esModule ? r : { default: r }; function a (e) { const n = (e = e || {}).blacklistController; return { select: function (e) { return e && (function (e) { let n; let t = 0; const r = []; let i = 0; let a = void 0; if ((a = e.sort((e, t) => { t = e.dvb_priority - t.dvb_priority; return isNaN(t) ? 0 : t; }).filter((e, t, n) => { return !t || n[0].dvb_priority && e.dvb_priority && n[0].dvb_priority === e.dvb_priority; })).length) return a.length > 1 && (a.forEach((e) => { t += e.dvb_weight, r.push(t); }), n = Math.floor(Math.random() * (t - 1)), r.every((e, t) => { return i = t, !(n < e); })), a[i]; }((t = [], e.filter((e) => { return !n.contains(e.serviceLocation) || (e.dvb_priority && t.push(e.dvb_priority), !1); }).filter((e) => { return !t.length || !e.dvb_priority || t.indexOf(e.dvb_priority) === -1; })))); let t; } }; }a.__dashjs_factory_name = `DVBSelector`, n.default = e.default.getClassFactory(a), t.exports = n.default; }, { 47: 47 }], 231: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.mediaType = null, this.bitrate = null, this.width = null, this.height = null, this.scanType = null, this.qualityIndex = NaN; }n.default = r, t.exports = n.default; }, {}], 232: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r (e, t, n) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.code = e || null, this.message = t || null, this.data = n || null; }n.default = r, t.exports = n.default; }, {}], 233: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.streamId = null, this.mediaInfo = null, this.segmentType = null, this.quality = NaN, this.index = NaN, this.bytes = null, this.start = NaN, this.end = NaN, this.duration = NaN, this.representationId = null, this.endFragment = null; }n.default = r, t.exports = n.default; }, {}], 234: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); var r = function (e, t, n) { return t && i(e.prototype, t), n && i(e, n), e; }; function i (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } } const a = e(248); var r = (r(o, [{ key: `isInitializationRequest`, value: function () { return this.type && this.type === a.HTTPRequest.INIT_SEGMENT_TYPE; } }, { key: `setInfo`, value: function (e) { this.type = e && e.init ? a.HTTPRequest.INIT_SEGMENT_TYPE : a.HTTPRequest.MEDIA_SEGMENT_TYPE, this.url = e && e.url ? e.url : null, this.range = e && e.range ? `${e.range.start}-${e.range.end}` : null, this.mediaType = e && e.mediaType ? e.mediaType : null; } }]), o); function o (e) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), this.action = o.ACTION_DOWNLOAD, this.startTime = NaN, this.mediaStartTime = NaN, this.mediaType = null, this.mediaInfo = null, this.type = null, this.duration = NaN, this.timescale = NaN, this.range = null, this.url = e || null, this.serviceLocation = null, this.requestStartDate = null, this.firstByteDate = null, this.requestEndDate = null, this.quality = NaN, this.index = NaN, this.availabilityStartTime = null, this.availabilityEndTime = null, this.wallStartTime = null, this.bytesLoaded = NaN, this.bytesTotal = NaN, this.delayLoadingTime = NaN, this.responseType = `arraybuffer`, this.representationId = null; }r.ACTION_DOWNLOAD = `download`, r.ACTION_COMPLETE = `complete`, n.default = r, t.exports = n.default; }, { 248: 248 }], 235: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; let i; const a = e(234); var e = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, ((i = a) && i.__esModule ? i : { default: i }).default)), o); function o (e) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this, e), this.checkForExistenceOnly = !0; }n.default = e, t.exports = n.default; }, { 234: 234 }], 236: [function (e, t, n) { "use strict"; function r (e, t) { for (let n = 0; n < t.length; n++) { const r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, `value` in r && (r.writable = !0), Object.defineProperty(e, r.key, r); } }Object.defineProperty(n, `__esModule`, { value: !0 }); const i = ((function (e, t, n) { return t && r(e.prototype, t), n && r(e, n), e; }(a, [{ key: `getChildBox`, value: function (e) { for (let t = 0; t < this.boxes.length; t++) if (this.boxes[t].type === e) return this.boxes[t]; } }, { key: `getChildBoxes`, value: function (e) { for (var t = [], n = 0; n < this.boxes.length; n++) this.boxes[n].type === e && t.push(this.boxes[n]); return t; } }])), a); function a (e) { if (!(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, a)), this.offset = e._offset, this.type = e.type, this.size = e.size, this.boxes = [], e.boxes) for (var t = 0; t < e.boxes.length; t++) this.boxes.push(new a(e.boxes[t])); switch (this.isComplete = !0, e.type) { case `sidx`:if (this.timescale = e.timescale, this.earliest_presentation_time = e.earliest_presentation_time, this.first_offset = e.first_offset, this.references = e.references, e.references) { this.references = []; for (t = 0; t < e.references.length; t++) { const n = { reference_type: e.references[t].reference_type, referenced_size: e.references[t].referenced_size, subsegment_duration: e.references[t].subsegment_duration }; this.references.push(n); } } break; case `emsg`:this.id = e.id, this.version = e.version === 1 ? 1 : 0, this.value = e.value, this.timescale = e.timescale, this.scheme_id_uri = e.scheme_id_uri, this.presentation_time_delta = e.version === 1 ? e.presentation_time : e.presentation_time_delta, this.event_duration = e.event_duration, this.message_data = e.message_data; break; case `mdhd`:this.timescale = e.timescale; break; case `mfhd`:this.sequence_number = e.sequence_number; break; case `subs`:this.entry_count = e.entry_count, this.entries = e.entries; break; case `tfhd`:this.base_data_offset = e.base_data_offset, this.sample_description_index = e.sample_description_index, this.default_sample_duration = e.default_sample_duration, this.default_sample_size = e.default_sample_size, this.default_sample_flags = e.default_sample_flags, this.flags = e.flags; break; case `tfdt`:this.version = e.version, this.baseMediaDecodeTime = e.baseMediaDecodeTime, this.flags = e.flags; break; case `trun`:if (this.sample_count = e.sample_count, this.first_sample_flags = e.first_sample_flags, this.data_offset = e.data_offset, this.flags = e.flags, this.samples = e.samples, e.samples) { this.samples = []; for (var t = 0, r = e.samples.length; t < r; t++) { const i = { sample_size: e.samples[t].sample_size, sample_duration: e.samples[t].sample_duration, sample_composition_time_offset: e.samples[t].sample_composition_time_offset }; this.samples.push(i); } } } }n.default = i, t.exports = n.default; }, {}], 237: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r (e, t, n) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.lastCompletedOffset = e, this.found = t, this.size = n; }n.default = r, t.exports = n.default; }, {}], 238: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.TcpList = [], this.HttpList = [], this.RepSwitchList = [], this.BufferLevel = [], this.BufferState = [], this.PlayList = [], this.DroppedFrames = [], this.SchedulingInfo = [], this.DVRInfo = [], this.ManifestUpdate = [], this.RequestsQueue = null, this.DVBErrors = []; }n.default = r, t.exports = n.default; }, {}], 239: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); const r = function (e, t, n) { for (var r = !0; r;) { let i = e; const a = t; const o = n; var r = !1; i === null && (i = Function.prototype); let s = Object.getOwnPropertyDescriptor(i, a); if (void 0 !== s) { if (`value` in s) return s.value; const u = s.get; if (void 0 === u) return; return u.call(o); }i = Object.getPrototypeOf(i); if (i === null) return; e = i, t = a, n = o, r = !0, s = void 0; } }; function i (e) { return e && e.__esModule ? e : { default: e }; } const a = i(e(108)); var e = ((function (e, t) { if (typeof t !== `function` && t !== null) throw new TypeError(`Super expression must either be null or a function, not ${typeof t}`); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t); }(o, i(e(234)).default)), o); function o (e, t) { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, o)), r(Object.getPrototypeOf(o.prototype), `constructor`, this).call(this), this.url = e || null, this.type = t || null, this.mediaType = a.default.STREAM, this.responseType = ``; }n.default = e, t.exports = n.default; }, { 108: 108, 234: 234 }], 240: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.captionData = null, this.label = null, this.lang = null, this.defaultTrack = !1, this.kind = null, this.isFragmented = !1, this.isEmbedded = !1; }n.default = r, t.exports = n.default; }, {}], 241: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.url = null, this.width = null, this.height = null, this.x = null, this.y = null; }n.default = r, t.exports = n.default; }, {}], 242: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.bitrate = 0, this.width = 0, this.height = 0, this.tilesHor = 0, this.tilesVert = 0, this.widthPerTile = 0, this.heightPerTile = 0, this.startNumber = 0, this.segmentDuration = 0, this.timescale = 0, this.templateUrl = ``, this.id = ``; }n.default = r, t.exports = n.default; }, {}], 243: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.t = null, this.xywh = null, this.track = null, this.id = null, this.s = null, this.r = null; }n.default = r, t.exports = n.default; }, {}], 244: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.t = null, this.level = null; }n.default = r, t.exports = n.default; }, {}], 245: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); let r; const i = e(109); const a = (r = i) && r.__esModule ? r : { default: r }; var e = function e () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, e)), this.target = null, this.state = a.default.BUFFER_EMPTY; }; n.default = e, t.exports = n.default; }, { 109: 109 }], 246: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.time = null, this.range = null, this.manifestInfo = null; }n.default = r, t.exports = n.default; }, {}], 247: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.time = null, this.droppedFrames = null; }n.default = r, t.exports = n.default; }, {}], 248: [function (e, t, n) { "use strict"; function r (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }Object.defineProperty(n, `__esModule`, { value: !0 }); function i () { r(this, i), this.tcpid = null, this.type = null, this.url = null, this.actualurl = null, this.range = null, this.trequest = null, this.tresponse = null, this.responsecode = null, this.interval = null, this.trace = [], this._stream = null, this._tfinish = null, this._mediaduration = null, this._quality = null, this._responseHeaders = null, this._serviceLocation = null; } function a () { r(this, a), this.s = null, this.d = null, this.b = []; }i.GET = `GET`, i.HEAD = `HEAD`, i.MPD_TYPE = `MPD`, i.XLINK_EXPANSION_TYPE = `XLinkExpansion`, i.INIT_SEGMENT_TYPE = `InitializationSegment`, i.INDEX_SEGMENT_TYPE = `IndexSegment`, i.MEDIA_SEGMENT_TYPE = `MediaSegment`, i.BITSTREAM_SWITCHING_SEGMENT_TYPE = `BitstreamSwitchingSegment`, i.OTHER_TYPE = `other`, n.HTTPRequest = i, n.HTTPRequestTrace = a; }, {}], 249: [function (e, t, n) { "use strict"; function r (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }Object.defineProperty(n, `__esModule`, { value: !0 }); function i () { r(this, i), this.mediaType = null, this.type = null, this.requestTime = null, this.fetchTime = null, this.availabilityStartTime = null, this.presentationStartTime = 0, this.clientTimeOffset = 0, this.currentTime = null, this.buffered = null, this.latency = 0, this.streamInfo = [], this.representationInfo = []; } function a () { r(this, a), this.id = null, this.index = null, this.start = null, this.duration = null; } function o () { r(this, o), this.id = null, this.index = null, this.mediaType = null, this.streamIndex = null, this.presentationTimeOffset = null, this.startNumber = null, this.fragmentInfoType = null; }n.ManifestUpdate = i, n.ManifestUpdateStreamInfo = a, n.ManifestUpdateRepresentationInfo = o; }, {}], 250: [function (e, t, n) { "use strict"; function r (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }Object.defineProperty(n, `__esModule`, { value: !0 }); function i () { r(this, i), this.start = null, this.mstart = null, this.starttype = null, this.trace = []; }i.INITIAL_PLAYOUT_START_REASON = `initial_playout`, i.SEEK_START_REASON = `seek`, i.RESUME_FROM_PAUSE_START_REASON = `resume`, i.METRICS_COLLECTION_START_REASON = `metrics_collection_start`; function a () { r(this, a), this.representationid = null, this.subreplevel = null, this.start = null, this.mstart = null, this.duration = null, this.playbackspeed = null, this.stopreason = null; }a.REPRESENTATION_SWITCH_STOP_REASON = `representation_switch`, a.REBUFFERING_REASON = `rebuffering`, a.USER_REQUEST_STOP_REASON = `user_request`, a.END_OF_PERIOD_STOP_REASON = `end_of_period`, a.END_OF_CONTENT_STOP_REASON = `end_of_content`, a.METRICS_COLLECTION_STOP_REASON = `metrics_collection_end`, a.FAILURE_STOP_REASON = `failure`, n.PlayList = i, n.PlayListTrace = a; }, {}], 251: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.t = null, this.mt = null, this.to = null, this.lto = null; }n.default = r, t.exports = n.default; }, {}], 252: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.loadingRequests = [], this.executedRequests = []; }n.default = r, t.exports = n.default; }, {}], 253: [function (e, t, n) { "use strict"; Object.defineProperty(n, `__esModule`, { value: !0 }); function r () { !(function (e, t) { if (!(e instanceof t)) throw new TypeError(`Cannot call a class as a function`); }(this, r)), this.mediaType = null, this.t = null, this.type = null, this.startTime = null, this.availabilityStartTime = null, this.duration = null, this.quality = null, this.range = null, this.state = null; }n.default = r, t.exports = n.default; }, {}] }, {}, [4]));
// # sourceMappingURL=dash.all.min.js.map
