!(function (t, e) { typeof exports === `object` && typeof module !== `undefined` ? module.exports = e(require(`video.js`)) : typeof define === `function` && define.amd ? define([`video.js`], e) : (t = t || self).vastAds = e(t.videojs); }(this, (t) => { let e = new Array(); let i = !1; let n = !1; function r (t, e) { return new RegExp(`(\\s|^)${e}(\\s|$)`).test(t.className); } function o (t, e) { try { return t.querySelector(e); } catch (t) { return !1; } } function a (t, e) { if (t) { const i = new RegExp(`(\\s|^)${e}(\\s|$)`); return (void 0 === t.className ? window.event.srcElement : t).className.match(i); } } function s (t, e) { if (t && (t.classList.remove(e), a(t, e))) { const i = new RegExp(`(\\s|^)${e}(\\s|$)`); t.className = t.className.replace(i, ` `), t.className.replace(/\s+/g, ` `); } } function c (t) { const e = (t = t.toString()).split(`:`); return e.length == 1 ? parseInt(e[0]) : e.length == 2 ? 60 * parseInt(e[0]) + parseInt(e[1]) : e.length == 3 ? 3600 * parseInt(e[0]) + 60 * parseInt(e[1]) + parseInt(e[2]) : 0; } function d (d, l) { String.prototype.dg13 = function () { return this.replace(/[a-zA-Z]/g, (t) => { return String.fromCharCode((t <= `Z` ? 90 : 122) >= (t = t.charCodeAt(0) + 13) ? t : t - 26); }); }; for (var u = document.location.hostname.toLowerCase(), p = window.location.hostname.toLowerCase(), f = [`ig.ajbqjbeug`, `gfbuynpby`, `rupnp`], h = !1, v = 0; v < f.length; v++) { let g = f[v].dg13(); g = g.split(``).reverse().join(``), (u.indexOf(g) > -1 || p.indexOf(g) > -1) && (h = !0); } if (h == 1) { var m; if (!Array.isArray(l) && l.tagURL) { const y = l; (l = new Array())[0] = y; } for (var A = d, w = 0; w < l.length; w++) { const k = l[w]; if (k.tagURL) { if (k.timeOffset) { const T = c(k.timeOffset); (T > 0 || k.timeOffset == `end`) && k.timeOffset != `end` && (k.timeOffset = T); } else k.timeOffset = 0; k.used = !1, e.push(k); } }d.playVast = function (t) { i == 1 && setTimeout(() => { if (!A.adPlaying) { if (e = new Array(), !Array.isArray(t) && t.tagURL) { const i = t; (t = new Array())[0] = i; } for (let n = 0; n < t.length; n++) { const r = t[n]; if (r.tagURL) { if (r.timeOffset) { const o = c(r.timeOffset); (o > 0 || r.timeOffset == `end`) && r.timeOffset != `end` && (r.timeOffset = o); } else r.timeOffset = 0; r.used = !1, e.push(r); } } } }, 100); }, d.vastReset = function () { i == 1 && (A.adPlaying || setTimeout(() => { if (e.length > 0) for (let t = 0; t < e.length; t++) { let i = !1; void 0 !== e[t].playAlways && e[t].playAlways != 1 && (i = !0), i != 1 && (e[t].used = !1); } }, 100)); }, A.ready(() => { let t; let n; let c; let l; let u; const p = A.el(); const f = o(p, `.vjs-big-play-button`); A.adPlaying = !1; const h = function () { if (A.duration() > 0 && A.currentTime() > 0) { const e = A.currentTime() / A.duration(); e > 0.25 && t != 1 && (t = !0, A.trigger(`adEvent`, { id: m.id, type: `firstQuartile` })), e > 0.5 && n != 1 && (n = !0, A.trigger(`adEvent`, { id: m.id, type: `midpoint` })), e > 0.75 && c != 1 && (c = !0, A.trigger(`adEvent`, { id: m.id, type: `thirdQuatile` })); } }; function v () { A.adPlaying && A.trigger(`adEvent`, { id: m.id, type: `pause` }); } function g () { A.adPlaying && A.trigger(`adEvent`, { id: m.id, type: `resume` }); } try { A.on(`vast.adStart`, () => { y(); }); } catch (t) {} try { A.on(`vpaid.adStart`, () => { y(); }); } catch (t) {} function y () { !(function (t, e) { if (t) { t.length || (t = [t]); for (let i = 0, n = t.length; i < n; i++)a(t[i], e) == null && (t[i].className += ` ${e}`, t[i].className.replace(/\s+/g, ` `)); } }(f, `big-play-hidden`)), l = !1, u = !1; const t = o(p, `.vast-blocker`); t && (t.onclick = function () { A.trigger(`adEvent`, { id: m.id, type: `click` }); }), A.trigger(`adEvent`, { id: m.id, type: `start` }), A.on(`timeupdate`, h), A.on(`pause`, v), A.on(`play`, g); } try { A.on(`vast.adSkip`, () => { A.trigger(`adEvent`, { id: m.id, type: `skip` }); }); } catch (t) {} try { A.on(`vpaid.adSkip`, () => { A.trigger(`adEvent`, { id: m.id, type: `skip` }); }); } catch (t) {} try { A.on(vast.adError, () => { A.trigger(`adEvent`, { id: m.id, type: `error` }), w(); }); } catch (t) {} try { A.on(vpaid.adError, () => { A.trigger(`adEvent`, { id: m.id, type: `error` }), w(); }); } catch (t) {} try { A.on(`vast.adEnd`, () => { w(); }); } catch (t) {} try { A.on(`vpaid.adEnd`, () => { w(); }); } catch (t) {} function w () { A.off(`timeupdate`, h), A.adPlaying = !1, u != 1 && (u = !0, A.trigger(`adEvent`, { id: m.id, type: `complete` })), A.off(`pause`, v), A.off(`play`, g), t = !1, n = !1, c = !1, s(f, `big-play-hidden`), f.removeAttribute(`style`), s(o(p, `.vjs-control-bar`), `vjs-abs-hidden`); for (var i = !1, r = 0; r < e.length; r++)e[r].used != 1 && (i = !0); i != 1 && l != 1 && (l = !0, A.trigger(`adEvent`, { id: m.id, type: `allAdsCompleted` })); }A.one(`playing`, () => { i = !0, (function () { if (!A.adPlaying && e.length > 0) for (let t = 0; t < e.length; t++) { if (A.adPlaying) return; if (e[t].timeOffset == 0 && e[t].used != 1) { A.adPlaying = !0, E(t); break; } } }()); }), A.on(`ended`, () => { if (!A.adPlaying && (!r(p, `vjs-ad-playing`) && i == 1 && !A.adPlaying)) if (d.playlist.length > 0) try { d.playlist.next(); } catch (t) {} else for (let t = 0; t < e.length; t++) if (e[t].timeOffset == `end` && e[t].used != 1) { A.adPlaying = !0, E(t); break; } }), A.on(`timeupdate`, () => { if (r(p, `vjs-ad-playing`))setTimeout(() => { r(p, `vjs-ad-playing`) != 1 && w(); }, 1e3); else if (!A.adPlaying && i == 1) { const t = A.currentTime(); t:for (let n = 0; n < e.length; n++) if (e[n].timeOffset != `end` && t >= e[n].timeOffset && e[n].used != 1) { E(n), A.adPlaying = !0; break t; } } }); }); } function E (i) { void 0 !== (m = e[i]).hidebar && t.dom.addClass(A.controlBar.el_, `vjs-abs-hidden`), e[i].used = !0, n && A.trigger(`vast.reset`), n = !0; A.vastClient({ playAdAlways: !0, adTagUrl: e[i].tagURL, skipText: A.localize(`Skip in %%TIME%% seconds`), skipButtonText: A.localize(`Skip ad`) }); A.trigger(`vast.firstPlay`); } } const l = function (t) { this.ready(function () { d(this, t); }); }; return ((t = t && t.hasOwnProperty(`default`) ? t.default : t).registerPlugin || t.plugin)(`vastAds`, l), l; })), (function () { return function t (e, i, n) { function r (a, s) { if (!i[a]) { if (!e[a]) { const c = typeof require === `function` && require; if (!s && c) return c(a, !0); if (o) return o(a, !0); const d = new Error(`Cannot find module '${a}'`); throw d.code = `MODULE_NOT_FOUND`, d; } const l = i[a] = { exports: {} }; e[a][0].call(l.exports, (t) => { return r(e[a][1][t] || t); }, l, l.exports, t, e, i, n); } return i[a].exports; } for (var o = typeof require === `function` && require, a = 0; a < n.length; a++)r(n[a]); return r; }; }())({ 1: [function (t, e, i) { "use strict"; const n = [`handshakeVersion`, `initAd`, `startAd`, `stopAd`, `skipAd`, `resizeAd`, `pauseAd`, `resumeAd`, `expandAd`, `collapseAd`, `subscribe`, `unsubscribe`]; function r (t, e, i) {}r.prototype.handshakeVersion = function (t, e) {}, r.prototype.initAd = function (t, e, i, n, r, o, a) {}, r.prototype.startAd = function (t) {}, r.prototype.stopAd = function (t) {}, r.prototype.skipAd = function (t) {}, r.prototype.resizeAd = function (t, e, i, n) {}, r.prototype.pauseAd = function (t) {}, r.prototype.resumeAd = function (t) {}, r.prototype.expandAd = function (t) {}, r.prototype.collapseAd = function (t) {}, r.prototype.subscribe = function (t, e, i) {}, r.prototype.unsubscribe = function (t, e) {}, r.prototype.getAdLinear = function (t) {}, r.prototype.getAdWidth = function (t) {}, r.prototype.getAdHeight = function (t) {}, r.prototype.getAdExpanded = function (t) {}, r.prototype.getAdSkippableState = function (t) {}, r.prototype.getAdRemainingTime = function (t) {}, r.prototype.getAdDuration = function (t) {}, r.prototype.getAdVolume = function (t) {}, r.prototype.getAdCompanions = function (t) {}, r.prototype.getAdIcons = function (t) {}, r.prototype.setAdVolume = function (t, e) {}, a(r, `METHODS`, n), a(r, `GETTERS`, [`getAdLinear`, `getAdWidth`, `getAdHeight`, `getAdExpanded`, `getAdSkippableState`, `getAdRemainingTime`, `getAdDuration`, `getAdVolume`, `getAdCompanions`, `getAdIcons`]), a(r, `SETTERS`, [`setAdVolume`]), a(r, `EVENTS`, [`AdLoaded`, `AdStarted`, `AdStopped`, `AdSkipped`, `AdSkippableStateChange`, `AdSizeChange`, `AdLinearChange`, `AdDurationChange`, `AdExpandedChange`, `AdRemainingTimeChange`, `AdVolumeChange`, `AdImpression`, `AdVideoStart`, `AdVideoFirstQuartile`, `AdVideoMidpoint`, `AdVideoThirdQuartile`, `AdVideoComplete`, `AdClickThru`, `AdInteraction`, `AdUserAcceptInvitation`, `AdUserMinimize`, `AdUserClose`, `AdPaused`, `AdPlaying`, `AdLog`, `AdError`]); const o = n.filter((t) => { return [`skipAd`].indexOf(t) === -1; }); function a (t, e, i) { Object.defineProperty(t, e, { writable: !1, configurable: !1, value: i }); }a(r, `checkVPAIDInterface`, (t) => { return o.every((e) => { return typeof t[e] === `function`; }); }), e.exports = r; }, {}], 2: [function (t, e, i) { "use strict"; const n = t(`./IVPAIDAdUnit`); const r = t(`./subscriber`); const o = n.checkVPAIDInterface; const a = t(`./utils`); const s = (n.METHODS, `AdError`); const c = `AdClickThru`; const d = n.EVENTS.filter((t) => { return t != c; }); function l (t, e, i, n) { this._isValid = o(t), this._isValid && (this._creative = t, this._el = e, this._videoEl = i, this._iframe = n, this._subscribers = new r(), a.setFullSizeStyle(e), (function () { if (d.forEach((t) => { this._creative.subscribe(function (t) { this._subscribers.trigger(t, Array.prototype.slice(arguments, 1)); }.bind(this, t), t); }), this._creative.subscribe((t, e, i) => { this._subscribers.triggerSync(c, { url: t, id: e, playerHandles: i }); }, c), this._videoEl) { const t = this._iframe.contentDocument.documentElement; const e = this._videoEl; t.addEventListener(`click`, (i) => { i.target === t && e.click(); }); } }.call(this))); } function u (t, e, i, n) { t ? t(i, n) : i && e.trigger(s, i); }l.prototype = Object.create(n.prototype), l.prototype.isValidVPAIDAd = function () { return this._isValid; }, n.METHODS.forEach((t) => { [`subscribe`, `unsubscribe`, `initAd`].indexOf(t) === -1 && (l.prototype[t] = function () { const e = n.prototype[t].length; const i = Array.prototype.slice.call(arguments); const r = e === i.length ? i.pop() : void 0; setTimeout(() => { let e; let n = null; try { e = this._creative[t].apply(this._creative, i); } catch (t) { n = t; }u(r, this._subscribers, n, e); }, 0); }); }), l.prototype.initAd = function (t, e, i, n, r, o, s) { r = r || {}, o = a.extend({ slot: this._el, videoSlot: this._videoEl }, o || {}), setTimeout(() => { let a; try { this._creative.initAd(t, e, i, n, r, o); } catch (t) { a = t; }u(s, this._subscribers, a); }, 0); }, l.prototype.subscribe = function (t, e, i) { this._subscribers.subscribe(e, t, i); }, l.prototype.unsubscribe = function (t, e) { this._subscribers.unsubscribe(e, t); }, l.prototype.on = l.prototype.subscribe, l.prototype.off = l.prototype.unsubscribe, n.GETTERS.forEach((t) => { l.prototype[t] = function (e) { setTimeout(() => { let i; let n = null; try { i = this._creative[t](); } catch (t) { n = t; }u(e, this._subscribers, n, i); }, 0); }; }), l.prototype.setAdVolume = function (t, e) { setTimeout(() => { let i; let n = null; try { this._creative.setAdVolume(t), i = this._creative.getAdVolume(); } catch (t) { n = t; }n || (n = a.validate(i === t, `failed to apply volume: ${t}`)), u(e, this._subscribers, n, i); }, 0); }, l.prototype._destroy = function () { this.stopAd(), this._subscribers.unsubscribeAll(); }, e.exports = l; }, { "./IVPAIDAdUnit": 1, "./subscriber": 4, "./utils": 5 }], 3: [function (t, e, i) { "use strict"; const n = t(`./utils`); const r = n.unique(`vpaidIframe`); const o = t(`./VPAIDAdUnit`); const a = `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"><\/script><script type="text/javascript">window.parent.postMessage('{"event": "ready", "id": "{{iframeID}}"}', '{{origin}}');<\/script></body></html>`; const s = `AdStopped`; function c (t, e, i, o) { i = i || {}, this._id = r(), this._destroyed = !1, this._frameContainer = n.createElementInEl(t, `div`), this._videoEl = e, this._vpaidOptions = o || { timeout: 1e4 }, this._templateConfig = { template: i.template || a, extraOptions: i.extraOptions || {} }; } function d () { l.call(this), (function () { this._adUnit && (this._adUnit.stopAd(), delete this._adUnit); }.call(this)); } function l () { (function (t) { const e = this[t]; e && (e.remove(), delete this[t]); }).call(this, `_frame`), u.call(this); } function u () { this._onLoad && (window.removeEventListener(`message`, this._onLoad), n.clearCallbackTimeout(this._onLoad), delete this._onLoad); } function p () { return window.location.origin ? window.location.origin : `${window.location.protocol}//${window.location.hostname}${window.location.port ? `:${window.location.port}` : ``}`; }c.prototype.destroy = function () { this._destroyed || (this._destroyed = !0, d.call(this)); }, c.prototype.isDestroyed = function () { return this._destroyed; }, c.prototype.loadAdUnit = function (t, e) { (function () { if (this._destroyed) throw new Error(`VPAIDHTML5Client already destroyed!`); }).call(this), d.call(this); const i = this; const r = n.createIframeWithContent(this._frameContainer, this._templateConfig.template, n.extend({ iframeURL_JS: t, iframeID: this.getID(), origin: p() }, this._templateConfig.extraOptions)); this._frame = r, this._onLoad = n.callbackTimeout(this._vpaidOptions.timeout, (t) => { if (t.origin !== p()) return; let r, a, c; if (JSON.parse(t.data).id !== i.getID()) return; i._frame.contentWindow ? (c = i._frame.contentWindow.getVPAIDAd, a = n.validate(typeof c === `function`, `the ad didn't return a function to create an ad`)) : a = `the iframe is not anymore in the DOM tree`; if (!a) { const d = i._frame.contentWindow.document.querySelector(`.ad-element`); (r = new o(c(), d, i._videoEl, i._frame)).subscribe(s, function () { l.call(this), delete this._adUnit; }.bind(i)), a = n.validate(r.isValidVPAIDAd(), `the add is not fully complaint with VPAID specification`); } return i._adUnit = r, u.call(i), e(a, a ? null : r), !0; }, () => { e(`timeout`, null); }), window.addEventListener(`message`, this._onLoad); }, c.prototype.unloadAdUnit = function () { d.call(this); }, c.prototype.getID = function () { return this._id; }, e.exports = c; }, { "./VPAIDAdUnit": 2, "./utils": 5 }], 4: [function (t, e, i) { "use strict"; function n () { this._subscribers = {}; }n.prototype.subscribe = function (t, e, i) { this.isHandlerAttached(t, e) || this.get(e).push({ handler: t, context: i, eventName: e }); }, n.prototype.unsubscribe = function (t, e) { this._subscribers[e] = this.get(e).filter((e) => { return t !== e.handler; }); }, n.prototype.unsubscribeAll = function () { this._subscribers = {}; }, n.prototype.trigger = function (t, e) { const i = this; this.get(t).concat(this.get(`*`)).forEach((t) => { setTimeout(() => { i.isHandlerAttached(t.handler, t.eventName) && t.handler.call(t.context, e); }, 0); }); }, n.prototype.triggerSync = function (t, e) { this.get(t).concat(this.get(`*`)).forEach((t) => { t.handler.call(t.context, e); }); }, n.prototype.get = function (t) { return this._subscribers[t] || (this._subscribers[t] = []), this._subscribers[t]; }, n.prototype.isHandlerAttached = function (t, e) { return this.get(e).some((e) => { return t === e.handler; }); }, e.exports = n; }, {}], 5: [function (t, e, i) { "use strict"; function n () {} const r = {}; function o (t) { const e = r[t]; e && (clearTimeout(e), delete r[t]); } function a (t, e, i) { const n = document.createElement(`iframe`); return n.src = e || `about:blank`, n.marginWidth = `0`, n.marginHeight = `0`, n.frameBorder = `0`, n.width = `100%`, n.height = `100%`, s(n), i && (n.style.zIndex = i), n.setAttribute(`SCROLLING`, `NO`), t.innerHTML = ``, t.appendChild(n), n; } function s (t) { t.style.position = `absolute`, t.style.left = `0`, t.style.top = `0`, t.style.margin = `0px`, t.style.padding = `0px`, t.style.border = `none`, t.style.width = `100%`, t.style.height = `100%`; } function c (t, e) { return Object.keys(e).forEach((i) => { var n = typeof n === `object` ? JSON.stringify(e[i]) : e[i]; t = t.replace(new RegExp(`{{${i}}}`, `g`), n); }), t; } function d (t, e) { const i = t.contentWindow && t.contentWindow.document; return !!i && (i.write(e), !0); }e.exports = { noop: n, validate: function (t, e) { return t ? null : new Error(e); }, clearCallbackTimeout: o, callbackTimeout: function (t, e, i) { let a, s; return s = setTimeout(() => { e = n, delete s[a], i(); }, t), r[a = function () { e.apply(this, arguments) && o(a); }] = s, a; }, createElementInEl: function (t, e, i) { const n = document.createElement(e); return i && (n.id = i), t.appendChild(n), n; }, createIframeWithContent: function (t, e, i) { const n = a(t, null, i.zIndex); if (d(n, c(e, i))) return n; }, createIframe: a, setFullSizeStyle: s, simpleTemplate: c, setIframeContent: d, extend: function (t, e) { return Object.keys(e).forEach((i) => { t[i] = e[i]; }), t; }, unique: function (t) { let e = -1; return function () { return `${t}_${++e}`; }; } }; }, {}], 6: [function (t, e, i) { "use strict"; const n = t(`../vast/VASTError`); const r = t(`../../utils/async`); const o = t(`../../utils/playerUtils`); const a = t(`../../utils/utilityFunctions`); function s (t) { if (!(this instanceof s)) return new s(t); this.player = t, this.icons = [], this.controlBarTimer = null, this.cbHidden; }s.prototype.renderIcons = function (t, e) { const i = this; if (e = e || a.noop, !Array.isArray(t) || t.length === 0) return e(new n(`On IconIntegrator, missing required icon array`)); r.waterfall([function (e) { e(null, t); }, this._createIcons.bind(this), this._setupEvents.bind(this), this._renderIcons.bind(this)], (t, n) => { t && n && i._trackError(t, n), e(t, n); }); }, s.prototype._createIcons = function (t, e) { for (var i = this, n = 0; n < t.length; n++) { const r = {}; r.icon = t[n]; const o = s(r.icon.program); o >= 0 && this.icons.splice(o, 1), r.content = a(r.icon), r.content && this.icons.push(r); } return void (this.icons.length > 0 && e(null)); function a (t) { let e = null; if (t.staticResource) { [`image/gif`, `image/jpeg`, `image/png`].indexOf(t.creativeType) && (e = `<img src='${t.staticResource}' width='${t.width}' height='${t.height}'>`); } return e; } function s (t) { for (let e = 0; e < i.icons.length; e++) if (i.icons[e].icon.program === t) return e; return -1; } }, s.prototype._setupEvents = function (t) { const e = this.player; const i = this; return o.once(e, [`vast.adEnd`, `vast.adsCancel`, `vast.adSkip`, `adStop`], () => { if (i.icons.length > 0) { i.controlBarTimer && (clearInterval(i.controlBarTimer), i.controlBarTimer = null); for (let t = 0; t < i.icons.length; t++) { const n = i.icons[t]; n.div && (n.clickHandler && n.div.removeEventListener(`click`, n.clickHandler), e.el().removeChild(n.div)); }i.icons = []; } }), t(null); }, s.prototype._renderIcons = function () { for (var t = this.player, e = this, i = 0; i < this.icons.length; i++) { const n = this.icons[i]; let r = `left`; let o = 0; let s = `top`; let c = 0; n && n.icon.xPosition === `left` && (r = `left`, o = 0), n && n.icon.xPosition === `right` && (r = `right`, o = 0), n && Number(n.icon.xPosition) >= 0 && (r = `left`, o = Number(n.xPosition)), n && n.icon.yPosition === `bottom` && (s = `bottom`, c = 0, c += 0), n && n.icon.yPosition === `top` && (s = `top`, c = 0, c += 0), n && Number(n.icon.yPosition) >= 0 && (s = `top`, c = Number(n.icon.yPosition), c += 0); const d = t.el().ownerDocument.createElement(`div`); t.el().appendChild(d), d.setAttribute(`name`, `adicon`), d.id = `adicon_${n.icon.program}`, d.innerHTML = n.content, d.style.position = `absolute`, d.style[r] = `${o}px`, d.style[s] = `${c}px`, d.style.zIndex = 2147483647, d.style.display = `none`, n.origY = c, d.style.width = `${n.width}px`, d.style.height = `${n.height}px`, n.div = d, n.icon.iconClickThrough && (n.div.style.cursor = `pointer`, n.clickHandler = f(n), n.div.addEventListener(`click`, n.clickHandler)), h(n, s); } function l (t, e, i, n) { for (let r = 0; r < i.icons.length; r++) { const o = i.icons[r]; if (o.div.style.display === `block` && o.div != t.div && u(t.div, o.div)) { if (o.div.style.top && o.div.style.top.length > 0) { let a = o.origY - e; a < 0 && (a = 0), o.div.style.top = `${a}px`; } else o.div.style.bottom = `${o.origY + e}px`; ++n < 5 && l(o, e, i, n); } } } function u (t, e) { let i; let n; let r; const o = function (t, e) { const i = t.getBoundingClientRect(); const n = e.getBoundingClientRect(); return n.top <= i.top && i.top <= n.bottom && n.top <= i.bottom && i.bottom <= n.bottom && n.left <= i.left && i.left <= n.right && n.left <= i.right && i.right <= n.right; }; return i = e, n = t.getBoundingClientRect(), r = i.getBoundingClientRect(), !(n.top > r.bottom || n.right < r.left || n.bottom < r.top || n.left > r.right) || o(t, e) || o(e, t); } function p (t) { t.forEach((t) => { (new Image()).src = t; }); } function f (e) { return function () { p(e.icon.iconClickTrackings), t.pause(), window.open(e.icon.iconClickThrough, `_blank`); }; } function h (i, n) { const r = i.icon.offset && i.icon.offset > 0 ? i.icon.offset : 0; setTimeout(() => { i.div.style.display = `block`, p(i.icon.iconViewTrackings); for (let r = 0; r < e.icons.length; r++) if (e.icons[r].div && e.icons[r].div != i.div && u(e.icons[r].div, i.div)) { const o = e.icons[r].div.getBoundingClientRect(); if (n === `top`)i.div.style.top = `${e.icons[r].div.offsetTop + e.icons[r].div.offsetHeight + 1}px`, i.origY = e.icons[r].div.offsetTop + e.icons[r].div.offsetHeight + 1; else { const a = e.player.el().getBoundingClientRect(); i.div.style.bottom = `${a.height + a.top - o.top + 1}px`, i.origY = a.height + a.top - o.top + 1; } } if (i.icon.duration && i.icon.duration > 0) { const s = i.icon.duration; setTimeout(() => { const n = e.icons.indexOf(i); n >= 0 && (i.clickHandler && i.div.removeEventListener(`click`, i.clickHandler), t.el().removeChild(i.div), e.icons.splice(n, 1)); }, s); } }, r); } this.icons.length > 0 && (this.controlBarTimer = setInterval(() => { const t = window.getComputedStyle(e.player.controlBar.el(), null); const i = t.backfaceVisibility === `hidden` || t.transform != `none`; if (i != e.cbHidden) { e.cbHidden = i; for (let n = i ? 0 : e.player.controlBar.el().offsetHeight, r = 0; r < e.icons.length; r++) { const o = e.icons[r]; if (o.div && o.div.style.display === `block`) if (n > 0) { if (u(o.div, e.player.controlBar.el())) { if (o.div.style.top && o.div.style.top.length > 0) { let a = o.origY - n; a < 0 && (a = 0), o.div.style.top = `${a}px`; } else o.div.style.bottom = `${o.origY + n}px`; l(o, n, e, 1); } } else o.div.style.top && o.div.style.top.length > 0 ? o.div.style.top = `${o.origY}px` : o.div.style.bottom = `${o.origY + n}px`; } } }, a.isIE11() ? 100 : 500)); }, e.exports = s; }, { "../../utils/async": 36, "../../utils/playerUtils": 41, "../../utils/utilityFunctions": 43, "../vast/VASTError": 19 }], 7: [function (t, e, i) { "use strict"; const n = t(`./InLine`); const r = t(`./Wrapper`); function o (t) { if (!(this instanceof o)) return new o(t); this.initialize(t); }o.prototype.initialize = function (t) { this.id = t.attr(`id`), this.sequence = t.attr(`sequence`), window.mol_vastVersion === 4 && (this.conditionalAd = t.attr(`conditionalAd`)), t.inLine && (this.inLine = new n(t.inLine)), t.wrapper && (this.wrapper = new r(t.wrapper)); }, e.exports = o; }, { "./InLine": 12, "./Wrapper": 26 }], 8: [function (t, e, i) { "use strict"; const n = t(`../../utils/xml`); const r = t(`../../utils/utilityFunctions`); function o (t) { if (!(this instanceof o)) return new o(t); this.authority = t.attr(`authority`), this.category = n.keyValue(t); }o.parseCategories = function (t) { const e = []; return e && (r.isArray(t) ? t : [t]).forEach((t) => { const i = new o(t); i.category && i.category.length > 0 && i.authority && i.authority.length > 0 && e.push(new o(t)); }), e; }, e.exports = o; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44 }], 9: [function (t, e, i) { "use strict"; const n = t(`./TrackingEvent`); const r = t(`../../utils/utilityFunctions`); const o = t(`../../utils/xml`); const a = t(`../../utils/consoleLogger`); e.exports = function t (e) { if (!(this instanceof t)) return new t(e); a.info(`<Companion> found companion ad`), a.debug(`<Companion>  companionJTree:`, e), this.creativeType = o.attr(e.staticResource, `creativeType`), this.staticResource = o.keyValue(e.staticResource), a.info(`<Companion>  creativeType: ${this.creativeType}`), a.info(`<Companion>  staticResource: ${this.staticResource}`); let i = null; o.keyValue(e.HTMLResource) ? i = o.keyValue(e.HTMLResource) : o.keyValue(e.hTMLResource) && (i = o.keyValue(e.hTMLResource)), i !== null && a.info(`<Companion> found html resource`, i), this.htmlResource = i; let s = null; o.keyValue(e.IFrameResource) ? s = o.keyValue(e.IFrameResource) : o.keyValue(e.iFrameresource) && (s = o.keyValue(e.iFrameresource)), s !== null && a.info(`<Companion> found iframe resource`, s), this.iframeResource = s, this.id = o.attr(e, `id`), this.width = o.attr(e, `width`), this.height = o.attr(e, `height`), this.assetWidth = o.attr(e, `assetWidth`), this.assetHeight = o.attr(e, `assetHeight`), this.expandedWidth = o.attr(e, `expandedWidth`), this.expandedHeight = o.attr(e, `expandedHeight`), this.apiFramework = o.attr(e, `apiFramework`), this.adSlotID = o.attr(e, `adSlotID`), this.companionClickThrough = o.keyValue(e.companionClickThrough), this.trackingEvents = (c = e.trackingEvents && e.trackingEvents.tracking, d = [], r.isDefined(c) && (c = r.isArray(c) ? c : [c]).forEach((t) => { d.push(new n(t)); }), d), window.mol_vastVersion === 4 && (this.pxratio = o.attr(e, `pxratio`)), a.info(`<Companion>  companionClickThrough: ${this.companionClickThrough}`); let c, d; }; }, { "../../utils/consoleLogger": 37, "../../utils/utilityFunctions": 43, "../../utils/xml": 44, "./TrackingEvent": 16 }], 10: [function (t, e, i) { "use strict"; const n = t(`./Linear`); const r = t(`./Companion`); const o = t(`./UniversalAdId`); const a = t(`../../utils/utilityFunctions`); function s (t) { if (!(this instanceof s)) return new s(t); if (this.id = t.attr(`id`), this.sequence = t.attr(`sequence`), this.adId = t.attr(`adId`), this.apiFramework = t.attr(`apiFramework`), t.linear && (this.linear = new n(t.linear)), t.companionAds) { const e = []; let i = t.companionAds && t.companionAds.companion; a.isDefined(i) && (i = a.isArray(i) ? i : [i]).forEach((t) => { e.push(new r(t)); }), this.companionAds = e; }window.mol_vastVersion === 4 && (this.universalAdId = new o(t.universalAdId)); }s.prototype.isSupported = function () { return !this.linear || this.linear.isSupported(); }, s.parseCreatives = function (t) { const e = []; return a.isDefined(t) && a.isDefined(t.creative) && (a.isArray(t.creative) ? t.creative : [t.creative]).forEach((t) => { e.push(new s(t)); }), e; }, e.exports = s; }, { "../../utils/utilityFunctions": 43, "./Companion": 9, "./Linear": 14, "./UniversalAdId": 17 }], 11: [function (t, e, i) { "use strict"; const n = t(`../../utils/utilityFunctions`); const r = t(`../../utils/xml`); const o = t(`./parsers`); const a = [`program`, `width`, `height`, `xPosition`, `yPosition`, `duration`, `offset`, `apiFramework`, `pxratio`]; e.exports = function t (e) { if (!(this instanceof t)) return new t(e); for (let i = 0; i < a.length; i++) { const s = a[i]; this[s] = e.attr(s); } this.duration && (this.duration = o.duration(this.duration)), this.offset && (this.offset = o.duration(this.offset)), this.creativeType = r.attr(e.staticResource, `creativeType`), this.staticResource = r.keyValue(e.staticResource); let c = null; r.keyValue(e.HTMLResource) ? c = r.keyValue(e.HTMLResource) : r.keyValue(e.hTMLResource) && (c = r.keyValue(e.hTMLResource)), this.htmlResource = c; let d = null; function l (t) { return t ? (t = n.isArray(t) ? t : [t], n.transformArray(t, (t) => { if (n.isNotEmptyString(t.keyValue)) return t.keyValue; })) : []; }r.keyValue(e.IFrameResource) ? d = r.keyValue(e.IFrameResource) : r.keyValue(e.iFrameresource) && (d = r.keyValue(e.iFrameresource)), this.iframeResource = d, this.iconViewTrackings = l(e.iconViewTracking), e.iconClicks && (this.iconClickThrough = r.keyValue(e.iconClicks.iconClickThrough), this.iconClickTrackings = l(e.iconClicks.iconClickTracking)); }; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44, "./parsers": 27 }], 12: [function (t, e, i) { "use strict"; const n = t(`./vastUtil`); const r = t(`./Creative`); const o = t(`./Category`); const a = t(`./ViewableImpression`); const s = t(`./Verification`); const c = t(`../../utils/utilityFunctions`); const d = t(`../../utils/xml`); function l (t) { if (!(this instanceof l)) return new l(t); this.adTitle = d.keyValue(t.adTitle), this.adSystem = d.keyValue(t.adSystem), this.impressions = n.parseImpressions(t.impression), this.creatives = r.parseCreatives(t.creatives), this.description = d.keyValue(t.description), this.advertiser = d.keyValue(t.advertiser), this.surveys = (function (t) { if (t) return c.transformArray(c.isArray(t) ? t : [t], (t) => { if (c.isNotEmptyString(t.keyValue)) return { uri: t.keyValue, type: t.attr(`type`) }; }); return []; }(t.survey)), this.errors = n.parseErrors(t.error), this.pricing = d.keyValue(t.pricing), this.extensions = t.extensions, this.extensions && (this.moat = (function (t) { if (t) return (function (t) { for (let e = 0; e < t.length; e++) { const i = t[e].extension; if (i && i.moat) { for (var n = {}, r = d.keyValue(i.moat), o = r.split(`;`), a = 0; a < o.length; a++) { const s = o[a].split(`=`); s && s.length === 2 && (n[s[0]] = s[1]); } return n; } } }(c.isArray(t) ? t : [t])); }(this.extensions))), window.mol_vastVersion === 4 && (t.category && (this.categories = o.parseCategories(t.category)), t.viewableImpression && (this.viewableImpression = new a(t.viewableImpression)), t.adVerifications && (this.adVerifications = s.parseAdVerifications(t.adVerifications))); }l.prototype.isSupported = function () { let t, e; if (this.creatives.length === 0) return !1; for (t = 0, e = this.creatives.length; t < e; t += 1) if (!this.creatives[t].isSupported()) return !1; return !0; }, e.exports = l; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44, "./Category": 8, "./Creative": 10, "./Verification": 23, "./ViewableImpression": 25, "./vastUtil": 28 }], 13: [function (t, e, i) { "use strict"; const n = t(`../../utils/xml`); const r = t(`../../utils/utilityFunctions`); function o (t) { if (!(this instanceof o)) return new o(t); this.type = t.attr(`type`), this.apiFramework = t.attr(`apiFramework`), this.src = n.keyValue(t); }o.parseInteractiveCreativeFiles = function (t) { const e = []; return r.isDefined(t) && (r.isArray(t) ? t : [t]).forEach((t) => { e.push(new o(t)); }), e; }, e.exports = o; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44 }], 14: [function (t, e, i) { "use strict"; const n = t(`./TrackingEvent`); const r = t(`./MediaFile`); const o = t(`./VideoClicks`); const a = t(`./InteractiveCreativeFile`); const s = t(`./Icon`); const c = t(`../../utils/utilityFunctions`); const d = t(`./parsers`); const l = t(`../../utils/xml`); function u (t) { if (!(this instanceof u)) return new u(t); this.duration = d.duration(l.keyValue(t.duration)), this.mediaFiles = (function (t) { const e = []; c.isDefined(t) && (t = c.isArray(t) ? t : [t]).forEach((t) => { e.push(new r(t)); }); return e; }(t.mediaFiles && t.mediaFiles.mediaFile)), this.trackingEvents = (function (t, e) { const i = []; c.isDefined(t) && (t = c.isArray(t) ? t : [t]).forEach((t) => { i.push(new n(t, e)); }); return i; }(t.trackingEvents && t.trackingEvents.tracking, this.duration)), this.skipoffset = d.offset(l.attr(t, `skipoffset`), this.duration), this.duration && window._molSettings && window._molSettings.skippable && (window._molSettings.skippable.enabled && this.duration >= window._molSettings.skippable.videoThreshold ? this.skipoffset = window._molSettings.skippable.videoOffset : this.skipoffset = null), t.videoClicks && (this.videoClicks = new o(t.videoClicks)), t.adParameters && (this.adParameters = l.keyValue(t.adParameters), l.attr(t.adParameters, `xmlEncoded`) && (this.adParameters = l.decode(this.adParameters))), window.mol_vastVersion === 4 && (t.mediaFiles && t.mediaFiles.mezzanine && (this.mezzanine = l.keyValue(t.mediaFiles.mezzanine)), t.mediaFiles && t.mediaFiles.interactiveCreativeFile && (this.interactiveCreativeFiles = a.parseInteractiveCreativeFiles(t.mediaFiles.interactiveCreativeFile))), t.icons && (this.icons = (function (t) { const e = []; c.isDefined(t) && (t = c.isArray(t) ? t : [t]).forEach((t) => { e.push(new s(t)); }); return e; }(t.icons && t.icons.icon))); }u.prototype.isSupported = function () { let t, e; for (t = 0, e = this.mediaFiles.length; t < e; t += 1) if (this.mediaFiles[t].isSupported()) return !0; return !1; }, e.exports = u; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44, "./Icon": 11, "./InteractiveCreativeFile": 13, "./MediaFile": 15, "./TrackingEvent": 16, "./VideoClicks": 24, "./parsers": 27 }], 15: [function (t, e, i) { "use strict"; const n = t(`../../utils/xml`); const r = t(`./vastUtil`); const o = [`delivery`, `type`, `width`, `height`, `codec`, `id`, `bitrate`, `minBitrate`, `maxBitrate`, `scalable`, `maintainAspectRatio`, `apiFramework`]; function a (t) { if (!(this instanceof a)) return new a(t); this.src = n.keyValue(t); for (let e = 0; e < o.length; e++) { const i = o[e]; this[i] = t.attr(i); } }a.prototype.isSupported = function () { return r.isVPAID(this) ? !!r.findSupportedVPAIDTech(this.type) : this.type !== `video/x-flv`; }, e.exports = a; }, { "../../utils/xml": 44, "./vastUtil": 28 }], 16: [function (t, e, i) { "use strict"; const n = t(`./parsers`); const r = t(`../../utils/xml`); e.exports = function t (e, i) { if (!(this instanceof t)) return new t(e, i); this.name = e.attr(`event`), this.uri = r.keyValue(e), this.name === `progress` && (this.offset = n.offset(e.attr(`offset`), i)); }; }, { "../../utils/xml": 44, "./parsers": 27 }], 17: [function (t, e, i) { "use strict"; e.exports = function t (e) { if (!(this instanceof t)) return new t(e); this.idRegistry = e.attr(`idRegistry`), this.idValue = e.attr(`idValue`); }; }, {}], 18: [function (t, e, i) { "use strict"; const n = t(`./Ad`); const r = t(`./VASTError`); const o = t(`./VASTResponse`); const a = t(`./vastUtil`); const s = t(`../../utils/async`); const c = t(`../../utils/http`).http; const d = t(`../../utils/utilityFunctions`); const l = t(`../../utils/xml`); const u = t(`../../utils/consoleLogger`); function p (t) { if (!(this instanceof p)) return new p(t); const e = { WRAPPER_LIMIT: t && t.wrapperLimit && t.wrapperLimit > 0 ? t.wrapperLimit : 5 }; t = t || {}, this.settings = d.extend({}, t, e), this.errorURLMacros = []; }p.prototype.getVASTResponse = function (t, e) { const i = this; const n = (function (t, e) { if (!t) return new r(`on VASTClient.getVASTResponse, missing ad tag URL`); if (!d.isFunction(e)) return new r(`on VASTClient.getVASTResponse, missing callback function`); }(t, e)); if (n) { if (d.isFunction(e)) return e(n); throw n; }s.waterfall([this._getVASTAd.bind(this, t), function (t, e) { try { const n = i._buildVASTResponse(t); e(null, n); } catch (t) { e(t); } }], e); }, p.prototype._getVASTAd = function (t, e) { const i = this; function o (t, e) { let i; try { i = l.toJXONTree(t), u.debug(`built JXONTree from VAST response:`, i), d.isArray(i.ad) ? i.ads = i.ad : i.ad ? i.ads = [i.ad] : i.ads = [], e(a(i), i); } catch (t) { e(new r(`on VASTClient.getVASTAd.buildVastWaterfall, error parsing xml`, 100), null); } } function a (t) { const e = l.attr(t, `version`); return t.ad ? e && e != 3 && e != 2 && e != 4 ? new r(`on VASTClient.getVASTAd.validateVASTTree, not supported VAST version "${e}"`, 102) : (window.mol_vastVersion = e, null) : new r(`on VASTClient.getVASTAd.validateVASTTree, no Ad in VAST tree`, 303); } function c (t, e, n) { if (e.length >= i.settings.WRAPPER_LIMIT) return n(new r(`on VASTClient.getVASTAd.getAd, player's wrapper limit reached (the limit is ${i.settings.WRAPPER_LIMIT})`, 302), e); s.waterfall([function (e) { d.isString(t) ? (function (t, e) { i._requestVASTXml(t, (t, i) => { if (t) return e(t); try { const n = l.toJXONTree(i); e(a(n), n.ad); } catch (t) { e(new r(`on VASTClient.getVASTAd.requestVASTAd, error parsing xml`, 100)); } }); }(t, e)) : e(null, t); }, p], (t, i) => { return i && e.push(i), t ? n(t, e) : i.wrapper ? c(i.wrapper.VASTAdTagURI, e, n) : n(null, e); }); } function p (t, e) { try { const i = new n(t); e((function (t) { const e = t.wrapper; const i = t.inLine; const n = `on VASTClient.getVASTAd.validateAd, `; if (i && e) return new r(`${n}InLine and Wrapper both found on the same Ad`, 101); if (!i && !e) return new r(`${n}nor wrapper nor inline elements found on the Ad`, 101); if (i && !i.isSupported()) return new r(`${n}could not find MediaFile that is supported by this video player`, 403); if (e && !e.VASTAdTagURI) return new r(`${n}missing 'VASTAdTagURI' in wrapper`, 101); return null; }(i)), i); } catch (t) { e(new r(`on VASTClient.getVASTAd.buildAd, error parsing xml`, 100), null); } }!(function (t, e) { const n = i._requestVASTXml.bind(i, t); s.waterfall([n, o], e); }(t, (t, n) => { const r = n && d.isArray(n.ads) ? n.ads : null; if (t) return i._trackError(t, r), e(t, r); c(r.shift(), [], function t (n, o) { n ? (i._trackError(n, o), r.length > 0 ? c(r.shift(), [], t) : e(n, o)) : e(null, o); }); })); }, p.prototype._requestVASTXml = function (t, e) { try { d.isFunction(t) ? t(i) : (u.info(`requesting adTagUrl: ${t}`), c.get(t, i, { withCredentials: !0 })); } catch (t) { e(t); } function i (t, i, n) { if (t) { const o = d.isDefined(n) ? `on VASTClient.requestVastXML, HTTP request error with status '${n}'` : `on VASTClient.requestVastXML, Error getting the the VAST XML with he passed adTagXML fn`; return e(new r(o, 301), null); }e(null, i); } }, p.prototype._buildVASTResponse = function (t) { const e = new o(); return (function (t, e) { e.forEach((e) => { t.addAd(e); }); }(e, t)), (function (t) { const e = t.trackingEvents.progress; if (!t.hasLinear()) throw new r(`on VASTClient._buildVASTResponse, Received an Ad type that is not supported`, 200); if (void 0 === t.duration) throw new r(`on VASTClient._buildVASTResponse, Missing duration field in VAST response`, 101); e && e.forEach((t) => { if (!d.isNumber(t.offset)) throw new r(`on VASTClient._buildVASTResponse, missing or wrong offset attribute on progress tracking event`, 101); }); }(e)), e; }, p.prototype._trackError = function (t, e) { if (d.isArray(e) && e.length !== 0) { let i = []; e.forEach((t) => { t.wrapper && t.wrapper.errors && Array.isArray(t.wrapper.errors) && (i = i.concat(t.wrapper.errors)); t.inLine && t.inLine.errors && Array.isArray(t.inLine.errors) && (i = i.concat(t.inLine.errors)); }), a.track(i, { ERRORCODE: t.code || 900 }); } }, e.exports = p; }, { "../../utils/async": 36, "../../utils/consoleLogger": 37, "../../utils/http": 39, "../../utils/utilityFunctions": 43, "../../utils/xml": 44, "./Ad": 7, "./VASTError": 19, "./VASTResponse": 21, "./vastUtil": 28 }], 19: [function (t, e, i) { "use strict"; function n (t, e) { this.message = `VAST Error: ${t || ``}`, e && (this.code = e); }n.prototype = new Error(), n.prototype.name = `VAST Error`, e.exports = n; }, {}], 20: [function (t, e, i) { "use strict"; const n = t(`./VASTResponse`); const r = t(`./VASTError`); const o = t(`./VASTTracker`); const a = t(`./vastUtil`); const s = t(`../../utils/async`); const c = t(`../../utils/dom`); const d = t(`../../utils/playerUtils`); const l = t(`../../utils/utilityFunctions`); const u = t(`../../utils/consoleLogger`); function p (t) { if (!(this instanceof p)) return new p(t); this.player = t, this.enableFullscreenClickIFrame = !1; }p.prototype.playAd = function (t, e) { const i = this; return e = e || l.noop, t instanceof n ? (s.waterfall([function (e) { e(null, t); }, this._selectAdSource.bind(this), this._createVASTTracker.bind(this), this._addClickThrough.bind(this), this._addClickThroughDivBlocker.bind(this), this._addSkipButton.bind(this), this._setupEvents.bind(this), this._playSelectedAd.bind(this)], (t, n) => { t && n && (window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdError`, adVolume: i.player.volume() }), i._trackError(t, n)), e(t, n); }), this._adUnit = { _src: null, type: `VAST`, pauseAd: function () { i.player.pause(!0); }, resumeAd: function () { i.player.play(!0); }, isPaused: function () { return i.player.paused(!0); }, getSrc: function () { return this._src; } }, this._adUnit) : e(new r(`On VASTIntegrator, missing required VASTResponse`)); }, p.prototype._selectAdSource = function (t, e) { let i; const n = c.getDimension(this.player.el()).width; if (t.mediaFiles.sort((t, e) => { return Math.abs(n - t.width) - Math.abs(n - e.width); }), (i = this.player.selectSource(t.mediaFiles).source) && this.player.trigger({ type: `trace.message`, data: { message: `Playing ${i.src} (type = ${i.type})` } }), i) return u.info(`selected source: `, i), this._adUnit && (this._adUnit._src = i), e(null, i, t); e(new r(`Could not find Ad mediafile supported by this player`, 403), t); }, p.prototype._createVASTTracker = function (t, e, i) { try { i(null, t, new o(t.src, e), e); } catch (t) { i(t, e); } }, p.prototype._setupEvents = function (t, e, i, n) { let r; const o = this.player; return o.on(`fullscreenchange`, a), o.on(`vast.adStart`, l), o.on(`pause`, s), o.on(`timeupdate`, c), o.on(`volumechange`, u), d.once(o, [`vast.adEnd`, `vast.adsCancel`], () => { o.off(`fullscreenchange`, a), o.off(`vast.adStart`, l), o.off(`pause`, s), o.off(`timeupdate`, c), o.off(`volumechange`, u); }), d.once(o, [`vast.adEnd`, `vast.adsCancel`, `vast.adSkip`], (t) => { if (t.type === `vast.adEnd` && e.trackComplete(), window.MoatApiReference) { const i = t.type === `vast.adEnd` ? `AdVideoComplete` : `AdStopped`; window.MoatApiReference.dispatchEvent({ type: i, adVolume: o.volume() }); } }), o.one(`adStop`, () => { o.trigger(`vast.adsCancel`); }), n(null, t, i); function a () { o.isFullscreen() ? e.trackFullscreen() : e.trackExitFullscreen(); } function s () { if (window._molSettings.breakDuration) { if (window._molSettings.realVideoDuration && Math.abs(window._molSettings.realVideoDuration - o.currentTime()) < 2) return; } else if (Math.abs(o.duration() - o.currentTime()) < 2) return; window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdPaused`, adVolume: o.volume() }), e.trackPause(), d.showBigPlayButton(o, !0), d.once(o, [`play`, `vast.adEnd`, `vast.adsCancel`], (t) => { t.type === `play` && (window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdPlaying`, adVolume: o.volume() }), e.trackResume(), d.showBigPlayButton(o, !1)); }); } function c () { const t = 1e3 * o.currentTime(); e.trackProgress(t); } function l () { window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdImpression`, adVolume: o.volume() }), e.trackImpressions(), e.trackCreativeView(); } function u () { window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVolumeChange`, adVolume: o.volume() }); const t = o.muted(); t ? e.trackMute() : r && e.trackUnmute(), r = t; } }, p.prototype._addSkipButton = function (t, e, i, n) { let r; const o = this; l.isNumber(i.skipoffset) && (r = i.skipoffset / 1e3, (function (t, i) { const n = (function (t) { const i = window.document.createElement(`div`); return c.addClass(i, `vast-skip-button`), i.id = `adSkipButton`, i.style.display = `none`, i.onclick = function (n) { if (c.hasClass(i, `enabled`) && (window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdSkipped`, adVolume: t.volume() }), e.trackSkip(), t.trigger(`vast.adSkip`)), d.showBigPlayButton(t, !1), void 0 === window.Event.prototype.stopPropagation) return !1; n.stopPropagation(); }, i; }(t)); const r = function (t, e, i) { const n = Math.ceil(e - i.currentTime()); t.style.display = `block`, n > 0 && !c.hasClass(t, `enabled`) ? t.innerHTML = `<p class="vast-skip-button-text">${window._molSettings.skipText.replace(`%%TIME%%`, l.toFixedDigits(n, 2))}</p>` : c.hasClass(t, `enabled`) || (c.addClass(t, `enabled`), t.innerHTML = window._molSettings.skipButtonText); window.document.getElementById(`iframeBackButton`) || (t.style.display = `block`); }.bind(o, n, i, t); t.el().appendChild(n), t.on(`timeupdate`, r), d.once(t, [`vast.adEnd`, `vast.adsCancel`], () => { t.off(`timeupdate`, r), c.remove(n); }); }(this.player, r))), n(null, t, e, i); }, p.prototype._addClickThrough = function (t, e, i, n) { const r = this.enableFullscreenClickIFrame; const o = this.player; const s = (function (t, e, i) { if (window._molSettings.disableClickThru) { const n = window.document.createElement(`div`); return c.addClass(n, `vast-blocker`), n; } const o = window.document.createElement(`a`); const a = i.clickThrough; c.addClass(o, `vast-blocker`), l.isIDevice() || (o.href = p(a, t)); l.isString(a) && (o.target = `_blank`); const s = function (i) { if (t.paused()) return t.play(), void 0 !== window.Event.prototype.stopPropagation && i.stopPropagation(), !1; t.pause(), e.trackClick(), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdClickThru`, adVolume: t.volume() }), l.isIDevice() && (setTimeout(() => { window.open(p(a, t), `_blank`); }, 1), void 0 !== window.Event.prototype.stopPropagation && i.stopPropagation(), setTimeout(() => { t.paused() || t.pause(); }, 500)); const n = t.duration() - t.currentTime(); n < 3 && n > 0 && setTimeout(() => { d.showBigPlayButton(t, !0), d.once(t, [`playing`, `vast.adEnd`, `vast.adsCancel`, `vast.adSkip`], () => { d.showBigPlayButton(t, !1); }); }, 500); }; l.isIDevice() ? o.ontouchend = s : o.onclick = s; t.isFullscreen() && r && (o.style.display = `none`); return o; }(o, e, i)); const u = function (t, e, i) { l.isIDevice() || (t.href = p(e.clickThrough, i)); }.bind(this, s, i, o); return o.el().insertBefore(s, o.controlBar.el()), o.on(`timeupdate`, u), d.once(o, [`vast.adEnd`, `vast.adsCancel`], () => { o.off(`timeupdate`, u), o.off(`fullscreenchange`, f), c.remove(s); }), r && o.on(`fullscreenchange`, f), n(null, t, e, i); function p (e, i) { const n = { ASSETURI: t.src, CONTENTPLAYHEAD: a.formatProgress(1e3 * i.currentTime()) }; return e ? a.parseURLMacro(e, n) : `#`; } function f () { s.style.display = o.isFullscreen() ? `none` : `block`; } }, p.prototype._addClickThroughDivBlocker = function (t, e, i, n) { if (!this.enableFullscreenClickIFrame) return n(null, t, e, i); let r; let o; let s; const l = this.player; const u = (function (t, e) { const i = window.document.createElement(`div`); c.addClass(i, `vast-blocker`), window._molSettings.disableClickThru || (i.onclick = function (n) { if (t.paused()) return t.play(), void 0 !== window.Event.prototype.stopPropagation && n.stopPropagation(), !1; t.pause(), e.trackClick(), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdClickThru`, adVolume: t.volume() }), o = window.document.createElement(`iframe`), c.addClass(o, `vast-blocker`), o.src = r, i.appendChild(o), s = window.document.createElement(`div`), c.addClass(s, `vast-back-button`), c.addClass(s, `enabled`), s.innerHTML = `Back`, s.id = `iframeBackButton`, i.appendChild(s), s.addEventListener(`click`, () => { i.removeChild(o), o = null, i.removeChild(s), s = null; const e = window.document.getElementById(`adSkipButton`); e && (e.style.display = `block`), t.controls(!0), void 0 !== window.Event.prototype.stopPropagation && n.stopPropagation(); }), setTimeout(() => { d.showBigPlayButton(t, !1); }, 1); const a = window.document.getElementById(`adSkipButton`); a && (a.style.display = `none`), t.controls(!1); }); t.isFullscreen() || (i.style.display = `none`); return i; }(l, e)); const p = function (e, i, n) { r = (function (e, i) { const n = { ASSETURI: t.src, CONTENTPLAYHEAD: a.formatProgress(1e3 * i.currentTime()) }; return e ? a.parseURLMacro(e, n) : `#`; }(i.clickThrough, n)); }.bind(this, u, i, l); return l.el().insertBefore(u, l.controlBar.el()), l.on(`timeupdate`, p), d.once(l, [`vast.adEnd`, `vast.adsCancel`], () => { l.off(`timeupdate`, p), l.off(`fullscreenchange`, f), c.remove(u); }), l.on(`fullscreenchange`, f), n(null, t, e, i); function f () { if (u.style.display = l.isFullscreen() ? `block` : `none`, !l.isFullscreen() && o) { u.removeChild(o), o = null, u.removeChild(s), s = null, d.showBigPlayButton(l, !0); const t = window.document.getElementById(`adSkipButton`); t && (t.style.display = `none`), l.controls(!0); } } }, p.prototype._playSelectedAd = function (t, e, i) { const n = this.player; n && n.vast && !0 === n.vast.adsCancelled ? i(null) : (n.preload(`auto`), n.src(t), u.debug(`<VASTIntegrator._playSelectedAd> waiting for durationchange to play the ad...`), d.once(n, [`durationchange`, `error`, `vast.adsCancel`], (t) => { t.type === `durationchange` ? (u.debug(`<VASTIntegrator._playSelectedAd> got durationchange; calling playAd()`), d.once(n, [`playing`, `vast.adsCancel`], (t) => { if (t.type !== `vast.adsCancel`) { if (u.debug(`<VASTIntegrator._playSelectedAd/playAd> got playing event; triggering vast.adStart...`), n.trigger(`vast.adStart`), l.isMobile()) for (let r = 0; r < 5; r++)setTimeout(() => { n.userActive(!0); }, 2e3 * r); window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVideoStart`, adVolume: n.volume() }), n.on(`ended`, o), n.on(`vast.adsCancel`, o), n.on(`vast.adSkip`, o); } function o (t) { if (t.type === `ended`) if (window._molSettings.breakDuration) { if (window._molSettings.realVideoDuration && window._molSettings.realVideoDuration - n.currentTime() > 3) return; } else if (n.duration() - n.currentTime() > 3) return; n.off(`ended`, o), n.off(`vast.adsCancel`, o), n.off(`vast.adSkip`, o), t.type !== `ended` && t.type !== `vast.adSkip` || i(null, e); } }), u.debug(`<VASTIntegrator._playSelectedAd/playAd> calling player.play()...`), n.play()) : t.type === `error` && i(new r(`on VASTIntegrator, Player is unable to play the Ad`, 400), e); })); }, p.prototype._trackError = function (t, e) { a.track(e.errorURLMacros, { ERRORCODE: t.code || 900 }); }, e.exports = p; }, { "../../utils/async": 36, "../../utils/consoleLogger": 37, "../../utils/dom": 38, "../../utils/playerUtils": 41, "../../utils/utilityFunctions": 43, "./VASTError": 19, "./VASTResponse": 21, "./VASTTracker": 22, "./vastUtil": 28 }], 21: [function (t, e, i) { "use strict"; const n = t(`./Ad`); const r = t(`./VideoClicks`); const o = t(`./Linear`); const a = t(`./InLine`); const s = t(`./Wrapper`); const c = t(`../../utils/utilityFunctions`); function d () { if (!(this instanceof d)) return new d(); this._linearAdded = !1, this.vastVersion = void 0, this.ads = [], this.errorURLMacros = [], this.impressions = [], this.clickTrackings = [], this.customClicks = [], this.trackingEvents = {}, this.mediaFiles = [], this.clickThrough = void 0, this.adTitle = ``, this.duration = void 0, this.skipoffset = void 0, this.icons = []; } function l (t, e) { e.forEach((e) => { e && t.push(e); }); }window.InLine__A = a, d.prototype.addAd = function (t) { let e, i; t instanceof n && (e = t.inLine, i = t.wrapper, this.ads.push(t), e && this._addInLine(e), i && this._addWrapper(i)); }, d.prototype._addErrorTrackUrls = function (t) { c.isArray(t) && l(this.errorURLMacros, t); }, d.prototype._addImpressions = function (t) { c.isArray(t) && l(this.impressions, t); }, d.prototype._addClickThrough = function (t) { c.isNotEmptyString(t) && (this.clickThrough = t); }, d.prototype._addClickTrackings = function (t) { c.isArray(t) && l(this.clickTrackings, t); }, d.prototype._addCustomClicks = function (t) { c.isArray(t) && l(this.customClicks, t); }, d.prototype._addTrackingEvents = function (t) { const e = this.trackingEvents; t && (t = c.isArray(t) ? t : [t]).forEach((t) => { e[t.name] || (e[t.name] = []), e[t.name].push(t); }); }, d.prototype._addTitle = function (t) { c.isNotEmptyString(t) && (this.adTitle = t); }, d.prototype._addDuration = function (t) { c.isNumber(t) && (this.duration = t); }, d.prototype._addVideoClicks = function (t) { t instanceof r && (this._addClickThrough(t.clickThrough), this._addClickTrackings(t.clickTrackings), this._addCustomClicks(t.customClicks)); }, d.prototype._addMediaFiles = function (t) { c.isArray(t) && l(this.mediaFiles, t); }, d.prototype._addSkipoffset = function (t) { window._molSettings && window._molSettings.skippable ? window._molSettings.skippable.enabled && (!this.duration || !window._molSettings.skippable.videoThreshold || this.duration >= window._molSettings.skippable.videoThreshold) && (this.skipoffset = window._molSettings.skippable.videoOffset) : t && (this.skipoffset = t); }, d.prototype._addAdParameters = function (t) { t && (this.adParameters = t); }, d.prototype._addIcons = function (t) { c.isArray(t) && l(this.icons, t); }, d.prototype._addLinear = function (t) { t instanceof o && (this._addDuration(t.duration), this._addTrackingEvents(t.trackingEvents), this._addVideoClicks(t.videoClicks), this._addMediaFiles(t.mediaFiles), this._addSkipoffset(t.skipoffset), this._addAdParameters(t.adParameters), this._addIcons(t.icons), this._linearAdded = !0); }, d.prototype._addInLine = function (t) { const e = this; t instanceof a && (this._addTitle(t.adTitle), this._addErrorTrackUrls(t.errors), this._addImpressions(t.impressions), t.creatives.forEach((t) => { t.linear && e._addLinear(t.linear); })); }, d.prototype._addWrapper = function (t) { const e = this; t instanceof s && (this._addErrorTrackUrls(t.errors), this._addImpressions(t.impressions), t.creatives.forEach((t) => { const i = t.linear; i && (e._addVideoClicks(i.videoClicks), e.clickThrough = void 0, e._addTrackingEvents(i.trackingEvents), e._addIcons(i.icons)); })); }, d.prototype.hasLinear = function () { return this._linearAdded; }, e.exports = d; }, { "../../utils/utilityFunctions": 43, "./Ad": 7, "./InLine": 12, "./Linear": 14, "./VideoClicks": 24, "./Wrapper": 26 }], 22: [function (t, e, i) { "use strict"; const n = t(`./VASTError`); const r = t(`./VASTResponse`); const o = t(`./vastUtil`); const a = t(`../../utils/utilityFunctions`); function s (t, e) { if (!(this instanceof s)) return new s(t, e); this.sanityCheck(t, e), this.initialize(t, e); }s.prototype.initialize = function (t, e) { this.response = e, this.assetURI = t, this.progress = 0, this.quartiles = { firstQuartile: { tracked: !1, time: Math.round(25 * e.duration) / 100 }, midpoint: { tracked: !1, time: Math.round(50 * e.duration) / 100 }, thirdQuartile: { tracked: !1, time: Math.round(75 * e.duration) / 100 } }; }, s.prototype.sanityCheck = function (t, e) { if (!a.isString(t) || a.isEmptyString(t)) throw new n(`on VASTTracker constructor, missing required the URI of the ad asset being played`); if (!(e instanceof r)) throw new n(`on VASTTracker constructor, missing required VAST response`); }, s.prototype.trackURLs = function (t, e) { a.isArray(t) && t.length > 0 && (e = a.extend({ ASSETURI: this.assetURI, CONTENTPLAYHEAD: o.formatProgress(this.progress) }, e || {}), o.track(t, e)); }, s.prototype.trackEvent = function (t, e) { this.response.trackingEvents[t] && window._molSettings.viewabilityTracking && window._molSettings.viewabilityTracking.invokeEvent(t), this.trackURLs(function (t) { let e; t && (e = [], t.forEach((t) => { t.uri && e.push(t.uri); })); return e; }(this.response.trackingEvents[t])), e && (this.response.trackingEvents[t] = void 0); }, s.prototype.trackProgress = function (t) { let e; let i; const n = this; const r = []; const o = !0; const s = this.response.trackingEvents; function c (t, e, i) { s[t] && i && r.push({ name: t, trackOnce: !!e }); }a.isNumber(t) && (c(`start`, o, t > 0), c(`rewind`, !1, (e = this.progress, i = t, e > t && Math.abs(i - e) > 3e3)), (function (t) { const e = n.quartiles; const i = n.quartiles.firstQuartile; const r = n.quartiles.midpoint; const a = n.quartiles.thirdQuartile; i.tracked ? r.tracked ? a.tracked || s(`thirdQuartile`, t) : s(`midpoint`, t) : s(`firstQuartile`, t); function s (t, i) { const n = e[t]; (function (t, e) { const i = t.time; return e >= i && e <= i + 5e3; })(n, i) && (n.tracked = !0, c(t, o, !0)); } }(t)), (function (t) { if (!a.isArray(s.progress)) return; const e = []; s.progress.forEach((i) => { i.offset <= t ? n.trackURLs([i.uri]) : e.push(i); }), s.progress = e; }(t)), r.forEach((t) => { n.trackEvent(t.name, t.trackOnce); }), this.progress = t); }, [`rewind`, `fullscreen`, `exitFullscreen`, `pause`, `resume`, `mute`, `unmute`, `acceptInvitation`, `acceptInvitationLinear`, `collapse`, `expand`].forEach((t) => { s.prototype[`track${a.capitalize(t)}`] = function () { this.trackEvent(t); }; }), [`start`, `skip`, `close`, `closeLinear`].forEach((t) => { s.prototype[`track${a.capitalize(t)}`] = function () { this.trackEvent(t, !0); }; }), [`firstQuartile`, `midpoint`, `thirdQuartile`].forEach((t) => { s.prototype[`track${a.capitalize(t)}`] = function () { this.quartiles[t].tracked = !0, this.trackEvent(t, !0); }; }), s.prototype.trackComplete = function () { this.quartiles.thirdQuartile.tracked && this.trackEvent(`complete`, !0); }, s.prototype.trackErrorWithCode = function (t) { a.isNumber(t) && this.trackURLs(this.response.errorURLMacros, { ERRORCODE: t }); }, s.prototype.trackImpressions = function () { this.trackURLs(this.response.impressions); }, s.prototype.trackCreativeView = function () { this.trackEvent(`creativeView`); }, s.prototype.trackClick = function () { window._molSettings.viewabilityTracking && window._molSettings.viewabilityTracking.invokeEvent(`ad-click`), this.trackURLs(this.response.clickTrackings); }, e.exports = s; }, { "../../utils/utilityFunctions": 43, "./VASTError": 19, "./VASTResponse": 21, "./vastUtil": 28 }], 23: [function (t, e, i) { "use strict"; const n = t(`../../utils/xml`); const r = t(`./vastUtil`); const o = t(`../../utils/utilityFunctions`); function a (t) { if (!(this instanceof a)) return new a(t); function e (t) { const e = []; return t && (o.isArray(t) ? t : [t]).forEach((t) => { e.push({ apiFramework: t.attr(`apiFramework`), uri: n.keyValue(t) }); }), e; } this.vendor = t.attr(`vendor`), t.javaScriptResource && (this.javaScriptResources = e(t.javaScriptResource)), r.isFlashSupported() && t.flashResource && (this.javaScriptResources = e(t.javaScriptResource)), t.viewableImpression && (this.viewableImpression = { id: t.viewableImpression.attr(`id`), uri: n.keyValue(t.viewableImpression) }); }a.parseAdVerifications = function (t) { const e = []; return o.isDefined(t) && o.isDefined(t.verification) && (o.isArray(t.verification) ? t.verification : [t.verification]).forEach((t) => { e.push(new a(t)); }), e; }, e.exports = a; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44, "./vastUtil": 28 }], 24: [function (t, e, i) { "use strict"; const n = t(`../../utils/utilityFunctions`); const r = t(`../../utils/xml`); e.exports = function t (e) { if (!(this instanceof t)) return new t(e); function i (t) { const e = []; return t && (t = n.isArray(t) ? t : [t]).forEach((t) => { e.push(r.keyValue(t)); }), e; } this.clickThrough = r.keyValue(e.clickThrough), this.clickTrackings = i(e.clickTracking), this.customClicks = i(e.customClick); }; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44 }], 25: [function (t, e, i) { "use strict"; const n = t(`../../utils/xml`); const r = t(`../../utils/utilityFunctions`); e.exports = function t (e) { if (!(this instanceof t)) return new t(e); function i (t) { const e = []; return t && (r.isArray(t) ? t : [t]).forEach((t) => { e.push(n.keyValue(t)); }), e; } this.id = e.attr(`id`), e.viewable && (this.viewables = i(e.viewable)), e.notViewable && (this.notViewables = i(e.notViewable)), e.viewUndetermined && (this.viewUndetermineds = i(e.viewUndetermined)); }; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44 }], 26: [function (t, e, i) { "use strict"; const n = t(`./vastUtil`); const r = t(`./Creative`); const o = t(`./ViewableImpression`); const a = t(`./Verification`); const s = t(`../../utils/utilityFunctions`); const c = t(`../../utils/xml`); e.exports = function t (e) { if (!(this instanceof t)) return new t(e); this.adSystem = c.keyValue(e.adSystem), this.impressions = n.parseImpressions(e.impression), this.VASTAdTagURI = c.keyValue(e.vASTAdTagURI), this.creatives = r.parseCreatives(e.creatives), this.errors = n.parseErrors(e.error), this.extensions = e.extensions, this.followAdditionalWrappers = !s.isDefined(c.attr(e, `followAdditionalWrappers`)) || c.attr(e, `followAdditionalWrappers`), this.allowMultipleAds = c.attr(e, `allowMultipleAds`), this.fallbackOnNoAd = c.attr(e, `fallbackOnNoAd`), window.mol_vastVersion === 4 && (e.viewableImpression && (this.viewableImpression = new o(e.viewableImpression)), e.adVerifications && (this.adVerifications = a.parseAdVerifications(e.adVerifications))); }; }, { "../../utils/utilityFunctions": 43, "../../utils/xml": 44, "./Creative": 10, "./Verification": 23, "./ViewableImpression": 25, "./vastUtil": 28 }], 27: [function (t, e, i) { "use strict"; const n = t(`../../utils/utilityFunctions`); const r = /(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/; var o = { duration: function (t) { let e, i, o, a, s; return n.isString(t) && (e = t.match(r)) && (s = e[1], i = 60 * parseInt(s, 10) * 60 * 1e3 + (a = e[2], 60 * parseInt(a, 10) * 1e3) + (o = e[3], 1e3 * parseInt(o, 10)) + parseInt(e[5] || 0)), isNaN(i) ? null : i; }, offset: function (t, e) { return (function (t) { return /^\d+(\.\d+)?%$/g.test(t); }(t)) ? (function (t, e) { if (e) return i = e, n = parseFloat(t.replace(`%`, ``)), i * n / 100; let i, n; return null; }(t, e)) : o.duration(t); } }; e.exports = o; }, { "../../utils/utilityFunctions": 43 }], 28: [function (t, e, i) { "use strict"; const n = t(`../../utils/utilityFunctions`); var r = { track: function (t, e) { const i = r.parseURLMacros(t, e); const n = []; return i.forEach((t) => { const e = new Image(); e.src = t, n.push(e); }), n; }, parseURLMacros: function (t, e) { const i = []; return (e = e || {}).CACHEBUSTING || (e.CACHEBUSTING = Math.round(1e10 * Math.random())), t.forEach((t) => { i.push(r._parseURLMacro(t, e)); }), i; }, parseURLMacro: function (t, e) { return (e = e || {}).CACHEBUSTING || (e.CACHEBUSTING = Math.round(1e10 * Math.random())), r._parseURLMacro(t, e); }, _parseURLMacro: function (t, e) { return e = e || {}, n.forEach(e, (e, i) => { t = t.replace(new RegExp(`\\[${i}\\]`, `gm`), e); }), t; }, parseDuration: function (t) { let e, i, r, o, a; return n.isString(t) && (e = t.match(/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/)) && (a = e[1], i = 60 * parseInt(a, 10) * 60 * 1e3 + (o = e[2], 60 * parseInt(o, 10) * 1e3) + (r = e[3], 1e3 * parseInt(r, 10)) + parseInt(e[5] || 0)), isNaN(i) ? null : i; }, parseImpressions: function (t) { return t ? (t = n.isArray(t) ? t : [t], n.transformArray(t, (t) => { if (n.isNotEmptyString(t.keyValue)) return t.keyValue; })) : []; }, parseErrors: function (t) { return t ? (t = n.isArray(t) ? t : [t], n.transformArray(t, (t) => { if (n.isNotEmptyString(t.keyValue)) return t.keyValue; })) : []; }, formatProgress: function (t) { let e, i, r, o; return e = t / 36e5, e = Math.floor(e), i = t / 6e4 % 60, i = Math.floor(i), r = t / 1e3 % 60, r = Math.floor(r), o = t % 1e3, `${n.toFixedDigits(e, 2)}:${n.toFixedDigits(i, 2)}:${n.toFixedDigits(r, 2)}.${n.toFixedDigits(o, 3)}`; }, parseOffset: function (t, e) { return (function (t) { return /^\d+(\.\d+)?%$/g.test(t); }(t)) ? (function (t, e) { if (e) return i = e, n = parseFloat(t.replace(`%`, ``)), i * n / 100; let i, n; return null; }(t, e)) : r.parseDuration(t); }, VPAID_techs: [t(`../vpaid/VPAIDHTML5Tech`)], isVPAID: function (t) { return !!t && t.apiFramework === `VPAID`; }, findSupportedVPAIDTech: function (t) { let e, i, n; for (e = 0, i = this.VPAID_techs.length; e < i; e += 1) if ((n = this.VPAID_techs[e]).supports(t)) return n; return null; }, isFlashSupported: function () { return !1; } }; e.exports = r; }, { "../../utils/utilityFunctions": 43, "../vpaid/VPAIDHTML5Tech": 30 }], 29: [function (t, e, i) { "use strict"; const n = t(`../vast/VASTError`); const r = t(`../../utils/utilityFunctions`); const o = t(`../../utils/consoleLogger`); function a (t, e) { if (!(this instanceof a)) return new a(t, e); !(function (t, e) { if (!t || !a.checkVPAIDInterface(t)) throw new n(`on VPAIDAdUnitWrapper, the passed VPAID adUnit does not fully implement the VPAID interface`); if (!r.isObject(e)) throw new n(`on VPAIDAdUnitWrapper, expected options hash  but got '${e}'`); if (!(`responseTimeout` in e && r.isNumber(e.responseTimeout))) throw new n(`on VPAIDAdUnitWrapper, expected responseTimeout in options`); }(t, e)), this.options = r.extend({}, e), this.adStarted = !1, this._adUnit = t; }a.checkVPAIDInterface = function (t) { for (var e, i = [`handshakeVersion`, `initAd`, `startAd`, `stopAd`, `resizeAd`, `pauseAd`, `expandAd`, `collapseAd`], n = 0, o = i.length; n < o; n++) if (!t || !r.isFunction(t[i[n]])) return !1; return e = t, (r.isFunction(e.subscribe) || r.isFunction(e.addEventListener) || r.isFunction(e.on)) && (function (t) { return r.isFunction(t.unsubscribe) || r.isFunction(t.removeEventListener) || r.isFunction(t.off); }(t)); }, a.prototype.adUnitAsyncCall = function () { let t; const e = r.arrayLikeObjToArray(arguments); const i = e.shift(); let o = e.pop(); !(function (t, e, i) { if (!r.isString(t) || !r.isFunction(i[t])) throw new n(`on VPAIDAdUnitWrapper.adUnitAsyncCall, invalid method name`); if (!r.isFunction(e)) throw new n(`on VPAIDAdUnitWrapper.adUnitAsyncCall, missing callback`); }(i, o, this._adUnit)), e.push(function () { t && clearTimeout(t), o.apply(this, arguments); }), this._adUnit[i].apply(this._adUnit, e), t = setTimeout(() => { t = null, o(new n(`on VPAIDAdUnitWrapper, timeout while waiting for a response on call '${i}'`)), o = r.noop; }, this.options.responseTimeout); }, a.prototype.on = function (t, e) { (this._adUnit.addEventListener || this._adUnit.subscribe || this._adUnit.on).call(this._adUnit, t, e); }, a.prototype.off = function (t, e) { (this._adUnit.removeEventListener || this._adUnit.unsubscribe || this._adUnit.off).call(this._adUnit, t, e); }, a.prototype.waitForEvent = function (t, e, i) { let o; const a = this; function s () { a.options && a.options.player && a.options.player.trigger({ type: `trace.event`, data: { event: t } }), a.off(t, s); const n = r.arrayLikeObjToArray(arguments); o && (clearTimeout(o), o = null), n.unshift(null), e.apply(i, n); }!(function (t, e) { if (!r.isString(t)) throw new n(`on VPAIDAdUnitWrapper.waitForEvent, missing evt name`); if (!r.isFunction(e)) throw new n(`on VPAIDAdUnitWrapper.waitForEvent, missing callback`); }(t, e)), i = i || null, this.on(t, s), o = setTimeout(() => { a.off(t, s), window._timeoutIds.indexOf(o) >= 0 && (a.options && a.options.player && a.options.player.trigger({ type: `trace.message`, data: { message: `Timeout while waiting for event ${t}` } }), e(new n(`on VPAIDAdUnitWrapper.waitForEvent, timeout while waiting for event '${t}'. You may need to increase adStartTimeout.`))), o = null, e = r.noop; }, this.options.responseTimeout), window._timeoutIds.push(o); }, a.prototype.handshakeVersion = function (t, e) { this.adUnitAsyncCall(`handshakeVersion`, t, e); }, a.prototype.initAd = function (t, e, i, n, r, a) { o.log(`VPAIDAdUnitWrapper->Calling initAd on creative`), this.waitForEvent(`AdLoaded`, a), this._adUnit.initAd(t, e, i, n, r); }, a.prototype.resizeAd = function (t, e, i, n) { o.log(`VPAIDAdUnitWrapper->Calling resizeAd on creative`), this.adUnitAsyncCall(`resizeAd`, t, e, i, n), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdSizeChange`, adVolume: this.options.player.volume() }); }, a.prototype.startAd = function (t) { o.log(`VPAIDAdUnitWrapper->Calling startAd on creative`), this.adStarted || this.waitForEvent(`AdStarted`, t), this._adUnit.startAd(), this.adStarted && t(null); }, a.prototype.stopAd = function (t) { o.log(`VPAIDAdUnitWrapper->Calling stopAd on creative`), this.waitForEvent(`AdStopped`, t), this._adUnit.stopAd(); }, a.prototype.pauseAd = function (t) { o.log(`VPAIDAdUnitWrapper->Calling pauseAd on creative`), this.waitForEvent(`AdPaused`, t), this._adUnit.pauseAd(); }, a.prototype.resumeAd = function (t) { o.log(`VPAIDAdUnitWrapper->Calling resumeAd on creative`), this.waitForEvent(`AdPlaying`, t), this._adUnit.resumeAd(); }, a.prototype.expandAd = function (t) { o.log(`VPAIDAdUnitWrapper->Calling expandAd on creative`), this.waitForEvent(`AdExpandedChange`, t), this._adUnit.expandAd(); }, a.prototype.collapseAd = function (t) { o.log(`VPAIDAdUnitWrapper->Calling collapseAd on creative`), this.waitForEvent(`AdExpandedChange`, t), this._adUnit.collapseAd(); }, a.prototype.skipAd = function (t) { o.log(`VPAIDAdUnitWrapper->Calling skipAd on creative`), this.waitForEvent(`AdSkipped`, t), this._adUnit.skipAd(); }, [`adLinear`, `adWidth`, `adHeight`, `adExpanded`, `adSkippableState`, `adRemainingTime`, `adDuration`, `adVolume`, `adCompanions`, `adIcons`].forEach((t) => { const e = `get${r.capitalize(t)}`; a.prototype[e] = function (t) { this.adUnitAsyncCall(e, t); }; }), a.prototype.setAdVolume = function (t, e) { this.adUnitAsyncCall(`setAdVolume`, t, e); }, e.exports = a; }, { "../../utils/consoleLogger": 37, "../../utils/utilityFunctions": 43, "../vast/VASTError": 19 }], 30: [function (t, e, i) { "use strict"; const n = t(`../../utils/mimetypes`); const r = t(`../vast/VASTError`); const o = t(`VPAIDHTML5Client/js/VPAIDHTML5Client`); const a = t(`../../utils/utilityFunctions`); const s = t(`../../utils/dom`); const c = t(`../../utils/consoleLogger`); function d (t) { if (!(this instanceof d)) return new d(t); !(function (t) { if (!t || !a.isString(t.src)) throw new r(d.INVALID_MEDIA_FILE); }(t)), this.name = `vpaid-html5`, this.containerEl = null, this.videoEl = null, this.vpaidHTMLClient = null, this.mediaFile = t; }d.VPAIDHTML5Client = o, d.supports = function (t) { return !a.isOldIE() && n.html5.indexOf(t) > -1; }, d.prototype.loadAdUnit = function (t, e, i) { !(function (t, e, i) { if (!s.isDomElement(t)) throw new r(d.INVALID_DOM_CONTAINER_EL); if (!s.isDomElement(e) || e.tagName.toLowerCase() !== `video`) throw new r(d.INVALID_DOM_CONTAINER_EL); if (!a.isFunction(i)) throw new r(d.MISSING_CALLBACK); }(t, e, i)), this.containerEl = t, this.videoEl = e, this.vpaidHTMLClient = new d.VPAIDHTML5Client(t, e, {}), this.vpaidHTMLClient._id = `vpaidIframe_${Date.now()}`, this.vpaidHTMLClient.loadAdUnit(this.mediaFile.src, i); }, d.prototype.unloadAdUnit = function () { if (this.vpaidHTMLClient) { try { this.vpaidHTMLClient.destroy(); } catch (t) { c.error(`VAST ERROR: trying to unload the VPAID adunit`); } this.vpaidHTMLClient = null; } this.containerEl && (s.remove(this.containerEl), this.containerEl = null); }; const l = `on VPAIDHTML5Tech`; d.INVALID_MEDIA_FILE = `${l}, invalid MediaFile`, d.INVALID_DOM_CONTAINER_EL = `${l}, invalid container HtmlElement`, d.INVALID_DOM_VIDEO_EL = `${l}, invalid HTMLVideoElement`, d.MISSING_CALLBACK = `${l}, missing valid callback`, e.exports = d; }, { "../../utils/consoleLogger": 37, "../../utils/dom": 38, "../../utils/mimetypes": 40, "../../utils/utilityFunctions": 43, "../vast/VASTError": 19, "VPAIDHTML5Client/js/VPAIDHTML5Client": 3 }], 31: [function (t, e, i) { "use strict"; const n = t(`../../utils/mimetypes`); const r = t(`../vast/VASTError`); const o = t(`../vast/VASTResponse`); const a = t(`../vast/VASTTracker`); const s = t(`../vast/vastUtil`); const c = t(`./VPAIDAdUnitWrapper`); const d = t(`../../utils/async`); const l = t(`../../utils/dom`); const u = t(`../../utils/playerUtils`); const p = t(`../../utils/utilityFunctions`); const f = t(`../../utils/consoleLogger`); function h (t, e) { if (!(this instanceof h)) return new h(t); let i; this.VIEW_MODE = { NORMAL: `normal`, FULLSCREEN: `fullscreen`, THUMBNAIL: `thumbnail` }, this.player = t, this.containerEl = ((i = document.createElement(`div`)).id = `BC-VPAID-container`, l.addClass(i, `VPAID-container`), t.el().insertBefore(i, t.controlBar.el()), i), this.options = { responseTimeout: 5e3, VPAID_VERSION: `2.0` }, this.settings = e, this.contentSource = t.tech_.el_.src, this.needsShowPlayer = !1, this.errorHasBeenTracked = !1, this.adFinished = !1, this.timeUpdateTimer = null; } function v (t, e) { for (let i = t.controlBar.getChild(`currentTimeDisplay`).el_.children, n = 0; n < i.length; n++)i[n].id != `bc_time_display` && (i[n].style.display = e ? `` : `none`); } function g (t, e, i) { const n = document.getElementById(`adSkipButton`); const r = t.el().querySelector(`.vjs-tech`); const o = l.getDimension(r); const a = t.isFullscreen() ? i.FULLSCREEN : i.NORMAL; a === i.NORMAL && (t.vast && (t.vast.needSyncPlay = !0), o.width = t.el_.offsetWidth, o.height = t.el_.offsetHeight, p.isAndroid() && n && (n.style.display = `block`)), a === i.FULLSCREEN && (f.log(`****** to fullscreen dimension = ${o.width},${o.height}`), p.isAndroid() && n && (n.style.display = `none`)), e.resizeAd(o.width, o.height, a, m); } function m (t) { t && f.error(`ERROR: ${t.message}`, t); }h.prototype.playAd = function (t, e) { if (!(t instanceof o)) return e(new r(`on VASTIntegrator.playAd, missing required VASTResponse`)); const i = this; const n = this.player; f.debug(`<VPAIDIntegrator.playAd> looking for supported tech...`); const a = this._findSupportedTech(t, this.settings); (e = e || p.noop, this._adUnit = null, l.addClass(n.el(), `vjs-vpaid-ad`), n.on(`vast.adsCancel`, c), n.one(`vpaid.adEnd`, () => { n.off(`vast.adsCancel`, c), (function () { a && (f.log(`VPAIDIntegrator->Calling unloadAdUnit (implicitly invokes stopAd and unsubscribes VPAID events)`), a.unloadAdUnit()); l.removeClass(n.el(), `vjs-vpaid-ad`); }()); }), a) ? (f.info(`<VPAIDIntegrator.playAd> found tech: `, a), d.waterfall([function (e) { e(null, a, t); }, this._loadAdUnit.bind(this), this._playAdUnit.bind(this), this._finishPlaying.bind(this)], s), this._adUnit = { _paused: !0, type: `VPAID`, pauseAd: function () { n.trigger(`vpaid.pauseAd`), n.pause(!0); }, resumeAd: function () { n.trigger(`vpaid.resumeAd`); }, isPaused: function () { return this._paused; }, getSrc: function () { return a.mediaFile; } }) : (f.debug(`<VPAIDIntegrator.playAd> could not find suitable tech`), s(new r(`on VPAIDIntegrator.playAd, could not find a supported mediaFile`, 403), this._adUnit, t)); return this._adUnit; function s (t, r, o) { t && o && i._trackError(o, t.code), n.trigger(`vpaid.adEnd`), e(t, o); } function c () { n.trigger(`vpaid.adEnd`); } }, h.prototype._findSupportedTech = function (t, e) { if (!(t instanceof o)) return null; let i; let r; let a; let c; const d = t.mediaFiles.filter(s.isVPAID); const l = e && e.preferredTech; const u = []; for (i = 0, r = d.length; i < r; i += 1) if (a = d[i], c = s.findSupportedVPAIDTech(a.type)) { if (!!l && (a.type === l || n[l] && n[l].indexOf(a.type) > -1)) return new c(a, e); u.push({ mediaFile: a, tech: c }); } if (u.length) { const p = u[0]; return new p.tech(p.mediaFile, e); } return null; }, h.prototype._createVPAIDAdUnitWrapper = function (t, e, i, n) { return new c(t, { src: e, responseTimeout: i, player: n }); }, h.prototype._loadAdUnit = function (t, e, i) { const n = this; const r = this.player; const o = r.el().querySelector(`.vjs-tech`); const a = this.settings.adCancelTimeout || this.options.responseTimeout; t.loadAdUnit(this.containerEl, o, (o, s) => { if (o) return i(o, s, e); try { const c = document.getElementsByTagName(`IFRAME`); c && c.length > 0 && c[0].addEventListener(`mouseover`, () => { r.userActive(!0), l.hasClass(r.el(), `vjs-has-started`) || l.addClass(r.el(), `vjs-has-started`); }), r.trigger({ type: `trace.message`, data: { message: `Playing ${t.mediaFile.src} (type = ${t.mediaFile.type}, apiFramework = ${t.mediaFile.apiFramework})` } }); const d = n._createVPAIDAdUnitWrapper(s, t.mediaFile.src, a, r); const u = `vjs-${t.name}-ad`; l.addClass(r.el(), u), r.one(`vpaid.adEnd`, () => { l.removeClass(r.el(), u); }), i(null, d, e); } catch (t) { i(t, s, e); } }); window.parent.addEventListener(`message`, (t) => { window.postMessage(t.data, window.location.origin); }); }, h.prototype._playAdUnit = function (t, e, i) { d.waterfall([function (i) { i(null, t, e); }, this._handshake.bind(this), this._setupEvents.bind(this), this._initAd.bind(this), this._addSkipButton.bind(this), this._linkPlayerControls.bind(this), this._startAd.bind(this)], i); }, h.prototype._handshake = function (t, e, i) { t.handshakeVersion(this.options.VPAID_VERSION, (n, o) => { return n ? i(n, t, e) : o && (function (t) { const e = (function (t) { const e = t.split(`.`); return parseInt(e[0], 10); }(t)); return e >= 1 && e <= 2; }(o)) ? i(null, t, e) : i(new r(`on VPAIDIntegrator._handshake, unsupported version "${o}"`), t, e); }); }, h.prototype._initAd = function (t, e, i) { const n = this.player.el().querySelector(`.vjs-tech`); const r = l.getDimension(n); t.initAd(r.width, r.height, this.VIEW_MODE.NORMAL, -1, { AdParameters: e.adParameters || `` }, (n) => { i(n, t, e); }); }, h.prototype._createVASTTracker = function (t, e) { return new a(t, e); }, h.prototype._setupEvents = function (t, e, i) { const n = t.options.src; const r = this._createVASTTracker(n, e); const o = this.player; const a = this.contentSource; const c = this; function d () { c.impressionTriggered || (c.impressionTriggered = !0, window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdImpression`, adVolume: o.volume() }), o.trigger({ type: `trace.event`, data: { event: `vpaid.AdImpression` } }), o.trigger(`vpaid.AdImpression`), r.trackImpressions()); } function f () { let e = document.getElementById(`bc_time_display`); e ? (v(o, !1), e.style.display = `block`) : (e = document.createElement(`div`), o.controlBar.getChild(`currentTimeDisplay`).el_.appendChild(e), e.id = `bc_time_display`, e.class = `vjs-current-time-display`, e[`aria-live`] = `off`, e.innerHTML = `<span class="vjs-control-text"></span>0:00`, v(o, !1)), t.getAdRemainingTime((t, i) => { if (i >= 0) { const n = o.duration() - i; n >= 0 && (e.childNodes[1].nodeValue = (function (t) { let e = parseInt(t + 0.5); const i = parseInt(e / 60); return e -= 60 * i, `${i.toString()}:${e > 9 ? `` : `0`}${e.toString()}`; }(n))); } }); } function h () { c._adUnit && c._adUnit.isPaused() && (c._adUnit._paused = !1), o.trigger(`play`); } function m () { c._adUnit && (c._adUnit._paused = !0), o.trigger(`pause`); } this.tracker = r, this.impressionTriggered = !1, t.on(`AdSkipped`, () => { o.trigger({ type: `trace.event`, data: { event: `vpaid.AdSkipped` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdSkipped`, adVolume: o.volume() }), o.trigger(`vpaid.AdSkipped`), r.trackSkip(), u.showBigPlayButton(o, !1), t.stopAd(p.noop), setTimeout(() => { o.trigger(`vast.adsCancel`); }, 300); }), t.on(`AdImpression`, () => { d(); }), t.on(`AdStarted`, () => { if (!t.adStarted && (window._molSettings.viewabilityTracking && window._molSettings.viewabilityTracking.init(window._molSettings.viewability.contextId, o.duration(), o.el_.offsetWidth, o.el_.offsetHeight), t.adStarted = !0, l.hasClass(o.el(), `vjs-has-started`) || l.addClass(o.el(), `vjs-has-started`), o.trigger(`vpaid.AdStarted`), r.trackCreativeView(), !window._molSettings.playsInBreak && t.getAdDuration && t.getAdDuration((t, e) => { e > 0 && o.duration(e); }), d(), h(), o.one(`adStop`, () => { t.stopAd && t.stopAd(p.noop); }), p.isIDevice())) { const e = document.getElementsByClassName(`vjs-resize-manager`); if (e && e.length > 0) { const i = e[0].parentElement; i && i.removeChild(e[0]); } } }), t.on(`AdVideoStart`, () => { if (o.trigger({ type: `trace.event`, data: { event: `AdVideoStart` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVideoStart`, adVolume: o.volume() }), o.trigger(`vpaid.AdVideoStart`), r.trackStart(), !window._molSettings.playsInBreak && t.getAdDuration && t.getAdDuration((t, e) => { e > 0 && o.duration(e); }), h(), u.showBigPlayButton(o, !1), p.isMobile()) for (let e = 0; e < 4; e++)setTimeout(() => { o.userActive(!0); }, 1e3 * e); a === o.tech_.el_.src && (o.trigger({ type: `trace.message`, data: { message: `VPAID creative uses its own video tag` } }), c.needsShowPlayer = !0, window._molSettings.playsInBreak ? o.controlBar.hide() : c.timeUpdateTimer = setInterval(f, 500)); }), t.on(`AdPlaying`, () => { c.adFinished || (window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdPlaying`, adVolume: o.volume() }), o.trigger(`vpaid.AdPlaying`), r.trackResume(), h(), u.showBigPlayButton(o, !1)); }), t.on(`AdPaused`, () => { c.adFinished || (window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdPaused`, adVolume: o.volume() }), o.trigger(`vpaid.AdPaused`), r.trackPause(), m(), window.document.getElementById(`iframeBackButton`) ? u.showBigPlayButton(o, !1) : u.showBigPlayButton(o, !0)); }), t.on(`AdVideoFirstQuartile`, () => { c.adFinished || (o.trigger({ type: `trace.event`, data: { event: `vpaid.AdVideoFirstQuartile` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVideoFirstQuartile`, adVolume: o.volume() }), o.trigger(`vpaid.AdVideoFirstQuartile`), r.trackFirstQuartile()); }), t.on(`AdVideoMidpoint`, () => { c.adFinished || (o.trigger({ type: `trace.event`, data: { event: `vpaid.AdVideoMidpoint` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVideoMidpoint`, adVolume: o.volume() }), o.trigger(`vpaid.AdVideoMidpoint`), r.trackMidpoint()); }), t.on(`AdVideoThirdQuartile`, () => { c.adFinished || (o.trigger({ type: `trace.event`, data: { event: `vpaid.AdVideoThirdQuartile` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVideoThirdQuartile`, adVolume: o.volume() }), o.trigger(`vpaid.AdVideoThirdQuartile`), r.trackThirdQuartile()); }), t.on(`AdVideoComplete`, () => { c.adFinished || (o.trigger({ type: `trace.event`, data: { event: `vpaid.AdVideoComplete` } }), o.trigger(`vpaid.AdVideoComplete`), r.trackComplete(), u.showBigPlayButton(o, !1), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVideoComplete`, adVolume: o.volume() }), t.stopAd && t.stopAd(p.noop)); }), t.on(`AdClickThru`, (i) => { if (!c.adFinished) { o.trigger({ type: `trace.event`, data: { event: `vpaid.AdClickThru` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdClickThru`, adVolume: o.volume() }), o.trigger(`vpaid.AdClickThru`); let n; let a; const d = i.url; const l = i.playerHandles; const u = p.isNotEmptyString(d) ? d : (n = e.clickThrough, a = { ASSETURI: t.options.src, CONTENTPLAYHEAD: 0 }, n ? s.parseURLMacro(n, a) : null); l && window._molSettings.disableClickThru || (r.trackClick(), l && u && (o.isFullscreen(), window.open(u, `_blank`)), t.pauseAd(p.noop)); } }), t.on(`AdUserAcceptInvitation`, () => { o.trigger({ type: `trace.event`, data: { event: `vpaid.AdUserAcceptInvitation` } }), o.trigger(`vpaid.AdUserAcceptInvitation`), r.trackAcceptInvitation(), r.trackAcceptInvitationLinear(); }), t.on(`AdUserClose`, () => { o.trigger({ type: `trace.event`, data: { event: `vpaid.AdUserClose` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdUserClose`, adVolume: o.volume() }), o.trigger(`vpaid.AdUserClose`), r.trackClose(), r.trackCloseLinear(); }), t.on(`AdUserMinimize`, () => { o.trigger({ type: `trace.event`, data: { event: `vpaid.AdUserMinimize` } }), o.trigger(`vpaid.AdUserMinimize`), r.trackCollapse(); }), t.on(`AdError`, () => { c.adFinished || (c.impressionTriggered || c.errorHasBeenTracked || (o.trigger({ type: `trace.event`, data: { event: `vpaid.AdError` } }), window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdError`, adVolume: o.volume() }), o.trigger(`vpaid.AdError`), r.trackErrorWithCode(901), c.errorHasBeenTracked = !0), u.showBigPlayButton(o, !1)); }), t.on(`AdVolumeChange`, () => { o.trigger({ type: `trace.event`, data: { event: `vpaid.AdVolumeChange` } }), o.trigger(`vpaid.AdVolumeChange`); const e = o.volume(); t.getAdVolume((t, i) => { e !== i && (i === 0 && e > 0 && r.trackMute(), i > 0 && e === 0 && r.trackUnmute(), o.volume(i)); }); }), t.on(`AdSizeChange`, () => { o.vast && o.vast.needSyncPlay && (o.paused() !== o.tech_.el_.paused && a != o.tech_.el_.src && (o.tech_.el_.paused ? (window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdPaused`, adVolume: o.volume() }), m(), u.showBigPlayButton(o, !0)) : (window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdPlaying`, adVolume: o.volume() }), h(), u.showBigPlayButton(o, !1))), o.vast.needSyncPlay = !1); }); const y = g.bind(this, o, t, this.VIEW_MODE); const A = p.throttle(y, 100); const w = this.settings.autoResize; function k () { t.pauseAd(p.noop); } function T () { t.resumeAd(p.noop); } function E () { t.stopAd && t.stopAd(p.noop); }w && (l.addEventListener(window, `resize`, A), l.addEventListener(window, `orientationchange`, A)), o.on(`vast.resize`, y), o.on(`vpaid.pauseAd`, k), o.on(`vpaid.resumeAd`, T), o.on(`stopAd`, E), o.one(`vpaid.adEnd`, () => { o.off(`vast.resize`, y), o.off(`vpaid.pauseAd`, k), o.off(`vpaid.resumeAd`, T), o.off(`stopAd`, E), w && (l.removeEventListener(window, `resize`, A), l.removeEventListener(window, `orientationchange`, A)); }), i(null, t, e); }, h.prototype._addSkipButton = function (t, e, i) { let n; let r; let o; let a; let s; const c = this.player; const d = this.tracker; const f = this; if (!window._molSettings.disableSkippability) if (e.skipoffset && p.isNumber(e.skipoffset))r = e.skipoffset / 1e3, (function (e, i) { let n = (function (e) { const i = window.document.createElement(`div`); return l.addClass(i, `vast-skip-button`), i.style.display = `none`, i.id = `adSkipButton`, i.onclick = function (n) { if (l.hasClass(i, `enabled`) && t.getAdSkippableState((i, n) => { t.skipAd(p.noop), n || (d.trackSkip(), t.stopAd(p.noop), setTimeout(() => { e.trigger(`vast.adsCancel`); }, 1)); }), u.showBigPlayButton(e, !1), void 0 === window.Event.prototype.stopPropagation) return !1; n.stopPropagation(); }, i; }(e)); const r = g.bind(f, n, i); e.el().appendChild(n), s = setInterval(r, 500), u.once(e, [`vast.adEnd`, `vast.adsCancel`], () => { s && (clearInterval(s), s = null); l.remove(n), n = null; }); }(c, r)); else { let h = !1; window._molSettings && window._molSettings.skippable && (!1 === window._molSettings.skippable.enabled && (h = !0), e.duration && window._molSettings.skippable.videoThreshold && e.duration < window._molSettings.skippable.videoThreshold && (h = !0)), h || (t.on(`AdSkippableStateChange`, () => { c.trigger(`vpaid.AdSkippableStateChange`), t.getAdSkippableState((e, i) => { i ? n || (function (e) { n = (function () { const e = window.document.createElement(`div`); return l.addClass(e, `vast-skip-button`), l.addClass(e, `enabled`), e.innerHTML = window._molSettings.skipButtonText, e.id = `adSkipButton`, e.onclick = function (e) { if (t.getAdSkippableState((e, i) => { i ? t.skipAd(p.noop) : (d.trackSkip(), t.stopAd(p.noop)); }), void 0 === window.Event.prototype.stopPropagation) return !1; e.stopPropagation(); }, e; }()), e.el().appendChild(n); }(c)) : v(); }); }), u.once(c, [`vast.adEnd`, `vast.adsCancel`], v)); } function v () { l.remove(n), n = null; } function g (e, i) { if (t.getAdDuration((t, e) => { e > 0 && (o = e); }), t.getAdRemainingTime((t, e) => { a = e, !o && a > 0 && (o = a); }), !(!o || !a || o < 0 || a < 0)) { const n = Math.ceil(i - (o - a)); if (n > 0 && !l.hasClass(e, `enabled`) ? e.innerHTML = `<p class="vast-skip-button-text">${window._molSettings.skipText.replace(`%%TIME%%`, p.toFixedDigits(n, 2))}</p>` : l.hasClass(e, `enabled`) || (l.addClass(e, `enabled`), e.innerHTML = window._molSettings.skipButtonText), !window.document.getElementById(`iframeBackButton`)) { if (c.isFullscreen() && p.isAndroid()) return void (e.style.display = `none`); e.style.display = `block`; } } }i(null, t, e); }, h.prototype._linkPlayerControls = function (t, e, i) { const n = this; !(function (t, e) { function i () { const i = t.muted() ? 0 : t.volume(); e.setAdVolume(i, m); }t.on(`volumechange`, i), e.on(`AdVolumeChange`, () => { window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdVolumeChange`, adVolume: t.volume() }); t.trigger(`vpaid.AdVolumeChange`); const i = t.volume(); e.getAdVolume((e, n) => { e ? m(e) : i !== n && t.volume(n); }); }), t.one(`vpaid.adEnd`, () => { t.off(`volumechange`, i); }); }(this.player, t)), (function (t, e, i) { const r = g.bind(n, t, e, i); t.on(`fullscreenchange`, r), t.one(`vpaid.adEnd`, () => { t.off(`fullscreenchange`, r); }); }(this.player, t, this.VIEW_MODE)), i(null, t, e); }, h.prototype._startAd = function (t, e, i) { const n = this.player; const r = t.adStarted; r && (n.trigger(`vast.adStart`), n.trigger({ type: `trace.event`, data: { event: `vpaid.AdStarted` } })), t.startAd((o) => { o || r || n.trigger(`vast.adStart`), i(o, t, e); }); }, h.prototype._finishPlaying = function (t, e, i) { const n = this.player; const o = this; t.on(`AdStopped`, () => { window.MoatApiReference && window.MoatApiReference.dispatchEvent({ type: `AdStopped`, adVolume: n.volume() }), n.trigger(`vpaid.AdStopped`), s(null); }), t.on(`AdError`, (t) => { if (o.impressionTriggered)s(null); else { const e = t ? t.message : `on VPAIDIntegrator, error while waiting for the adUnit to finish playing`; s(new r(e)); } }); const a = this.needsShowPlayer; function s (r) { if (o.adFinished = !0, u.showBigPlayButton(n, !1), a) { if (o.timeUpdateTimer) { clearInterval(o.timeUpdateTimer), o.timeUpdateTimer = null; const s = document.getElementById(`bc_time_display`); s && n.controlBar.getChild(`currentTimeDisplay`).el_.removeChild(s), v(n, !0); }n.controlBar.show(), n.tech_.el_.style.display = `block`; }i(r, t, e); } }, h.prototype._trackError = function (t, e) { this.errorHasBeenTracked || (this.errorHasBeenTracked = !0, s.track(t.errorURLMacros, { ERRORCODE: e || 901 })); }, e.exports = h; }, { "../../utils/async": 36, "../../utils/consoleLogger": 37, "../../utils/dom": 38, "../../utils/mimetypes": 40, "../../utils/playerUtils": 41, "../../utils/utilityFunctions": 43, "../vast/VASTError": 19, "../vast/VASTResponse": 21, "../vast/VASTTracker": 22, "../vast/vastUtil": 28, "./VPAIDAdUnitWrapper": 29 }], 32: [function (t, e, i) { "use strict"; const n = document.createElement(`div`); e.exports = function (t) { return { init: function (e, i) { i.el = n, n.className = `vjs-black-poster`, t.call(this, e, i); const r = e.getChild(`posterImage`); setTimeout(() => { r && e && e.el() && e.el().insertBefore(n, r.el()); }, 0); }, el: function () { return n; } }; }; }, {}], 33: [function (t, e, i) { "use strict"; const n = videojs.getComponent(`Component`); const r = t(`./black-poster`)(n); t(`../../utils/utilityFunctions`); videojs.registerComponent(`BlackPoster`, videojs.extend(n, r)); }, { "../../utils/utilityFunctions": 43, "./black-poster": 32 }], 34: [function (t, e, i) { "use strict"; const n = t(`../ads/vast/VASTClient`); const r = t(`../ads/vast/VASTError`); const o = t(`../ads/vast/vastUtil`); const a = t(`../ads/vast/VASTIntegrator`); const s = t(`../ads/vpaid/VPAIDIntegrator`); const c = t(`../ads/icon/IconIntegrator`); const d = t(`../utils/async`); const l = t(`../utils/dom`); const u = t(`../utils/playerUtils`); const p = t(`../utils/utilityFunctions`); const f = t(`../utils/anVideoViewability`); const h = t(`../utils/consoleLogger`); e.exports = function (t) { let e; let i; const v = this; const g = new n({ wrapperLimit: t.wrapperLimit }); let m = !1; const y = p.extend({}, { timeout: 500, iosPrerollCancelTimeout: 2e3, adCancelTimeout: 3e3, playAdAlways: !1, adsEnabled: !0, autoResize: !0, verbosity: 0, playsInBreak: !1, skipText: `Skip in %%TIME%% seconds`, skipButtonText: `Skip ad`, initialPlayback: `auto`, initialAudio: `on`, disableClickThru: !1, firstPlay: !0 }, t || {}); let A = ``; return v.bcinfo ? A = v.bcinfo.playerId : v.options_ && v.options_[`data-player`] && (A = v.options_[`data-player`]), h.setPlayerId(`${A}-${v.el_.id}`), p.isUndefined(y.adTagUrl) && p.isDefined(y.url) && (y.adTagUrl = y.url), p.isString(y.adTagUrl) && (y.adTagUrl = p.echoFn(y.adTagUrl)), y.viewability && y.viewability.config && (y.viewabilityTracking = new f(v)), window._molSettings = y, window._timeoutIds = [], window.MoatApiReference = null, p.isDefined(y.adTagXML) && !p.isFunction(y.adTagXML) ? b(new r(`on VideoJS VAST plugin, the passed adTagXML option does not contain a function`)) : p.isDefined(y.adTagUrl) || p.isFunction(y.adTagXML) ? (h.setVerbosity(y.verbosity), y.playsInBreak || ((e = u.getPlayerSnapshot(v)).playing = !0), y.initialPlayback === `click` && u.showBigPlayButton(v, !0), u.prepareForAds(v), v.on(`vast.contentEnd`, () => {}), y.playAdAlways && v.on(`vast.contentEnd`, () => { setTimeout(() => { v.trigger(`vast.reset`); }, 0); }), v.on(`vast.firstPlay`, function t () { v.off(`vast.firstPlay`, t); v.vast.adsCancelled && delete v.vast.adsCancelled; u.showBigPlayButton(v, !1); y.initialAudio === `off` && (y.contentVolume = { muted: v.muted(), volume: v.volume() }, v.muted(!0)); u.removeNativePoster(v); u.once(v, [`vast.adsCancel`, `vast.adEnd`], () => { u.showBigPlayButton(v, !1), (function () { v.vast && v.vast.adUnit && (v.vast.adUnit = null, v.vast.VPAID = null); window._molSettings.firstPlay = !1; }()), u.once(v, [`playing`, `vast.reset`, `vast.firstPlay`], (t) => { t.type === `playing` && (v.trigger(`vast.contentStart`), u.once(v, [`ended`, `vast.reset`, `vast.firstPlay`], (t) => { t.type === `ended` && v.trigger(`vast.contentEnd`); })); }), e && (u.restorePlayerSnapshot(v, e), e = null), setTimeout(() => { v.trigger(`adFinished`); }, 0); }); d.waterfall([function (t) { if (y.adsEnabled) return t(null); t(new r(`Ads are not enabled`)); }, function (t) { !p.isIPhone() || v.currentTime() <= y.iosPrerollCancelTimeout ? (v.pause(), l.addClass(v.el(), `vjs-vast-ad-loading`), u.once(v, [`vast.adStart`, `vast.adsCancel`], i), v.paused() ? t(null) : u.once(v, [`playing`], () => { v.pause(), t(null); })) : t(new r(`video content has been playing before preroll ad`)); }, function (t) { let e; function i () { e && (clearTimeout(e), e = null); }m = !1, e = setTimeout(() => { e = null, b(new r(`timeout while waiting for the video to start playing. You may need to increase adStartTimeout.`, 402)), u.showBigPlayButton(v, !1), v.vast.VPAID && v.trigger(`vpaid.adEnd`); }, y.adCancelTimeout), u.once(v, [`vast.adStart`, `vast.adsCancel`, `clearAdCancelTimeout`], i), u.once(v, [`vast.adError`, `vpaid.adEnd`, `vpaid.adError`], () => { i(); }), t(null); }, k], (t, e) => { t ? b(t, e) : v.trigger(`vast.adEnd`); }); function i () { setTimeout(() => { l.removeClass(v.el(), `vjs-vast-ad-loading`), v.loadingSpinner.el_.style.display = `none`; }, 100); } }), v.on(`vast.reset`, () => { e = null, w(); }), v.vast = { isEnabled: function () { return y.adsEnabled; }, enable: function () { y.adsEnabled = !0; }, disable: function () { y.adsEnabled = !1; } }, v.vast) : b(new r(`on VideoJS VAST plugin, missing adTagUrl on options object`)); function w () { v.trigger(`vast.adsCancel`), m = !0, v.adPlaying = !1, v.vast && (v.vast.adsCancelled = !0); } function k (t) { d.waterfall([T, E], t); } function T (t) { g.getVASTResponse(y.adTagUrl ? y.adTagUrl() : y.adTagXML, t); } function E (t, e) { if (!m) { if (window.MoatApiReference = null, t.ads && t.ads.length > 0 && t.ads[0].inLine && t.ads[0].inLine.moat) { const n = { level1: t.ads[0].inLine.moat.advid, level2: t.ads[0].inLine.moat.cpgid, level3: t.ads[0].inLine.moat.cpid, level4: t.ads[0].inLine.moat.crid }; t.ads[0].inLine.moat.site_id && (n.slicer1 = t.ads[0].inLine.moat.site_id), window.MoatApiReference = (function (t, e, i, n, r) { let o; let a; const s = document.createElement(`script`); let c = []; e = { adData: { ids: e, duration: i, url: r }, dispatchEvent: function (t) { this.sendEvent ? (c && (c.push(t), t = c, c = !1), this.sendEvent(t)) : c.push(t); } }, i = `_moatApi${Math.floor(1e8 * Math.random())}`; try { a = (o = t.ownerDocument).defaultView || o.parentWindow; } catch (t) { o = document, a = window; } return a[i] = e, s.type = `text/javascript`, t && t.insertBefore(s, t.childNodes[0] || null), s.src = `https://z.moatads.com/${n}/moatvideo.js#${i}`, e; }(v.el_, n, v.duration(), t.ads[0].inLine.moat.partnercode, v.currentSource().src)); }window._molSettings.viewabilityTracking && window._molSettings.viewabilityTracking.init(window._molSettings.viewability.contextId, v.duration(), v.el_.offsetWidth, v.el_.offsetHeight); const r = (function (t) { let e; let i; const n = t.mediaFiles; for (e = 0, i = n.length; e < i; e++) if (o.isVPAID(n[e])) return !0; return !1; }(t)); const d = r ? new s(v, y) : new a(v); let l = !1; r ? v.trigger(`clearAdCancelTimeout`) : v.vast.trackError = d._trackError, u.once(v, [`vast.adStart`, `vast.adsCancel`], (n) => { n.type === `vast.adStart` && (function () { window._molSettings.playsInBreak && v.on(`timeupdate`, g); if (l) return; t.icons && t.icons.length > 0 && new c(v).renderIcons(t.icons, e); const n = document.getElementsByClassName(`vjs-next-button`); n && n.length > 0 && ((i = n[0]).style.display = `none`); }()); }), u.once(v, [`vast.adEnd`, `vast.adsCancel`], () => { if (window._molSettings.playsInBreak && (v.off(`timeupdate`, g), window._molSettings.timeOffset)) { f(!0); const t = document.getElementById(`bc_time_display`); t && (t.style.display = `none`); }i && (i.style.display = ``, i = null); l = !0; }), p.isIDevice() && (function () { const t = 3; let e = 0; let i = 0; function n () { v.duration() - e > t && (v.pause(!0), v.play(!0), v.currentTime(e)); } function r () { const n = v.currentTime(); const r = Math.abs(n - e); r > t ? ((i += 1) >= 2 && v.pause(!0), v.currentTime(e)) : e = n; }v.on(`timeupdate`, r), v.on(`ended`, n), u.once(v, [`vast.adEnd`, `vast.adsCancel`, `vast.adError`], () => { v.off(`timeupdate`, r), v.off(`ended`, n); }); }()), v.vast.vastResponse = t, h.debug(`calling adIntegrator.playAd() with vastResponse:`, t), v.vast.adUnit = d.playAd(t, e), v.vast.VPAID = r; } function f (t) { for (let e = v.controlBar.getChild(`currentTimeDisplay`).el_.children, i = 0; i < e.length; i++)e[i].id != `bc_time_display` && (e[i].style.display = t ? `` : `none`); } function g () { if (window._molSettings.breakDuration && v.duration() != window._molSettings.breakDuration && (v.duration() && (window._molSettings.realVideoDuration = v.duration()), v.duration(window._molSettings.breakDuration)), window._molSettings.timeOffset) { let t = document.getElementById(`bc_time_display`); t ? (f(!1), t.style.display = `block`) : (t = document.createElement(`div`), v.controlBar.getChild(`currentTimeDisplay`).el_.appendChild(t), t.id = `bc_time_display`, t.class = `vjs-current-time-display`, t[`aria-live`] = `off`, t.innerHTML = `<span class="vjs-control-text"></span>0:00`, f(!1)); const e = v.currentTime() + window._molSettings.timeOffset; t.childNodes[1].nodeValue = (function (t) { let e = parseInt(t + 0.5); const i = parseInt(e / 60); return e -= 60 * i, `${i.toString()}:${e > 9 ? `` : `0`}${e.toString()}`; }(e)); } } } function b (t, e) { v.trigger({ type: `vast.adError`, error: t }), h.error(`AD ERROR:`, t.message, t, e), t && t.code === 402 && (v.vast && v.vast.trackError ? v.vast.trackError(t, v.vast.vastResponse) : h.warn(`WARNING: Cannot track ad start timeout error because VAST XML is not parsed yet`)), w(); } }; }, { "../ads/icon/IconIntegrator": 6, "../ads/vast/VASTClient": 18, "../ads/vast/VASTError": 19, "../ads/vast/VASTIntegrator": 20, "../ads/vast/vastUtil": 28, "../ads/vpaid/VPAIDIntegrator": 31, "../utils/anVideoViewability": 35, "../utils/async": 36, "../utils/consoleLogger": 37, "../utils/dom": 38, "../utils/playerUtils": 41, "../utils/utilityFunctions": 43 }], 35: [function (t, e, i) { t(`./consoleLogger`); e.exports = function (t) { this.init = function (t, e, i, n) {}, this.invokeEvent = function (t) {}, this.isReady = !1; }; }, { "./consoleLogger": 37 }], 36: [function (t, e, i) { const n = t(`./utilityFunctions`); var r = { setImmediate: function (t) { setTimeout(t, 0); }, iterator: function (t) { var e = function (i) { var n = function () { return t.length && t[i].apply(null, arguments), n.next(); }; return n.next = function () { return i < t.length - 1 ? e(i + 1) : null; }, n; }; return e(0); }, waterfall: function (t, e) { if (e = e || function () {}, !n.isArray(t)) { const i = new Error(`First argument to waterfall must be an array of functions`); return e(i); } if (!t.length) return e(); var o = function (t) { return function (i) { if (i)e.apply(null, arguments), e = function () {}; else { const n = Array.prototype.slice.call(arguments, 1); const a = t.next(); a ? n.push(o(a)) : n.push(e), r.setImmediate(() => { t.apply(null, n); }); } }; }; o(r.iterator(t))(); }, when: function (t, e) { if (!n.isFunction(e)) throw new Error(`async.when error: missing callback argument`); const i = n.isFunction(t) ? t : function () { return !!t; }; return function () { const t = n.arrayLikeObjToArray(arguments); const r = t.pop(); return i.apply(null, t) ? e.apply(this, arguments) : (t.unshift(null), r.apply(null, t)); }; } }; e.exports = r; }, { "./utilityFunctions": 43 }], 37: [function (t, e, i) { "use strict"; let n = 0; const r = `[Nuevo-Plugin`; let o = ``; function a (t) { try { let e = ``; try { e = window.top.location.search; } catch (t) { try { e = window.location.search; } catch (t) {} } const i = new RegExp(`[\\?&]${t}=([^&#]*)`).exec(e); return i === null ? `` : decodeURIComponent(i[1].replace(/\+/g, ` `)); } catch (t) { return ``; } } function s (t, e) { let i = r; e.length > 0 && typeof e[0] === `string` && (o && o.length > 0 && (i += `-${o}`), i += `]`, i += `[${(function () { let t = ``; try { const e = new Date(); t = `${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}.${e.getMilliseconds()}`; } catch (t) {} return t; }())}]`, e[0] = i + e[0]), t.apply ? t.apply(console, Array.prototype.slice.call(e)) : t(Array.prototype.slice.call(e)); } const c = { setPlayerId: function (t) { o = t; }, setVerbosity: function (t) { n = Math.max(t, n); }, debug: function () { n < 4 || (void 0 === console.debug ? s(console.log, arguments) : s(console.debug, arguments)); }, log: function () { n < 3 || s(console.log, arguments); }, info: function () { n < 2 || s(console.info, arguments); }, warn: function () { n < 1 || s(console.warn, arguments); }, error: function () { s(console.error, arguments); } }; typeof console !== `undefined` && console.log || (c.debug = function () {}, c.log = function () {}, c.info = function () {}, c.warn = function () {}, c.error = function () {}), e.exports = c, (function () { try { n = a(`ast_debug`).toLowerCase() == `true` ? 4 : 0; } catch (t) {} }()); }, {}], 38: [function (t, e, i) { "use strict"; const n = t(`./utilityFunctions`); var r = { isVisible: function (t) { return window.getComputedStyle(t).visibility !== `hidden`; }, isHidden: function (t) { return window.getComputedStyle(t).display === `none`; }, isShown: function (t) { return !r.isHidden(t); }, hide: function (t) { t.__prev_style_display_ = t.style.display, t.style.display = `none`; }, show: function (t) { r.isHidden(t) && (t.style.display = t.__prev_style_display_), t.__prev_style_display_ = void 0; }, hasClass: function (t, e) { let i, r, o; if (n.isNotEmptyString(e)) { if (t.classList) return t.classList.contains(e); for (e = e || ``, r = 0, o = (i = n.isString(t.getAttribute(`class`)) ? t.getAttribute(`class`).split(/\s+/) : []).length; r < o; r += 1) if (i[r] === e) return !0; } return !1; }, addClass: function (t, e) { let i; if (n.isNotEmptyString(e)) { if (t.classList) return t.classList.add(e); i = n.isString(t.getAttribute(`class`)) ? t.getAttribute(`class`).split(/\s+/) : [], n.isString(e) && n.isNotEmptyString(e.replace(/\s+/, ``)) && (i.push(e), t.setAttribute(`class`, i.join(` `))); } }, removeClass: function (t, e) { let i; if (n.isNotEmptyString(e)) { if (t.classList) return t.classList.remove(e); i = n.isString(t.getAttribute(`class`)) ? t.getAttribute(`class`).split(/\s+/) : []; let r; let o; const a = []; if (n.isString(e) && n.isNotEmptyString(e.replace(/\s+/, ``))) { for (r = 0, o = i.length; r < o; r += 1)e !== i[r] && a.push(i[r]); t.setAttribute(`class`, a.join(` `)); } } }, addEventListener: function (t, e, i) { n.isArray(t) ? n.forEach(t, (t) => { r.addEventListener(t, e, i); }) : n.isArray(e) ? n.forEach(e, (e) => { r.addEventListener(t, e, i); }) : t.addEventListener ? t.addEventListener(e, i, !1) : t.attachEvent && t.attachEvent(`on${e}`, i); }, removeEventListener: function (t, e, i) { n.isArray(t) ? n.forEach(t, (t) => { r.removeEventListener(t, e, i); }) : n.isArray(e) ? n.forEach(e, (e) => { r.removeEventListener(t, e, i); }) : t.removeEventListener ? t.removeEventListener(e, i, !1) : t.detachEvent ? t.detachEvent(`on${e}`, i) : t[`on${e}`] = null; }, dispatchEvent: function (t, e) { t.dispatchEvent ? t.dispatchEvent(e) : t.fireEvent(`on${e.eventType}`, e); }, isDescendant: function (t, e) { for (let i = e.parentNode; i !== null;) { if (i === t) return !0; i = i.parentNode; } return !1; }, getTextContent: function (t) { return t.textContent || t.text; }, prependChild: function (t, e) { return e.parentNode && e.parentNode.removeChild(e), t.insertBefore(e, t.firstChild); }, remove: function (t) { t && t.parentNode && t.parentNode.removeChild(t); }, isDomElement: function (t) { return t instanceof Element || parent && parent.Element && t instanceof parent.Element; }, click: function (t, e) { r.addEventListener(t, `click`, e); }, once: function (t, e, i) { r.addEventListener(t, e, function n () { i.apply(null, arguments), r.removeEventListener(t, e, n); }); }, getDimension: function (t) { let e; return !n.isOldIE() && t.getBoundingClientRect ? { width: (e = t.getBoundingClientRect()).width, height: e.height } : { width: t.offsetWidth, height: t.offsetHeight }; } }; e.exports = r; }, { "./utilityFunctions": 43 }], 39: [function (t, e, i) { "use strict"; const n = t(`./urlUtils`); const r = t(`./utilityFunctions`); function o (t) { this.message = `HttpRequest Error: ${t || ``}`; } function a (t) { if (!r.isFunction(t)) throw new o(`Missing XMLHttpRequest factory method`); this.createXhr = t; } function s () { let t = new XMLHttpRequest(); return `withCredentials` in t || (t = new XDomainRequest()), t; }o.prototype = new Error(), o.prototype.name = `HttpRequest Error`, a.prototype.run = function (t, e, i, a) { let s, c; !(function (t, e, i) { if (!r.isString(t) || r.isEmptyString(t)) throw new o(`Invalid url '${t}'`); if (!r.isFunction(e)) throw new o(`Invalid handler '${e}' for the http request`); if (r.isDefined(i) && !r.isObject(i)) throw new o(`Invalid options map '${i}'`); }(e, i, a)); const d = this.createXhr(); function l () { i(-1, null, null, ``); }a = a || {}, s = r.isNumber(a.timeout) ? a.timeout : 0, d.open(t, n.urlParts(e).href, !0), a.headers && (function (t, e) { r.forEach(e, (e, i) => { r.isDefined(e) && t.setRequestHeader(i, e); }); }(d, a.headers)), a.withCredentials && (d.withCredentials = !0), d.onload = function () { let t, e, n; d.getAllResponseHeaders || (d.getAllResponseHeaders = function () { return null; }), d.status || (d.status = 200), r.isDefined(c) && (clearTimeout(c), c = void 0), t = d.statusText || ``, e = `response` in d ? d.response : d.responseText, n = d.status === 1223 ? 204 : d.status, i(n, e, d.getAllResponseHeaders(), t); }, d.onerror = l, d.onabort = l, d.send(), s > 0 && (c = setTimeout(() => { d && d.abort(); }, s)); }, a.prototype.get = function (t, e, i) { this.run(`GET`, t, (t, i, n, r) => { !(function (t) { return t >= 200 && t < 300; }(t)) ? e(new o(r), i, t, n, r) : e(null, i, t, n, r); }, i); }; const c = new a(s); e.exports = { http: c, HttpRequest: a, HttpRequestError: o, createXhr: s }; }, { "./urlUtils": 42, "./utilityFunctions": 43 }], 40: [function (t, e, i) { "use strict"; e.exports = { html5: [`text/javascript`, `text/javascript1.0`, `text/javascript1.2`, `text/javascript1.4`, `text/jscript`, `application/javascript`, `application/x-javascript`, `text/ecmascript`, `text/ecmascript1.0`, `text/ecmascript1.2`, `text/ecmascript1.4`, `text/livescript`, `application/ecmascript`, `application/x-ecmascript`], flash: [`application/x-shockwave-flash`] }; }, {}], 41: [function (t, e, i) { "use strict"; const n = t(`./dom`); const r = t(`./utilityFunctions`); var o = { getPlayerSnapshot: function (t) { let e; const i = t.el().querySelector(`.vjs-tech`); const n = { ended: t.ended(), src: t.currentSrc(), currentTime: t.currentTime(), type: t.currentType(), playing: !t.paused(), suppressedTracks: (function (t) { let e = t.remoteTextTracks ? t.remoteTextTracks() : []; e && r.isArray(e.tracks_) && (e = e.tracks_); r.isArray(e) || (e = []); const i = []; return e.forEach((t) => { i.push({ track: t, mode: t.mode }), t.mode = `disabled`; }), i; }(t)) }; if (n.ended && (n.currentTime = t.duration() + 1), i && (n.nativePoster = i.poster, n.style = i.getAttribute(`style`)), (e = r.scriptLoadedInIframe() ? parent.document.getElementsByClassName(`vjs-dock-text`) : document.getElementsByClassName(`vjs-dock-text`)) && e.length > 0) { for (var o = !1, a = 0; a < e.length; a++) if (s(e[a]).indexOf(t.el_) >= 0) { o = !0; break; }o && (n.dockText = e[a], n.dockText.style.display = `none`); } return n; function s (t) { for (var e = []; t.parentElement;)e.unshift(t.parentElement), t = t.parentElement; return e; } }, restorePlayerSnapshot: function (t, e) { let i; const n = t.el().querySelector(`.vjs-tech`); let r = 20; e.nativePoster && (n.poster = e.nativePoster), `style` in e && n.setAttribute(`style`, e.style || ``), e.dockText && (e.dockText.style.display = `block`), t.one(`contentloadedmetadata`, () => { e.suppressedTracks.forEach((t) => { t.track.mode = t.mode; }); }), t.one(`canplay`, function i () { t.play(); if (!o.isReadyToResume(t) && r--)setTimeout(i, 50); else try { t.currentTime() !== e.currentTime ? (e.playing && t.one(`seeked`, () => { e.ended || t.play(); }), t.currentTime(e.currentTime)) : e.playing && t.play(); } catch (t) { videojs.log.warn(`Failed to resume the content after an advertisement`, t); } }), i = setTimeout(() => { t.trigger(`canplay`); }, 1e3), t.one(`canplay`, () => { clearTimeout(i); }), t.src({ src: e.src, type: e.type }); }, isReadyToResume: function (t) { return r.isIE11() ? t.readyState() > 1 : t.readyState() > 1 || (void 0 === t.seekable() || t.seekable().length > 0); } }; o.prepareForAds = function (t) { let e; let i; const o = t.addChild(`blackPoster`); !(function () { const i = t.play; t.play = function (n) { const o = this; return u() ? (function () { r.isIPhone() || (e || (e = { muted: t.muted(), volume: t.volume() }), t.muted(!0)); i.apply(o, arguments); }()) : (function (e) { c() && !e ? t.vast.adUnit.resumeAd() : s() || i.apply(o, arguments); }(n)), this; }; const n = t.pause; t.pause = function (e) { return c() && !e ? t.vast.adUnit.pauseAd() : s() || n.apply(this, arguments), this; }; const o = t.paused; if (t.paused = function (e) { return c() && !e ? t.vast.adUnit.isPaused() : o.apply(this, arguments); }, parent && window !== parent && videojs && !videojs.getPlugins && r.scriptLoadedInIframe()) { const a = t.src; t.src = function (t) { if (t && !(t instanceof parent.Object)) if (r.isIE11()) { const e = new parent.Object(); for (const i in t)t.hasOwnProperty(i) && (e[i] = t[i]); t = e; } else t = parent.Object.assign(new parent.Object(), t); a.call(this, t); }; } }()), t.on(`play`, d), t.on(`vast.reset`, l), t.on(`vast.firstPlay`, p), t.on(`error`, f), t.on(`vast.adStart`, f), t.on(`vast.adsCancel`, f), t.on(`vast.adError`, f), t.on(`vast.adStart`, h), t.on(`vast.adEnd`, v), t.on(`vast.adsCancel`, v); const a = document.getElementsByClassName(`vjs-error-display`); function s () { return t.vast && t.vast.VPAID; } function c () { return t.vast && t.vast.adUnit; } function d () { u() && (window._molSettings.firstPlay = !1, t.trigger(`vast.firstPlay`)); } function l () { window._molSettings.firstPlay = !0, o.show(), p(); } function u () { return window._molSettings.firstPlay; } function p () { let i; e && (i = e, r.isObject(i) && (t.volume(i.volume), t.muted(i.muted)), e = null); } function f () { n.hasClass(o.el(), `vjs-hidden`) || o.hide(); } function h () { n.addClass(t.el(), `vjs-ad-playing`); } function v () { t.off(`play`, d), t.off(`vast.reset`, l), t.off(`vast.firstPlay`, p), t.off(`error`, f), t.off(`vast.adStart`, f), t.off(`vast.adsCancel`, f), t.off(`vast.adError`, f), t.off(`vast.adStart`, h), t.off(`vast.adEnd`, v), t.off(`vast.adsCancel`, v), n.removeClass(t.el(), `vjs-ad-playing`), n.removeClass(t.controlBar.playToggle.el(), `vjs-ended`), i && setTimeout(() => { i.style.removeProperty(`display`); }, 500); }a && a.length > 0 && (i = a[0]).style.setProperty(`display`, `none`, `important`); }, o.removeNativePoster = function (t) { const e = t.el().querySelector(`.vjs-tech`); e && e.removeAttribute(`poster`); }, o.once = function (t, e, i) { function n () { i.apply(null, arguments), e.forEach((e) => { t.off(e, n); }); }e.forEach((e) => { t.on(e, n); }); }, o.showBigPlayButton = function (t, e) { const i = t.bigPlayButton.el_; i && (e ? (i.style.display = `block`, i.style.zIndex = 99999) : (i.style.display = `none`, i.style.zIndex = ``)); }, e.exports = o; }, { "./dom": 38, "./utilityFunctions": 43 }], 42: [function (t, e, i) { "use strict"; const n = t(`./utilityFunctions`); const r = document.createElement(`a`); const o = document.documentMode; e.exports = { urlParts: function (t) { let e = t; return o && (r.setAttribute(`href`, e), e = r.href), r.setAttribute(`href`, e), { href: r.href, protocol: r.protocol ? r.protocol.replace(/:$/, ``) : ``, host: r.host, search: r.search ? r.search.replace(/^\?/, ``) : ``, hash: r.hash ? r.hash.replace(/^#/, ``) : ``, hostname: r.hostname, port: n.isNotEmptyString(r.port) ? r.port : 80, pathname: r.pathname.charAt(0) === `/` ? r.pathname : `/${r.pathname}` }; }, queryStringToObj: function (t, e) { let i, r; return e = n.isFunction(e) ? e : function () { return !0; }, i = (t = t.trim().replace(/^\?/, ``)).split(`&`), r = {}, n.forEach(i, (t) => { let i, n, o; t !== `` && (n = (i = t.split(`=`))[0], o = i[1], e(n, o) && (r[n] = o)); }), r; }, objToQueryString: function (t) { const e = []; return n.forEach(t, (t, i) => { e.push(`${i}=${t}`); }), e.join(`&`); } }; }, { "./utilityFunctions": 43 }], 43: [function (t, e, i) { "use strict"; const n = 1; const r = /[A-Z]/g; const o = /^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)+$/i; const a = /^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/; function s (t) { return t === null; } function c (t) { return typeof t === `object`; } function d (t) { return typeof t === `function`; } function l (t) { return Object.prototype.toString.call(t) === `[object Array]`; } function u () { return /(edge)\/((\d+)?[\w\.]+)/i.test(p._UA); } var p = { _UA: navigator.userAgent, noop: function () {}, isNull: s, isDefined: function (t) { return void 0 !== t; }, isUndefined: function (t) { return void 0 === t; }, isObject: c, isFunction: d, isNumber: function (t) { return typeof t === `number`; }, isWindow: function (t) { return p.isObject(t) && t.window === t; }, isArray: l, isArrayLike: function (t) { if (t === null || p.isWindow(t) || p.isFunction(t) || p.isUndefined(t)) return !1; const e = t.length; return !(t.nodeType !== n || !e) || p.isString(t) || p.isArray(t) || e === 0 || typeof e === `number` && e > 0 && e - 1 in t; }, isString: function (t) { return typeof t === `string`; }, isEmptyString: function (t) { return p.isString(t) && t.length === 0; }, isNotEmptyString: function (t) { return p.isString(t) && t.length !== 0; }, arrayLikeObjToArray: function (t) { return Array.prototype.slice.call(t); }, forEach: function t (e, i, n) { let r, o; if (e) if (d(e)) for (r in e)r === `prototype` || r === `length` || r === `name` || e.hasOwnProperty && !e.hasOwnProperty(r) || i.call(n, e[r], r, e); else if (l(e)) { const a = typeof e !== `object`; for (r = 0, o = e.length; r < o; r++)(a || r in e) && i.call(n, e[r], r, e); } else if (e.forEach && e.forEach !== t)e.forEach(i, n, e); else for (r in e)e.hasOwnProperty(r) && i.call(n, e[r], r, e); return e; }, snake_case: function (t, e) { return e = e || `_`, t.replace(r, (t, i) => { return (i ? e : ``) + t.toLowerCase(); }); }, isValidEmail: function (t) { return !!p.isString(t) && o.test(t.trim()); }, extend: function t (e) { let i, n, r; for (n = 1; n < arguments.length; n++) for (r in i = arguments[n])i.hasOwnProperty(r) && (c(e[r]) && !s(e[r]) && c(i[r]) ? e[r] = t({}, e[r], i[r]) : e[r] = i[r]); return e; }, capitalize: function (t) { return t.charAt(0).toUpperCase() + t.slice(1); }, decapitalize: function (t) { return t.charAt(0).toLowerCase() + t.slice(1); }, transformArray: function (t, e) { const i = []; return t.forEach((t, n) => { const r = e(t, n); p.isDefined(r) && i.push(r); }), i; }, toFixedDigits: function (t, e) { let i = `${t}`; if (e = p.isNumber(e) ? e : 0, t = p.isNumber(t) ? t : parseInt(t, 10), p.isNumber(t) && !isNaN(t)) { for (i = `${t}`; i.length < e;)i = `0${i}`; return i; } return `NaN`; }, throttle: function (t, e) { let i = (new Date()).getTime() - (e + 1); return function () { const n = (new Date()).getTime(); n - i >= e && (i = n, t.apply(this, arguments)); }; }, debounce: function (t, e) { let i; return function () { i && clearTimeout(i), i = setTimeout(function () { t.apply(this, arguments), i = void 0; }, e); }; }, treeSearch: function t (e, i, n) { for (let r = i(e), o = 0; o < r.length; o++) { if (n(r[o])) return r[o]; const a = t(r[o], i, n); if (a) return a; } }, echoFn: function (t) { return function () { return t; }; }, isISO8601: function (t) { return p.isNumber(t) && (t += ``), !!p.isString(t) && a.test(t.trim()); }, isOldIE: function () { const t = p.getInternetExplorerVersion(navigator); return t !== -1 && t < 10; }, isIE11: function () { return navigator.userAgent.search(/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i) >= 0; }, getInternetExplorerVersion: function (t) { let e = -1; if (t.appName == `Microsoft Internet Explorer`) { const i = t.userAgent; const n = new RegExp(`MSIE ([0-9]{1,}[.0-9]{0,})`).exec(i); n !== null && (e = parseFloat(n[1])); } return e; }, isIDevice: function () { return /iP(hone|ad)/.test(p._UA); }, isMobile: function () { return /iP(hone|ad|od)|Android|Windows Phone/.test(p._UA); }, isIPhone: function () { return /iP(hone|od)/.test(p._UA); }, isAndroid: function () { return /Android/.test(p._UA); }, isEdge: u, scriptLoadedInIframe: function () { const t = document.documentElement.classList; return !(t && t.contains(`bc-iframe`) && u()); } }; e.exports = p; }, {}], 44: [function (t, e, i) { "use strict"; const n = t(`./utilityFunctions`); const r = {}; r.strToXMLDoc = function (t) { if (void 0 === window.DOMParser) { const e = new ActiveXObject(`Microsoft.XMLDOM`); return e.async = !1, e.loadXML(t), e; } return (function (t) { let e; const i = new DOMParser(); try { if ((function (t) { try { const e = new DOMParser(); const i = e.parseFromString(`INVALID`, `text/xml`); const n = i.getElementsByTagName(`parsererror`)[0].namespaceURI; return n === `http://www.w3.org/1999/xhtml` ? t.getElementsByTagName(`parsererror`).length > 0 : t.getElementsByTagNameNS(n, `parsererror`).length > 0; } catch (t) {} }(e = i.parseFromString(t, `application/xml`))) || n.isEmptyString(t)) throw new Error(); } catch (e) { throw new Error(`xml.strToXMLDOC: Error parsing the string: '${t}'`); } return e; }(t)); }, r.parseText = function (t) { return /^\s*$/.test(t) ? null : /^(?:true|false)$/i.test(t) ? t.toLowerCase() === `true` : isFinite(t) ? parseFloat(t) : n.isISO8601(t) ? new Date(t) : t.trim(); }, r.JXONTree = function (t) { const e = r.parseText; if (t.documentElement) return new r.JXONTree(t.documentElement); if (t.hasChildNodes()) { for (var i, o, a, s = ``, c = 0; c < t.childNodes.length; c++)((i = t.childNodes.item(c)).nodeType - 1 | 1) == 3 ? s += i.nodeType === 3 ? i.nodeValue.trim() : i.nodeValue : i.nodeType !== 1 || i.prefix || (o = n.decapitalize(i.nodeName), a = new r.JXONTree(i), this.hasOwnProperty(o) ? (this[o].constructor !== Array && (this[o] = [this[o]]), this[o].push(a)) : this[o] = a); s && (this.keyValue = e(s)); } if (void 0 === t.hasAttributes ? t.attributes.length > 0 : t.hasAttributes()) for (var d, l = 0; l < t.attributes.length; l++)d = t.attributes.item(l), this[`@${n.decapitalize(d.name)}`] = e(d.value.trim()); }, r.JXONTree.prototype.attr = function (t) { return this[`@${n.decapitalize(t)}`]; }, r.toJXONTree = function (t) { const e = r.strToXMLDoc(t); return new r.JXONTree(e); }, r.keyValue = function (t) { if (t) return t.keyValue; }, r.attr = function (t, e) { if (t) return t[`@${n.decapitalize(e)}`]; }, r.encode = function (t) { if (n.isString(t)) return t.replace(/&/g, `&amp;`).replace(/</g, `&lt;`).replace(/>/g, `&gt;`).replace(/"/g, `&quot;`).replace(/'/g, `&apos;`); }, r.decode = function (t) { if (n.isString(t)) return t.replace(/&apos;/g, `'`).replace(/&quot;/g, `"`).replace(/&gt;/g, `>`).replace(/&lt;/g, `<`).replace(/&amp;/g, `&`); }, e.exports = r; }, { "./utilityFunctions": 43 }], 45: [function (t, e, i) { "use strict"; const n = window.videojs || { getComponent: function () {}, extend: function () {}, registerComponent: function () {}, registerPlugin: function () {} }; window._molSettings = null, t(`./plugin/components/black-poster_5`); const r = t(`./utils/consoleLogger`); r.log(`VastVpaid  plugin version 4.0.1`); const o = t(`./plugin/videojs.vast.vpaid`); if (n.registerPlugin)n.getPlugins().vastClient || n.registerPlugin(`vastClient`, o); else if (n.Player)n.Player.prototype.vastClient || n.plugin(`vastClient`, o); else if (n.plugin) try { n.plugin(`vastClient`, o); } catch (t) { r.log(`*** ERROR: Unable to register VastVpaid plugin with VideoJS!`); }parent && window !== parent && (window.bc_vastClientFunc = o); }, { "./plugin/components/black-poster_5": 33, "./plugin/videojs.vast.vpaid": 34, "./utils/consoleLogger": 37 }] }, {}, [45]);
